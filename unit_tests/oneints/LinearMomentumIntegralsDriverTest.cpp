//
//                             VELOXCHEM
//      ---------------------------------------------------
//                     An Electronic Structure Code
//
//  Copyright Â© 2019 by VeloxChem developers. All rights reserved.
//  Contact: Zilvinas Rinkevicius (rinkevic@kth.se), KTH, Sweden.

#include "LinearMomentumIntegralsDriverTest.hpp"

#include "LinearMomentumIntegralsDriver.hpp"
#include "MoleculeSetter.hpp"
#include "MolecularBasisSetter.hpp"

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeSSForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 0);
    
    CGtoBlock kgtos(mlih, mbas, 0);
    
    CDenseMatrix lmomxmat(4, 4);
    
    CDenseMatrix lmomymat(4, 4);
    
    CDenseMatrix lmomzmat(4, 4);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.127944518802996,
                                  0.145535821281024,  0.000000000000000,  0.000000000000000,
                                  0.146032908655964,  0.162329148804550, -0.127944518802996,
                                 -0.146032908655964,  0.000000000000000, -0.000000000000000,
                                 -0.145535821281024, -0.162329148804550,  0.000000000000000,
                                  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 4, 4));
    
    std::vector<double> intyvals{ 0.000000000000000, -0.000000000000000,  0.191916778204494,
                                  0.218303731921536,  0.000000000000000,  0.000000000000000,
                                  0.219049362983946,  0.243493723206825, -0.191916778204494,
                                 -0.219049362983946,  0.000000000000000, -0.000000000000000,
                                 -0.218303731921536, -0.243493723206825,  0.000000000000000,
                                  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 4, 4));
    
    std::vector<double> intzvals{ 0.000000000000000, -0.000000000000000,  0.351847426708239,
                                  0.400223508522816,  0.000000000000000,  0.000000000000000,
                                  0.401590498803901,  0.446405159212512, -0.351847426708239,
                                 -0.401590498803901,  0.000000000000000, -0.000000000000000,
                                 -0.400223508522816, -0.446405159212512,  0.000000000000000,
                                  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 4, 4));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeSPForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 0);
    
    CGtoBlock kgtos(mlih, mbas, 1);
    
    CDenseMatrix lmomxmat(4, 12);
    
    CDenseMatrix lmomymat(4, 12);
    
    CDenseMatrix lmomzmat(4, 12);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                    bgtos, kgtos);
    
    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.107307967194877,
                                 -0.110697466574632, -0.000000000000000, -0.000000000000000,
                                 -0.196731273190607, -0.202945355386824,  1.432596339546310,
                                  1.298471579586876,  0.137019220788034,  0.332986675882284,
                                 -0.000000000000000, -0.000000000000000, -0.090520533275482,
                                 -0.104537955299516, -0.000000000000000, -0.000000000000000,
                                 -0.165954311005051, -0.191652918049112,  1.008632382577365,
                                  1.095445115010333,  0.177142761791934,  0.384031794121138,
                                 -0.118168626828747, -0.127882642712090, -0.000000000000000,
                                 -0.000000000000000, -0.216642482519369, -0.234451511638832,
                                 -0.000000000000000, -0.000000000000000,  0.154741562277104,
                                  0.248017897395952,  1.565288327337252,  1.076710929452701,
                                 -0.070949043161217, -0.085354883079230, -0.000000000000000,
                                 -0.000000000000000, -0.130073245795564, -0.156483952311922,
                                 -0.000000000000000, -0.000000000000000,  0.216953508414834,
                                  0.313560646867450,  0.623282362491886,  0.894427190999916};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 4, 12));
    
    std::vector<double> intyvals{ 1.432596339546310,  1.298471579586876,  0.047595914792303,
                                  0.240738787070091, -0.000000000000000, -0.000000000000000,
                                 -0.295096909785911, -0.304418033080237, -0.000000000000000,
                                 -0.000000000000000, -0.107307967194877, -0.110697466574632,
                                  1.008632382577365,  1.095445115010333,  0.101708984062365,
                                  0.296916831371542, -0.000000000000000, -0.000000000000000,
                                 -0.248931466507576, -0.287479377073669, -0.000000000000000,
                                 -0.000000000000000, -0.090520533275482, -0.104537955299516,
                                  0.056267706586482,  0.141449028469210,  1.565288327337252,
                                  1.076710929452701, -0.324963723779053, -0.351677267458248,
                                 -0.000000000000000, -0.000000000000000, -0.118168626828747,
                                 -0.127882642712090, -0.000000000000000, -0.000000000000000,
                                  0.157829305780487,  0.242431577634758,  0.623282362491886,
                                  0.894427190999916, -0.195109868693346, -0.234725928467883,
                                 -0.000000000000000, -0.000000000000000, -0.070949043161217,
                                 -0.085354883079230, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 4, 12));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.295096909785911,
                                 -0.304418033080237,  1.432596339546310,  1.298471579586876,
                                 -0.332453135689551, -0.151314740381729, -0.000000000000000,
                                 -0.000000000000000, -0.196731273190607, -0.202945355386824,
                                 -0.000000000000000, -0.000000000000000, -0.248931466507576,
                                 -0.287479377073669,  1.008632382577365,  1.095445115010333,
                                 -0.218884571288302, -0.073321760314244, -0.000000000000000,
                                 -0.000000000000000, -0.165954311005051, -0.191652918049112,
                                 -0.324963723779053, -0.351677267458248, -0.000000000000000,
                                 -0.000000000000000, -0.362246180098662, -0.311468664469442,
                                  1.565288327337252,  1.076710929452701, -0.216642482519369,
                                 -0.234451511638832, -0.000000000000000, -0.000000000000000,
                                 -0.195109868693346, -0.234725928467883, -0.000000000000000,
                                 -0.000000000000000, -0.093448555415488, -0.059866966604182,
                                  0.623282362491886,  0.894427190999916, -0.130073245795564,
                                 -0.156483952311922, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 4, 12));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputePSForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 1);
    
    CGtoBlock kgtos(mlih, mbas, 0);
    
    CDenseMatrix lmomxmat(12, 4);
    
    CDenseMatrix lmomymat(12, 4);
    
    CDenseMatrix lmomzmat(12, 4);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000,  0.118168626828747,
                                  0.070949043161217,  0.000000000000000,  0.000000000000000,
                                  0.127882642712090,  0.085354883079230,  0.107307967194877,
                                  0.090520533275482,  0.000000000000000,  0.000000000000000,
                                  0.110697466574632,  0.104537955299516,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.216642482519369,  0.130073245795564,  0.000000000000000,
                                  0.000000000000000,  0.234451511638832,  0.156483952311922,
                                  0.196731273190607,  0.165954311005051,  0.000000000000000,
                                  0.000000000000000,  0.202945355386824,  0.191652918049112,
                                  0.000000000000000,  0.000000000000000, -1.432596339546310,
                                 -1.008632382577365, -0.154741562277104, -0.216953508414834,
                                 -1.298471579586876, -1.095445115010333, -0.248017897395952,
                                 -0.313560646867450, -0.137019220788034, -0.177142761791934,
                                 -1.565288327337252, -0.623282362491886, -0.332986675882284,
                                 -0.384031794121138, -1.076710929452701, -0.894427190999916};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 12, 4));
    
    std::vector<double> intyvals{-1.432596339546310, -1.008632382577365, -0.056267706586482,
                                 -0.157829305780487, -1.298471579586876, -1.095445115010333,
                                 -0.141449028469210, -0.242431577634758, -0.047595914792303,
                                 -0.101708984062365, -1.565288327337252, -0.623282362491886,
                                 -0.240738787070091, -0.296916831371542, -1.076710929452701,
                                 -0.894427190999916,  0.000000000000000,  0.000000000000000,
                                  0.324963723779053,  0.195109868693346,  0.000000000000000,
                                  0.000000000000000,  0.351677267458248,  0.234725928467883,
                                  0.295096909785911,  0.248931466507576,  0.000000000000000,
                                  0.000000000000000,  0.304418033080237,  0.287479377073669,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.118168626828747,  0.070949043161217,
                                  0.000000000000000,  0.000000000000000,  0.127882642712090,
                                  0.085354883079230,  0.107307967194877,  0.090520533275482,
                                  0.000000000000000,  0.000000000000000,  0.110697466574632,
                                  0.104537955299516,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 12, 4));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.324963723779053,
                                  0.195109868693346,  0.000000000000000,  0.000000000000000,
                                  0.351677267458248,  0.234725928467883,  0.295096909785911,
                                  0.248931466507576,  0.000000000000000,  0.000000000000000,
                                  0.304418033080237,  0.287479377073669,  0.000000000000000,
                                  0.000000000000000, -1.432596339546310, -1.008632382577365,
                                  0.362246180098662,  0.093448555415488, -1.298471579586876,
                                 -1.095445115010333,  0.311468664469442,  0.059866966604182,
                                  0.332453135689551,  0.218884571288302, -1.565288327337252,
                                 -0.623282362491886,  0.151314740381729,  0.073321760314244,
                                 -1.076710929452701, -0.894427190999916,  0.000000000000000,
                                  0.000000000000000,  0.216642482519369,  0.130073245795564,
                                  0.000000000000000,  0.000000000000000,  0.234451511638832,
                                  0.156483952311922,  0.196731273190607,  0.165954311005051,
                                  0.000000000000000,  0.000000000000000,  0.202945355386824,
                                  0.191652918049112,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 12, 4));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeSDForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 0);
    
    CGtoBlock kgtos(mlih, mbas, 2);
    
    CDenseMatrix lmomxmat(4, 20);
    
    CDenseMatrix lmomymat(4, 20);
    
    CDenseMatrix lmomzmat(4, 20);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.113392189400599,
                                 -0.252839962861648, -0.000000000000000, -0.000000000000000,
                                  0.169737349857497,  0.155564371560704, -0.000000000000000,
                                 -0.000000000000000,  0.208459331839402,  0.248370868738446,
                                 -0.000000000000000, -0.000000000000000, -0.207885680567764,
                                 -0.463539931913022, -0.000000000000000, -0.000000000000000,
                                 -0.142461021665474, -0.229842909492285, -0.000000000000000,
                                 -0.000000000000000, -0.110260343385320, -0.247311704786708,
                                 -0.000000000000000, -0.000000000000000,  0.102985392621790,
                                  0.123422098419075, -0.000000000000000, -0.000000000000000,
                                  0.142437854758723,  0.215032952491695, -0.000000000000000,
                                 -0.000000000000000, -0.202143962873087, -0.453404792108965,
                                 -0.000000000000000, -0.000000000000000, -0.114076898744252,
                                 -0.213495296507744,  0.141878644848978,  0.216858774232038,
                                  0.000000000000000, -0.000000000000000, -0.201762260890393,
                                 -0.206228255647979, -0.000000000000000, -0.000000000000000,
                                 -0.250519903981283, -0.283716242018247, -0.000000000000000,
                                 -0.000000000000000,  0.260110848889792,  0.397574419425402,
                                 -0.000000000000000, -0.000000000000000,  0.174067866007655,
                                  0.225813950197835,  0.000000000000000,  0.000000000000000,
                                  0.106941208623041,  0.164874469857805, -0.000000000000000,
                                 -0.000000000000000, -0.063678019032567, -0.082281398946050,
                                 -0.000000000000000, -0.000000000000000, -0.102992930977326,
                                 -0.143355301661130, -0.000000000000000, -0.000000000000000,
                                  0.196058882475576,  0.302269861405977, -0.000000000000000,
                                 -0.000000000000000,  0.096379419306978,  0.142330197671830,
                                  0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 4, 20));

    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.024159232370855,
                                 -0.121419256586340, -0.000000000000000, -0.000000000000000,
                                 -0.066437889019850, -0.333902955612435, -0.000000000000000,
                                 -0.000000000000000,  0.312688997759103,  0.372556303107670,
                                 -0.000000000000000, -0.000000000000000,  0.169737349857497,
                                  0.155564371560704, -0.000000000000000, -0.000000000000000,
                                  0.136538191653894,  0.274053286256289, -0.000000000000000,
                                 -0.000000000000000, -0.042299200856338, -0.127473833973237,
                                 -0.000000000000000, -0.000000000000000, -0.116322802354928,
                                 -0.350553043426402, -0.000000000000000, -0.000000000000000,
                                  0.213656782138084,  0.322549428737542, -0.000000000000000,
                                 -0.000000000000000,  0.102985392621790,  0.123422098419075,
                                 -0.000000000000000, -0.000000000000000,  0.124303806015564,
                                  0.264141990934764,  0.033445684174957,  0.082079105352274,
                                  0.000000000000000,  0.000000000000000,  0.091975631481131,
                                  0.225717539718753, -0.000000000000000, -0.000000000000000,
                                 -0.375779855971924, -0.425574363027370, -0.000000000000000,
                                 -0.000000000000000, -0.201762260890393, -0.206228255647979,
                                 -0.000000000000000, -0.000000000000000, -0.169391680424940,
                                 -0.244980809093126, -0.000000000000000, -0.000000000000000,
                                  0.051997769678219,  0.084982555982158,  0.000000000000000,
                                 -0.000000000000000,  0.142993866615103,  0.233702028950935,
                                 -0.000000000000000, -0.000000000000000, -0.154489396465989,
                                 -0.215032952491695, -0.000000000000000, -0.000000000000000,
                                 -0.063678019032567, -0.082281398946050, -0.000000000000000,
                                 -0.000000000000000, -0.115624574854755, -0.176094660623176,
                                 -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 4, 20));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000,  0.169737349857497,
                                  0.155564371560704, -0.000000000000000, -0.000000000000000,
                                  0.291662850032064,  0.118393196544577, -0.000000000000000,
                                 -0.000000000000000,  0.017198792385434, -0.299485087973419,
                                 -0.000000000000000, -0.000000000000000,  0.194441900021376,
                                  0.078928797696384, -0.000000000000000, -0.000000000000000,
                                 -0.070723895773957, -0.064818488150293, -0.000000000000000,
                                 -0.000000000000000,  0.102985392621790,  0.123422098419075,
                                 -0.000000000000000, -0.000000000000000,  0.135500252643952,
                                  0.047218302804268, -0.000000000000000, -0.000000000000000,
                                 -0.077336801858595, -0.336495080468175, -0.000000000000000,
                                 -0.000000000000000,  0.090333501762634,  0.031478868536178,
                                 -0.000000000000000, -0.000000000000000, -0.042910580259079,
                                 -0.051425874341281, -0.201762260890393, -0.206228255647979,
                                 -0.000000000000000, -0.000000000000000, -0.339599477730370,
                                 -0.275276835837003,  0.000000000000000, -0.000000000000000,
                                 -0.005429538796785,  0.146531306510053, -0.000000000000000,
                                 -0.000000000000000, -0.226399651820247, -0.183517890558002,
                                  0.000000000000000,  0.000000000000000,  0.084067608704330,
                                  0.085928439853325, -0.000000000000000, -0.000000000000000,
                                 -0.063678019032567, -0.082281398946050, -0.000000000000000,
                                 -0.000000000000000, -0.045017700431948, -0.031478868536178,
                                 -0.000000000000000, -0.000000000000000,  0.129882428395056,
                                  0.224330053645450, -0.000000000000000, -0.000000000000000,
                                 -0.030011800287965, -0.020985912357452,  0.000000000000000,
                                 -0.000000000000000,  0.026532507930236,  0.034283916227521,
                                 -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 4, 20));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeDSForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 2);
    
    CGtoBlock kgtos(mlih, mbas, 0);
    
    CDenseMatrix lmomxmat(20, 4);
    
    CDenseMatrix lmomymat(20, 4);
    
    CDenseMatrix lmomzmat(20, 4);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000, -0.141878644848978,
                                 -0.106941208623041,  0.000000000000000,  0.000000000000000,
                                 -0.216858774232038, -0.164874469857805,  0.113392189400599,
                                  0.110260343385320, -0.000000000000000,  0.000000000000000,
                                  0.252839962861648,  0.247311704786708,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.201762260890393,  0.063678019032567,  0.000000000000000,
                                  0.000000000000000,  0.206228255647979,  0.082281398946050,
                                 -0.169737349857497, -0.102985392621790,  0.000000000000000,
                                  0.000000000000000, -0.155564371560704, -0.123422098419075,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.250519903981283,  0.102992930977326,
                                  0.000000000000000,  0.000000000000000,  0.283716242018247,
                                  0.143355301661130, -0.208459331839402, -0.142437854758723,
                                  0.000000000000000,  0.000000000000000, -0.248370868738446,
                                 -0.215032952491695,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.260110848889792,
                                 -0.196058882475576,  0.000000000000000,  0.000000000000000,
                                 -0.397574419425402, -0.302269861405977,  0.207885680567764,
                                  0.202143962873087,  0.000000000000000,  0.000000000000000,
                                  0.463539931913022,  0.453404792108965,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.174067866007655, -0.096379419306978,  0.000000000000000,
                                  0.000000000000000, -0.225813950197835, -0.142330197671830,
                                  0.142461021665474,  0.114076898744252, -0.000000000000000,
                                 -0.000000000000000,  0.229842909492285,  0.213495296507744,
                                 -0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 20, 4));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000, -0.033445684174957,
                                 -0.051997769678219,  0.000000000000000,  0.000000000000000,
                                 -0.082079105352274, -0.084982555982158,  0.024159232370855,
                                  0.042299200856338, -0.000000000000000, -0.000000000000000,
                                  0.121419256586340,  0.127473833973237, -0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.091975631481131, -0.142993866615103,  0.000000000000000,
                                  0.000000000000000, -0.225717539718753, -0.233702028950935,
                                  0.066437889019850,  0.116322802354928,  0.000000000000000,
                                  0.000000000000000,  0.333902955612435,  0.350553043426402,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.375779855971924,  0.154489396465989,
                                  0.000000000000000,  0.000000000000000,  0.425574363027370,
                                  0.215032952491695, -0.312688997759103, -0.213656782138084,
                                  0.000000000000000,  0.000000000000000, -0.372556303107670,
                                 -0.322549428737542,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.201762260890393,
                                  0.063678019032567,  0.000000000000000,  0.000000000000000,
                                  0.206228255647979,  0.082281398946050, -0.169737349857497,
                                 -0.102985392621790,  0.000000000000000,  0.000000000000000,
                                 -0.155564371560704, -0.123422098419075,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.169391680424940,  0.115624574854755,  0.000000000000000,
                                  0.000000000000000,  0.244980809093126,  0.176094660623176,
                                 -0.136538191653894, -0.124303806015564,  0.000000000000000,
                                  0.000000000000000, -0.274053286256289, -0.264141990934764,
                                  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 20, 4));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.201762260890393,
                                 0.063678019032567,  0.000000000000000,  0.000000000000000,
                                 0.206228255647979,  0.082281398946050, -0.169737349857497,
                                -0.102985392621790,  0.000000000000000,  0.000000000000000,
                                -0.155564371560704, -0.123422098419075,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.339599477730370,  0.045017700431948,  0.000000000000000,
                                 0.000000000000000,  0.275276835837003,  0.031478868536178,
                                -0.291662850032064, -0.135500252643952, -0.000000000000000,
                                 0.000000000000000, -0.118393196544577, -0.047218302804268,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.005429538796785, -0.129882428395056,
                                 0.000000000000000,  0.000000000000000, -0.146531306510053,
                                -0.224330053645450, -0.017198792385434,  0.077336801858595,
                                 0.000000000000000,  0.000000000000000,  0.299485087973419,
                                 0.336495080468175,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.226399651820247,
                                 0.030011800287965,  0.000000000000000,  0.000000000000000,
                                 0.183517890558002,  0.020985912357452, -0.194441900021376,
                                -0.090333501762634, -0.000000000000000, -0.000000000000000,
                                -0.078928797696384, -0.031478868536178, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.084067608704330, -0.026532507930236,  0.000000000000000,
                                 0.000000000000000, -0.085928439853325, -0.034283916227521,
                                 0.070723895773957,  0.042910580259079,  0.000000000000000,
                                 0.000000000000000,  0.064818488150293,  0.051425874341281,
                                 0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 20, 4));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeSFForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 0);
    
    CGtoBlock kgtos(mlih, mbas, 3);
    
    CDenseMatrix lmomxmat(4, 28);
    
    CDenseMatrix lmomymat(4, 28);
    
    CDenseMatrix lmomzmat(4, 28);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000,  0.117851647770337,
                                  0.189190438578309, -0.000000000000000, -0.000000000000000,
                                  0.176843787060133,  0.354704157595720, -0.000000000000000,
                                 -0.000000000000000, -0.187600295962828, -0.174364610630303,
                                 -0.000000000000000, -0.000000000000000, -0.189531235180121,
                                 -0.261597908152478, -0.000000000000000, -0.000000000000000,
                                  0.161773050371414,  0.333759470962090, -0.000000000000000,
                                 -0.000000000000000,  0.226571213273936,  0.323256874535949,
                                  0.000000000000000, -0.000000000000000, -0.022888268516412,
                                 -0.057892954330979, -0.000000000000000, -0.000000000000000,
                                  0.072718713387662,  0.150688924783396, -0.000000000000000,
                                 -0.000000000000000,  0.125958030088768,  0.291987053706184,
                                 -0.000000000000000, -0.000000000000000, -0.085604351346710,
                                 -0.121927759901318, -0.000000000000000, -0.000000000000000,
                                 -0.106802684464488, -0.202657131286198, -0.000000000000000,
                                 -0.000000000000000,  0.117431398242516,  0.275739110670462,
                                 -0.000000000000000, -0.000000000000000,  0.130180293797371,
                                  0.252061917818193,  0.000000000000000,  0.000000000000000,
                                 -0.019152289644901, -0.048939075762308,  0.156245633330473,
                                  0.202846830738321,  0.000000000000000, -0.000000000000000,
                                  0.240294212105779,  0.349176223774588, -0.000000000000000,
                                 -0.000000000000000, -0.238263986655851, -0.242694803899954,
                                 -0.000000000000000, -0.000000000000000, -0.247760074164408,
                                 -0.299236614416822, -0.000000000000000, -0.000000000000000,
                                  0.220581529019958,  0.325291395982974, -0.000000000000000,
                                 -0.000000000000000,  0.297048203370227,  0.364380142515249,
                                 -0.000000000000000, -0.000000000000000, -0.032088480653987,
                                 -0.052773607760957, -0.000000000000000, -0.000000000000000,
                                  0.051337460318673,  0.082024661246212, -0.000000000000000,
                                 -0.000000000000000,  0.097012194547972,  0.158937620684173,
                                 -0.000000000000000, -0.000000000000000, -0.045949937924130,
                                 -0.066369066053068, -0.000000000000000, -0.000000000000000,
                                 -0.070526373716034, -0.110312569863868, -0.000000000000000,
                                 -0.000000000000000,  0.091363744663877,  0.150093360726989,
                                 -0.000000000000000, -0.000000000000000,  0.087281391158074,
                                  0.137205129387093, -0.000000000000000, -0.000000000000000,
                                 -0.015937047202223, -0.026639058689125, -0.000000000000000,
                                  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 4, 28));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.059808665934473,
                                 -0.087377345030640, -0.000000000000000, -0.000000000000000,
                                  0.034299430937129,  0.169709872136530, -0.000000000000000,
                                 -0.000000000000000,  0.005439470402390,  0.188455628770171,
                                 -0.000000000000000, -0.000000000000000, -0.284296852770182,
                                 -0.392396862228718, -0.000000000000000, -0.000000000000000,
                                 -0.187600295962828, -0.174364610630303, -0.000000000000000,
                                 -0.000000000000000, -0.214462179256465, -0.384745962412998,
                                 -0.000000000000000, -0.000000000000000, -0.080620994911787,
                                 -0.159458279889576, -0.000000000000000, -0.000000000000000,
                                 -0.034850677073639, -0.068440959448250, -0.000000000000000,
                                 -0.000000000000000,  0.048427194106724,  0.150501203485607,
                                 -0.000000000000000, -0.000000000000000,  0.046094438786925,
                                  0.174132644086031, -0.000000000000000, -0.000000000000000,
                                 -0.160204026696732, -0.303985696929296, -0.000000000000000,
                                 -0.000000000000000, -0.085604351346710, -0.121927759901318,
                                 -0.000000000000000, -0.000000000000000, -0.141953201767373,
                                 -0.311857628249516, -0.000000000000000, -0.000000000000000,
                                 -0.056888406736835, -0.131023159721942, -0.078581381499882,
                                 -0.097480858655093,  0.000000000000000, -0.000000000000000,
                                  0.054925324506642,  0.131556462004450, -0.000000000000000,
                                 -0.000000000000000,  0.022028206806749,  0.123045726066345,
                                 -0.000000000000000, -0.000000000000000, -0.371640111246612,
                                 -0.448854921625233, -0.000000000000000, -0.000000000000000,
                                 -0.238263986655851, -0.242694803899954, -0.000000000000000,
                                 -0.000000000000000, -0.287666079709524, -0.394728683004961,
                                 -0.000000000000000, -0.000000000000000, -0.109362035838814,
                                 -0.157763888660200, -0.000000000000000, -0.000000000000000,
                                 -0.023617210402258, -0.037254539589939,  0.000000000000000,
                                 -0.000000000000000,  0.047285108063193,  0.081922478714337,
                                 -0.000000000000000, -0.000000000000000,  0.053072129727102,
                                  0.094785805682766, -0.000000000000000, -0.000000000000000,
                                 -0.105789560574051, -0.165468854795802, -0.000000000000000,
                                 -0.000000000000000, -0.045949937924130, -0.066369066053068,
                                 -0.000000000000000, -0.000000000000000, -0.104837554283927,
                                 -0.169753791467973, -0.000000000000000, -0.000000000000000,
                                 -0.043592757932083, -0.071319974623542, -0.000000000000000,
                                 -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 4, 28));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.015357644304152,
                                 -0.012264515459103, -0.000000000000000, -0.000000000000000,
                                 -0.175082936863881, -0.062191791529686, -0.000000000000000,
                                 -0.000000000000000, -0.077673166979311,  0.208001208526650,
                                 -0.000000000000000, -0.000000000000000,  0.181400531267548,
                                  0.382882370087936, -0.000000000000000, -0.000000000000000,
                                 -0.051782111319541,  0.138667472351100, -0.000000000000000,
                                 -0.000000000000000,  0.072951223693284,  0.025913246470702,
                                 -0.000000000000000, -0.000000000000000,  0.078494626443441,
                                  0.062685301235413, -0.000000000000000, -0.000000000000000,
                                 -0.006530001493466, -0.008112128087850, -0.000000000000000,
                                 -0.000000000000000, -0.055984536104297, -0.020272000291682,
                                 -0.000000000000000, -0.000000000000000,  0.031186731557226,
                                  0.210152427398887, -0.000000000000000, -0.000000000000000,
                                  0.133730943572636,  0.317220210393613, -0.000000000000000,
                                 -0.000000000000000,  0.020791154371484,  0.140101618265925,
                                 -0.000000000000000, -0.000000000000000,  0.023326890043457,
                                  0.008446666788201, -0.000000000000000, -0.000000000000000,
                                  0.033375563188828,  0.041461988004567, -0.019339483965309,
                                 -0.018596713607225, -0.000000000000000, -0.000000000000000,
                                 -0.214077625803548, -0.162906113729801,  0.000000000000000,
                                 -0.000000000000000, -0.075550122373621,  0.076751407480548,
                                 -0.000000000000000, -0.000000000000000,  0.248055449755117,
                                  0.370216203416129, -0.000000000000000, -0.000000000000000,
                                 -0.050366748249081,  0.051167604987032, -0.000000000000000,
                                 -0.000000000000000,  0.089199010751478,  0.067877547387417,
                                 -0.000000000000000, -0.000000000000000,  0.098846251378248,
                                  0.095049869548038, -0.000000000000000, -0.000000000000000,
                                 -0.003194689734468, -0.004415683231852, -0.000000000000000,
                                 -0.000000000000000, -0.014520582120451, -0.011034679284483,
                                 -0.000000000000000, -0.000000000000000,  0.060022032201180,
                                  0.114392492296569, -0.000000000000000, -0.000000000000000,
                                  0.104882962115120,  0.172672811458373, -0.000000000000000,
                                  0.000000000000000,  0.040014688134120,  0.076261661531046,
                                 -0.000000000000000, -0.000000000000000,  0.006050242550188,
                                  0.004597783035201, -0.000000000000000, -0.000000000000000,
                                  0.016328414198394,  0.022569047629463, -0.000000000000000,
                                 -0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 4, 28));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeFSForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 3);
    
    CGtoBlock kgtos(mlih, mbas, 0);
    
    CDenseMatrix lmomxmat(28, 4);
    
    CDenseMatrix lmomymat(28, 4);
    
    CDenseMatrix lmomzmat(28, 4);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000, -0.156245633330473,
                                 -0.051337460318673,  0.000000000000000,  0.000000000000000,
                                 -0.202846830738321, -0.082024661246212, -0.117851647770337,
                                 -0.072718713387662, -0.000000000000000,  0.000000000000000,
                                 -0.189190438578309, -0.150688924783396,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.240294212105779, -0.097012194547972,  0.000000000000000,
                                  0.000000000000000, -0.349176223774588, -0.158937620684173,
                                 -0.176843787060133, -0.125958030088768,  0.000000000000000,
                                  0.000000000000000, -0.354704157595720, -0.291987053706184,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.238263986655851,  0.045949937924130,
                                  0.000000000000000,  0.000000000000000,  0.242694803899954,
                                  0.066369066053068,  0.187600295962828,  0.085604351346710,
                                  0.000000000000000,  0.000000000000000,  0.174364610630303,
                                  0.121927759901318,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.247760074164408,
                                  0.070526373716034,  0.000000000000000,  0.000000000000000,
                                  0.299236614416822,  0.110312569863868,  0.189531235180121,
                                  0.106802684464488,  0.000000000000000,  0.000000000000000,
                                  0.261597908152478,  0.202657131286198,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.220581529019958, -0.091363744663877,  0.000000000000000,
                                  0.000000000000000, -0.325291395982974, -0.150093360726989,
                                 -0.161773050371414, -0.117431398242516,  0.000000000000000,
                                  0.000000000000000, -0.333759470962090, -0.275739110670462,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.297048203370227, -0.087281391158074,
                                  0.000000000000000,  0.000000000000000, -0.364380142515249,
                                 -0.137205129387093, -0.226571213273936, -0.130180293797371,
                                  0.000000000000000,  0.000000000000000, -0.323256874535949,
                                 -0.252061917818193,  0.000000000000000,  0.000000000000000,
                                 -0.000000000000000, -0.000000000000000,  0.032088480653987,
                                  0.015937047202223,  0.000000000000000, -0.000000000000000,
                                  0.052773607760957,  0.026639058689125,  0.022888268516412,
                                  0.019152289644901,  0.000000000000000,  0.000000000000000,
                                  0.057892954330979,  0.048939075762308,  0.000000000000000,
                                 -0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 28, 4));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.078581381499882,
                                  0.023617210402258,  0.000000000000000,  0.000000000000000,
                                  0.097480858655093,  0.037254539589939,  0.059808665934473,
                                  0.034850677073639, -0.000000000000000, -0.000000000000000,
                                  0.087377345030640,  0.068440959448250,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.054925324506642, -0.047285108063193,  0.000000000000000,
                                  0.000000000000000, -0.131556462004450, -0.081922478714337,
                                 -0.034299430937129, -0.048427194106724,  0.000000000000000,
                                  0.000000000000000, -0.169709872136530, -0.150501203485607,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.022028206806749, -0.053072129727102,
                                  0.000000000000000,  0.000000000000000, -0.123045726066345,
                                 -0.094785805682766, -0.005439470402390, -0.046094438786925,
                                  0.000000000000000,  0.000000000000000, -0.188455628770171,
                                 -0.174132644086031,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.371640111246612,
                                  0.105789560574051,  0.000000000000000,  0.000000000000000,
                                  0.448854921625233,  0.165468854795802,  0.284296852770182,
                                  0.160204026696732,  0.000000000000000,  0.000000000000000,
                                  0.392396862228718,  0.303985696929296,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.238263986655851,  0.045949937924130,  0.000000000000000,
                                  0.000000000000000,  0.242694803899954,  0.066369066053068,
                                  0.187600295962828,  0.085604351346710,  0.000000000000000,
                                  0.000000000000000,  0.174364610630303,  0.121927759901318,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.287666079709524,  0.104837554283927,
                                  0.000000000000000,  0.000000000000000,  0.394728683004961,
                                  0.169753791467973,  0.214462179256465,  0.141953201767373,
                                  0.000000000000000,  0.000000000000000,  0.384745962412998,
                                  0.311857628249516,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.109362035838814,
                                  0.043592757932083,  0.000000000000000,  0.000000000000000,
                                  0.157763888660200,  0.071319974623542,  0.080620994911787,
                                  0.056888406736835,  0.000000000000000,  0.000000000000000,
                                  0.159458279889576,  0.131023159721942,  0.000000000000000,
                                  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 28, 4));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.019339483965309,
                                  0.003194689734468,  0.000000000000000,  0.000000000000000,
                                  0.018596713607225,  0.004415683231852,  0.015357644304152,
                                  0.006530001493466,  0.000000000000000,  0.000000000000000,
                                  0.012264515459103,  0.008112128087850,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.214077625803548,  0.014520582120451,  0.000000000000000,
                                  0.000000000000000,  0.162906113729801,  0.011034679284483,
                                  0.175082936863881,  0.055984536104297, -0.000000000000000,
                                  0.000000000000000,  0.062191791529686,  0.020272000291682,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.075550122373621, -0.060022032201180,
                                  0.000000000000000,  0.000000000000000, -0.076751407480548,
                                 -0.114392492296569,  0.077673166979311, -0.031186731557226,
                                  0.000000000000000,  0.000000000000000, -0.208001208526650,
                                 -0.210152427398887,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.248055449755117,
                                 -0.104882962115120,  0.000000000000000,  0.000000000000000,
                                 -0.370216203416129, -0.172672811458373, -0.181400531267548,
                                 -0.133730943572636,  0.000000000000000,  0.000000000000000,
                                 -0.382882370087936, -0.317220210393613,  0.000000000000000,
                                 -0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.050366748249081, -0.040014688134120,  0.000000000000000,
                                  0.000000000000000, -0.051167604987032, -0.076261661531046,
                                  0.051782111319541, -0.020791154371484,  0.000000000000000,
                                  0.000000000000000, -0.138667472351100, -0.140101618265925,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.089199010751478, -0.006050242550188,
                                  0.000000000000000,  0.000000000000000, -0.067877547387417,
                                 -0.004597783035201, -0.072951223693284, -0.023326890043457,
                                  0.000000000000000,  0.000000000000000, -0.025913246470702,
                                 -0.008446666788201,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.098846251378248,
                                 -0.016328414198394,  0.000000000000000,  0.000000000000000,
                                 -0.095049869548038, -0.022569047629463, -0.078494626443441,
                                 -0.033375563188828,  0.000000000000000,  0.000000000000000,
                                 -0.062685301235413, -0.041461988004567,  0.000000000000000,
                                  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 28, 4));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeSGForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 0);
    
    CGtoBlock kgtos(mlih, mbas, 4);
    
    CDenseMatrix lmomxmat(4, 36);
    
    CDenseMatrix lmomymat(4, 36);
    
    CDenseMatrix lmomzmat(4, 36);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.020871223265119,
                                 -0.023083338431137, -0.000000000000000, -0.000000000000000,
                                 -0.191337349586558, -0.267879185008559, -0.000000000000000,
                                 -0.000000000000000, -0.159242006619683, -0.287003703060834,
                                 -0.000000000000000, -0.000000000000000,  0.171944252615817,
                                  0.169397826580562, -0.000000000000000, -0.000000000000000,
                                  0.138878907366503,  0.202175495087857, -0.000000000000000,
                                 -0.000000000000000, -0.058105584141349, -0.123169062457521,
                                 -0.000000000000000, -0.000000000000000, -0.230270428699743,
                                 -0.285848456000791, -0.000000000000000, -0.000000000000000,
                                  0.036051581355088,  0.081742207565155, -0.000000000000000,
                                 -0.000000000000000,  0.058014187830252,  0.084694901179898,
                                 -0.000000000000000, -0.000000000000000, -0.007836823841236,
                                 -0.014645417542892, -0.000000000000000, -0.000000000000000,
                                 -0.083104213791499, -0.177909958655630, -0.000000000000000,
                                 -0.000000000000000, -0.081984539012045, -0.197763558628158,
                                 -0.000000000000000, -0.000000000000000,  0.060405528928663,
                                  0.104540281418188, -0.000000000000000, -0.000000000000000,
                                  0.061868796996864,  0.135137515995300, -0.000000000000000,
                                 -0.000000000000000, -0.033606628154757, -0.086470913666939,
                                 -0.000000000000000, -0.000000000000000, -0.092701572850214,
                                 -0.185764604473854, -0.000000000000000, -0.000000000000000,
                                  0.021916333086817,  0.057779620884761, -0.000000000000000,
                                 -0.000000000000000,  0.025892557567496,  0.056637239647119,
                                  0.028484925381739,  0.031255550527769,  0.000000000000000,
                                 -0.000000000000000,  0.268114370111140,  0.328525914098987,
                                 -0.000000000000000, -0.000000000000000,  0.231085599896637,
                                  0.321227364720878, -0.000000000000000, -0.000000000000000,
                                 -0.232092331159578, -0.241992224445290, -0.000000000000000,
                                 -0.000000000000000, -0.195566182305791, -0.244231443904738,
                                  0.000000000000000, -0.000000000000000,  0.086608201671069,
                                  0.130977969630511, -0.000000000000000, -0.000000000000000,
                                  0.318138041789306,  0.368104306244965, -0.000000000000000,
                                  0.000000000000000, -0.054396111988605, -0.085237188778418,
                                 -0.000000000000000, -0.000000000000000, -0.081724015648061,
                                 -0.102202220745696,  0.000000000000000,  0.000000000000000,
                                  0.003970006329387,  0.006509074463508, -0.000000000000000,
                                 -0.000000000000000,  0.046693901313976,  0.079071092735836,
                                 -0.000000000000000, -0.000000000000000,  0.050587381428010,
                                  0.087894914945848, -0.000000000000000, -0.000000000000000,
                                 -0.028904213800103, -0.046462347296973, -0.000000000000000,
                                 -0.000000000000000, -0.035308770228227, -0.060061118220133,
                                  0.000000000000000, -0.000000000000000,  0.021835054765095,
                                  0.038431517185306, -0.000000000000000, -0.000000000000000,
                                  0.049506761308176,  0.082562046432824, -0.000000000000000,
                                 -0.000000000000000, -0.014521744389591, -0.025679831504338,
                                 -0.000000000000000, -0.000000000000000, -0.014793484942424,
                                 -0.025172106509831,  0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 4, 36));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000,  0.053960954123210,
                                  0.081922279894812, -0.000000000000000, -0.000000000000000,
                                  0.097554603868832,  0.123813452808795, -0.000000000000000,
                                 -0.000000000000000, -0.010692806243926, -0.118633760532682,
                                 -0.000000000000000, -0.000000000000000,  0.085181293038499,
                                  0.017995793026281, -0.000000000000000, -0.000000000000000,
                                  0.208318361049755,  0.303263242631785, -0.000000000000000,
                                 -0.000000000000000,  0.171944252615817,  0.169397826580562,
                                 -0.000000000000000, -0.000000000000000,  0.202202845795821,
                                  0.319719621739376, -0.000000000000000, -0.000000000000000,
                                  0.129317494950850,  0.225454399888922, -0.000000000000000,
                                 -0.000000000000000,  0.001036956682297,  0.009515675257394,
                                 -0.000000000000000, -0.000000000000000,  0.024712901431257,
                                  0.055119837574735, -0.000000000000000, -0.000000000000000,
                                  0.039816218252465,  0.080804400743401, -0.000000000000000,
                                 -0.000000000000000, -0.025390810488401, -0.090363732376402,
                                 -0.000000000000000, -0.000000000000000,  0.016731312619129,
                                  0.000645987514884, -0.000000000000000, -0.000000000000000,
                                  0.092803195495296,  0.202706273992950, -0.000000000000000,
                                 -0.000000000000000,  0.060405528928663,  0.104540281418188,
                                 -0.000000000000000, -0.000000000000000,  0.095154035995878,
                                  0.216428946647225, -0.000000000000000, -0.000000000000000,
                                  0.065053909422779,  0.154691693251959, -0.000000000000000,
                                 -0.000000000000000,  0.002064244223738,  0.007220097565731,
                                 -0.076404304522227, -0.097408706014770, -0.000000000000000,
                                 -0.000000000000000, -0.135116429835154, -0.157973099343819,
                                 -0.000000000000000, -0.000000000000000,  0.027840931835030,
                                  0.095726399738755, -0.000000000000000,  0.000000000000000,
                                 -0.106802074295245, -0.070682217407231, -0.000000000000000,
                                 -0.000000000000000, -0.293349273458686, -0.366347165857107,
                                  0.000000000000000, -0.000000000000000, -0.232092331159578,
                                 -0.241992224445290, -0.000000000000000, -0.000000000000000,
                                 -0.287882860539866, -0.374518694254702,  0.000000000000000,
                                 -0.000000000000000, -0.186715730265881, -0.255178777394381,
                                 -0.000000000000000, -0.000000000000000, -0.002453224216796,
                                 -0.007798761229714,  0.000000000000000, -0.000000000000000,
                                 -0.014335555261515, -0.024497705588771, -0.000000000000000,
                                 -0.000000000000000, -0.021470285112944, -0.035913066997067,
                                 -0.000000000000000, -0.000000000000000,  0.021585043754953,
                                  0.040161658833956, -0.000000000000000, -0.000000000000000,
                                 -0.002251790068324, -0.000287105562171, -0.000000000000000,
                                 -0.000000000000000, -0.052963155342341, -0.090091677330200,
                                 -0.000000000000000, -0.000000000000000, -0.028904213800103,
                                 -0.046462347296973, -0.000000000000000, -0.000000000000000,
                                 -0.056050326166684, -0.096190642954322, -0.000000000000000,
                                 -0.000000000000000, -0.039686969492108, -0.068751863667537,
                                 -0.000000000000000, -0.000000000000000, -0.001729153710514,
                                 -0.003208932251436, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 4, 36));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.021927329890557,
                                 -0.014999426624239, -0.000000000000000, -0.000000000000000,
                                  0.016463175138052,  0.005034637372009, -0.000000000000000,
                                 -0.000000000000000,  0.064803699115031, -0.102124257338697,
                                 -0.000000000000000, -0.000000000000000, -0.107979819153391,
                                 -0.328051954486113, -0.000000000000000, -0.000000000000000,
                                 -0.164319307964236, -0.190634138259557, -0.000000000000000,
                                 -0.000000000000000, -0.071986546102261, -0.218701302990742,
                                 -0.000000000000000, -0.000000000000000, -0.027001541297929,
                                  0.042551773891124, -0.000000000000000, -0.000000000000000,
                                 -0.084145117372265, -0.025732591012491, -0.000000000000000,
                                 -0.000000000000000, -0.021744602141469, -0.014874431402370,
                                 -0.000000000000000, -0.000000000000000, -0.006381746310802,
                                 -0.008208896457162, -0.000000000000000, -0.000000000000000,
                                  0.003545216031788,  0.001332411821461, -0.000000000000000,
                                 -0.000000000000000, -0.010449756653963, -0.089356931234459,
                                 -0.000000000000000, -0.000000000000000, -0.082298190886459,
                                 -0.237621465766726, -0.000000000000000, -0.000000000000000,
                                 -0.063480334160509, -0.122207133900535, -0.000000000000000,
                                 -0.000000000000000, -0.054865460590973, -0.158414310511151,
                                 -0.000000000000000, -0.000000000000000,  0.004354065272484,
                                  0.037232054681025, -0.000000000000000, -0.000000000000000,
                                 -0.018119993051360, -0.006810104865243, -0.000000000000000,
                                 -0.000000000000000, -0.006328565091545, -0.008140488986686,
                                  0.028778765106972,  0.025932128872222, -0.000000000000000,
                                 -0.000000000000000, -0.020834931386718, -0.014822603681346,
                                 -0.000000000000000, -0.000000000000000, -0.066887582472290,
                                  0.032662713956147, -0.000000000000000, -0.000000000000000,
                                  0.173246498704753,  0.317408810400415,  0.000000000000000,
                                 -0.000000000000000,  0.225365775939078,  0.252716640130608,
                                 -0.000000000000000, -0.000000000000000,  0.115497665803168,
                                  0.211605873600276,  0.000000000000000,  0.000000000000000,
                                  0.027869826030121, -0.013609464148394, -0.000000000000000,
                                 -0.000000000000000,  0.106489649309892,  0.075759974371326,
                                 -0.000000000000000, -0.000000000000000,  0.028538942064414,
                                  0.025716027798287, -0.000000000000000, -0.000000000000000,
                                  0.002477324503277,  0.003648398425406, -0.000000000000000,
                                 -0.000000000000000, -0.000720134781645, -0.000592183031760,
                                 -0.000000000000000, -0.000000000000000,  0.019486809083130,
                                  0.039714191659760, -0.000000000000000, -0.000000000000000,
                                  0.058728535560073,  0.105609540340767, -0.000000000000000,
                                 -0.000000000000000,  0.032884820821120,  0.054314281733571,
                                 -0.000000000000000, -0.000000000000000,  0.039152357040049,
                                  0.070406360227178,  0.000000000000000, -0.000000000000000,
                                 -0.008119503784638, -0.016547579858233, -0.000000000000000,
                                 -0.000000000000000,  0.003680688883965,  0.003026713273442,
                                  0.000000000000000, -0.000000000000000,  0.002456680132417,
                                  0.003617995105194, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 4, 36));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeGSForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 4);
    
    CGtoBlock kgtos(mlih, mbas, 0);
    
    CDenseMatrix lmomxmat(36, 4);
    
    CDenseMatrix lmomymat(36, 4);
    
    CDenseMatrix lmomzmat(36, 4);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000, -0.028484925381739,
                                 -0.003970006329387,  0.000000000000000,  0.000000000000000,
                                 -0.031255550527769, -0.006509074463508,  0.020871223265119,
                                  0.007836823841236, -0.000000000000000,  0.000000000000000,
                                  0.023083338431137,  0.014645417542892,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.268114370111140, -0.046693901313976,  0.000000000000000,
                                  0.000000000000000, -0.328525914098987, -0.079071092735836,
                                  0.191337349586558,  0.083104213791499,  0.000000000000000,
                                  0.000000000000000,  0.267879185008559,  0.177909958655630,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.231085599896637, -0.050587381428010,
                                  0.000000000000000,  0.000000000000000, -0.321227364720878,
                                 -0.087894914945848,  0.159242006619683,  0.081984539012045,
                                  0.000000000000000,  0.000000000000000,  0.287003703060834,
                                  0.197763558628158,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.232092331159578,
                                  0.028904213800103,  0.000000000000000,  0.000000000000000,
                                  0.241992224445290,  0.046462347296973, -0.171944252615817,
                                 -0.060405528928663,  0.000000000000000,  0.000000000000000,
                                 -0.169397826580562, -0.104540281418188,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.195566182305791,  0.035308770228227,  0.000000000000000,
                                  0.000000000000000,  0.244231443904738,  0.060061118220133,
                                 -0.138878907366503, -0.061868796996864, -0.000000000000000,
                                 -0.000000000000000, -0.202175495087857, -0.135137515995300,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.086608201671069, -0.021835054765095,
                                  0.000000000000000,  0.000000000000000, -0.130977969630511,
                                 -0.038431517185306,  0.058105584141349,  0.033606628154757,
                                  0.000000000000000,  0.000000000000000,  0.123169062457521,
                                  0.086470913666939,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.318138041789306,
                                 -0.049506761308176,  0.000000000000000,  0.000000000000000,
                                 -0.368104306244965, -0.082562046432824,  0.230270428699743,
                                  0.092701572850214,  0.000000000000000,  0.000000000000000,
                                  0.285848456000791,  0.185764604473854, -0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.054396111988605,  0.014521744389591,  0.000000000000000,
                                  0.000000000000000,  0.085237188778418,  0.025679831504338,
                                 -0.036051581355088, -0.021916333086817,  0.000000000000000,
                                 0.000000000000000, -0.081742207565155, -0.057779620884761,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.081724015648061,  0.014793484942424,
                                  0.000000000000000,  0.000000000000000,  0.102202220745696,
                                  0.025172106509831, -0.058014187830252, -0.025892557567496,
                                 -0.000000000000000, -0.000000000000000, -0.084694901179898,
                                 -0.056637239647119, -0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 36, 4));

    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.076404304522227,
                                  0.014335555261515,  0.000000000000000,  0.000000000000000,
                                  0.097408706014770,  0.024497705588771, -0.053960954123210,
                                 -0.024712901431257,  0.000000000000000,  0.000000000000000,
                                 -0.081922279894812, -0.055119837574735,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.135116429835154,  0.021470285112944,  0.000000000000000,
                                  0.000000000000000,  0.157973099343819,  0.035913066997067,
                                 -0.097554603868832, -0.039816218252465,  0.000000000000000,
                                  0.000000000000000, -0.123813452808795, -0.080804400743401,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.027840931835030, -0.021585043754953,
                                  0.000000000000000,  0.000000000000000, -0.095726399738755,
                                 -0.040161658833956,  0.010692806243926,  0.025390810488401,
                                  0.000000000000000,  0.000000000000000,  0.118633760532682,
                                  0.090363732376402, -0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.106802074295245,
                                  0.002251790068324,  0.000000000000000,  0.000000000000000,
                                  0.070682217407231,  0.000287105562171, -0.085181293038499,
                                 -0.016731312619129,  0.000000000000000,  0.000000000000000,
                                 -0.017995793026281, -0.000645987514884,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.293349273458686,  0.052963155342341,  0.000000000000000,
                                  0.000000000000000,  0.366347165857107,  0.090091677330200,
                                 -0.208318361049755, -0.092803195495296, -0.000000000000000,
                                  0.000000000000000, -0.303263242631785, -0.202706273992950,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.232092331159578,  0.028904213800103,
                                  0.000000000000000,  0.000000000000000,  0.241992224445290,
                                  0.046462347296973, -0.171944252615817, -0.060405528928663,
                                  0.000000000000000,  0.000000000000000, -0.169397826580562,
                                 -0.104540281418188,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.287882860539866,
                                  0.056050326166684,  0.000000000000000,  0.000000000000000,
                                  0.374518694254702,  0.096190642954322, -0.202202845795821,
                                 -0.095154035995878, -0.000000000000000,  0.000000000000000,
                                 -0.319719621739376, -0.216428946647225,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.186715730265881,  0.039686969492108,  0.000000000000000,
                                  0.000000000000000,  0.255178777394381,  0.068751863667537,
                                 -0.129317494950850, -0.065053909422779,  0.000000000000000,
                                  0.000000000000000, -0.225454399888922, -0.154691693251959,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.002453224216796,  0.001729153710514,
                                  0.000000000000000,  0.000000000000000,  0.007798761229714,
                                  0.003208932251436, -0.001036956682297, -0.002064244223738,
                                 -0.000000000000000,  0.000000000000000, -0.009515675257394,
                                 -0.007220097565731,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 36, 4));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000, -0.028778765106972,
                                 -0.002477324503277,  0.000000000000000,  0.000000000000000,
                                 -0.025932128872222, -0.003648398425406,  0.021927329890557,
                                  0.006381746310802,  0.000000000000000,  0.000000000000000,
                                  0.014999426624239,  0.008208896457162,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.020834931386718,  0.000720134781645,  0.000000000000000,
                                  0.000000000000000,  0.014822603681346,  0.000592183031760,
                                 -0.016463175138052, -0.003545216031788,  0.000000000000000,
                                  0.000000000000000, -0.005034637372009, -0.001332411821461,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.066887582472290, -0.019486809083130,
                                  0.000000000000000,  0.000000000000000, -0.032662713956147,
                                 -0.039714191659760, -0.064803699115031,  0.010449756653963,
                                  0.000000000000000,  0.000000000000000,  0.102124257338697,
                                  0.089356931234459,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.173246498704753,
                                 -0.058728535560073,  0.000000000000000,  0.000000000000000,
                                 -0.317408810400415, -0.105609540340767,  0.107979819153391,
                                  0.082298190886459, -0.000000000000000,  0.000000000000000,
                                  0.328051954486113,  0.237621465766726,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.225365775939078, -0.032884820821120,  0.000000000000000,
                                  0.000000000000000, -0.252716640130608, -0.054314281733571,
                                  0.164319307964236,  0.063480334160509,  0.000000000000000,
                                  0.000000000000000,  0.190634138259557,  0.122207133900535,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.115497665803168, -0.039152357040049,
                                  0.000000000000000,  0.000000000000000, -0.211605873600276,
                                 -0.070406360227178,  0.071986546102261,  0.054865460590973,
                                 -0.000000000000000, -0.000000000000000,  0.218701302990742,
                                  0.158414310511151, -0.000000000000000,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000, -0.027869826030121,
                                  0.008119503784638,  0.000000000000000,  0.000000000000000,
                                  0.013609464148394,  0.016547579858233,  0.027001541297929,
                                 -0.004354065272484,  0.000000000000000,  0.000000000000000,
                                 -0.042551773891124, -0.037232054681025,  0.000000000000000,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 -0.106489649309892, -0.003680688883965,  0.000000000000000,
                                  0.000000000000000, -0.075759974371326, -0.003026713273442,
                                  0.084145117372265,  0.018119993051360,  0.000000000000000,
                                 -0.000000000000000,  0.025732591012491,  0.006810104865243,
                                  0.000000000000000,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.028538942064414, -0.002456680132417,
                                  0.000000000000000,  0.000000000000000, -0.025716027798287,
                                 -0.003617995105194,  0.021744602141469,  0.006328565091545,
                                  0.000000000000000,  0.000000000000000,  0.014874431402370,
                                  0.008140488986686,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 36, 4));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputePPForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 1);
    
    CGtoBlock kgtos(mlih, mbas, 1);
    
    CDenseMatrix lmomxmat(12, 12);
    
    CDenseMatrix lmomymat(12, 12);
    
    CDenseMatrix lmomzmat(12, 12);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.028009735182111,
                                  0.078559595293000, -0.000000000000000, -0.000000000000000,
                                 -0.181956279246506, -0.098351258340267,  0.000000000000000,
                                 -0.000000000000000,  0.124722002430669,  0.162544510366894,
                                  0.000000000000000,  0.000000000000000,  0.058634900735623,
                                  0.104081949596897,  0.000000000000000, -0.000000000000000,
                                 -0.144994125464398, -0.100773721370100,  0.000000000000000,
                                  0.000000000000000,  0.153858771769069,  0.201929161381754,
                                 -0.028009735182111, -0.058634900735623,  0.000000000000000,
                                 -0.000000000000000,  0.181956279246506,  0.144994125464398,
                                 -0.000000000000000, -0.000000000000000, -0.124722002430669,
                                 -0.153858771769069,  0.000000000000000, -0.000000000000000,
                                 -0.078559595293000, -0.104081949596897,  0.000000000000000,
                                  0.000000000000000,  0.098351258340267,  0.100773721370100,
                                  0.000000000000000, -0.000000000000000, -0.162544510366894,
                                 -0.201929161381754,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.000000000000000, -0.181956279246506,
                                 -0.098351258340267,  0.000000000000000, -0.000000000000000,
                                 -0.206327897180813, -0.048104904084616,  0.000000000000000,
                                 -0.000000000000000,  0.228657004456227,  0.297998269005972,
                                  0.000000000000000,  0.000000000000000, -0.144994125464398,
                                 -0.100773721370100,  0.000000000000000,  0.000000000000000,
                                 -0.128099957817011, -0.025702388531263,  0.000000000000000,
                                  0.000000000000000,  0.282074414909961,  0.370203462533216,
                                  0.181956279246506,  0.144994125464398,  0.000000000000000,
                                 -0.000000000000000,  0.206327897180813,  0.128099957817011,
                                  0.000000000000000, -0.000000000000000, -0.228657004456227,
                                 -0.282074414909961,  0.000000000000000, -0.000000000000000,
                                  0.098351258340267,  0.100773721370100,  0.000000000000000,
                                  0.000000000000000,  0.048104904084616,  0.025702388531263,
                                  0.000000000000000,  0.000000000000000, -0.297998269005972,
                                 -0.370203462533216,  0.000000000000000,  0.000000000000000,
                                 -0.000000000000000, -0.000000000000000,  0.124722002430669,
                                  0.162544510366894, -0.000000000000000, -0.000000000000000,
                                  0.228657004456227,  0.297998269005972,  0.000000000000000,
                                 -0.000000000000000,  0.337665231162674,  0.372774479323007,
                                  0.000000000000000, -0.000000000000000,  0.153858771769069,
                                  0.201929161381754,  0.000000000000000, -0.000000000000000,
                                  0.282074414909961,  0.370203462533216,  0.000000000000000,
                                  0.000000000000000,  0.378017725581483,  0.452718308882345,
                                 -0.124722002430669, -0.153858771769069, -0.000000000000000,
                                 -0.000000000000000, -0.228657004456227, -0.282074414909961,
                                 -0.000000000000000, -0.000000000000000, -0.337665231162674,
                                 -0.378017725581483,  0.000000000000000,  0.000000000000000,
                                 -0.162544510366894, -0.201929161381754,  0.000000000000000,
                                 -0.000000000000000, -0.297998269005972, -0.370203462533216,
                                  0.000000000000000, -0.000000000000000, -0.372774479323007,
                                 -0.452718308882345, -0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 12, 12));
    
    std::vector<double> intyvals{ 0.000000000000000, -0.000000000000000,  0.423790447086509,
                                  0.514456601557117, -0.000000000000000, -0.000000000000000,
                                  0.077026771750805,  0.216038887055749,  0.000000000000000,
                                 -0.000000000000000,  0.028009735182111,  0.078559595293000,
                                  0.000000000000000,  0.000000000000000,  0.501120167706589,
                                  0.633271226337108,  0.000000000000000, -0.000000000000000,
                                  0.161245977022962,  0.286225361391466,  0.000000000000000,
                                  0.000000000000000,  0.058634900735623,  0.104081949596897,
                                 -0.423790447086509, -0.501120167706589,  0.000000000000000,
                                 -0.000000000000000, -0.077026771750805, -0.161245977022962,
                                 -0.000000000000000, -0.000000000000000, -0.028009735182111,
                                 -0.058634900735623, -0.000000000000000, -0.000000000000000,
                                 -0.514456601557117, -0.633271226337108,  0.000000000000000,
                                  0.000000000000000, -0.216038887055749, -0.286225361391466,
                                  0.000000000000000, -0.000000000000000, -0.078559595293000,
                                 -0.104081949596897, -0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.000000000000000,  0.077026771750805,
                                  0.216038887055749,  0.000000000000000, -0.000000000000000,
                                 -0.309491845771220, -0.072157356126924,  0.000000000000000,
                                 -0.000000000000000, -0.181956279246506, -0.098351258340267,
                                  0.000000000000000,  0.000000000000000,  0.161245977022962,
                                  0.286225361391466,  0.000000000000000,  0.000000000000000,
                                 -0.192149936725517, -0.038553582796895,  0.000000000000000,
                                  0.000000000000000, -0.144994125464398, -0.100773721370100,
                                 -0.077026771750805, -0.161245977022962,  0.000000000000000,
                                 -0.000000000000000,  0.309491845771220,  0.192149936725517,
                                  0.000000000000000, -0.000000000000000,  0.181956279246506,
                                  0.144994125464398,  0.000000000000000, -0.000000000000000,
                                 -0.216038887055749, -0.286225361391466,  0.000000000000000,
                                  0.000000000000000,  0.072157356126924,  0.038553582796895,
                                  0.000000000000000,  0.000000000000000,  0.098351258340267,
                                  0.100773721370100,  0.000000000000000,  0.000000000000000,
                                 -0.000000000000000, -0.000000000000000,  0.028009735182111,
                                  0.078559595293000, -0.000000000000000, -0.000000000000000,
                                 -0.181956279246506, -0.098351258340267,  0.000000000000000,
                                 -0.000000000000000,  0.124722002430669,  0.162544510366894,
                                  0.000000000000000, -0.000000000000000,  0.058634900735623,
                                  0.104081949596897,  0.000000000000000, -0.000000000000000,
                                 -0.144994125464398, -0.100773721370100,  0.000000000000000,
                                  0.000000000000000,  0.153858771769069,  0.201929161381754,
                                 -0.028009735182111, -0.058634900735623,  0.000000000000000,
                                  0.000000000000000,  0.181956279246506,  0.144994125464398,
                                 -0.000000000000000, -0.000000000000000, -0.124722002430669,
                                 -0.153858771769069,  0.000000000000000, -0.000000000000000,
                                 -0.078559595293000, -0.104081949596897,  0.000000000000000,
                                 -0.000000000000000,  0.098351258340267,  0.100773721370100,
                                  0.000000000000000, -0.000000000000000, -0.162544510366894,
                                 -0.201929161381754,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 12, 12));
    
    std::vector<double> intzvals{ 0.000000000000000, -0.000000000000000,  0.077026771750805,
                                  0.216038887055749, -0.000000000000000, -0.000000000000000,
                                 -0.309491845771220, -0.072157356126924,  0.000000000000000,
                                 -0.000000000000000, -0.181956279246506, -0.098351258340267,
                                  0.000000000000000,  0.000000000000000,  0.161245977022962,
                                  0.286225361391466,  0.000000000000000, -0.000000000000000,
                                 -0.192149936725517, -0.038553582796895,  0.000000000000000,
                                  0.000000000000000, -0.144994125464398, -0.100773721370100,
                                 -0.077026771750805, -0.161245977022962,  0.000000000000000,
                                 -0.000000000000000,  0.309491845771220,  0.192149936725517,
                                  0.000000000000000, -0.000000000000000,  0.181956279246506,
                                  0.144994125464398,  0.000000000000000, -0.000000000000000,
                                 -0.216038887055749, -0.286225361391466,  0.000000000000000,
                                  0.000000000000000,  0.072157356126924,  0.038553582796895,
                                  0.000000000000000, -0.000000000000000,  0.098351258340267,
                                  0.100773721370100,  0.000000000000000,  0.000000000000000,
                                  0.000000000000000, -0.000000000000000, -0.309491845771220,
                                 -0.072157356126924,  0.000000000000000, -0.000000000000000,
                                  0.132520663993891,  0.594843062899604,  0.000000000000000,
                                 -0.000000000000000, -0.206327897180813, -0.048104904084616,
                                  0.000000000000000,  0.000000000000000, -0.192149936725517,
                                 -0.038553582796895,  0.000000000000000,  0.000000000000000,
                                  0.405199446442338,  0.804090318432259,  0.000000000000000,
                                  0.000000000000000, -0.128099957817011, -0.025702388531263,
                                  0.309491845771220,  0.192149936725517, -0.000000000000000,
                                 -0.000000000000000, -0.132520663993891, -0.405199446442338,
                                  0.000000000000000, -0.000000000000000,  0.206327897180813,
                                  0.128099957817011, -0.000000000000000, -0.000000000000000,
                                  0.072157356126924,  0.038553582796895,  0.000000000000000,
                                  0.000000000000000, -0.594843062899604, -0.804090318432259,
                                  0.000000000000000,  0.000000000000000,  0.048104904084616,
                                  0.025702388531263, -0.000000000000000,  0.000000000000000,
                                 -0.000000000000000, -0.000000000000000, -0.181956279246506,
                                 -0.098351258340267, -0.000000000000000, -0.000000000000000,
                                 -0.206327897180813, -0.048104904084616,  0.000000000000000,
                                 -0.000000000000000,  0.228657004456227,  0.297998269005972,
                                  0.000000000000000, -0.000000000000000, -0.144994125464398,
                                 -0.100773721370100,  0.000000000000000, -0.000000000000000,
                                 -0.128099957817011, -0.025702388531263,  0.000000000000000,
                                  0.000000000000000,  0.282074414909961,  0.370203462533216,
                                  0.181956279246506,  0.144994125464398, -0.000000000000000,
                                 -0.000000000000000,  0.206327897180813,  0.128099957817011,
                                  0.000000000000000,  0.000000000000000, -0.228657004456227,
                                 -0.282074414909961,  0.000000000000000, -0.000000000000000,
                                  0.098351258340267,  0.100773721370100,  0.000000000000000,
                                 -0.000000000000000,  0.048104904084616,  0.025702388531263,
                                  0.000000000000000, -0.000000000000000, -0.297998269005972,
                                 -0.370203462533216,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 12, 12));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputePDForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 1);
    
    CGtoBlock kgtos(mlih, mbas, 2);
    
    CDenseMatrix lmomxmat(12, 20);
    
    CDenseMatrix lmomymat(12, 20);
    
    CDenseMatrix lmomzmat(12, 20);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 1.433006196130325,  1.251699175764304,  0.033065154174388,
                                  0.180189212829290, -0.000000000000000, -0.000000000000000,
                                 -0.038846375342300, -0.108326711269521, -0.000000000000000,
                                 -0.000000000000000,  0.254225293012190,  0.177705872383887,
                                 -0.000000000000000, -0.000000000000000, -0.189332013930234,
                                 -0.224940098708485, -0.000000000000000, -0.000000000000000,
                                 -0.023829536530324, -0.011354551237128,  0.978156907634135,
                                  1.095445115010332,  0.072201673566824,  0.246232904772071,
                                 -0.000000000000000, -0.000000000000000, -0.066914659366273,
                                 -0.122883718071506, -0.000000000000000, -0.000000000000000,
                                  0.173291543073507,  0.172202860406103, -0.000000000000000,
                                 -0.000000000000000, -0.175182510486035, -0.238406431026259,
                                 -0.000000000000000, -0.000000000000000, -0.013601912988477,
                                 -0.009832882530727,  0.039085004910987,  0.099867625777288,
                                  1.565369789120220,  0.931286395379278, -0.045509172362209,
                                 -0.093355941289276, -0.000000000000000, -0.000000000000000,
                                  0.276698868637266,  0.244688411521011,  0.000000000000000,
                                 -0.000000000000000, -0.209752124390492, -0.246071908134020,
                                 -0.000000000000000, -0.000000000000000, -0.025725157426760,
                                 -0.019279635672746,  0.000000000000000, -0.000000000000000,
                                  0.119596869363952,  0.201048324858298,  0.541850606645985,
                                  0.894427190999916, -0.070788616895268, -0.100334135657071,
                                 -0.000000000000000, -0.000000000000000,  0.114514779743228,
                                  0.140603046747558, -0.000000000000000, -0.000000000000000,
                                 -0.146073230172780, -0.194658035804123, -0.000000000000000,
                                 -0.000000000000000, -0.007252782696341, -0.008028514967003,
                                 -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 -0.000000000000000, -0.189332013930234, -0.224940098708485,
                                 -0.000000000000000, -0.000000000000000,  0.181362128502866,
                                  0.037426388459486, -0.000000000000000, -0.000000000000000,
                                  0.126387619330081,  0.008366778011796,  1.433006196130325,
                                  1.251699175764304, -0.210771530432732, -0.109506368840729,
                                 -0.000000000000000, -0.000000000000000, -0.239808800081369,
                                 -0.204083426702634, -0.000000000000000, -0.000000000000000,
                                 -0.175182510486035, -0.238406431026260, -0.000000000000000,
                                 -0.000000000000000,  0.079117355293182,  0.016552018926724,
                                 -0.000000000000000, -0.000000000000000,  0.046310823625133,
                                 -0.009540543090265,  0.978156907634135,  1.095445115010332,
                                 -0.153412165695493, -0.060805680640536, -0.000000000000000,
                                 -0.000000000000000, -0.181624125569099, -0.205807694080640,
                                 -0.209752124390492, -0.246071908134020, -0.000000000000000,
                                 -0.000000000000000,  0.193840653202617,  0.112955480696922,
                                 -0.000000000000000, -0.000000000000000,  0.134379014433917,
                                  0.066502351278756, -0.000000000000000, -0.000000000000000,
                                 -0.231050306804041, -0.217043165001374,  1.565369789120220,
                                  0.931286395379278, -0.262457999994550, -0.255947535462771,
                                 -0.000000000000000, -0.000000000000000, -0.146073230172780,
                                 -0.194658035804123, -0.000000000000000, -0.000000000000000,
                                  0.023036680066937,  0.013514666861121, -0.000000000000000,
                                 -0.000000000000000,  0.004423840168742, -0.007789820813395,
                                 -0.000000000000000, -0.000000000000000, -0.068527745252507,
                                 -0.049647630343981,  0.541850606645985,  0.894427190999916,
                                 -0.131953750967747, -0.168041278545462, -0.000000000000000,
                                 -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 -0.282798532093657, -0.281723762549885, -0.000000000000000,
                                 -0.000000000000000, -0.189332013930234, -0.224940098708485,
                                 -0.827346513086245, -0.722668856071953, -0.194880930362660,
                                 -0.323326989107613, -0.000000000000000, -0.000000000000000,
                                 -0.518463975505037, -0.516493564674789,  1.433006196130325,
                                  1.251699175764303,  0.093706988207300,  0.270323190922635,
                                 -0.000000000000000, -0.000000000000000, -0.234634314820620,
                                 -0.291544967036065, -0.000000000000000, -0.000000000000000,
                                 -0.175182510486035, -0.238406431026259, -0.564739153932260,
                                 -0.632455532033676, -0.209540746675983, -0.375941420923589,
                                 -0.000000000000000, -0.000000000000000, -0.430162910504470,
                                 -0.534499106232786,  0.978156907634135,  1.095445115010332,
                                  0.137321380236403,  0.344111056296686, -0.311141003100714,
                                 -0.330136915753537, -0.000000000000000, -0.000000000000000,
                                 -0.209752124390492, -0.246071908134020, -0.000000000000000,
                                 -0.000000000000000, -0.217731501742966, -0.293331082986603,
                                 -0.903766669129867, -0.537678451064862, -0.570425172351309,
                                 -0.605251012214818, -0.000000000000000, -0.000000000000000,
                                  0.106986711712061,  0.191153548393337,  1.565369789120220,
                                  0.931286395379278, -0.182561519362234, -0.238045468771634,
                                 -0.000000000000000, -0.000000000000000, -0.146073230172779,
                                 -0.194658035804123, -0.000000000000000, -0.000000000000000,
                                 -0.211530807088571, -0.306954884813221, -0.312837593607622,
                                 -0.516397779494323, -0.334696118830762, -0.436416692747995,
                                 -0.000000000000000, -0.000000000000000,  0.178257490626997,
                                  0.280965500925672,  0.541850606645985,  0.894427190999917};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 12, 20));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.235139459033008,
                                 -0.259014660075629, -0.000000000000000, -0.000000000000000,
                                 -0.646633512340772, -0.712290315207979, -0.827346513086245,
                                 -0.722668856071953,  0.016973480480832, -0.175238762121040,
                                 -0.000000000000000, -0.000000000000000, -0.038846375342300,
                                 -0.108326711269521, -1.433006196130325, -1.251699175764303,
                                  0.122100508095477, -0.045015514828671, -0.000000000000000,
                                 -0.000000000000000, -0.207430488843665, -0.271879201974610,
                                 -0.000000000000000, -0.000000000000000, -0.570433844320080,
                                 -0.747667805430179, -0.564739153932260, -0.632455532033676,
                                 -0.065131127448060, -0.232439037251836, -0.000000000000000,
                                 -0.000000000000000, -0.066914659366273, -0.122883718071506,
                                 -0.978156907634135, -1.095445115010332,  0.046872287957049,
                                 -0.109350985875571, -0.259690688247194, -0.291577644408044,
                                 -0.000000000000000, -0.000000000000000, -0.714149392679784,
                                 -0.801838522122122, -0.000000000000000, -0.000000000000000,
                                  0.012850888788089, -0.089424073385760, -0.903766669129867,
                                 -0.537678451064862, -0.045509172362209, -0.093355941289276,
                                 -0.000000000000000, -0.000000000000000,  0.130859826349568,
                                  0.067894185007322, -1.565369789120220, -0.931286395379278,
                                 -0.168055953969551, -0.221988438837628, -0.000000000000000,
                                 -0.000000000000000, -0.462153873416265, -0.610468206803477,
                                 -0.000000000000000, -0.000000000000000, -0.116101823969214,
                                 -0.189785679190256, -0.312837593607622, -0.516397779494323,
                                 -0.070788616895268, -0.100334135657071, -0.000000000000000,
                                 -0.000000000000000, -0.032166876738753, -0.089284706088480,
                                 -0.541850606645985, -0.894427190999917, -0.000000000000000,
                                 -0.000000000000000, -0.038846375342300, -0.108326711269521,
                                  1.433006196130325,  1.251699175764304, -0.059636423347010,
                                 -0.078317711791157, -0.000000000000000, -0.000000000000000,
                                  0.189581428995122,  0.012550167017694, -0.000000000000000,
                                 -0.000000000000000,  0.181362128502866,  0.037426388459486,
                                 -0.000000000000000, -0.000000000000000,  0.228650749205269,
                                  0.243675108249747, -0.000000000000000, -0.000000000000000,
                                 -0.066914659366273, -0.122883718071506,  0.978156907634135,
                                  1.095445115010332, -0.087481036284508, -0.047012331534932,
                                 -0.000000000000000, -0.000000000000000,  0.069466235437700,
                                 -0.014310814635397, -0.000000000000000, -0.000000000000000,
                                  0.079117355293182,  0.016552018926724, -0.000000000000000,
                                 -0.000000000000000,  0.197625666917022,  0.254630687201960,
                                 -0.045509172362209, -0.093355941289276, -0.000000000000000,
                                 -0.000000000000000, -0.069516429135194, -0.122913597753939,
                                  1.565369789120220,  0.931286395379278,  0.201568521650876,
                                  0.099753526918134, -0.000000000000000, -0.000000000000000,
                                  0.193840653202617,  0.112955480696922, -0.000000000000000,
                                 -0.000000000000000,  0.252198634144646,  0.277883306994051,
                                 -0.000000000000000, -0.000000000000000, -0.070788616895268,
                                 -0.100334135657071, -0.000000000000000, -0.000000000000000,
                                 -0.049330511863392, -0.038385407959713,  0.541850606645985,
                                  0.894427190999916,  0.006635760253112, -0.011684731220092,
                                 -0.000000000000000, -0.000000000000000,  0.023036680066937,
                                  0.013514666861121, -0.000000000000000, -0.000000000000000,
                                  0.158040321621743,  0.207905085499677, -0.000000000000000,
                                 -0.000000000000000,  1.433006196130325,  1.251699175764304,
                                  0.033065154174388,  0.180189212829290, -0.000000000000000,
                                 -0.000000000000000, -0.038846375342300, -0.108326711269521,
                                 -0.000000000000000, -0.000000000000000,  0.254225293012190,
                                  0.177705872383887, -0.000000000000000, -0.000000000000000,
                                 -0.189332013930234, -0.224940098708486, -0.000000000000000,
                                 -0.000000000000000, -0.023829536530324, -0.011354551237128,
                                  0.978156907634135,  1.095445115010332,  0.072201673566824,
                                  0.246232904772071, -0.000000000000000, -0.000000000000000,
                                 -0.066914659366273, -0.122883718071506, -0.000000000000000,
                                 -0.000000000000000,  0.173291543073507,  0.172202860406103,
                                 -0.000000000000000, -0.000000000000000, -0.175182510486035,
                                 -0.238406431026259, -0.000000000000000, -0.000000000000000,
                                 -0.013601912988477, -0.009832882530727,  0.039085004910987,
                                  0.099867625777288,  1.565369789120220,  0.931286395379278,
                                 -0.045509172362209, -0.093355941289276, -0.000000000000000,
                                 -0.000000000000000,  0.276698868637266,  0.244688411521011,
                                  0.000000000000000, -0.000000000000000, -0.209752124390492,
                                 -0.246071908134020, -0.000000000000000, -0.000000000000000,
                                 -0.025725157426760, -0.019279635672746, -0.000000000000000,
                                 -0.000000000000000,  0.119596869363952,  0.201048324858298,
                                  0.541850606645985,  0.894427190999916, -0.070788616895268,
                                 -0.100334135657071, -0.000000000000000, -0.000000000000000,
                                  0.114514779743228,  0.140603046747558, -0.000000000000000,
                                 -0.000000000000000, -0.146073230172780, -0.194658035804123,
                                 -0.000000000000000, -0.000000000000000, -0.007252782696341,
                                 -0.008028514967003, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 12, 20));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.038846375342300,
                                 -0.108326711269521,  1.433006196130325,  1.251699175764304,
                                 -0.059636423347010, -0.078317711791157, -0.000000000000000,
                                 -0.000000000000000,  0.189581428995122,  0.012550167017694,
                                 -0.000000000000000, -0.000000000000000,  0.181362128502866,
                                  0.037426388459486, -0.000000000000000, -0.000000000000000,
                                  0.228650749205269,  0.243675108249747, -0.000000000000000,
                                 -0.000000000000000, -0.066914659366273, -0.122883718071506,
                                  0.978156907634135,  1.095445115010332, -0.087481036284508,
                                 -0.047012331534932, -0.000000000000000, -0.000000000000000,
                                  0.069466235437700, -0.014310814635397, -0.000000000000000,
                                 -0.000000000000000,  0.079117355293182,  0.016552018926724,
                                 -0.000000000000000, -0.000000000000000,  0.197625666917022,
                                  0.254630687201960, -0.045509172362209, -0.093355941289276,
                                 -0.000000000000000, -0.000000000000000, -0.069516429135194,
                                 -0.122913597753939,  1.565369789120220,  0.931286395379278,
                                  0.201568521650876,  0.099753526918134, -0.000000000000000,
                                 -0.000000000000000,  0.193840653202617,  0.112955480696922,
                                  0.000000000000000, -0.000000000000000,  0.252198634144646,
                                  0.277883306994051, -0.000000000000000, -0.000000000000000,
                                 -0.070788616895268, -0.100334135657071, -0.000000000000000,
                                 -0.000000000000000, -0.049330511863392, -0.038385407959713,
                                  0.541850606645985,  0.894427190999916,  0.006635760253112,
                                 -0.011684731220092, -0.000000000000000, -0.000000000000000,
                                  0.023036680066937,  0.013514666861121, -0.000000000000000,
                                 -0.000000000000000,  0.158040321621743,  0.207905085499677,
                                 -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 -0.000000000000000,  0.181362128502866,  0.037426388459486,
                                 -0.000000000000000, -0.000000000000000, -0.089618095944441,
                                 -0.446877680040111,  1.654693026172490,  1.445337712143907,
                                 -0.591284452802138, -0.651675796652711, -0.000000000000000,
                                 -0.000000000000000, -0.059745397296294, -0.297918453360074,
                                 -0.000000000000000, -0.000000000000000, -0.075567553542861,
                                 -0.015594328524786, -0.000000000000000, -0.000000000000000,
                                  0.079117355293182,  0.016552018926724, -0.000000000000000,
                                 -0.000000000000000, -0.252489128214420, -0.517824176274428,
                                  1.129478307864519,  1.264911064067352, -0.554788195325154,
                                 -0.641410974783387, -0.000000000000000, -0.000000000000000,
                                 -0.168326085476280, -0.345216117516285, -0.000000000000000,
                                 -0.000000000000000, -0.032965564705493, -0.006896674552802,
                                  0.193840653202617,  0.112955480696922, -0.000000000000000,
                                 -0.000000000000000, -0.112823837829274, -0.351177038271673,
                                 -0.000000000000000, -0.000000000000000, -0.656673901576362,
                                 -0.779934768242255,  1.807533338259734,  1.075356902129725,
                                 -0.075215891886183, -0.234118025514449, -0.000000000000000,
                                 -0.000000000000000, -0.080766938834424, -0.047064783623717,
                                 -0.000000000000000, -0.000000000000000,  0.023036680066937,
                                  0.013514666861121, -0.000000000000000, -0.000000000000000,
                                 -0.292620077889285, -0.422801669449786, -0.000000000000000,
                                 -0.000000000000000, -0.421002436501258, -0.523709867880156,
                                  0.625675187215243,  1.032795558988646, -0.195080051926190,
                                 -0.281867779633191, -0.000000000000000, -0.000000000000000,
                                 -0.009598616694557, -0.005631111192134, -0.000000000000000,
                                 -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 -0.189332013930234, -0.224940098708485, -0.000000000000000,
                                 -0.000000000000000,  0.181362128502866,  0.037426388459486,
                                 -0.000000000000000, -0.000000000000000,  0.126387619330081,
                                  0.008366778011796,  1.433006196130325,  1.251699175764304,
                                 -0.210771530432732, -0.109506368840729, -0.000000000000000,
                                 -0.000000000000000, -0.239808800081369, -0.204083426702634,
                                 -0.000000000000000, -0.000000000000000, -0.175182510486035,
                                 -0.238406431026260, -0.000000000000000, -0.000000000000000,
                                  0.079117355293182,  0.016552018926724, -0.000000000000000,
                                 -0.000000000000000,  0.046310823625133, -0.009540543090265,
                                  0.978156907634135,  1.095445115010332, -0.153412165695493,
                                 -0.060805680640536, -0.000000000000000, -0.000000000000000,
                                 -0.181624125569099, -0.205807694080640, -0.209752124390492,
                                 -0.246071908134020, -0.000000000000000, -0.000000000000000,
                                  0.193840653202617,  0.112955480696922,  0.000000000000000,
                                 -0.000000000000000,  0.134379014433917,  0.066502351278756,
                                 -0.000000000000000, -0.000000000000000, -0.231050306804041,
                                 -0.217043165001374,  1.565369789120220,  0.931286395379278,
                                 -0.262457999994550, -0.255947535462771, -0.000000000000000,
                                 -0.000000000000000, -0.146073230172780, -0.194658035804123,
                                 -0.000000000000000, -0.000000000000000,  0.023036680066937,
                                  0.013514666861121, -0.000000000000000, -0.000000000000000,
                                  0.004423840168742, -0.007789820813395, -0.000000000000000,
                                 -0.000000000000000, -0.068527745252507, -0.049647630343981,
                                  0.541850606645985,  0.894427190999916, -0.131953750967747,
                                 -0.168041278545462, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 12, 20));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeDPForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 2);
    
    CGtoBlock kgtos(mlih, mbas, 1);
    
    CDenseMatrix lmomxmat(20, 12);
    
    CDenseMatrix lmomymat(20, 12);
    
    CDenseMatrix lmomzmat(20, 12);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

    std::vector<double> intxvals{-1.433006196130325, -0.978156907634135, -0.039085004910987,
                                -0.119596869363952,  0.000000000000000,  0.000000000000000,
                                 0.209752124390492,  0.146073230172780,  0.000000000000000,
                                 0.000000000000000,  0.311141003100714,  0.182561519362234,
                                -1.251699175764304, -1.095445115010332, -0.099867625777288,
                                -0.201048324858298,  0.000000000000000,  0.000000000000000,
                                 0.246071908134020,  0.194658035804123,  0.000000000000000,
                                 0.000000000000000,  0.330136915753537,  0.238045468771634,
                                -0.033065154174388, -0.072201673566824, -1.565369789120220,
                                -0.541850606645985,  0.189332013930234,  0.175182510486035,
                                 0.000000000000000,  0.000000000000000,  0.282798532093657,
                                 0.234634314820620,  0.000000000000000,  0.000000000000000,
                                -0.180189212829290, -0.246232904772071, -0.931286395379278,
                                -0.894427190999916,  0.224940098708485,  0.238406431026260,
                                 0.000000000000000,  0.000000000000000,  0.281723762549885,
                                 0.291544967036065,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.045509172362209,
                                 0.070788616895268,  0.000000000000000,  0.000000000000000,
                                -0.193840653202617, -0.023036680066937,  0.000000000000000,
                                 0.000000000000000,  0.209752124390492,  0.146073230172779,
                                 0.000000000000000,  0.000000000000000,  0.093355941289276,
                                 0.100334135657071,  0.000000000000000,  0.000000000000000,
                                -0.112955480696922, -0.013514666861121,  0.000000000000000,
                                 0.000000000000000,  0.246071908134020,  0.194658035804123,
                                 0.038846375342300,  0.066914659366273,  0.000000000000000,
                                 0.000000000000000, -0.181362128502866, -0.079117355293182,
                                 0.000000000000000,  0.000000000000000,  0.189332013930234,
                                 0.175182510486035,  0.000000000000000,  0.000000000000000,
                                 0.108326711269521,  0.122883718071506,  0.000000000000000,
                                 0.000000000000000, -0.037426388459486, -0.016552018926724,
                                 0.000000000000000,  0.000000000000000,  0.224940098708485,
                                 0.238406431026259,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.276698868637266,
                                -0.114514779743228,  0.000000000000000,  0.000000000000000,
                                -0.134379014433917, -0.004423840168742,  0.827346513086245,
                                 0.564739153932260,  0.217731501742966,  0.211530807088571,
                                 0.000000000000000,  0.000000000000000, -0.244688411521011,
                                -0.140603046747558,  0.000000000000000,  0.000000000000000,
                                -0.066502351278756,  0.007789820813395,  0.722668856071953,
                                 0.632455532033676,  0.293331082986603,  0.306954884813221,
                                -0.254225293012190, -0.173291543073507, -0.000000000000000,
                                 0.000000000000000, -0.126387619330081, -0.046310823625133,
                                 0.000000000000000,  0.000000000000000,  0.194880930362660,
                                 0.209540746675983,  0.903766669129867,  0.312837593607622,
                                -0.177705872383887, -0.172202860406103,  0.000000000000000,
                                 0.000000000000000, -0.008366778011796,  0.009540543090265,
                                 0.000000000000000,  0.000000000000000,  0.323326989107613,
                                 0.375941420923589,  0.537678451064862,  0.516397779494323,
                                 0.000000000000000,  0.000000000000000,  0.209752124390492,
                                 0.146073230172780, -1.433006196130325, -0.978156907634135,
                                 0.231050306804041,  0.068527745252507,  0.000000000000000,
                                 0.000000000000000,  0.570425172351309,  0.334696118830762,
                                 0.000000000000000,  0.000000000000000,  0.246071908134020,
                                 0.194658035804123, -1.251699175764304, -1.095445115010332,
                                 0.217043165001374,  0.049647630343981,  0.000000000000000,
                                 0.000000000000000,  0.605251012214818,  0.436416692747995,
                                 0.189332013930234,  0.175182510486035,  0.000000000000000,
                                 0.000000000000000,  0.210771530432732,  0.153412165695493,
                                -1.565369789120220, -0.541850606645985,  0.518463975505037,
                                 0.430162910504470,  0.000000000000000,  0.000000000000000,
                                 0.224940098708485,  0.238406431026259,  0.000000000000000,
                                 0.000000000000000,  0.109506368840729,  0.060805680640536,
                                -0.931286395379278, -0.894427190999916,  0.516493564674789,
                                 0.534499106232786,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.025725157426760,
                                 0.007252782696341,  0.000000000000000,  0.000000000000000,
                                 0.262457999994550,  0.131953750967747, -1.433006196130325,
                                -0.978156907634135, -0.106986711712061, -0.178257490626997,
                                 0.000000000000000,  0.000000000000000,  0.019279635672746,
                                 0.008028514967003,  0.000000000000000,  0.000000000000000,
                                 0.255947535462771,  0.168041278545462, -1.251699175764303,
                                -1.095445115010332, -0.191153548393337, -0.280965500925672,
                                 0.023829536530324,  0.013601912988477, -0.000000000000000,
                                 0.000000000000000,  0.239808800081369,  0.181624125569099,
                                 0.000000000000000,  0.000000000000000, -0.093706988207300,
                                -0.137321380236403, -1.565369789120220, -0.541850606645985,
                                 0.011354551237128,  0.009832882530727,  0.000000000000000,
                                 0.000000000000000,  0.204083426702634,  0.205807694080640,
                                 0.000000000000000,  0.000000000000000, -0.270323190922635,
                                -0.344111056296686, -0.931286395379278, -0.894427190999917};


    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 20, 12));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.259690688247194,
                                 0.168055953969551,  0.000000000000000,  0.000000000000000,
                                 0.045509172362209,  0.070788616895268, -1.433006196130325,
                                -0.978156907634135, -0.039085004910987, -0.119596869363952,
                                 0.000000000000000,  0.000000000000000,  0.291577644408044,
                                 0.221988438837628,  0.000000000000000,  0.000000000000000,
                                 0.093355941289276,  0.100334135657071, -1.251699175764304,
                                -1.095445115010332, -0.099867625777288, -0.201048324858298,
                                 0.235139459033008,  0.207430488843665,  0.000000000000000,
                                 0.000000000000000,  0.038846375342300,  0.066914659366273,
                                 0.000000000000000,  0.000000000000000, -0.033065154174388,
                                -0.072201673566824, -1.565369789120220, -0.541850606645985,
                                 0.259014660075629,  0.271879201974610,  0.000000000000000,
                                 0.000000000000000,  0.108326711269521,  0.122883718071506,
                                 0.000000000000000,  0.000000000000000, -0.180189212829290,
                                -0.246232904772071, -0.931286395379278, -0.894427190999916,
                                 0.000000000000000,  0.000000000000000,  0.714149392679784,
                                 0.462153873416265, -1.433006196130325, -0.978156907634135,
                                 0.069516429135194,  0.049330511863392,  0.000000000000000,
                                 0.000000000000000,  0.045509172362209,  0.070788616895268,
                                 0.000000000000000,  0.000000000000000,  0.801838522122122,
                                 0.610468206803477, -1.251699175764304, -1.095445115010332,
                                 0.122913597753939,  0.038385407959713,  0.000000000000000,
                                 0.000000000000000,  0.093355941289276,  0.100334135657071,
                                 0.646633512340772,  0.570433844320080,  0.000000000000000,
                                 0.000000000000000,  0.059636423347010,  0.087481036284508,
                                -1.565369789120220, -0.541850606645985,  0.038846375342300,
                                 0.066914659366273,  0.000000000000000,  0.000000000000000,
                                 0.712290315207979,  0.747667805430179,  0.000000000000000,
                                 0.000000000000000,  0.078317711791157,  0.047012331534932,
                                -0.931286395379278, -0.894427190999916,  0.108326711269521,
                                 0.122883718071506,  0.000000000000000,  0.000000000000000,
                                 0.827346513086245,  0.564739153932260, -0.012850888788089,
                                 0.116101823969214,  0.000000000000000,  0.000000000000000,
                                -0.201568521650876, -0.006635760253112,  0.000000000000000,
                                 0.000000000000000, -0.276698868637266, -0.114514779743228,
                                 0.722668856071953,  0.632455532033676,  0.089424073385760,
                                 0.189785679190256,  0.000000000000000,  0.000000000000000,
                                -0.099753526918134,  0.011684731220092,  0.000000000000000,
                                 0.000000000000000, -0.244688411521011, -0.140603046747558,
                                -0.016973480480832,  0.065131127448060,  0.903766669129867,
                                 0.312837593607622, -0.189581428995122, -0.069466235437700,
                                 0.000000000000000,  0.000000000000000, -0.254225293012190,
                                -0.173291543073507, -0.000000000000000,  0.000000000000000,
                                 0.175238762121040,  0.232439037251836,  0.537678451064862,
                                 0.516397779494323, -0.012550167017694,  0.014310814635397,
                                 0.000000000000000,  0.000000000000000, -0.177705872383887,
                                -0.172202860406103,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.045509172362209,
                                 0.070788616895268,  0.000000000000000,  0.000000000000000,
                                -0.193840653202617, -0.023036680066937,  0.000000000000000,
                                 0.000000000000000,  0.209752124390492,  0.146073230172780,
                                 0.000000000000000,  0.000000000000000,  0.093355941289276,
                                 0.100334135657071,  0.000000000000000,  0.000000000000000,
                                -0.112955480696922, -0.013514666861121,  0.000000000000000,
                                 0.000000000000000,  0.246071908134020,  0.194658035804123,
                                 0.038846375342300,  0.066914659366273,  0.000000000000000,
                                 0.000000000000000, -0.181362128502866, -0.079117355293182,
                                 0.000000000000000,  0.000000000000000,  0.189332013930234,
                                 0.175182510486035,  0.000000000000000,  0.000000000000000,
                                 0.108326711269521,  0.122883718071506,  0.000000000000000,
                                 0.000000000000000, -0.037426388459486, -0.016552018926724,
                                 0.000000000000000,  0.000000000000000,  0.224940098708486,
                                 0.238406431026259,  0.000000000000000,  0.000000000000000,
                                 1.433006196130325,  0.978156907634135, -0.130859826349568,
                                 0.032166876738753,  0.000000000000000,  0.000000000000000,
                                -0.252198634144646, -0.158040321621743,  0.000000000000000,
                                 0.000000000000000,  0.025725157426760,  0.007252782696341,
                                 1.251699175764303,  1.095445115010332, -0.067894185007322,
                                 0.089284706088480,  0.000000000000000,  0.000000000000000,
                                -0.277883306994051, -0.207905085499677,  0.000000000000000,
                                 0.000000000000000,  0.019279635672746,  0.008028514967003,
                                -0.122100508095477, -0.046872287957049,  1.565369789120220,
                                 0.541850606645985, -0.228650749205269, -0.197625666917022,
                                 0.000000000000000,  0.000000000000000,  0.023829536530324,
                                 0.013601912988477,  0.000000000000000,  0.000000000000000,
                                 0.045015514828671,  0.109350985875571,  0.931286395379278,
                                 0.894427190999917, -0.243675108249747, -0.254630687201960,
                                 0.000000000000000,  0.000000000000000,  0.011354551237128,
                                 0.009832882530727,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 20, 12));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.045509172362209,
                                 0.070788616895268,  0.000000000000000,  0.000000000000000,
                                -0.193840653202617, -0.023036680066937,  0.000000000000000,
                                 0.000000000000000,  0.209752124390492,  0.146073230172780,
                                 0.000000000000000,  0.000000000000000,  0.093355941289276,
                                 0.100334135657071,  0.000000000000000,  0.000000000000000,
                                -0.112955480696922, -0.013514666861121,  0.000000000000000,
                                 0.000000000000000,  0.246071908134020,  0.194658035804123,
                                 0.038846375342300,  0.066914659366273,  0.000000000000000,
                                 0.000000000000000, -0.181362128502866, -0.079117355293182,
                                 0.000000000000000,  0.000000000000000,  0.189332013930234,
                                 0.175182510486035,  0.000000000000000,  0.000000000000000,
                                 0.108326711269521,  0.122883718071506,  0.000000000000000,
                                 0.000000000000000, -0.037426388459486, -0.016552018926724,
                                 0.000000000000000,  0.000000000000000,  0.224940098708485,
                                 0.238406431026260,  0.000000000000000,  0.000000000000000,
                                -1.433006196130325, -0.978156907634135,  0.069516429135194,
                                 0.049330511863392,  0.000000000000000,  0.000000000000000,
                                 0.112823837829274,  0.292620077889285,  0.000000000000000,
                                 0.000000000000000, -0.193840653202617, -0.023036680066937,
                                -1.251699175764304, -1.095445115010332,  0.122913597753939,
                                 0.038385407959713,  0.000000000000000,  0.000000000000000,
                                 0.351177038271673,  0.422801669449786,  0.000000000000000,
                                 0.000000000000000, -0.112955480696922, -0.013514666861121,
                                 0.059636423347010,  0.087481036284508, -1.565369789120220,
                                -0.541850606645985,  0.089618095944441,  0.252489128214420,
                                 0.000000000000000,  0.000000000000000, -0.181362128502866,
                                -0.079117355293182, -0.000000000000000,  0.000000000000000,
                                 0.078317711791157,  0.047012331534932, -0.931286395379278,
                                -0.894427190999916,  0.446877680040111,  0.517824176274428,
                                 0.000000000000000,  0.000000000000000, -0.037426388459486,
                                -0.016552018926724,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.201568521650876,
                                -0.006635760253112, -1.654693026172490, -1.129478307864519,
                                 0.656673901576362,  0.421002436501258,  0.000000000000000,
                                 0.000000000000000, -0.134379014433917, -0.004423840168742,
                                 0.000000000000000,  0.000000000000000, -0.099753526918134,
                                 0.011684731220092, -1.445337712143907, -1.264911064067352,
                                 0.779934768242255,  0.523709867880156,  0.000000000000000,
                                 0.000000000000000, -0.066502351278756,  0.007789820813395,
                                -0.189581428995122, -0.069466235437700,  0.000000000000000,
                                 0.000000000000000,  0.591284452802138,  0.554788195325154,
                                -1.807533338259734, -0.625675187215243, -0.126387619330081,
                                -0.046310823625133,  0.000000000000000,  0.000000000000000,
                                -0.012550167017694,  0.014310814635397,  0.000000000000000,
                                 0.000000000000000,  0.651675796652711,  0.641410974783387,
                                -1.075356902129725, -1.032795558988646, -0.008366778011796,
                                 0.009540543090265,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.193840653202617,
                                -0.023036680066937,  0.000000000000000,  0.000000000000000,
                                 0.075215891886183,  0.195080051926190, -1.433006196130325,
                                -0.978156907634135,  0.231050306804041,  0.068527745252507,
                                 0.000000000000000,  0.000000000000000, -0.112955480696922,
                                -0.013514666861121,  0.000000000000000,  0.000000000000000,
                                 0.234118025514449,  0.281867779633191, -1.251699175764304,
                                -1.095445115010332,  0.217043165001374,  0.049647630343981,
                                -0.181362128502866, -0.079117355293182, -0.000000000000000,
                                 0.000000000000000,  0.059745397296294,  0.168326085476280,
                                 0.000000000000000,  0.000000000000000,  0.210771530432732,
                                 0.153412165695493, -1.565369789120220, -0.541850606645985,
                                -0.037426388459486, -0.016552018926724,  0.000000000000000,
                                 0.000000000000000,  0.297918453360074,  0.345216117516285,
                                 0.000000000000000,  0.000000000000000,  0.109506368840729,
                                 0.060805680640536, -0.931286395379278, -0.894427190999916,
                                 0.000000000000000,  0.000000000000000, -0.252198634144646,
                                -0.158040321621743,  0.000000000000000,  0.000000000000000,
                                 0.080766938834424,  0.009598616694557,  0.000000000000000,
                                 0.000000000000000,  0.262457999994550,  0.131953750967747,
                                 0.000000000000000,  0.000000000000000, -0.277883306994051,
                                -0.207905085499677,  0.000000000000000,  0.000000000000000,
                                 0.047064783623717,  0.005631111192134,  0.000000000000000,
                                 0.000000000000000,  0.255947535462771,  0.168041278545462,
                                -0.228650749205269, -0.197625666917022,  0.000000000000000,
                                 0.000000000000000,  0.075567553542861,  0.032965564705493,
                                 0.000000000000000,  0.000000000000000,  0.239808800081369,
                                 0.181624125569099,  0.000000000000000,  0.000000000000000,
                                -0.243675108249747, -0.254630687201960,  0.000000000000000,
                                 0.000000000000000,  0.015594328524786,  0.006896674552802,
                                 0.000000000000000,  0.000000000000000,  0.204083426702634,
                                 0.205807694080640,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 20, 12));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputePFForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 1);
    
    CGtoBlock kgtos(mlih, mbas, 3);
    
    CDenseMatrix lmomxmat(12, 28);
    
    CDenseMatrix lmomymat(12, 28);
    
    CDenseMatrix lmomzmat(12, 28);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                    bgtos, kgtos);
    
   std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.066013642665058,
                                -0.162896503251476, -0.000000000000000, -0.000000000000000,
                                -0.046018465107950, -0.248051030598819, -0.000000000000000,
                                -0.000000000000000,  0.009234482546492,  0.095695302431250,
                                -0.000000000000000, -0.000000000000000, -0.305793957910457,
                                -0.234080537212701, -0.000000000000000, -0.000000000000000,
                                 0.183097069608091,  0.233316874463443, -0.000000000000000,
                                -0.000000000000000,  0.038809755631904,  0.015984866146216,
                                -0.000000000000000, -0.000000000000000,  0.117745210640368,
                                 0.252057057205153, -0.000000000000000, -0.000000000000000,
                                -0.069350123330725, -0.176960061470030, -0.000000000000000,
                                -0.000000000000000, -0.082720879939642, -0.290713375058084,
                                -0.000000000000000, -0.000000000000000,  0.039072503597410,
                                 0.100537204269365, -0.000000000000000, -0.000000000000000,
                                -0.167965284312890, -0.200230673659366, -0.000000000000000,
                                -0.000000000000000,  0.134584063169548,  0.221614118781487,
                                -0.000000000000000, -0.000000000000000,  0.015457130135389,
                                 0.011609132701836, -0.000000000000000, -0.000000000000000,
                                 0.111482867759020,  0.271041211435118,  0.083524988560448,
                                 0.134974891265574,  0.000000000000000,  0.000000000000000,
                                 0.063744568098847,  0.158768100891384, -0.000000000000000,
                                -0.000000000000000, -0.017791761585086, -0.075380466239036,
                                -0.000000000000000, -0.000000000000000,  0.359677482351091,
                                 0.334513812213734, -0.000000000000000, -0.000000000000000,
                                -0.222143965844059, -0.265464261317567, -0.000000000000000,
                                -0.000000000000000, -0.044402485808422, -0.031157761477034,
                                -0.000000000000000, -0.000000000000000, -0.146710583386785,
                                -0.217495185730165, -0.000000000000000, -0.000000000000000,
                                 0.070553521430633,  0.117973374313353,  0.000000000000000,
                                -0.000000000000000,  0.108879182958717,  0.193808916705389,
                                -0.000000000000000, -0.000000000000000, -0.041287424467726,
                                -0.067024802846243, -0.000000000000000, -0.000000000000000,
                                 0.097575118327674,  0.133487115772911, -0.000000000000000,
                                -0.000000000000000, -0.098877161284213, -0.147742745854325,
                                -0.000000000000000, -0.000000000000000, -0.006499088820371,
                                -0.007739421801224, -0.000000000000000, -0.000000000000000,
                                -0.108965931664710, -0.180694140956745, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 0.198180305356053,  0.167110979113897, -0.000000000000000,
                                -0.000000000000000,  0.182530612824980,  0.085055621731753,
                                -0.000000000000000, -0.000000000000000, -0.104217364347808,
                                 0.023291579073892, -0.000000000000000, -0.000000000000000,
                                -0.040524799664794,  0.069137368032799, -0.000000000000000,
                                -0.000000000000000,  0.008005452162899, -0.234988518306776,
                                -0.000000000000000, -0.000000000000000,  0.239877776845744,
                                 0.077887588207647, -0.000000000000000, -0.000000000000000,
                                -0.037947814399728, -0.051248587415871, -0.000000000000000,
                                -0.000000000000000,  0.115434762445182,  0.145262872955315,
                                -0.000000000000000, -0.000000000000000,  0.095152907912646,
                                 0.039158102975150, -0.000000000000000, -0.000000000000000,
                                -0.013232065861939,  0.035426405462052, -0.000000000000000,
                                -0.000000000000000,  0.011092226728066,  0.087308364097195,
                                -0.000000000000000, -0.000000000000000, -0.056270478265601,
                                -0.296119132472069, -0.000000000000000, -0.000000000000000,
                                 0.098766813663208,  0.033803781396317, -0.000000000000000,
                                -0.000000000000000, -0.030323673767172, -0.047176862899707,
                                -0.234500109786121, -0.229476105986692, -0.000000000000000,
                                -0.000000000000000, -0.215024097117425, -0.191089561772110,
                                 0.000000000000000, -0.000000000000000,  0.113224272771534,
                                 0.029160508057531, -0.000000000000000, -0.000000000000000,
                                 0.041306068743198, -0.019312116728642, -0.000000000000000,
                                -0.000000000000000,  0.000198946015675,  0.105272530922714,
                                -0.000000000000000, -0.000000000000000, -0.276075869662672,
                                -0.199645822188726,  0.000000000000000,  0.000000000000000,
                                 0.046649989442647,  0.059786754445323, -0.000000000000000,
                                -0.000000000000000, -0.069843488992626, -0.096841915303543,
                                -0.000000000000000, -0.000000000000000, -0.033200011049607,
                                -0.026105401983433, -0.000000000000000, -0.000000000000000,
                                -0.010941494826860, -0.023617603641368, -0.000000000000000,
                                -0.000000000000000, -0.030844095707664, -0.058205576064796,
                                -0.000000000000000, -0.000000000000000,  0.104550123573360,
                                 0.197412754981380, -0.000000000000000, -0.000000000000000,
                                -0.030135111336053, -0.022535854264211,  0.000000000000000,
                                -0.000000000000000,  0.021628155727216,  0.031451241933138,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.056938147674833, -0.211469273586920,
                                -0.000000000000000, -0.000000000000000,  0.446630869559385,
                                 0.393351763099729, -0.000000000000000, -0.000000000000000,
                                 0.183097069608091,  0.233316874463443, -0.000000000000000,
                                -0.000000000000000,  0.122678558017838,  0.305329974179091,
                                -0.000000000000000, -0.000000000000000,  0.546722508057091,
                                 0.562392597797893, -0.000000000000000, -0.000000000000000,
                                -0.138971247241124, -0.373583919806122, -0.000000000000000,
                                -0.000000000000000, -0.236161645260905, -0.312417215370373,
                                -0.000000000000000, -0.000000000000000, -0.080627641169359,
                                -0.237219068391986, -0.000000000000000, -0.000000000000000,
                                 0.267299136434698,  0.344210784609425, -0.000000000000000,
                                -0.000000000000000,  0.134584063169548,  0.221614118781487,
                                -0.000000000000000, -0.000000000000000,  0.131765808305184,
                                 0.329012393580158, -0.000000000000000, -0.000000000000000,
                                 0.350208454630757,  0.518757104098911, -0.000000000000000,
                                -0.000000000000000, -0.156998407795832, -0.406272616827606,
                                -0.000000000000000, -0.000000000000000, -0.171039130925191,
                                -0.307758163695717,  0.075729789835990,  0.155882641991485,
                                 0.000000000000000, -0.000000000000000, -0.530003127794211,
                                -0.530941606351194, -0.000000000000000, -0.000000000000000,
                                -0.222143965844059, -0.265464261317567, -0.000000000000000,
                                -0.000000000000000, -0.155972773912666, -0.256522565083309,
                                -0.000000000000000, -0.000000000000000, -0.652774676718976,
                                -0.693481655391415, -0.000000000000000, -0.000000000000000,
                                 0.178013238739555,  0.305215142659499, -0.000000000000000,
                                -0.000000000000000,  0.285404422607042,  0.336970050259947,
                                 0.000000000000000,  0.000000000000000,  0.092118409967104,
                                 0.158146045594657, -0.000000000000000, -0.000000000000000,
                                -0.164581821067256, -0.229473856406283, -0.000000000000000,
                                -0.000000000000000, -0.098877161284213, -0.147742745854325,
                                -0.000000000000000, -0.000000000000000, -0.132077128409392,
                                -0.219341595720105, -0.000000000000000, -0.000000000000000,
                                -0.237163415456558, -0.345838069399274, -0.000000000000000,
                                -0.000000000000000,  0.161857128567849,  0.270848411218404,
                                -0.000000000000000, -0.000000000000000,  0.133110864833045,
                                 0.205172109130478,  0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 12, 28));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000,  0.121225741576466,
                                 0.269033330619389, -0.000000000000000, -0.000000000000000,
                                 0.369011358295576,  0.361382030807298, -0.000000000000000,
                                -0.000000000000000,  0.650838416297284,  0.753814975880271,
                                -0.000000000000000, -0.000000000000000, -0.132149740240876,
                                 0.110262859835173, -0.000000000000000, -0.000000000000000,
                                 0.009234482546492,  0.095695302431250, -0.000000000000000,
                                -0.000000000000000, -0.200879681031777,  0.059111505678194,
                                -0.000000000000000, -0.000000000000000, -0.092419390236332,
                                 0.018200923871085, -0.000000000000000, -0.000000000000000,
                                 0.119506111736012,  0.287715312527720, -0.000000000000000,
                                -0.000000000000000,  0.236384876163920,  0.320992519205754,
                                -0.000000000000000, -0.000000000000000,  0.449337374172703,
                                 0.707327343770926, -0.000000000000000, -0.000000000000000,
                                -0.008205261955557,  0.162153498864020, -0.000000000000000,
                                -0.000000000000000,  0.039072503597410,  0.100537204269365,
                                -0.000000000000000, -0.000000000000000, -0.052869930786925,
                                 0.129104573571281, -0.000000000000000, -0.000000000000000,
                                -0.027673051971034,  0.049666249224184, -0.152103730650250,
                                -0.233084084583785, -0.000000000000000, -0.000000000000000,
                                -0.441198156177366, -0.468626083397126, -0.000000000000000,
                                -0.000000000000000, -0.783705691612034, -0.887828921128109,
                                -0.000000000000000, -0.000000000000000,  0.143758461379909,
                                 0.022238945094802, -0.000000000000000, -0.000000000000000,
                                -0.017791761585086, -0.075380466239036, -0.000000000000000,
                                -0.000000000000000,  0.226653962915269,  0.111271394735634,
                                -0.000000000000000, -0.000000000000000,  0.104951274888064,
                                 0.057615100767363, -0.000000000000000, -0.000000000000000,
                                -0.116213541758727, -0.191810208351814, -0.000000000000000,
                                -0.000000000000000, -0.151583643426513, -0.213995012803836,
                                -0.000000000000000, -0.000000000000000, -0.318799098602213,
                                -0.471551562513951, -0.000000000000000, -0.000000000000000,
                                -0.050764529802998, -0.108102332576013, -0.000000000000000,
                                -0.000000000000000, -0.041287424467726, -0.067024802846243,
                                -0.000000000000000, -0.000000000000000, -0.030121518362112,
                                -0.086069715714188, -0.000000000000000, -0.000000000000000,
                                -0.009957969009190, -0.033110832816123, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.100795746080241, -0.077134238049900, -0.000000000000000,
                                -0.000000000000000,  0.030771150886583,  0.040408485985415,
                                -0.000000000000000, -0.000000000000000, -0.078842351460274,
                                -0.215578869078533, -0.000000000000000, -0.000000000000000,
                                -0.060787199497191,  0.103706052049198, -0.000000000000000,
                                -0.000000000000000, -0.104217364347808,  0.023291579073892,
                                -0.000000000000000, -0.000000000000000, -0.223442778773511,
                                -0.092388489557841, -0.000000000000000, -0.000000000000000,
                                -0.134804239795872, -0.141007802003952, -0.000000000000000,
                                -0.000000000000000, -0.055354716681730, -0.065976516930901,
                                -0.000000000000000, -0.000000000000000,  0.036257162925268,
                                 0.020183571665830, -0.000000000000000, -0.000000000000000,
                                -0.067297199817217, -0.266597127920360, -0.000000000000000,
                                -0.000000000000000,  0.016638340092099,  0.130962546145792,
                                -0.000000000000000, -0.000000000000000, -0.013232065861939,
                                 0.035426405462052, -0.000000000000000, -0.000000000000000,
                                -0.107383056970069, -0.041822926618071, -0.000000000000000,
                                -0.000000000000000, -0.090193374632182, -0.126305238638145,
                                 0.118554703839730,  0.110243162447454, -0.000000000000000,
                                -0.000000000000000, -0.041252112244138, -0.071813978868084,
                                 0.000000000000000,  0.000000000000000,  0.094552506658620,
                                 0.129572954303990, -0.000000000000000, -0.000000000000000,
                                 0.061959103114798, -0.028968175092963, -0.000000000000000,
                                -0.000000000000000,  0.113224272771534,  0.029160508057531,
                                -0.000000000000000, -0.000000000000000,  0.260967875742790,
                                 0.216100139813105, -0.000000000000000, -0.000000000000000,
                                 0.161991154091584,  0.178595694555972, -0.000000000000000,
                                -0.000000000000000,  0.032152681932490,  0.043984344620601,
                                -0.000000000000000, -0.000000000000000, -0.015978132517957,
                                -0.013455714443887,  0.000000000000000, -0.000000000000000,
                                 0.095432211217643,  0.177731418613573, -0.000000000000000,
                                -0.000000000000000, -0.046266143561496, -0.087308364097195,
                                -0.000000000000000, -0.000000000000000, -0.010941494826860,
                                -0.023617603641368, -0.000000000000000, -0.000000000000000,
                                 0.035969854731408,  0.027881951078714, -0.000000000000000,
                                -0.000000000000000,  0.059230521390668,  0.084203492425430,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.066013642665058, -0.162896503251476,
                                -0.000000000000000, -0.000000000000000, -0.046018465107950,
                                -0.248051030598819, -0.000000000000000, -0.000000000000000,
                                 0.009234482546492,  0.095695302431250, -0.000000000000000,
                                -0.000000000000000, -0.305793957910457, -0.234080537212701,
                                -0.000000000000000, -0.000000000000000,  0.183097069608091,
                                 0.233316874463443, -0.000000000000000, -0.000000000000000,
                                 0.038809755631904,  0.015984866146216, -0.000000000000000,
                                -0.000000000000000,  0.117745210640368,  0.252057057205153,
                                -0.000000000000000, -0.000000000000000, -0.069350123330725,
                                -0.176960061470030, -0.000000000000000, -0.000000000000000,
                                -0.082720879939643, -0.290713375058084, -0.000000000000000,
                                -0.000000000000000,  0.039072503597410,  0.100537204269365,
                                -0.000000000000000, -0.000000000000000, -0.167965284312890,
                                -0.200230673659366, -0.000000000000000, -0.000000000000000,
                                 0.134584063169548,  0.221614118781487, -0.000000000000000,
                                -0.000000000000000,  0.015457130135389,  0.011609132701836,
                                -0.000000000000000, -0.000000000000000,  0.111482867759020,
                                 0.271041211435118,  0.083524988560448,  0.134974891265574,
                                 0.000000000000000,  0.000000000000000,  0.063744568098847,
                                 0.158768100891384, -0.000000000000000, -0.000000000000000,
                                -0.017791761585086, -0.075380466239036, -0.000000000000000,
                                -0.000000000000000,  0.359677482351091,  0.334513812213734,
                                -0.000000000000000, -0.000000000000000, -0.222143965844059,
                                -0.265464261317567, -0.000000000000000, -0.000000000000000,
                                -0.044402485808422, -0.031157761477034, -0.000000000000000,
                                -0.000000000000000, -0.146710583386785, -0.217495185730165,
                                -0.000000000000000, -0.000000000000000,  0.070553521430633,
                                 0.117973374313353,  0.000000000000000, -0.000000000000000,
                                 0.108879182958717,  0.193808916705389, -0.000000000000000,
                                -0.000000000000000, -0.041287424467726, -0.067024802846243,
                                -0.000000000000000, -0.000000000000000,  0.097575118327674,
                                 0.133487115772911, -0.000000000000000, -0.000000000000000,
                                -0.098877161284213, -0.147742745854325, -0.000000000000000,
                                -0.000000000000000, -0.006499088820371, -0.007739421801224,
                                -0.000000000000000, -0.000000000000000, -0.108965931664710,
                                -0.180694140956745, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 12, 28));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.100795746080241,
                                -0.077134238049900, -0.000000000000000, -0.000000000000000,
                                 0.030771150886583,  0.040408485985415, -0.000000000000000,
                                -0.000000000000000, -0.078842351460274, -0.215578869078533,
                                -0.000000000000000, -0.000000000000000, -0.060787199497191,
                                 0.103706052049198, -0.000000000000000, -0.000000000000000,
                                -0.104217364347808,  0.023291579073892, -0.000000000000000,
                                -0.000000000000000, -0.223442778773511, -0.092388489557841,
                                -0.000000000000000, -0.000000000000000, -0.134804239795872,
                                -0.141007802003952, -0.000000000000000, -0.000000000000000,
                                -0.055354716681730, -0.065976516930901, -0.000000000000000,
                                -0.000000000000000,  0.036257162925268,  0.020183571665830,
                                -0.000000000000000, -0.000000000000000, -0.067297199817217,
                                -0.266597127920360, -0.000000000000000, -0.000000000000000,
                                 0.016638340092099,  0.130962546145792, -0.000000000000000,
                                -0.000000000000000, -0.013232065861939,  0.035426405462052,
                                -0.000000000000000, -0.000000000000000, -0.107383056970069,
                                -0.041822926618071, -0.000000000000000, -0.000000000000000,
                                -0.090193374632182, -0.126305238638145,  0.118554703839730,
                                 0.110243162447454, -0.000000000000000, -0.000000000000000,
                                -0.041252112244138, -0.071813978868084,  0.000000000000000,
                                 0.000000000000000,  0.094552506658620,  0.129572954303990,
                                -0.000000000000000, -0.000000000000000,  0.061959103114798,
                                -0.028968175092963, -0.000000000000000, -0.000000000000000,
                                 0.113224272771534,  0.029160508057531, -0.000000000000000,
                                -0.000000000000000,  0.260967875742790,  0.216100139813105,
                                -0.000000000000000, -0.000000000000000,  0.161991154091584,
                                 0.178595694555972, -0.000000000000000, -0.000000000000000,
                                 0.032152681932490,  0.043984344620601, -0.000000000000000,
                                -0.000000000000000, -0.015978132517957, -0.013455714443887,
                                 0.000000000000000, -0.000000000000000,  0.095432211217643,
                                 0.177731418613573, -0.000000000000000, -0.000000000000000,
                                -0.046266143561496, -0.087308364097195, -0.000000000000000,
                                -0.000000000000000, -0.010941494826860, -0.023617603641368,
                                -0.000000000000000, -0.000000000000000,  0.035969854731408,
                                 0.027881951078714, -0.000000000000000, -0.000000000000000,
                                 0.059230521390668,  0.084203492425430, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.016702321807662, -0.002993630754198, -0.000000000000000,
                                -0.000000000000000,  0.039128435424389,  0.225510668564464,
                                -0.000000000000000, -0.000000000000000,  0.493002671776464,
                                 0.534590685288806, -0.000000000000000, -0.000000000000000,
                                 0.404893513832557,  0.037874473123673, -0.000000000000000,
                                -0.000000000000000,  0.328668447850976,  0.356393790192538,
                                -0.000000000000000, -0.000000000000000, -0.016303514760162,
                                -0.093962778568527, -0.000000000000000, -0.000000000000000,
                                 0.085367422572494,  0.015300779410347, -0.000000000000000,
                                -0.000000000000000, -0.004992937444811, -0.001087909696610,
                                -0.000000000000000, -0.000000000000000,  0.104999270013111,
                                 0.222314891240151, -0.000000000000000, -0.000000000000000,
                                 0.360992921957162,  0.448833663862925, -0.000000000000000,
                                -0.000000000000000,  0.158020201752633, -0.080594344880482,
                                -0.000000000000000, -0.000000000000000,  0.240661947971441,
                                 0.299222442575283, -0.000000000000000, -0.000000000000000,
                                -0.043749695838796, -0.092631204683396, -0.000000000000000,
                                -0.000000000000000,  0.025519458051257,  0.005560427338231,
                                 0.018756469081256,  0.010210525728749, -0.000000000000000,
                                -0.000000000000000, -0.063777026805778, -0.203785110842334,
                                -0.000000000000000, -0.000000000000000, -0.600841203545924,
                                -0.714780696144137,  0.000000000000000, -0.000000000000000,
                                -0.466573220070140, -0.322395019791729, -0.000000000000000,
                                -0.000000000000000, -0.400560802363950, -0.476520464096092,
                                 0.000000000000000,  0.000000000000000,  0.026573761169074,
                                 0.084910462850973, -0.000000000000000, -0.000000000000000,
                                -0.095866397526417, -0.052187131502497, -0.000000000000000,
                                -0.000000000000000,  0.001130783947948,  0.000725273131074,
                                -0.000000000000000, -0.000000000000000, -0.096341388453356,
                                -0.148209927493434, -0.000000000000000, -0.000000000000000,
                                -0.222695604750094, -0.299222442575283, -0.000000000000000,
                                -0.000000000000000, -0.007986628958187,  0.053729563253655,
                                -0.000000000000000, -0.000000000000000, -0.148463736500062,
                                -0.199481628383522,  0.000000000000000, -0.000000000000000,
                                 0.040142245188898,  0.061754136455597, -0.000000000000000,
                                -0.000000000000000, -0.005779562400621, -0.003706951558820,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000,  0.198180305356053,  0.167110979113897,
                                -0.000000000000000, -0.000000000000000,  0.182530612824980,
                                 0.085055621731753, -0.000000000000000, -0.000000000000000,
                                -0.104217364347808,  0.023291579073892, -0.000000000000000,
                                -0.000000000000000, -0.040524799664794,  0.069137368032799,
                                -0.000000000000000, -0.000000000000000,  0.008005452162899,
                                -0.234988518306776, -0.000000000000000, -0.000000000000000,
                                 0.239877776845744,  0.077887588207647, -0.000000000000000,
                                -0.000000000000000, -0.037947814399728, -0.051248587415871,
                                -0.000000000000000, -0.000000000000000,  0.115434762445182,
                                 0.145262872955315, -0.000000000000000, -0.000000000000000,
                                 0.095152907912646,  0.039158102975150, -0.000000000000000,
                                -0.000000000000000, -0.013232065861939,  0.035426405462052,
                                -0.000000000000000, -0.000000000000000,  0.011092226728066,
                                 0.087308364097195, -0.000000000000000, -0.000000000000000,
                                -0.056270478265601, -0.296119132472069, -0.000000000000000,
                                -0.000000000000000,  0.098766813663208,  0.033803781396317,
                                -0.000000000000000, -0.000000000000000, -0.030323673767172,
                                -0.047176862899707, -0.234500109786121, -0.229476105986692,
                                -0.000000000000000, -0.000000000000000, -0.215024097117425,
                                -0.191089561772110,  0.000000000000000, -0.000000000000000,
                                 0.113224272771534,  0.029160508057531, -0.000000000000000,
                                -0.000000000000000,  0.041306068743198, -0.019312116728642,
                                -0.000000000000000, -0.000000000000000,  0.000198946015675,
                                 0.105272530922714, -0.000000000000000, -0.000000000000000,
                                -0.276075869662672, -0.199645822188726,  0.000000000000000,
                                 0.000000000000000,  0.046649989442647,  0.059786754445323,
                                -0.000000000000000, -0.000000000000000, -0.069843488992626,
                                -0.096841915303543, -0.000000000000000, -0.000000000000000,
                                -0.033200011049607, -0.026105401983433, -0.000000000000000,
                                -0.000000000000000, -0.010941494826860, -0.023617603641368,
                                -0.000000000000000, -0.000000000000000, -0.030844095707664,
                                -0.058205576064796, -0.000000000000000, -0.000000000000000,
                                 0.104550123573360,  0.197412754981379, -0.000000000000000,
                                -0.000000000000000, -0.030135111336053, -0.022535854264211,
                                 0.000000000000000, -0.000000000000000,  0.021628155727216,
                                 0.031451241933138, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 12, 28));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeFPForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 3);
    
    CGtoBlock kgtos(mlih, mbas, 1);
    
    CDenseMatrix lmomxmat(28, 12);
    
    CDenseMatrix lmomymat(28, 12);
    
    CDenseMatrix lmomzmat(28, 12);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000, -0.083524988560448,
                                -0.070553521430633,  0.000000000000000,  0.000000000000000,
                                 0.234500109786121,  0.069843488992626,  0.000000000000000,
                                 0.000000000000000, -0.075729789835990, -0.092118409967104,
                                 0.000000000000000,  0.000000000000000, -0.134974891265574,
                                -0.117973374313353,  0.000000000000000,  0.000000000000000,
                                 0.229476105986692,  0.096841915303543,  0.000000000000000,
                                 0.000000000000000, -0.155882641991485, -0.158146045594657,
                                 0.066013642665058,  0.069350123330725, -0.000000000000000,
                                -0.000000000000000, -0.198180305356053, -0.115434762445182,
                                 0.000000000000000,  0.000000000000000,  0.056938147674833,
                                 0.080627641169359, -0.000000000000000,  0.000000000000000,
                                 0.162896503251476,  0.176960061470030, -0.000000000000000,
                                 0.000000000000000, -0.167110979113897, -0.145262872955315,
                                 0.000000000000000,  0.000000000000000,  0.211469273586920,
                                 0.237219068391986,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.063744568098847,
                                -0.108879182958717,  0.000000000000000,  0.000000000000000,
                                 0.215024097117425,  0.033200011049607,  0.000000000000000,
                                 0.000000000000000,  0.530003127794211,  0.164581821067256,
                                 0.000000000000000,  0.000000000000000, -0.158768100891384,
                                -0.193808916705389,  0.000000000000000,  0.000000000000000,
                                 0.191089561772110,  0.026105401983433,  0.000000000000000,
                                 0.000000000000000,  0.530941606351194,  0.229473856406283,
                                 0.046018465107950,  0.082720879939642,  0.000000000000000,
                                 0.000000000000000, -0.182530612824980, -0.095152907912646,
                                -0.000000000000000,  0.000000000000000, -0.446630869559385,
                                -0.267299136434698,  0.000000000000000,  0.000000000000000,
                                 0.248051030598819,  0.290713375058084,  0.000000000000000,
                                 0.000000000000000, -0.085055621731753, -0.039158102975150,
                                 0.000000000000000,  0.000000000000000, -0.393351763099729,
                                -0.344210784609425,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.017791761585086,
                                 0.041287424467726,  0.000000000000000,  0.000000000000000,
                                -0.113224272771534,  0.010941494826860,  0.000000000000000,
                                 0.000000000000000,  0.222143965844059,  0.098877161284213,
                                 0.000000000000000,  0.000000000000000,  0.075380466239036,
                                 0.067024802846243,  0.000000000000000,  0.000000000000000,
                                -0.029160508057531,  0.023617603641368,  0.000000000000000,
                                 0.000000000000000,  0.265464261317567,  0.147742745854325,
                                -0.009234482546492, -0.039072503597410,  0.000000000000000,
                                 0.000000000000000,  0.104217364347808,  0.013232065861939,
                                 0.000000000000000,  0.000000000000000, -0.183097069608091,
                                -0.134584063169548,  0.000000000000000,  0.000000000000000,
                                -0.095695302431250, -0.100537204269365,  0.000000000000000,
                                 0.000000000000000, -0.023291579073892, -0.035426405462052,
                                 0.000000000000000,  0.000000000000000, -0.233316874463443,
                                -0.221614118781487,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.359677482351091,
                                -0.097575118327674,  0.000000000000000,  0.000000000000000,
                                -0.041306068743198,  0.030844095707664,  0.000000000000000,
                                 0.000000000000000,  0.155972773912666,  0.132077128409392,
                                 0.000000000000000,  0.000000000000000, -0.334513812213734,
                                -0.133487115772911,  0.000000000000000,  0.000000000000000,
                                 0.019312116728642,  0.058205576064796,  0.000000000000000,
                                 0.000000000000000,  0.256522565083309,  0.219341595720105,
                                 0.305793957910457,  0.167965284312890,  0.000000000000000,
                                 0.000000000000000,  0.040524799664794, -0.011092226728066,
                                 0.000000000000000,  0.000000000000000, -0.122678558017838,
                                -0.131765808305184,  0.000000000000000,  0.000000000000000,
                                 0.234080537212701,  0.200230673659366,  0.000000000000000,
                                 0.000000000000000, -0.069137368032799, -0.087308364097195,
                                 0.000000000000000,  0.000000000000000, -0.305329974179091,
                                -0.329012393580158,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.222143965844059,
                                 0.098877161284213,  0.000000000000000,  0.000000000000000,
                                -0.000198946015675, -0.104550123573360,  0.000000000000000,
                                 0.000000000000000,  0.652774676718976,  0.237163415456558,
                                 0.000000000000000,  0.000000000000000,  0.265464261317567,
                                 0.147742745854325,  0.000000000000000,  0.000000000000000,
                                -0.105272530922714, -0.197412754981380,  0.000000000000000,
                                 0.000000000000000,  0.693481655391415,  0.345838069399274,
                                -0.183097069608091, -0.134584063169548,  0.000000000000000,
                                 0.000000000000000, -0.008005452162899,  0.056270478265601,
                                 0.000000000000000,  0.000000000000000, -0.546722508057091,
                                -0.350208454630757,  0.000000000000000,  0.000000000000000,
                                -0.233316874463443, -0.221614118781487,  0.000000000000000,
                                 0.000000000000000,  0.234988518306776,  0.296119132472069,
                                 0.000000000000000,  0.000000000000000, -0.562392597797893,
                                -0.518757104098911,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.044402485808422,
                                 0.006499088820371,  0.000000000000000,  0.000000000000000,
                                 0.276075869662672,  0.030135111336053,  0.000000000000000,
                                 0.000000000000000, -0.178013238739555, -0.161857128567849,
                                 0.000000000000000,  0.000000000000000,  0.031157761477034,
                                 0.007739421801224,  0.000000000000000,  0.000000000000000,
                                 0.199645822188726,  0.022535854264211,  0.000000000000000,
                                 0.000000000000000, -0.305215142659499, -0.270848411218404,
                                -0.038809755631904, -0.015457130135389,  0.000000000000000,
                                 0.000000000000000, -0.239877776845744, -0.098766813663208,
                                -0.000000000000000, -0.000000000000000,  0.138971247241124,
                                 0.156998407795832,  0.000000000000000,  0.000000000000000,
                                -0.015984866146216, -0.011609132701836,  0.000000000000000,
                                 0.000000000000000, -0.077887588207647, -0.033803781396317,
                                -0.000000000000000,  0.000000000000000,  0.373583919806122,
                                 0.406272616827606,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.146710583386785,
                                 0.108965931664710,  0.000000000000000,  0.000000000000000,
                                -0.046649989442647, -0.021628155727216,  0.000000000000000,
                                 0.000000000000000, -0.285404422607042, -0.133110864833045,
                                 0.000000000000000,  0.000000000000000,  0.217495185730165,
                                 0.180694140956745,  0.000000000000000,  0.000000000000000,
                                -0.059786754445323, -0.031451241933138,  0.000000000000000,
                                 0.000000000000000, -0.336970050259947, -0.205172109130478,
                                -0.117745210640368, -0.111482867759020,  0.000000000000000,
                                 0.000000000000000,  0.037947814399728,  0.030323673767172,
                                 0.000000000000000,  0.000000000000000,  0.236161645260905,
                                 0.171039130925191, -0.000000000000000, -0.000000000000000,
                                -0.252057057205153, -0.271041211435118,  0.000000000000000,
                                 0.000000000000000,  0.051248587415871,  0.047176862899707,
                                 0.000000000000000,  0.000000000000000,  0.312417215370373,
                                 0.307758163695717, -0.000000000000000,  0.000000000000000};
   
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 28, 12));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.152103730650250,
                                 0.116213541758727,  0.000000000000000,  0.000000000000000,
                                -0.118554703839730, -0.032152681932490,  0.000000000000000,
                                 0.000000000000000, -0.083524988560448, -0.070553521430633,
                                 0.000000000000000,  0.000000000000000,  0.233084084583785,
                                 0.191810208351814,  0.000000000000000,  0.000000000000000,
                                -0.110243162447454, -0.043984344620601,  0.000000000000000,
                                 0.000000000000000, -0.134974891265574, -0.117973374313353,
                                -0.121225741576466, -0.119506111736012,  0.000000000000000,
                                 0.000000000000000,  0.100795746080241,  0.055354716681730,
                                 0.000000000000000,  0.000000000000000,  0.066013642665058,
                                 0.069350123330725, -0.000000000000000, -0.000000000000000,
                                -0.269033330619389, -0.287715312527720,  0.000000000000000,
                                 0.000000000000000,  0.077134238049900,  0.065976516930901,
                                 0.000000000000000,  0.000000000000000,  0.162896503251476,
                                 0.176960061470030, -0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.441198156177366,
                                 0.151583643426513,  0.000000000000000,  0.000000000000000,
                                 0.041252112244138,  0.015978132517957,  0.000000000000000,
                                 0.000000000000000, -0.063744568098847, -0.108879182958717,
                                 0.000000000000000,  0.000000000000000,  0.468626083397126,
                                 0.213995012803836,  0.000000000000000,  0.000000000000000,
                                 0.071813978868084,  0.013455714443887,  0.000000000000000,
                                 0.000000000000000, -0.158768100891384, -0.193808916705389,
                                -0.369011358295576, -0.236384876163920,  0.000000000000000,
                                 0.000000000000000, -0.030771150886583, -0.036257162925268,
                                -0.000000000000000, -0.000000000000000,  0.046018465107950,
                                 0.082720879939643,  0.000000000000000,  0.000000000000000,
                                -0.361382030807298, -0.320992519205754,  0.000000000000000,
                                 0.000000000000000, -0.040408485985415, -0.020183571665830,
                                -0.000000000000000,  0.000000000000000,  0.248051030598819,
                                 0.290713375058084,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.783705691612034,
                                 0.318799098602213,  0.000000000000000,  0.000000000000000,
                                -0.094552506658620, -0.095432211217643,  0.000000000000000,
                                 0.000000000000000,  0.017791761585086,  0.041287424467726,
                                 0.000000000000000,  0.000000000000000,  0.887828921128109,
                                 0.471551562513951,  0.000000000000000,  0.000000000000000,
                                -0.129572954303990, -0.177731418613573,  0.000000000000000,
                                 0.000000000000000,  0.075380466239036,  0.067024802846243,
                                -0.650838416297284, -0.449337374172703,  0.000000000000000,
                                 0.000000000000000,  0.078842351460274,  0.067297199817217,
                                 0.000000000000000,  0.000000000000000, -0.009234482546492,
                                -0.039072503597410,  0.000000000000000,  0.000000000000000,
                                -0.753814975880271, -0.707327343770926,  0.000000000000000,
                                 0.000000000000000,  0.215578869078533,  0.266597127920360,
                                 0.000000000000000,  0.000000000000000, -0.095695302431250,
                                -0.100537204269365,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.143758461379909,
                                 0.050764529802998,  0.000000000000000,  0.000000000000000,
                                -0.061959103114798,  0.046266143561496,  0.000000000000000,
                                 0.000000000000000, -0.359677482351091, -0.097575118327674,
                                 0.000000000000000,  0.000000000000000, -0.022238945094802,
                                 0.108102332576013,  0.000000000000000,  0.000000000000000,
                                 0.028968175092963,  0.087308364097195,  0.000000000000000,
                                 0.000000000000000, -0.334513812213734, -0.133487115772911,
                                 0.132149740240876,  0.008205261955557,  0.000000000000000,
                                 0.000000000000000,  0.060787199497191, -0.016638340092099,
                                 0.000000000000000,  0.000000000000000,  0.305793957910457,
                                 0.167965284312890,  0.000000000000000,  0.000000000000000,
                                -0.110262859835173, -0.162153498864020,  0.000000000000000,
                                 0.000000000000000, -0.103706052049198, -0.130962546145792,
                                 0.000000000000000,  0.000000000000000,  0.234080537212701,
                                 0.200230673659366,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.017791761585086,
                                 0.041287424467726,  0.000000000000000,  0.000000000000000,
                                -0.113224272771534,  0.010941494826860,  0.000000000000000,
                                 0.000000000000000,  0.222143965844059,  0.098877161284213,
                                 0.000000000000000,  0.000000000000000,  0.075380466239036,
                                 0.067024802846243,  0.000000000000000,  0.000000000000000,
                                -0.029160508057531,  0.023617603641368,  0.000000000000000,
                                 0.000000000000000,  0.265464261317567,  0.147742745854325,
                                -0.009234482546492, -0.039072503597410,  0.000000000000000,
                                 0.000000000000000,  0.104217364347808,  0.013232065861939,
                                 0.000000000000000,  0.000000000000000, -0.183097069608091,
                                -0.134584063169548,  0.000000000000000,  0.000000000000000,
                                -0.095695302431250, -0.100537204269365,  0.000000000000000,
                                 0.000000000000000, -0.023291579073892, -0.035426405462052,
                                 0.000000000000000,  0.000000000000000, -0.233316874463443,
                                -0.221614118781487,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.226653962915269,
                                 0.030121518362112,  0.000000000000000,  0.000000000000000,
                                -0.260967875742790, -0.035969854731408,  0.000000000000000,
                                 0.000000000000000,  0.044402485808422,  0.006499088820371,
                                 0.000000000000000,  0.000000000000000, -0.111271394735634,
                                 0.086069715714188,  0.000000000000000,  0.000000000000000,
                                -0.216100139813105, -0.027881951078714,  0.000000000000000,
                                 0.000000000000000,  0.031157761477034,  0.007739421801224,
                                 0.200879681031777,  0.052869930786925,  0.000000000000000,
                                 0.000000000000000,  0.223442778773511,  0.107383056970069,
                                 0.000000000000000,  0.000000000000000, -0.038809755631904,
                                -0.015457130135389,  0.000000000000000,  0.000000000000000,
                                -0.059111505678194, -0.129104573571281,  0.000000000000000,
                                 0.000000000000000,  0.092388489557841,  0.041822926618071,
                                 0.000000000000000,  0.000000000000000, -0.015984866146216,
                                -0.011609132701836,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.104951274888064,
                                 0.009957969009190,  0.000000000000000,  0.000000000000000,
                                -0.161991154091584, -0.059230521390668,  0.000000000000000,
                                 0.000000000000000,  0.146710583386785,  0.108965931664710,
                                 0.000000000000000,  0.000000000000000, -0.057615100767363,
                                 0.033110832816123,  0.000000000000000,  0.000000000000000,
                                -0.178595694555972, -0.084203492425430,  0.000000000000000,
                                 0.000000000000000,  0.217495185730165,  0.180694140956745,
                                 0.092419390236332,  0.027673051971034,  0.000000000000000,
                                 0.000000000000000,  0.134804239795872,  0.090193374632182,
                                 0.000000000000000,  0.000000000000000, -0.117745210640368,
                                -0.111482867759020,  0.000000000000000,  0.000000000000000,
                                -0.018200923871085, -0.049666249224184,  0.000000000000000,
                                 0.000000000000000,  0.141007802003952,  0.126305238638145,
                                 0.000000000000000,  0.000000000000000, -0.252057057205153,
                                -0.271041211435118,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 28, 12));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000, -0.118554703839730,
                                -0.032152681932490,  0.000000000000000,  0.000000000000000,
                                -0.018756469081256, -0.001130783947948,  0.000000000000000,
                                 0.000000000000000,  0.234500109786121,  0.069843488992626,
                                 0.000000000000000,  0.000000000000000, -0.110243162447454,
                                -0.043984344620601,  0.000000000000000,  0.000000000000000,
                                -0.010210525728749, -0.000725273131074,  0.000000000000000,
                                 0.000000000000000,  0.229476105986692,  0.096841915303543,
                                 0.100795746080241,  0.055354716681730,  0.000000000000000,
                                 0.000000000000000,  0.016702321807662,  0.004992937444811,
                                 0.000000000000000,  0.000000000000000, -0.198180305356053,
                                -0.115434762445182,  0.000000000000000,  0.000000000000000,
                                 0.077134238049900,  0.065976516930901,  0.000000000000000,
                                 0.000000000000000,  0.002993630754198,  0.001087909696610,
                                 0.000000000000000,  0.000000000000000, -0.167110979113897,
                                -0.145262872955315,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.041252112244138,
                                 0.015978132517957,  0.000000000000000,  0.000000000000000,
                                 0.063777026805778,  0.096341388453356,  0.000000000000000,
                                 0.000000000000000,  0.215024097117425,  0.033200011049607,
                                 0.000000000000000,  0.000000000000000,  0.071813978868084,
                                 0.013455714443887,  0.000000000000000,  0.000000000000000,
                                 0.203785110842334,  0.148209927493434,  0.000000000000000,
                                 0.000000000000000,  0.191089561772110,  0.026105401983433,
                                -0.030771150886583, -0.036257162925268, -0.000000000000000,
                                -0.000000000000000, -0.039128435424389, -0.104999270013111,
                                 0.000000000000000,  0.000000000000000, -0.182530612824980,
                                -0.095152907912646, -0.000000000000000,  0.000000000000000,
                                -0.040408485985415, -0.020183571665830, -0.000000000000000,
                                 0.000000000000000, -0.225510668564464, -0.222314891240151,
                                 0.000000000000000,  0.000000000000000, -0.085055621731753,
                                -0.039158102975150,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.094552506658620,
                                -0.095432211217643,  0.000000000000000,  0.000000000000000,
                                 0.600841203545924,  0.222695604750094,  0.000000000000000,
                                 0.000000000000000, -0.113224272771534,  0.010941494826860,
                                 0.000000000000000,  0.000000000000000, -0.129572954303990,
                                -0.177731418613573,  0.000000000000000,  0.000000000000000,
                                 0.714780696144137,  0.299222442575283,  0.000000000000000,
                                 0.000000000000000, -0.029160508057531,  0.023617603641368,
                                 0.078842351460274,  0.067297199817217,  0.000000000000000,
                                 0.000000000000000, -0.493002671776464, -0.360992921957162,
                                -0.000000000000000,  0.000000000000000,  0.104217364347808,
                                 0.013232065861939,  0.000000000000000,  0.000000000000000,
                                 0.215578869078533,  0.266597127920360,  0.000000000000000,
                                 0.000000000000000, -0.534590685288806, -0.448833663862925,
                                 0.000000000000000,  0.000000000000000, -0.023291579073892,
                                -0.035426405462052,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.061959103114798,
                                 0.046266143561496,  0.000000000000000,  0.000000000000000,
                                 0.466573220070140,  0.007986628958187,  0.000000000000000,
                                 0.000000000000000, -0.041306068743198,  0.030844095707664,
                                 0.000000000000000,  0.000000000000000,  0.028968175092963,
                                 0.087308364097195,  0.000000000000000,  0.000000000000000,
                                 0.322395019791729, -0.053729563253655,  0.000000000000000,
                                 0.000000000000000,  0.019312116728642,  0.058205576064796,
                                 0.060787199497191, -0.016638340092099,  0.000000000000000,
                                 0.000000000000000, -0.404893513832557, -0.158020201752633,
                                 0.000000000000000,  0.000000000000000,  0.040524799664794,
                                -0.011092226728066,  0.000000000000000,  0.000000000000000,
                                -0.103706052049198, -0.130962546145792,  0.000000000000000,
                                 0.000000000000000, -0.037874473123673,  0.080594344880482,
                                 0.000000000000000,  0.000000000000000, -0.069137368032799,
                                -0.087308364097195,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.113224272771534,
                                 0.010941494826860,  0.000000000000000,  0.000000000000000,
                                 0.400560802363950,  0.148463736500062,  0.000000000000000,
                                 0.000000000000000, -0.000198946015675, -0.104550123573360,
                                 0.000000000000000,  0.000000000000000, -0.029160508057531,
                                 0.023617603641368,  0.000000000000000,  0.000000000000000,
                                 0.476520464096092,  0.199481628383522,  0.000000000000000,
                                 0.000000000000000, -0.105272530922714, -0.197412754981379,
                                 0.104217364347808,  0.013232065861939,  0.000000000000000,
                                 0.000000000000000, -0.328668447850976, -0.240661947971441,
                                -0.000000000000000, -0.000000000000000, -0.008005452162899,
                                 0.056270478265601,  0.000000000000000,  0.000000000000000,
                                -0.023291579073892, -0.035426405462052,  0.000000000000000,
                                 0.000000000000000, -0.356393790192538, -0.299222442575283,
                                -0.000000000000000,  0.000000000000000,  0.234988518306776,
                                 0.296119132472069,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.260967875742790,
                                -0.035969854731408,  0.000000000000000,  0.000000000000000,
                                -0.026573761169074, -0.040142245188898,  0.000000000000000,
                                 0.000000000000000,  0.276075869662672,  0.030135111336053,
                                 0.000000000000000,  0.000000000000000, -0.216100139813105,
                                -0.027881951078714,  0.000000000000000,  0.000000000000000,
                                -0.084910462850973, -0.061754136455597,  0.000000000000000,
                                 0.000000000000000,  0.199645822188726,  0.022535854264211,
                                 0.223442778773511,  0.107383056970069,  0.000000000000000,
                                 0.000000000000000,  0.016303514760162,  0.043749695838796,
                                 0.000000000000000,  0.000000000000000, -0.239877776845744,
                                -0.098766813663208, -0.000000000000000, -0.000000000000000,
                                 0.092388489557841,  0.041822926618071,  0.000000000000000,
                                 0.000000000000000,  0.093962778568527,  0.092631204683396,
                                 0.000000000000000,  0.000000000000000, -0.077887588207647,
                                -0.033803781396317, -0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.161991154091584,
                                -0.059230521390668,  0.000000000000000,  0.000000000000000,
                                 0.095866397526417,  0.005779562400621,  0.000000000000000,
                                 0.000000000000000, -0.046649989442647, -0.021628155727216,
                                 0.000000000000000,  0.000000000000000, -0.178595694555972,
                                -0.084203492425430,  0.000000000000000,  0.000000000000000,
                                 0.052187131502497,  0.003706951558820,  0.000000000000000,
                                 0.000000000000000, -0.059786754445323, -0.031451241933138,
                                 0.134804239795872,  0.090193374632182,  0.000000000000000,
                                 0.000000000000000, -0.085367422572494, -0.025519458051257,
                                 0.000000000000000,  0.000000000000000,  0.037947814399728,
                                 0.030323673767172,  0.000000000000000,  0.000000000000000,
                                 0.141007802003952,  0.126305238638145,  0.000000000000000,
                                 0.000000000000000, -0.015300779410347, -0.005560427338231,
                                 0.000000000000000,  0.000000000000000,  0.051248587415871,
                                 0.047176862899707,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 28, 12));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputePGForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 1);
    
    CGtoBlock kgtos(mlih, mbas, 4);
    
    CDenseMatrix lmomxmat(12, 36);
    
    CDenseMatrix lmomymat(12, 36);
    
    CDenseMatrix lmomzmat(12, 36);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.051572334260750,
                                -0.084703667117786, -0.000000000000000, -0.000000000000000,
                                 0.101617403497579,  0.226870018647538, -0.000000000000000,
                                 0.000000000000000,  0.015828036154404,  0.159017151822187,
                                -0.000000000000000, -0.000000000000000,  0.037511387856772,
                                -0.065252392200681, -0.000000000000000, -0.000000000000000,
                                 0.301299267415648,  0.241148094066501, -0.000000000000000,
                                -0.000000000000000, -0.134467319170516, -0.206692360491195,
                                -0.000000000000000, -0.000000000000000, -0.049338088675590,
                                -0.020872873214460, -0.000000000000000, -0.000000000000000,
                                -0.183686441089812, -0.351246016036831, -0.000000000000000,
                                -0.000000000000000, -0.113324251646096, -0.199631571660790,
                                 0.000000000000000, -0.000000000000000, -0.032501972044018,
                                -0.075512733086854, -0.000000000000000, -0.000000000000000,
                                 0.079355777994553,  0.208926815723751, -0.000000000000000,
                                 0.000000000000000,  0.039773747383029,  0.162848461229686,
                                -0.000000000000000, -0.000000000000000, -0.011579424540030,
                                -0.068034483637618, -0.000000000000000, -0.000000000000000,
                                 0.128473472669380,  0.181659618879921, -0.000000000000000,
                                -0.000000000000000, -0.084306354305065, -0.177900466639615,
                                -0.000000000000000, -0.000000000000000, -0.014691147093264,
                                -0.013479870723757, -0.000000000000000, -0.000000000000000,
                                -0.127518108278530, -0.320003150793648, -0.000000000000000,
                                -0.000000000000000, -0.075168650084216, -0.179020065090643,
                                -0.068517274264409, -0.089395314399473, -0.000000000000000,
                                 0.000000000000000,  0.140518651572511,  0.216552554447807,
                                -0.000000000000000, -0.000000000000000,  0.030883050408938,
                                 0.105192955306592, -0.000000000000000,  0.000000000000000,
                                 0.036565890617141, -0.028501263496619, -0.000000000000000,
                                -0.000000000000000,  0.378894924232090,  0.360932732710717,
                                 0.000000000000000, -0.000000000000000, -0.179156587979936,
                                -0.232594273317764, -0.000000000000000, -0.000000000000000,
                                -0.059426208817849, -0.042023937976893,  0.000000000000000,
                                -0.000000000000000, -0.248083160351765, -0.349230998062619,
                                -0.000000000000000, -0.000000000000000, -0.151971504697098,
                                -0.206391875093336, -0.000000000000000, -0.000000000000000,
                                -0.023809348127846, -0.041103925587950,  0.000000000000000,
                                -0.000000000000000,  0.064288297462721,  0.113725353801707,
                                -0.000000000000000, -0.000000000000000,  0.046284327502977,
                                 0.088643474535587, -0.000000000000000,  0.000000000000000,
                                -0.019139329295780, -0.037033282183532, -0.000000000000000,
                                -0.000000000000000,  0.065240161010712,  0.098882971805393,
                                -0.000000000000000, -0.000000000000000, -0.057642738206366,
                                -0.096836748504462, -0.000000000000000, -0.000000000000000,
                                -0.005457452807233, -0.007337512238197, -0.000000000000000,
                                -0.000000000000000, -0.099253855585368, -0.174187652339409,
                                -0.000000000000000, -0.000000000000000, -0.056199326769736,
                                -0.097446180709313, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.035343071389969,
                                -0.020238170465612, -0.000000000000000, -0.000000000000000,
                                -0.204543129818398, -0.065364632164785, -0.000000000000000,
                                -0.000000000000000, -0.035111372590446,  0.165115250028287,
                                -0.000000000000000, -0.000000000000000,  0.016967093381082,
                                -0.079764632853654, -0.000000000000000, -0.000000000000000,
                                -0.052782748117870, -0.177160576105603,  0.000000000000000,
                                 0.000000000000000,  0.139837260768048,  0.330855401021416,
                                -0.000000000000000, -0.000000000000000, -0.092418061972798,
                                 0.128880013986014,  0.000000000000000, -0.000000000000000,
                                 0.036964892924938,  0.019841576803152, -0.000000000000000,
                                -0.000000000000000,  0.097628079721076,  0.074384881972503,
                                -0.000000000000000, -0.000000000000000, -0.012430508161157,
                                -0.014118060972090, -0.000000000000000, -0.000000000000000,
                                -0.062665952683293, -0.023859333463298, -0.000000000000000,
                                -0.000000000000000,  0.026835718150639,  0.183934319141027,
                                -0.000000000000000, -0.000000000000000, -0.022755596498668,
                                -0.074101892558135, -0.000000000000000, -0.000000000000000,
                                -0.055091536668682, -0.169927028869730,  0.000000000000000,
                                -0.000000000000000,  0.110042312307499,  0.312128285372013,
                                -0.000000000000000, -0.000000000000000,  0.014653998241955,
                                 0.144283092644421,  0.000000000000000, -0.000000000000000,
                                 0.016437721287932,  0.007748769391493, -0.000000000000000,
                                -0.000000000000000,  0.041002605964569,  0.054597828999214,
                                -0.043372579254813, -0.035250796237630, -0.000000000000000,
                                -0.000000000000000, -0.248499930781107, -0.180362765718772,
                                 0.000000000000000, -0.000000000000000, -0.030680478460045,
                                 0.066679567649492, -0.000000000000000, -0.000000000000000,
                                 0.009251788245766, -0.060095016007890, -0.000000000000000,
                                -0.000000000000000, -0.077715955801829, -0.148820072231843,
                                -0.000000000000000, -0.000000000000000,  0.192850453299536,
                                 0.299396530414833,  0.000000000000000, -0.000000000000000,
                                -0.096283713112455,  0.032411105228434, -0.000000000000000,
                                -0.000000000000000,  0.047390538297426,  0.046725932293844,
                                 0.000000000000000, -0.000000000000000,  0.122615218643481,
                                 0.115368860572765, -0.000000000000000, -0.000000000000000,
                                -0.005382315009484, -0.007684899008694, -0.000000000000000,
                                -0.000000000000000, -0.015738566484269, -0.012987376130665,
                                -0.000000000000000, -0.000000000000000,  0.049167980749842,
                                 0.100121161795945, -0.000000000000000, -0.000000000000000,
                                -0.022722503151283, -0.040335961275994, -0.000000000000000,
                                -0.000000000000000, -0.050712751338019, -0.092496558719561,
                                -0.000000000000000, -0.000000000000000,  0.094285829341926,
                                 0.169901118544722, -0.000000000000000,  0.000000000000000,
                                 0.038519569173786,  0.078537767886565, -0.000000000000000,
                                -0.000000000000000,  0.004848316231315,  0.004217895809701,
                                 0.000000000000000, -0.000000000000000,  0.020017135081562,
                                 0.029719293802623, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.166899885226883,
                                 0.242225978684909, -0.000000000000000, -0.000000000000000,
                                 0.083721139298584,  0.294003825736656, -0.000000000000000,
                                -0.000000000000000, -0.490490153159249, -0.417956635725716,
                                -0.000000000000000, -0.000000000000000, -0.134467319170516,
                                -0.206692360491195,  0.000000000000000,  0.000000000000000,
                                -0.034678489377001, -0.191935985796157, -0.000000000000000,
                                -0.000000000000000, -0.472384666027085, -0.529452744651908,
                                 0.000000000000000,  0.000000000000000,  0.101787520482674,
                                 0.283070854326532, -0.000000000000000, -0.000000000000000,
                                 0.377751312317553,  0.437262236489609, -0.000000000000000,
                                -0.000000000000000,  0.016273004439947, -0.037313615383029,
                                -0.000000000000000, -0.000000000000000,  0.098309623719471,
                                 0.210479279587957, -0.000000000000000, -0.000000000000000,
                                 0.092359321821135,  0.280071244191368, -0.000000000000000,
                                -0.000000000000000, -0.216935183618830, -0.319214008929638,
                                -0.000000000000000, -0.000000000000000, -0.084306354305065,
                                -0.177900466639615,  0.000000000000000, -0.000000000000000,
                                -0.055546583724123, -0.187301361896058, -0.000000000000000,
                                -0.000000000000000, -0.240012407271487, -0.436706257207965,
                                -0.000000000000000,  0.000000000000000,  0.094904654200373,
                                 0.263502608546684, -0.000000000000000, -0.000000000000000,
                                 0.195328660890019,  0.363352796217381, -0.000000000000000,
                                -0.000000000000000, -0.005559689882212, -0.041202565879439,
                                 0.219528870072936,  0.271430584207173,  0.000000000000000,
                                -0.000000000000000,  0.125406980717246,  0.249526689815205,
                                -0.000000000000000, -0.000000000000000, -0.619888078621785,
                                -0.608399750630638, -0.000000000000000, -0.000000000000000,
                                -0.179156587979936, -0.232594273317764, -0.000000000000000,
                                -0.000000000000000, -0.058038926653419, -0.148849328274543,
                                 0.000000000000000, -0.000000000000000, -0.607918961459230,
                                -0.667687083246552, -0.000000000000000, -0.000000000000000,
                                 0.146546848671843,  0.257835400258149, -0.000000000000000,
                                 0.000000000000000,  0.487326861890417,  0.542864969042878,
                                -0.000000000000000, -0.000000000000000,  0.016038964298587,
                                -0.013410989281147,  0.000000000000000, -0.000000000000000,
                                 0.067678497716073,  0.114570408093132, -0.000000000000000,
                                -0.000000000000000,  0.084030369818616,  0.152451475532284,
                                -0.000000000000000, -0.000000000000000, -0.113423233438425,
                                -0.173758097916855, -0.000000000000000, -0.000000000000000,
                                -0.057642738206366, -0.096836748504462, -0.000000000000000,
                                -0.000000000000000, -0.055197572366489, -0.101953947727492,
                                 0.000000000000000, -0.000000000000000, -0.146148136959609,
                                -0.237712777253365, -0.000000000000000, -0.000000000000000,
                                 0.080446121364961,  0.143432652629270,  0.000000000000000,
                                 0.000000000000000,  0.120905305287118,  0.197784210521347,
                                -0.000000000000000, -0.000000000000000, -0.011097625467988,
                                -0.022427836110674, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 12, 36));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.051216012266497,
                                -0.154050787948967, -0.000000000000000, -0.000000000000000,
                                -0.187947022375730, -0.374991950567171, -0.000000000000000,
                                -0.000000000000000, -0.391813975808068, -0.376210889296797,
                                -0.000000000000000, -0.000000000000000, -0.517842598084953,
                                -0.685365344787688,  0.000000000000000,  0.000000000000000,
                                 0.216404233469373,  0.009020759259261, -0.000000000000000,
                                -0.000000000000000,  0.037511387856773, -0.065252392200681,
                                -0.000000000000000, -0.000000000000000,  0.265839199920375,
                                 0.047832281099514, -0.000000000000000, -0.000000000000000,
                                 0.154958756743419, -0.023322931800308, -0.000000000000000,
                                -0.000000000000000,  0.098446836245769,  0.124754012862838,
                                -0.000000000000000, -0.000000000000000, -0.049711821837380,
                                -0.145755831564587, -0.000000000000000, -0.000000000000000,
                                -0.136701451412026, -0.339689326405218, -0.000000000000000,
                                -0.000000000000000, -0.187552889432301, -0.292254267482124,
                                -0.000000000000000, -0.000000000000000, -0.293081393412209,
                                -0.579210644628759,  0.000000000000000, -0.000000000000000,
                                 0.051514643500361, -0.035918346162791, -0.000000000000000,
                                -0.000000000000000, -0.011579424540030, -0.068034483637618,
                                -0.000000000000000, -0.000000000000000,  0.073632042904265,
                                -0.008724160041784, -0.000000000000000, -0.000000000000000,
                                 0.031308890352311, -0.058638153791037, -0.000000000000000,
                                -0.000000000000000,  0.053752510081953,  0.105386651835948,
                                -0.074231573710770, -0.134692518842072, -0.000000000000000,
                                -0.000000000000000, -0.256548087438488, -0.374227135359406,
                                -0.000000000000000, -0.000000000000000, -0.501035660986086,
                                -0.524351874676853, -0.000000000000000, -0.000000000000000,
                                -0.677873018283197, -0.811688246796993, -0.000000000000000,
                                -0.000000000000000,  0.257706843539990,  0.151927948984388,
                                 0.000000000000000, -0.000000000000000,  0.036565890617141,
                                -0.028501263496619, -0.000000000000000, -0.000000000000000,
                                 0.320504709498104,  0.214144443619973,  0.000000000000000,
                                -0.000000000000000,  0.182949905795930,  0.094492863738593,
                                -0.000000000000000, -0.000000000000000,  0.128047521260561,
                                 0.149009570768206,  0.000000000000000, -0.000000000000000,
                                -0.043950043363523, -0.079339425415175, -0.000000000000000,
                                -0.000000000000000, -0.105839487984948, -0.184903449058335,
                                -0.000000000000000, -0.000000000000000, -0.102508327823959,
                                -0.159083073440461, -0.000000000000000, -0.000000000000000,
                                -0.190288461176716, -0.315282340650884, -0.000000000000000,
                                -0.000000000000000, -0.000830771524229, -0.019551471222998,
                                 0.000000000000000, -0.000000000000000, -0.019139329295780,
                                -0.037033282183532, -0.000000000000000, -0.000000000000000,
                                 0.009525362494366, -0.004748831230388, -0.000000000000000,
                                -0.000000000000000, -0.009436479103641, -0.031918568054864,
                                -0.000000000000000, -0.000000000000000,  0.034628342700932,
                                 0.057365227266315, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.090713371398608,
                                 0.071964762700222, -0.000000000000000,  0.000000000000000,
                                 0.104930667229805,  0.030253987516313, -0.000000000000000,
                                -0.000000000000000,  0.029677403077524,  0.095612848249251,
                                 0.000000000000000,  0.000000000000000,  0.153976505252283,
                                 0.264384873643372, -0.000000000000000, -0.000000000000000,
                                -0.079174122176804, -0.265740864158405, -0.000000000000000,
                                -0.000000000000000,  0.016967093381082, -0.079764632853654,
                                -0.000000000000000, -0.000000000000000,  0.058999615752466,
                                -0.171624043324610, -0.000000000000000, -0.000000000000000,
                                 0.136006214552986,  0.054864722201933, -0.000000000000000,
                                -0.000000000000000,  0.001506342959535,  0.008395455666008,
                                -0.000000000000000, -0.000000000000000,  0.039125868712914,
                                 0.053135065994037, -0.000000000000000, -0.000000000000000,
                                 0.030060182675893,  0.010836600475922, -0.000000000000000,
                                -0.000000000000000,  0.020380079171045,  0.105961176952683,
                                 0.000000000000000, -0.000000000000000,  0.091079315225276,
                                 0.250376708240234, -0.000000000000000, -0.000000000000000,
                                -0.082637305003023, -0.254890543304595, -0.000000000000000,
                                -0.000000000000000, -0.022755596498668, -0.074101892558135,
                                -0.000000000000000, -0.000000000000000, -0.025715397968860,
                                -0.191432085254628, -0.000000000000000, -0.000000000000000,
                                 0.048929016829887,  0.020745554218496, -0.000000000000000,
                                -0.000000000000000,  0.003246802101829,  0.006960114135285,
                                 0.114363405207927,  0.109971162228305, -0.000000000000000,
                                -0.000000000000000,  0.126467234674186,  0.086756715614416,
                                -0.000000000000000, -0.000000000000000,  0.037877163697733,
                                 0.053716075769836, -0.000000000000000, -0.000000000000000,
                                 0.200560276837674,  0.249317350408258,  0.000000000000000,
                                -0.000000000000000, -0.116573933702743, -0.223230108347764,
                                -0.000000000000000, -0.000000000000000,  0.009251788245766,
                                -0.060095016007890, -0.000000000000000, -0.000000000000000,
                                 0.056929345662038, -0.062511203847913, -0.000000000000000,
                                -0.000000000000000,  0.168758724350762,  0.139995589261052,
                                -0.000000000000000, -0.000000000000000,  0.002992803672636,
                                 0.008837469093014, -0.000000000000000, -0.000000000000000,
                                 0.019393046361059,  0.028923066474334, -0.000000000000000,
                                -0.000000000000000,  0.007255664830745,  0.005898698158313,
                                -0.000000000000000, -0.000000000000000,  0.028362565109721,
                                 0.057677959128629, -0.000000000000000, -0.000000000000000,
                                 0.075350410049190,  0.136287817481393, -0.000000000000000,
                                 0.000000000000000, -0.076069127007028, -0.138744838079342,
                                -0.000000000000000, -0.000000000000000, -0.022722503151283,
                                -0.040335961275994, -0.000000000000000, -0.000000000000000,
                                -0.051155220675420, -0.104202428726846, -0.000000000000000,
                                -0.000000000000000,  0.013310988064675,  0.011292449392568,
                                -0.000000000000000, -0.000000000000000,  0.002328372664072,
                                 0.003788606262885, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.051572334260750,
                                -0.084703667117786, -0.000000000000000, -0.000000000000000,
                                 0.101617403497579,  0.226870018647538, -0.000000000000000,
                                 0.000000000000000,  0.015828036154404,  0.159017151822187,
                                -0.000000000000000, -0.000000000000000,  0.037511387856772,
                                -0.065252392200681, -0.000000000000000, -0.000000000000000,
                                 0.301299267415648,  0.241148094066501, -0.000000000000000,
                                -0.000000000000000, -0.134467319170516, -0.206692360491195,
                                -0.000000000000000, -0.000000000000000, -0.049338088675590,
                                -0.020872873214460, -0.000000000000000, -0.000000000000000,
                                -0.183686441089812, -0.351246016036831, -0.000000000000000,
                                -0.000000000000000, -0.113324251646096, -0.199631571660790,
                                -0.000000000000000, -0.000000000000000, -0.032501972044018,
                                -0.075512733086854, -0.000000000000000, -0.000000000000000,
                                 0.079355777994553,  0.208926815723751, -0.000000000000000,
                                 0.000000000000000,  0.039773747383029,  0.162848461229686,
                                -0.000000000000000, -0.000000000000000, -0.011579424540030,
                                -0.068034483637618, -0.000000000000000, -0.000000000000000,
                                 0.128473472669380,  0.181659618879921, -0.000000000000000,
                                -0.000000000000000, -0.084306354305065, -0.177900466639615,
                                -0.000000000000000, -0.000000000000000, -0.014691147093265,
                                -0.013479870723757, -0.000000000000000, -0.000000000000000,
                                -0.127518108278530, -0.320003150793648, -0.000000000000000,
                                -0.000000000000000, -0.075168650084216, -0.179020065090643,
                                -0.068517274264409, -0.089395314399473, -0.000000000000000,
                                -0.000000000000000,  0.140518651572511,  0.216552554447807,
                                -0.000000000000000, -0.000000000000000,  0.030883050408938,
                                 0.105192955306592, -0.000000000000000,  0.000000000000000,
                                 0.036565890617141, -0.028501263496619, -0.000000000000000,
                                -0.000000000000000,  0.378894924232090,  0.360932732710717,
                                 0.000000000000000, -0.000000000000000, -0.179156587979936,
                                -0.232594273317764, -0.000000000000000, -0.000000000000000,
                                -0.059426208817849, -0.042023937976893, -0.000000000000000,
                                -0.000000000000000, -0.248083160351765, -0.349230998062619,
                                -0.000000000000000, -0.000000000000000, -0.151971504697098,
                                -0.206391875093336, -0.000000000000000, -0.000000000000000,
                                -0.023809348127846, -0.041103925587950, -0.000000000000000,
                                 0.000000000000000,  0.064288297462721,  0.113725353801707,
                                -0.000000000000000, -0.000000000000000,  0.046284327502977,
                                 0.088643474535587, -0.000000000000000,  0.000000000000000,
                                -0.019139329295780, -0.037033282183532, -0.000000000000000,
                                -0.000000000000000,  0.065240161010712,  0.098882971805393,
                                -0.000000000000000, -0.000000000000000, -0.057642738206366,
                                -0.096836748504462, -0.000000000000000, -0.000000000000000,
                                -0.005457452807233, -0.007337512238197, -0.000000000000000,
                                -0.000000000000000, -0.099253855585368, -0.174187652339409,
                                -0.000000000000000, -0.000000000000000, -0.056199326769736,
                                -0.097446180709313, -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 12, 36));

    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000,  0.090713371398608,
                                 0.071964762700222, -0.000000000000000, -0.000000000000000,
                                 0.104930667229805,  0.030253987516313, -0.000000000000000,
                                -0.000000000000000,  0.029677403077524,  0.095612848249251,
                                -0.000000000000000, -0.000000000000000,  0.153976505252283,
                                 0.264384873643372, -0.000000000000000, -0.000000000000000,
                                -0.079174122176804, -0.265740864158405, -0.000000000000000,
                                -0.000000000000000,  0.016967093381082, -0.079764632853654,
                                -0.000000000000000, -0.000000000000000,  0.058999615752466,
                                -0.171624043324610, -0.000000000000000, -0.000000000000000,
                                 0.136006214552986,  0.054864722201933, -0.000000000000000,
                                -0.000000000000000,  0.001506342959535,  0.008395455666008,
                                -0.000000000000000, -0.000000000000000,  0.039125868712914,
                                 0.053135065994037, -0.000000000000000, -0.000000000000000,
                                 0.030060182675893,  0.010836600475922, -0.000000000000000,
                                -0.000000000000000,  0.020380079171045,  0.105961176952683,
                                 0.000000000000000, -0.000000000000000,  0.091079315225276,
                                 0.250376708240234, -0.000000000000000, -0.000000000000000,
                                -0.082637305003023, -0.254890543304595, -0.000000000000000,
                                -0.000000000000000, -0.022755596498668, -0.074101892558135,
                                -0.000000000000000, -0.000000000000000, -0.025715397968860,
                                -0.191432085254628, -0.000000000000000, -0.000000000000000,
                                 0.048929016829887,  0.020745554218496, -0.000000000000000,
                                -0.000000000000000,  0.003246802101829,  0.006960114135285,
                                 0.114363405207927,  0.109971162228305, -0.000000000000000,
                                -0.000000000000000,  0.126467234674186,  0.086756715614416,
                                -0.000000000000000,  0.000000000000000,  0.037877163697733,
                                 0.053716075769836, -0.000000000000000, -0.000000000000000,
                                 0.200560276837674,  0.249317350408258,  0.000000000000000,
                                 0.000000000000000, -0.116573933702743, -0.223230108347764,
                                -0.000000000000000, -0.000000000000000,  0.009251788245766,
                                -0.060095016007890, -0.000000000000000, -0.000000000000000,
                                 0.056929345662038, -0.062511203847913, -0.000000000000000,
                                -0.000000000000000,  0.168758724350762,  0.139995589261052,
                                -0.000000000000000, -0.000000000000000,  0.002992803672636,
                                 0.008837469093014, -0.000000000000000, -0.000000000000000,
                                 0.019393046361059,  0.028923066474334, -0.000000000000000,
                                -0.000000000000000,  0.007255664830745,  0.005898698158313,
                                -0.000000000000000, -0.000000000000000,  0.028362565109721,
                                 0.057677959128629, -0.000000000000000, -0.000000000000000,
                                 0.075350410049190,  0.136287817481393,  0.000000000000000,
                                -0.000000000000000, -0.076069127007028, -0.138744838079342,
                                -0.000000000000000, -0.000000000000000, -0.022722503151283,
                                -0.040335961275994, -0.000000000000000, -0.000000000000000,
                                -0.051155220675420, -0.104202428726846, -0.000000000000000,
                                -0.000000000000000,  0.013310988064675,  0.011292449392568,
                                -0.000000000000000, -0.000000000000000,  0.002328372664072,
                                 0.003788606262885, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.024231458772890,
                                -0.003712278768290, -0.000000000000000, -0.000000000000000,
                                -0.002474043598821, -0.017556966557781, -0.000000000000000,
                                -0.000000000000000, -0.282562102121688, -0.281670601337345,
                                -0.000000000000000, -0.000000000000000, -0.450010111947473,
                                -0.126014484656567, -0.000000000000001, -0.000000000000001,
                                 0.025737247236372,  0.374522288294937, -0.000000000000000,
                                -0.000000000000000, -0.300006741298315, -0.084009656437711,
                                -0.000000000000000, -0.000000000000000,  0.117734209217370,
                                 0.117362750557227, -0.000000000000000, -0.000000000000000,
                                 0.012645111727306,  0.089735606850882, -0.000000000000000,
                                 0.000000000000000, -0.024029529949783, -0.003681343111888,
                                -0.000000000000000, -0.000000000000000, -0.004856740247334,
                                -0.001100887209559, -0.000000000000000, -0.000000000000000,
                                -0.006691712551198, -0.014612025696185, -0.000000000000000,
                                -0.000000000000000, -0.152659445283908, -0.198917904050045,
                                -0.000000000000000, -0.000000000000000, -0.149844351806521,
                                -0.009762280946962, -0.000000000000001, -0.000000000000001,
                                 0.103260064175053,  0.367549706339342, -0.000000000000000,
                                -0.000000000000000, -0.099896234537681, -0.006508187297975,
                                -0.000000000000000,  0.000000000000000,  0.063608102201628,
                                 0.082882460020852, -0.000000000000000, -0.000000000000000,
                                 0.034202086372789,  0.074683686891610, -0.000000000000000,
                                -0.000000000000000, -0.004816267411939, -0.001091713149479,
                                -0.028192773903447, -0.014271952105304, -0.000000000000000,
                                -0.000000000000000, -0.005487806476743, -0.018183976055877,
                                -0.000000000000000, -0.000000000000000, -0.370683725672331,
                                -0.427148581335331,  0.000000000000000, -0.000000000000000,
                                -0.554487648511991, -0.431860572927492, -0.000000000000000,
                                -0.000000000000000,  0.065987776768498,  0.274740028682968,
                                -0.000000000000000, -0.000000000000000, -0.369658432341328,
                                -0.287907048618328, -0.000000000000000, -0.000000000000000,
                                 0.154451552363471,  0.177978575556388, -0.000000000000000,
                                -0.000000000000000,  0.028048788658907,  0.092940322063372,
                                -0.000000000000000, -0.000000000000000, -0.027957834120918,
                                -0.014153019171093, -0.000000000000000, -0.000000000000000,
                                -0.000858278581178, -0.000599247095061, -0.000000000000000,
                                -0.000000000000000, -0.004874114852194, -0.007953779347575,
                                -0.000000000000000, -0.000000000000000, -0.075375078281552,
                                -0.108277192361447, -0.000000000000000, -0.000000000000000,
                                -0.027734052848397, -0.005313912676834, -0.000000000000000,
                                -0.000000000000000,  0.107910135310845,  0.200068719031375,
                                -0.000000000000000, -0.000000000000001, -0.018489368565598,
                                -0.003542608451222, -0.000000000000000, -0.000000000000000,
                                 0.031406282617314,  0.045115496817270, -0.000000000000000,
                                -0.000000000000000,  0.024912142577880,  0.040652649998718,
                                -0.000000000000000, -0.000000000000000, -0.000851126259669,
                                -0.000594253369269, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.035343071389969,
                                -0.020238170465612, -0.000000000000000, -0.000000000000000,
                                -0.204543129818398, -0.065364632164785, -0.000000000000000,
                                -0.000000000000000, -0.035111372590446,  0.165115250028287,
                                -0.000000000000000, -0.000000000000000,  0.016967093381082,
                                -0.079764632853654, -0.000000000000000, -0.000000000000000,
                                -0.052782748117870, -0.177160576105603, -0.000000000000000,
                                -0.000000000000000,  0.139837260768047,  0.330855401021416,
                                -0.000000000000000, -0.000000000000000, -0.092418061972799,
                                 0.128880013986014,  0.000000000000000, -0.000000000000000,
                                 0.036964892924938,  0.019841576803152, -0.000000000000000,
                                -0.000000000000000,  0.097628079721075,  0.074384881972503,
                                -0.000000000000000, -0.000000000000000, -0.012430508161157,
                                -0.014118060972090, -0.000000000000000, -0.000000000000000,
                                -0.062665952683293, -0.023859333463298, -0.000000000000000,
                                -0.000000000000000,  0.026835718150639,  0.183934319141027,
                                -0.000000000000000, -0.000000000000000, -0.022755596498668,
                                -0.074101892558135, -0.000000000000000, -0.000000000000000,
                                -0.055091536668682, -0.169927028869730,  0.000000000000000,
                                -0.000000000000000,  0.110042312307499,  0.312128285372013,
                                -0.000000000000000, -0.000000000000000,  0.014653998241954,
                                 0.144283092644420,  0.000000000000000, -0.000000000000000,
                                 0.016437721287932,  0.007748769391493, -0.000000000000000,
                                -0.000000000000000,  0.041002605964569,  0.054597828999213,
                                -0.043372579254813, -0.035250796237630, -0.000000000000000,
                                -0.000000000000000, -0.248499930781107, -0.180362765718772,
                                 0.000000000000000, -0.000000000000000, -0.030680478460045,
                                 0.066679567649492, -0.000000000000000, -0.000000000000000,
                                 0.009251788245766, -0.060095016007890, -0.000000000000000,
                                -0.000000000000000, -0.077715955801829, -0.148820072231843,
                                -0.000000000000000, -0.000000000000000,  0.192850453299536,
                                 0.299396530414833,  0.000000000000000,  0.000000000000000,
                                -0.096283713112455,  0.032411105228434, -0.000000000000000,
                                -0.000000000000000,  0.047390538297426,  0.046725932293844,
                                 0.000000000000000, -0.000000000000000,  0.122615218643481,
                                 0.115368860572765, -0.000000000000000, -0.000000000000000,
                                -0.005382315009484, -0.007684899008694, -0.000000000000000,
                                -0.000000000000000, -0.015738566484269, -0.012987376130665,
                                -0.000000000000000, -0.000000000000000,  0.049167980749842,
                                 0.100121161795945, -0.000000000000000, -0.000000000000000,
                                -0.022722503151283, -0.040335961275994, -0.000000000000000,
                                -0.000000000000000, -0.050712751338019, -0.092496558719561,
                                -0.000000000000000, -0.000000000000000,  0.094285829341926,
                                 0.169901118544722,  0.000000000000000, -0.000000000000000,
                                 0.038519569173786,  0.078537767886565, -0.000000000000000,
                                -0.000000000000000,  0.004848316231315,  0.004217895809701,
                                 0.000000000000000,  0.000000000000000,  0.020017135081562,
                                 0.029719293802623, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 12, 36));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeGPForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 4);
    
    CGtoBlock kgtos(mlih, mbas, 1);
    
    CDenseMatrix lmomxmat(36, 12);
    
    CDenseMatrix lmomymat(36, 12);
    
    CDenseMatrix lmomzmat(36, 12);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.068517274264409,
                                 0.023809348127846,  0.000000000000000,  0.000000000000000,
                                 0.043372579254813,  0.005382315009484,  0.000000000000000,
                                 0.000000000000000, -0.219528870072936, -0.067678497716073,
                                 0.000000000000000,  0.000000000000000,  0.089395314399473,
                                 0.041103925587950,  0.000000000000000,  0.000000000000000,
                                 0.035250796237630,  0.007684899008694,  0.000000000000000,
                                 0.000000000000000, -0.271430584207173, -0.114570408093132,
                                 0.051572334260750,  0.032501972044018,  0.000000000000000,
                                -0.000000000000000,  0.035343071389969,  0.012430508161157,
                                 0.000000000000000,  0.000000000000000, -0.166899885226883,
                                -0.098309623719471, -0.000000000000000,  0.000000000000000,
                                 0.084703667117786,  0.075512733086854, -0.000000000000000,
                                 0.000000000000000,  0.020238170465612,  0.014118060972090,
                                 0.000000000000000,  0.000000000000000, -0.242225978684909,
                                -0.210479279587957,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.140518651572511,
                                -0.064288297462721,  0.000000000000000,  0.000000000000000,
                                 0.248499930781107,  0.015738566484269,  0.000000000000000,
                                 0.000000000000000, -0.125406980717246, -0.084030369818616,
                                 0.000000000000000,  0.000000000000000, -0.216552554447807,
                                -0.113725353801707,  0.000000000000000,  0.000000000000000,
                                 0.180362765718772,  0.012987376130665,  0.000000000000000,
                                 0.000000000000000, -0.249526689815205, -0.152451475532284,
                                -0.101617403497579, -0.079355777994553,  0.000000000000000,
                                 0.000000000000000,  0.204543129818398,  0.062665952683293,
                                -0.000000000000000,  0.000000000000000, -0.083721139298584,
                                -0.092359321821135,  0.000000000000000,  0.000000000000000,
                                -0.226870018647538, -0.208926815723751,  0.000000000000000,
                                 0.000000000000000,  0.065364632164785,  0.023859333463298,
                                 0.000000000000000,  0.000000000000000, -0.294003825736656,
                                -0.280071244191368,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.030883050408938,
                                -0.046284327502977,  0.000000000000000,  0.000000000000000,
                                 0.030680478460045, -0.049167980749842,  0.000000000000000,
                                 0.000000000000000,  0.619888078621785,  0.113423233438425,
                                -0.000000000000000, -0.000000000000000, -0.105192955306592,
                                -0.088643474535587,  0.000000000000000,  0.000000000000000,
                                -0.066679567649492, -0.100121161795945,  0.000000000000000,
                                 0.000000000000000,  0.608399750630638,  0.173758097916855,
                                -0.015828036154404, -0.039773747383029,  0.000000000000000,
                                 0.000000000000000,  0.035111372590446, -0.026835718150639,
                                 0.000000000000000,  0.000000000000000,  0.490490153159249,
                                 0.216935183618830,  0.000000000000000,  0.000000000000000,
                                -0.159017151822187, -0.162848461229686, -0.000000000000000,
                                -0.000000000000000, -0.165115250028287, -0.183934319141027,
                                 0.000000000000000,  0.000000000000000,  0.417956635725716,
                                 0.319214008929638,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.036565890617141,
                                 0.019139329295780,  0.000000000000000,  0.000000000000000,
                                -0.009251788245766,  0.022722503151283,  0.000000000000000,
                                 0.000000000000000,  0.179156587979936,  0.057642738206366,
                                 0.000000000000000,  0.000000000000000,  0.028501263496619,
                                 0.037033282183532,  0.000000000000000,  0.000000000000000,
                                 0.060095016007890,  0.040335961275994,  0.000000000000000,
                                 0.000000000000000,  0.232594273317764,  0.096836748504462,
                                -0.037511387856772,  0.011579424540030,  0.000000000000000,
                                 0.000000000000000, -0.016967093381082,  0.022755596498668,
                                 0.000000000000000,  0.000000000000000,  0.134467319170516,
                                 0.084306354305065,  0.000000000000000,  0.000000000000000,
                                 0.065252392200681,  0.068034483637618,  0.000000000000000,
                                 0.000000000000000,  0.079764632853654,  0.074101892558135,
                                 0.000000000000000,  0.000000000000000,  0.206692360491195,
                                 0.177900466639615,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.378894924232090,
                                -0.065240161010712,  0.000000000000000,  0.000000000000000,
                                 0.077715955801829,  0.050712751338019, -0.000000000000000,
                                -0.000000000000000,  0.058038926653419,  0.055197572366489,
                                 0.000000000000000,  0.000000000000000, -0.360932732710717,
                                -0.098882971805393,  0.000000000000000,  0.000000000000000,
                                 0.148820072231843,  0.092496558719561, -0.000000000000000,
                                 0.000000000000000,  0.148849328274543,  0.101953947727492,
                                -0.301299267415648, -0.128473472669380, -0.000000000000000,
                                 0.000000000000000,  0.052782748117870,  0.055091536668682,
                                 0.000000000000000,  0.000000000000000,  0.034678489377001,
                                 0.055546583724123, -0.000000000000000, -0.000000000000000,
                                -0.241148094066501, -0.181659618879921,  0.000000000000000,
                                 0.000000000000000,  0.177160576105603,  0.169927028869730,
                                 0.000000000000000,  0.000000000000000,  0.191935985796157,
                                 0.187301361896058,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.179156587979936,
                                 0.057642738206366, -0.000000000000000, -0.000000000000000,
                                -0.192850453299536, -0.094285829341926,  0.000000000000000,
                                 0.000000000000000,  0.607918961459230,  0.146148136959609,
                                 0.000000000000000,  0.000000000000000,  0.232594273317764,
                                 0.096836748504462, -0.000000000000000,  0.000000000000000,
                                -0.299396530414833, -0.169901118544722,  0.000000000000000,
                                 0.000000000000000,  0.667687083246552,  0.237712777253365,
                                 0.134467319170516,  0.084306354305065,  0.000000000000000,
                                 0.000000000000000, -0.139837260768048, -0.110042312307499,
                                -0.000000000000000,  0.000000000000000,  0.472384666027085,
                                 0.240012407271487,  0.000000000000000,  0.000000000000000,
                                 0.206692360491195,  0.177900466639615,  0.000000000000000,
                                 0.000000000000000, -0.330855401021416, -0.312128285372013,
                                 0.000000000000000, -0.000000000000000,  0.529452744651908,
                                 0.436706257207965,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.059426208817849,
                                 0.005457452807233,  0.000000000000000,  0.000000000000000,
                                 0.096283713112455, -0.038519569173786, -0.000000000000000,
                                 0.000000000000000, -0.146546848671843, -0.080446121364961,
                                 0.000000000000000,  0.000000000000000,  0.042023937976893,
                                 0.007337512238197,  0.000000000000000,  0.000000000000000,
                                -0.032411105228434, -0.078537767886565, -0.000000000000000,
                                -0.000000000000000, -0.257835400258149, -0.143432652629270,
                                 0.049338088675590,  0.014691147093264, -0.000000000000000,
                                 0.000000000000000,  0.092418061972798, -0.014653998241955,
                                 0.000000000000000,  0.000000000000000, -0.101787520482674,
                                -0.094904654200373,  0.000000000000000, -0.000000000000000,
                                 0.020872873214460,  0.013479870723757,  0.000000000000000,
                                 0.000000000000000, -0.128880013986014, -0.144283092644421,
                                 0.000000000000000,  0.000000000000000, -0.283070854326532,
                                -0.263502608546684, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.248083160351765,
                                 0.099253855585368, -0.000000000000000, -0.000000000000000,
                                -0.047390538297426, -0.004848316231315,  0.000000000000000,
                                 0.000000000000000, -0.487326861890417, -0.120905305287118,
                                 0.000000000000000,  0.000000000000000,  0.349230998062619,
                                 0.174187652339409,  0.000000000000000,  0.000000000000000,
                                -0.046725932293844, -0.004217895809701,  0.000000000000000,
                                 0.000000000000000, -0.542864969042878, -0.197784210521347,
                                 0.183686441089812,  0.127518108278530,  0.000000000000000,
                                 0.000000000000000, -0.036964892924938, -0.016437721287932,
                                -0.000000000000000, -0.000000000000000, -0.377751312317553,
                                -0.195328660890019,  0.000000000000000,  0.000000000000000,
                                 0.351246016036831,  0.320003150793648,  0.000000000000000,
                                 0.000000000000000, -0.019841576803152, -0.007748769391493,
                                 0.000000000000000,  0.000000000000000, -0.437262236489609,
                                -0.363352796217381,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.151971504697098,
                                 0.056199326769736,  0.000000000000000,  0.000000000000000,
                                -0.122615218643481, -0.020017135081562,  0.000000000000000,
                                 0.000000000000000, -0.016038964298587,  0.011097625467988,
                                 0.000000000000000,  0.000000000000000,  0.206391875093336,
                                 0.097446180709313,  0.000000000000000,  0.000000000000000,
                                -0.115368860572765, -0.029719293802623,  0.000000000000000,
                                 0.000000000000000,  0.013410989281147,  0.022427836110674,
                                 0.113324251646096,  0.075168650084216,  0.000000000000000,
                                 0.000000000000000, -0.097628079721076, -0.041002605964569,
                                 0.000000000000000,  0.000000000000000, -0.016273004439947,
                                 0.005559689882212, -0.000000000000000,  0.000000000000000,
                                 0.199631571660790,  0.179020065090643,  0.000000000000000,
                                 0.000000000000000, -0.074384881972503, -0.054597828999214,
                                 0.000000000000000,  0.000000000000000,  0.037313615383029,
                                 0.041202565879439,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 36, 12));

    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.074231573710770,
                                 0.043950043363523,  0.000000000000000,  0.000000000000000,
                                -0.114363405207927, -0.019393046361059, -0.000000000000000,
                                 0.000000000000000,  0.068517274264409,  0.023809348127846,
                                 0.000000000000000,  0.000000000000000,  0.134692518842072,
                                 0.079339425415175,  0.000000000000000,  0.000000000000000,
                                -0.109971162228305, -0.028923066474334, -0.000000000000000,
                                 0.000000000000000,  0.089395314399473,  0.041103925587950,
                                 0.051216012266497,  0.049711821837380,  0.000000000000000,
                                 0.000000000000000, -0.090713371398608, -0.039125868712914,
                                 0.000000000000000,  0.000000000000000,  0.051572334260750,
                                 0.032501972044018,  0.000000000000000,  0.000000000000000,
                                 0.154050787948967,  0.145755831564587,  0.000000000000000,
                                 0.000000000000000, -0.071964762700222, -0.053135065994037,
                                 0.000000000000000,  0.000000000000000,  0.084703667117786,
                                 0.075512733086854,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.256548087438488,
                                 0.105839487984948,  0.000000000000000,  0.000000000000000,
                                -0.126467234674186, -0.007255664830745,  0.000000000000000,
                                 0.000000000000000, -0.140518651572511, -0.064288297462721,
                                 0.000000000000000,  0.000000000000000,  0.374227135359406,
                                 0.184903449058335, -0.000000000000000,  0.000000000000000,
                                -0.086756715614416, -0.005898698158313,  0.000000000000000,
                                 0.000000000000000, -0.216552554447807, -0.113725353801707,
                                 0.187947022375730,  0.136701451412026,  0.000000000000000,
                                 0.000000000000000, -0.104930667229805, -0.030060182675893,
                                 0.000000000000000,  0.000000000000000, -0.101617403497579,
                                -0.079355777994553,  0.000000000000000,  0.000000000000000,
                                 0.374991950567171,  0.339689326405218,  0.000000000000000,
                                 0.000000000000000, -0.030253987516313, -0.010836600475922,
                                 0.000000000000000,  0.000000000000000, -0.226870018647538,
                                -0.208926815723751,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.501035660986086,
                                 0.102508327823959,  0.000000000000000,  0.000000000000000,
                                -0.037877163697733, -0.028362565109721,  0.000000000000000,
                                 0.000000000000000, -0.030883050408938, -0.046284327502977,
                                 0.000000000000000,  0.000000000000000,  0.524351874676853,
                                 0.159083073440461,  0.000000000000000,  0.000000000000000,
                                -0.053716075769836, -0.057677959128629, -0.000000000000000,
                                -0.000000000000000, -0.105192955306592, -0.088643474535587,
                                 0.391813975808068,  0.187552889432301,  0.000000000000000,
                                 0.000000000000000, -0.029677403077524, -0.020380079171045,
                                 0.000000000000000,  0.000000000000000, -0.015828036154404,
                                -0.039773747383029,  0.000000000000000,  0.000000000000000,
                                 0.376210889296797,  0.292254267482124,  0.000000000000000,
                                 0.000000000000000, -0.095612848249251, -0.105961176952683,
                                 0.000000000000000,  0.000000000000000, -0.159017151822187,
                                -0.162848461229686, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.677873018283197,
                                 0.190288461176716, -0.000000000000000, -0.000000000000000,
                                -0.200560276837674, -0.075350410049190,  0.000000000000000,
                                 0.000000000000000, -0.036565890617141,  0.019139329295780,
                                 0.000000000000000,  0.000000000000000,  0.811688246796993,
                                 0.315282340650884, -0.000000000000000,  0.000000000000000,
                                -0.249317350408258, -0.136287817481393,  0.000000000000000,
                                 0.000000000000000,  0.028501263496619,  0.037033282183532,
                                 0.517842598084953,  0.293081393412209,  0.000000000000000,
                                 0.000000000000000, -0.153976505252283, -0.091079315225276,
                                -0.000000000000000,  0.000000000000000, -0.037511387856772,
                                 0.011579424540030,  0.000000000000000,  0.000000000000000,
                                 0.685365344787688,  0.579210644628759,  0.000000000000000,
                                 0.000000000000000, -0.264384873643372, -0.250376708240234,
                                 0.000000000000000, -0.000000000000000,  0.065252392200681,
                                 0.068034483637618,  0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.257706843539990,
                                 0.000830771524229,  0.000000000000000,  0.000000000000000,
                                 0.116573933702743,  0.076069127007028,  0.000000000000000,
                                 0.000000000000000, -0.378894924232090, -0.065240161010712,
                                -0.000000000000000,  0.000000000000000, -0.151927948984388,
                                 0.019551471222998,  0.000000000000000,  0.000000000000000,
                                 0.223230108347764,  0.138744838079342,  0.000000000000000,
                                 0.000000000000000, -0.360932732710717, -0.098882971805393,
                                -0.216404233469373, -0.051514643500361, -0.000000000000000,
                                -0.000000000000000,  0.079174122176804,  0.082637305003023,
                                 0.000000000000000,  0.000000000000000, -0.301299267415648,
                                -0.128473472669380, -0.000000000000000,  0.000000000000000,
                                -0.009020759259261,  0.035918346162791,  0.000000000000000,
                                 0.000000000000000,  0.265740864158405,  0.254890543304595,
                                 0.000000000000000,  0.000000000000000, -0.241148094066501,
                                -0.181659618879921,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.036565890617141,
                                 0.019139329295780,  0.000000000000000,  0.000000000000000,
                                -0.009251788245766,  0.022722503151283,  0.000000000000000,
                                 0.000000000000000,  0.179156587979936,  0.057642738206366,
                                 0.000000000000000,  0.000000000000000,  0.028501263496619,
                                 0.037033282183532,  0.000000000000000,  0.000000000000000,
                                 0.060095016007890,  0.040335961275994,  0.000000000000000,
                                 0.000000000000000,  0.232594273317764,  0.096836748504462,
                                -0.037511387856773,  0.011579424540030,  0.000000000000000,
                                 0.000000000000000, -0.016967093381082,  0.022755596498668,
                                 0.000000000000000,  0.000000000000000,  0.134467319170516,
                                 0.084306354305065,  0.000000000000000,  0.000000000000000,
                                 0.065252392200681,  0.068034483637618,  0.000000000000000,
                                 0.000000000000000,  0.079764632853654,  0.074101892558135,
                                 0.000000000000000,  0.000000000000000,  0.206692360491195,
                                 0.177900466639615,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.320504709498104,
                                -0.009525362494366,  0.000000000000000,  0.000000000000000,
                                -0.056929345662038,  0.051155220675420,  0.000000000000000,
                                 0.000000000000000,  0.059426208817849,  0.005457452807233,
                                 0.000000000000000,  0.000000000000000, -0.214144443619973,
                                 0.004748831230388,  0.000000000000000,  0.000000000000000,
                                 0.062511203847913,  0.104202428726846,  0.000000000000000,
                                 0.000000000000000,  0.042023937976893,  0.007337512238197,
                                -0.265839199920375, -0.073632042904265, -0.000000000000000,
                                 0.000000000000000, -0.058999615752466,  0.025715397968860,
                                 0.000000000000000,  0.000000000000000,  0.049338088675590,
                                 0.014691147093265,  0.000000000000000,  0.000000000000000,
                                -0.047832281099514,  0.008724160041784,  0.000000000000000,
                                 0.000000000000000,  0.171624043324610,  0.191432085254628,
                                 0.000000000000000,  0.000000000000000,  0.020872873214460,
                                 0.013479870723757,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.182949905795930,
                                 0.009436479103641,  0.000000000000000,  0.000000000000000,
                                -0.168758724350762, -0.013310988064675,  0.000000000000000,
                                 0.000000000000000,  0.248083160351765,  0.099253855585368,
                                 0.000000000000000,  0.000000000000000, -0.094492863738593,
                                 0.031918568054864,  0.000000000000000,  0.000000000000000,
                                -0.139995589261052, -0.011292449392568,  0.000000000000000,
                                 0.000000000000000,  0.349230998062619,  0.174187652339409,
                                -0.154958756743419, -0.031308890352311,  0.000000000000000,
                                 0.000000000000000, -0.136006214552986, -0.048929016829887,
                                 0.000000000000000,  0.000000000000000,  0.183686441089812,
                                 0.127518108278530,  0.000000000000000,  0.000000000000000,
                                 0.023322931800308,  0.058638153791037,  0.000000000000000,
                                 0.000000000000000, -0.054864722201933, -0.020745554218496,
                                 0.000000000000000,  0.000000000000000,  0.351246016036831,
                                 0.320003150793648,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.128047521260561,
                                -0.034628342700932,  0.000000000000000,  0.000000000000000,
                                -0.002992803672636, -0.002328372664072,  0.000000000000000,
                                 0.000000000000000,  0.151971504697098,  0.056199326769736,
                                 0.000000000000000,  0.000000000000000, -0.149009570768206,
                                -0.057365227266315,  0.000000000000000,  0.000000000000000,
                                -0.008837469093014, -0.003788606262885,  0.000000000000000,
                                 0.000000000000000,  0.206391875093336,  0.097446180709313,
                                -0.098446836245769, -0.053752510081953, -0.000000000000000,
                                 0.000000000000000, -0.001506342959535, -0.003246802101829,
                                 0.000000000000000,  0.000000000000000,  0.113324251646096,
                                 0.075168650084216,  0.000000000000000,  0.000000000000000,
                                -0.124754012862838, -0.105386651835948,  0.000000000000000,
                                 0.000000000000000, -0.008395455666008, -0.006960114135285,
                                 0.000000000000000,  0.000000000000000,  0.199631571660790,
                                 0.179020065090643,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 36, 12));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000, -0.114363405207927,
                                -0.019393046361059,  0.000000000000000,  0.000000000000000,
                                 0.028192773903447,  0.000858278581178,  0.000000000000000,
                                 0.000000000000000,  0.043372579254813,  0.005382315009484,
                                 0.000000000000000,  0.000000000000000, -0.109971162228305,
                                -0.028923066474334,  0.000000000000000,  0.000000000000000,
                                 0.014271952105304,  0.000599247095061,  0.000000000000000,
                                 0.000000000000000,  0.035250796237630,  0.007684899008694,
                                -0.090713371398608, -0.039125868712914,  0.000000000000000,
                                 0.000000000000000,  0.024231458772890,  0.004856740247334,
                                 0.000000000000000,  0.000000000000000,  0.035343071389969,
                                 0.012430508161157,  0.000000000000000,  0.000000000000000,
                                -0.071964762700222, -0.053135065994037,  0.000000000000000,
                                 0.000000000000000,  0.003712278768290,  0.001100887209559,
                                 0.000000000000000,  0.000000000000000,  0.020238170465612,
                                 0.014118060972090,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.126467234674186,
                                -0.007255664830745,  0.000000000000000,  0.000000000000000,
                                 0.005487806476743,  0.004874114852194,  0.000000000000000,
                                 0.000000000000000,  0.248499930781107,  0.015738566484269,
                                 0.000000000000000,  0.000000000000000, -0.086756715614416,
                                -0.005898698158313,  0.000000000000000,  0.000000000000000,
                                 0.018183976055877,  0.007953779347575,  0.000000000000000,
                                 0.000000000000000,  0.180362765718772,  0.012987376130665,
                                -0.104930667229805, -0.030060182675893,  0.000000000000000,
                                 0.000000000000000,  0.002474043598821,  0.006691712551198,
                                 0.000000000000000,  0.000000000000000,  0.204543129818398,
                                 0.062665952683293, -0.000000000000000,  0.000000000000000,
                                -0.030253987516313, -0.010836600475922, -0.000000000000000,
                                 0.000000000000000,  0.017556966557781,  0.014612025696185,
                                 0.000000000000000,  0.000000000000000,  0.065364632164785,
                                 0.023859333463298,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.037877163697733,
                                -0.028362565109721,  0.000000000000000,  0.000000000000000,
                                 0.370683725672331,  0.075375078281552,  0.000000000000000,
                                 0.000000000000000,  0.030680478460045, -0.049167980749842,
                                 0.000000000000000,  0.000000000000000, -0.053716075769836,
                                -0.057677959128629,  0.000000000000000,  0.000000000000000,
                                 0.427148581335331,  0.108277192361447,  0.000000000000000,
                                 0.000000000000000, -0.066679567649492, -0.100121161795945,
                                -0.029677403077524, -0.020380079171045,  0.000000000000000,
                                 0.000000000000000,  0.282562102121688,  0.152659445283908,
                                -0.000000000000000,  0.000000000000000,  0.035111372590446,
                                -0.026835718150639,  0.000000000000000,  0.000000000000000,
                                -0.095612848249251, -0.105961176952683,  0.000000000000000,
                                 0.000000000000000,  0.281670601337345,  0.198917904050045,
                                 0.000000000000000,  0.000000000000000, -0.165115250028287,
                                -0.183934319141027,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.200560276837674,
                                -0.075350410049190,  0.000000000000000,  0.000000000000000,
                                 0.554487648511991,  0.027734052848397,  0.000000000000000,
                                 0.000000000000000, -0.009251788245766,  0.022722503151283,
                                 0.000000000000000,  0.000000000000000, -0.249317350408258,
                                -0.136287817481393,  0.000000000000000,  0.000000000000000,
                                 0.431860572927492,  0.005313912676834,  0.000000000000000,
                                 0.000000000000000,  0.060095016007890,  0.040335961275994,
                                -0.153976505252283, -0.091079315225276, -0.000000000000000,
                                -0.000000000000000,  0.450010111947473,  0.149844351806521,
                                 0.000000000000000,  0.000000000000000, -0.016967093381082,
                                 0.022755596498668,  0.000000000000000,  0.000000000000000,
                                -0.264384873643372, -0.250376708240234, -0.000000000000000,
                                 0.000000000000000,  0.126014484656567,  0.009762280946962,
                                 0.000000000000000,  0.000000000000000,  0.079764632853654,
                                 0.074101892558135,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.116573933702743,
                                 0.076069127007028,  0.000000000000001,  0.000000000000001,
                                -0.065987776768498, -0.107910135310845,  0.000000000000000,
                                 0.000000000000000,  0.077715955801829,  0.050712751338019,
                                 0.000000000000000,  0.000000000000000,  0.223230108347764,
                                 0.138744838079342,  0.000000000000001,  0.000000000000001,
                                -0.274740028682968, -0.200068719031375,  0.000000000000000,
                                 0.000000000000000,  0.148820072231843,  0.092496558719561,
                                 0.079174122176804,  0.082637305003023,  0.000000000000000,
                                 0.000000000000000, -0.025737247236372, -0.103260064175053,
                                 0.000000000000000,  0.000000000000000,  0.052782748117870,
                                 0.055091536668682,  0.000000000000000,  0.000000000000000,
                                 0.265740864158405,  0.254890543304595,  0.000000000000000,
                                 0.000000000000000, -0.374522288294937, -0.367549706339342,
                                 0.000000000000000,  0.000000000000001,  0.177160576105603,
                                 0.169927028869730,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.009251788245766,
                                 0.022722503151283,  0.000000000000000,  0.000000000000000,
                                 0.369658432341328,  0.018489368565598,  0.000000000000000,
                                -0.000000000000000, -0.192850453299536, -0.094285829341926,
                                 0.000000000000000,  0.000000000000000,  0.060095016007890,
                                 0.040335961275994,  0.000000000000000,  0.000000000000000,
                                 0.287907048618328,  0.003542608451222,  0.000000000000000,
                                 0.000000000000000, -0.299396530414833, -0.169901118544722,
                                -0.016967093381082,  0.022755596498668,  0.000000000000000,
                                 0.000000000000000,  0.300006741298315,  0.099896234537681,
                                 0.000000000000000,  0.000000000000000, -0.139837260768047,
                                -0.110042312307499, -0.000000000000000, -0.000000000000000,
                                 0.079764632853654,  0.074101892558135,  0.000000000000000,
                                 0.000000000000000,  0.084009656437711,  0.006508187297975,
                                 0.000000000000000,  0.000000000000000, -0.330855401021416,
                                -0.312128285372013, -0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.056929345662038,
                                 0.051155220675420,  0.000000000000000,  0.000000000000000,
                                -0.154451552363471, -0.031406282617314,  0.000000000000000,
                                 0.000000000000000,  0.096283713112455, -0.038519569173786,
                                 0.000000000000000,  0.000000000000000,  0.062511203847913,
                                 0.104202428726846,  0.000000000000000, -0.000000000000000,
                                -0.177978575556388, -0.045115496817270,  0.000000000000000,
                                 0.000000000000000, -0.032411105228434, -0.078537767886565,
                                -0.058999615752466,  0.025715397968860,  0.000000000000000,
                                 0.000000000000000, -0.117734209217370, -0.063608102201628,
                                 0.000000000000000,  0.000000000000000,  0.092418061972799,
                                -0.014653998241954,  0.000000000000000,  0.000000000000000,
                                 0.171624043324610,  0.191432085254628,  0.000000000000000,
                                 0.000000000000000, -0.117362750557227, -0.082882460020852,
                                 0.000000000000000,  0.000000000000000, -0.128880013986014,
                                -0.144283092644420,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.168758724350762,
                                -0.013310988064675,  0.000000000000000,  0.000000000000000,
                                -0.028048788658907, -0.024912142577880, -0.000000000000000,
                                -0.000000000000000, -0.047390538297426, -0.004848316231315,
                                 0.000000000000000,  0.000000000000000, -0.139995589261052,
                                -0.011292449392568,  0.000000000000000,  0.000000000000000,
                                -0.092940322063372, -0.040652649998718,  0.000000000000000,
                                 0.000000000000000, -0.046725932293844, -0.004217895809701,
                                -0.136006214552986, -0.048929016829887,  0.000000000000000,
                                 0.000000000000000, -0.012645111727306, -0.034202086372789,
                                 0.000000000000000,  0.000000000000000, -0.036964892924938,
                                -0.016437721287932, -0.000000000000000, -0.000000000000000,
                                -0.054864722201933, -0.020745554218496,  0.000000000000000,
                                 0.000000000000000, -0.089735606850882, -0.074683686891610,
                                 0.000000000000000,  0.000000000000000, -0.019841576803152,
                                -0.007748769391493,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.002992803672636,
                                -0.002328372664072,  0.000000000000000,  0.000000000000000,
                                 0.027957834120918,  0.000851126259669,  0.000000000000000,
                                 0.000000000000000, -0.122615218643481, -0.020017135081562,
                                 0.000000000000000,  0.000000000000000, -0.008837469093014,
                                -0.003788606262885, -0.000000000000000,  0.000000000000000,
                                 0.014153019171093,  0.000594253369269,  0.000000000000000,
                                 0.000000000000000, -0.115368860572765, -0.029719293802623,
                                -0.001506342959535, -0.003246802101829,  0.000000000000000,
                                 0.000000000000000,  0.024029529949783,  0.004816267411939,
                                 0.000000000000000,  0.000000000000000, -0.097628079721075,
                                -0.041002605964569,  0.000000000000000,  0.000000000000000,
                                -0.008395455666008, -0.006960114135285,  0.000000000000000,
                                 0.000000000000000,  0.003681343111888,  0.001091713149479,
                                 0.000000000000000,  0.000000000000000, -0.074384881972503,
                                -0.054597828999213,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 36, 12));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeDDForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 2);
    
    CGtoBlock kgtos(mlih, mbas, 2);
    
    CDenseMatrix lmomxmat(20, 20);
    
    CDenseMatrix lmomymat(20, 20);
    
    CDenseMatrix lmomzmat(20, 20);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.074861802723330,
                                 0.203013578485047, -0.000000000000000, -0.000000000000000,
                                 0.053431010137091,  0.162566942306357, -0.000000000000000,
                                -0.000000000000000, -0.249572190097327, -0.243811211838770,
                                -0.000000000000000, -0.000000000000000, -0.478459284142602,
                                -0.251477834036522, -0.000000000000000, -0.000000000000000,
                                -0.039577929431811, -0.015825664917622,  0.000000000000000,
                                 0.000000000000000,  0.152537567893312,  0.290273216817137,
                                 0.000000000000000, -0.000000000000000,  0.114056075350927,
                                 0.237366476764885,  0.000000000000000, -0.000000000000000,
                                -0.265908588535036, -0.311903516144659,  0.000000000000000,
                                -0.000000000000000, -0.374819818543856, -0.281046928752045,
                                 0.000000000000000, -0.000000000000000, -0.026564796138843,
                                -0.016911071521566, -0.074861802723330, -0.152537567893312,
                                 0.000000000000000,  0.000000000000000, -0.053431010137091,
                                -0.114056075350927, -0.000000000000000, -0.000000000000000,
                                 0.249572190097327,  0.265908588535036, -0.000000000000000,
                                -0.000000000000000,  0.478459284142602,  0.374819818543856,
                                -0.000000000000000, -0.000000000000000,  0.039577929431811,
                                 0.026564796138843,  0.000000000000001, -0.000000000000000,
                                -0.203013578485047, -0.290273216817137, -0.000000000000000,
                                 0.000000000000000, -0.162566942306357, -0.237366476764885,
                                 0.000000000000000, -0.000000000000000,  0.243811211838770,
                                 0.311903516144659,  0.000000000000000, -0.000000000000000,
                                 0.251477834036522,  0.281046928752045,  0.000000000000000,
                                -0.000000000000000,  0.015825664917622,  0.016911071521566,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000,  0.053431010137091,  0.162566942306357,
                                 0.000000000000000, -0.000000000000000, -0.034952102486263,
                                -0.025107293264223, -0.000000000000000, -0.000000000000000,
                                 0.224109575987041,  0.055240665936192, -0.000000000000000,
                                -0.000000000000000, -0.194758410054005, -0.052510127874473,
                                -0.000000000000000, -0.000000000000000, -0.040859912849713,
                                -0.010071541057413,  0.000000000000000,  0.000000000000000,
                                 0.114056075350927,  0.237366476764885,  0.000000000000000,
                                 0.000000000000000, -0.050770052072981, -0.016479817256060,
                                 0.000000000000000, -0.000000000000000,  0.119755322957207,
                                 0.051989677562029,  0.000000000000000, -0.000000000000000,
                                -0.134157720326956, -0.031972457194826,  0.000000000000000,
                                -0.000000000000000, -0.021833926719863, -0.009478817158585,
                                -0.053431010137091, -0.114056075350927,  0.000000000000000,
                                -0.000000000000000,  0.034952102486263,  0.050770052072981,
                                 0.000000000000000, -0.000000000000000, -0.224109575987041,
                                -0.119755322957207, -0.000000000000000, -0.000000000000000,
                                 0.194758410054005,  0.134157720326956,  0.000000000000000,
                                -0.000000000000000,  0.040859912849713,  0.021833926719863,
                                -0.000000000000000, -0.000000000000000, -0.162566942306357,
                                -0.237366476764885,  0.000000000000000,  0.000000000000000,
                                 0.025107293264223,  0.016479817256060,  0.000000000000000,
                                 0.000000000000000, -0.055240665936192, -0.051989677562029,
                                 0.000000000000000, -0.000000000000000,  0.052510127874473,
                                 0.031972457194826,  0.000000000000000, -0.000000000000000,
                                 0.010071541057413,  0.009478817158585,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.249572190097327, -0.243811211838770,  0.000000000000000,
                                -0.000000000000000,  0.224109575987041,  0.055240665936192,
                                 0.000000000000000, -0.000000000000000,  0.080455539635377,
                                 0.091040483826580, -0.000000000000000, -0.000000000000000,
                                -0.063880208254916,  0.024462101450502, -0.000000000000000,
                                -0.000000000000000, -0.378357467982546, -0.245163746644840,
                                 0.000000000000000,  0.000000000000000, -0.265908588535036,
                                -0.311903516144659,  0.000000000000000,  0.000000000000000,
                                 0.119755322957207,  0.051989677562029,  0.000000000000000,
                                 0.000000000000000,  0.077562589769321,  0.130390252446991,
                                 0.000000000000000, -0.000000000000000, -0.025852629512398,
                                 0.056432996130470,  0.000000000000000, -0.000000000000000,
                                -0.317643620458004, -0.295787453150617,  0.249572190097327,
                                 0.265908588535036,  0.000000000000000, -0.000000000000000,
                                -0.224109575987041, -0.119755322957207,  0.000000000000000,
                                -0.000000000000000, -0.080455539635377, -0.077562589769321,
                                 0.000000000000000, -0.000000000000000,  0.063880208254916,
                                 0.025852629512398, -0.000000000000000, -0.000000000000000,
                                 0.378357467982546,  0.317643620458004,  0.000000000000000,
                                -0.000000000000000,  0.243811211838770,  0.311903516144659,
                                 0.000000000000000,  0.000000000000000, -0.055240665936192,
                                -0.051989677562029,  0.000000000000000,  0.000000000000000,
                                -0.091040483826580, -0.130390252446991,  0.000000000000000,
                                 0.000000000000000, -0.024462101450502, -0.056432996130470,
                                 0.000000000000000, -0.000000000000000,  0.245163746644840,
                                 0.295787453150617,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.478459284142602,
                                -0.251477834036522,  0.000000000000000, -0.000000000000000,
                                -0.194758410054005, -0.052510127874473,  0.000000000000000,
                                -0.000000000000000, -0.063880208254916,  0.024462101450502,
                                 0.000000000000000, -0.000000000000000, -0.541335760187597,
                                -0.120859389592292, -0.000000000000000, -0.000000000000000,
                                 0.154725254357197,  0.243177674617116,  0.000000000000000,
                                 0.000000000000000, -0.374819818543856, -0.281046928752045,
                                 0.000000000000000,  0.000000000000000, -0.134157720326956,
                                -0.031972457194826,  0.000000000000000,  0.000000000000000,
                                -0.025852629512398,  0.056432996130470,  0.000000000000000,
                                 0.000000000000000, -0.330184925685897, -0.071681161121102,
                                 0.000000000000000, -0.000000000000000,  0.217829575616528,
                                 0.331720202564300,  0.478459284142602,  0.374819818543856,
                                 0.000000000000000, -0.000000000000000,  0.194758410054005,
                                 0.134157720326956, -0.000000000000000, -0.000000000000000,
                                 0.063880208254916,  0.025852629512398,  0.000000000000000,
                                -0.000000000000000,  0.541335760187597,  0.330184925685897,
                                 0.000000000000000,  0.000000000000000, -0.154725254357197,
                                -0.217829575616528, -0.000000000000000, -0.000000000000000,
                                 0.251477834036522,  0.281046928752045,  0.000000000000000,
                                 0.000000000000000,  0.052510127874473,  0.031972457194826,
                                 0.000000000000000,  0.000000000000000, -0.024462101450502,
                                -0.056432996130470,  0.000000000000000,  0.000000000000000,
                                 0.120859389592292,  0.071681161121102, -0.000000000000000,
                                 0.000000000000000, -0.243177674617116, -0.331720202564300,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.039577929431811, -0.015825664917622,
                                 0.000000000000000, -0.000000000000000, -0.040859912849713,
                                -0.010071541057413,  0.000000000000000, -0.000000000000000,
                                -0.378357467982546, -0.245163746644840,  0.000000000000000,
                                -0.000000000000000,  0.154725254357197,  0.243177674617116,
                                 0.000000000000000, -0.000000000000000,  0.298084215640795,
                                 0.320085677030566,  0.000000000000000,  0.000000000000000,
                                -0.026564796138843, -0.016911071521566,  0.000000000000000,
                                 0.000000000000000, -0.021833926719863, -0.009478817158585,
                                 0.000000000000000,  0.000000000000000, -0.317643620458004,
                                -0.295787453150617,  0.000000000000000,  0.000000000000000,
                                 0.217829575616528,  0.331720202564300,  0.000000000000000,
                                 0.000000000000000,  0.327181469830697,  0.421071319042824,
                                 0.039577929431811,  0.026564796138843, -0.000000000000001,
                                -0.000000000000000,  0.040859912849713,  0.021833926719863,
                                 0.000000000000000, -0.000000000000000,  0.378357467982546,
                                 0.317643620458004, -0.000000000000000, -0.000000000000000,
                                -0.154725254357197, -0.217829575616528,  0.000000000000000,
                                -0.000000000000000, -0.298084215640795, -0.327181469830697,
                                 0.000000000000000,  0.000000000000000,  0.015825664917622,
                                 0.016911071521566,  0.000000000000000,  0.000000000000000,
                                 0.010071541057413,  0.009478817158585,  0.000000000000000,
                                 0.000000000000000,  0.245163746644840,  0.295787453150617,
                                 0.000000000000000,  0.000000000000000, -0.243177674617116,
                                -0.331720202564300,  0.000000000000000,  0.000000000000000,
                                -0.320085677030566, -0.421071319042824, -0.000000000000000,
                                 0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 20, 20));

    std::vector<double> intyvals{ 0.000000000000000, -0.000000000000000,  0.277091232782614,
                                 0.385608943402838, -0.000000000000000, -0.000000000000000,
                                -0.396739458443176, -0.231334751921696, -0.000000000000000,
                                -0.000000000000000, -0.003322992435914, -0.098984701159955,
                                -0.000000000000000, -0.000000000000000,  0.053431010137091,
                                 0.162566942306357, -0.000000000000000, -0.000000000000000,
                                 0.104058313477422,  0.056674340168207,  0.000000000000000,
                                 0.000000000000000,  0.352974261323495,  0.525171351348670,
                                 0.000000000000000, -0.000000000000000, -0.331151965104130,
                                -0.262089294434875,  0.000000000000000, -0.000000000000000,
                                -0.069294524586449, -0.140357388413739,  0.000000000000000,
                                -0.000000000000000,  0.114056075350927,  0.237366476764885,
                                 0.000000000000000, -0.000000000000000,  0.083285982696233,
                                 0.063646906122923, -0.277091232782614, -0.352974261323495,
                                 0.000000000000000, -0.000000000000000,  0.396739458443176,
                                 0.331151965104130, -0.000000000000000, -0.000000000000000,
                                 0.003322992435914,  0.069294524586449, -0.000000000000000,
                                -0.000000000000000, -0.053431010137091, -0.114056075350927,
                                -0.000000000000000, -0.000000000000000, -0.104058313477422,
                                -0.083285982696233, -0.000000000000000, -0.000000000000000,
                                -0.385608943402838, -0.525171351348670,  0.000000000000000,
                                 0.000000000000000,  0.231334751921696,  0.262089294434875,
                                 0.000000000000000, -0.000000000000000,  0.098984701159955,
                                 0.140357388413739,  0.000000000000000, -0.000000000000000,
                                -0.162566942306356, -0.237366476764885,  0.000000000000000,
                                -0.000000000000000, -0.056674340168207, -0.063646906122923,
                                -0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.396739458443176, -0.231334751921696,
                                 0.000000000000000, -0.000000000000000, -0.669673383956783,
                                -0.166439896410301, -0.000000000000000, -0.000000000000000,
                                 0.122877771734284,  0.070495989730662, -0.000000000000000,
                                -0.000000000000000, -0.034952102486263, -0.025107293264223,
                                -0.000000000000000, -0.000000000000000,  0.209940888386877,
                                -0.042005763801192,  0.000000000000000,  0.000000000000000,
                                -0.331151965104130, -0.262089294434875,  0.000000000000000,
                                 0.000000000000000, -0.437274746311360, -0.100269010370918,
                                 0.000000000000000, -0.000000000000000,  0.073943472951941,
                                 0.099757727432160,  0.000000000000000, -0.000000000000000,
                                -0.050770052072981, -0.016479817256060,  0.000000000000000,
                                -0.000000000000000,  0.076325334236799, -0.105413442903083,
                                 0.396739458443176,  0.331151965104130,  0.000000000000000,
                                -0.000000000000000,  0.669673383956783,  0.437274746311360,
                                 0.000000000000000, -0.000000000000000, -0.122877771734284,
                                -0.073943472951941, -0.000000000000000, -0.000000000000000,
                                 0.034952102486263,  0.050770052072981, -0.000000000000000,
                                -0.000000000000000, -0.209940888386877, -0.076325334236799,
                                -0.000000000000000, -0.000000000000000,  0.231334751921696,
                                 0.262089294434875,  0.000000000000000,  0.000000000000000,
                                 0.166439896410301,  0.100269010370918,  0.000000000000000,
                                 0.000000000000000, -0.070495989730662, -0.099757727432160,
                                 0.000000000000000, -0.000000000000000,  0.025107293264223,
                                 0.016479817256060, -0.000000000000000, -0.000000000000000,
                                 0.042005763801192,  0.105413442903083,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.003322992435914, -0.098984701159955,  0.000000000000000,
                                -0.000000000000000,  0.122877771734284,  0.070495989730662,
                                 0.000000000000000, -0.000000000000000,  0.120683309453066,
                                 0.136560725739869, -0.000000000000000, -0.000000000000000,
                                 0.224109575987041,  0.055240665936192, -0.000000000000000,
                                -0.000000000000000,  0.322948500530364,  0.272411459868422,
                                 0.000000000000000,  0.000000000000000, -0.069294524586449,
                                -0.140357388413739,  0.000000000000000,  0.000000000000000,
                                 0.073943472951941,  0.099757727432160,  0.000000000000000,
                                 0.000000000000000,  0.116343884653982,  0.195585378670487,
                                 0.000000000000000, -0.000000000000000,  0.119755322957207,
                                 0.051989677562029,  0.000000000000000, -0.000000000000000,
                                 0.314498629031644,  0.342313746201875,  0.003322992435914,
                                 0.069294524586449,  0.000000000000000, -0.000000000000000,
                                -0.122877771734284, -0.073943472951941,  0.000000000000000,
                                -0.000000000000000, -0.120683309453066, -0.116343884653982,
                                 0.000000000000000, -0.000000000000000, -0.224109575987041,
                                -0.119755322957207, -0.000000000000000, -0.000000000000000,
                                -0.322948500530364, -0.314498629031644, -0.000000000000000,
                                -0.000000000000000,  0.098984701159955,  0.140357388413739,
                                 0.000000000000000,  0.000000000000000, -0.070495989730662,
                                -0.099757727432160,  0.000000000000000,  0.000000000000000,
                                -0.136560725739869, -0.195585378670487,  0.000000000000000,
                                 0.000000000000000, -0.055240665936192, -0.051989677562029,
                                 0.000000000000000, -0.000000000000000, -0.272411459868422,
                                -0.342313746201875,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.053431010137091,
                                 0.162566942306356,  0.000000000000000, -0.000000000000000,
                                -0.034952102486263, -0.025107293264223,  0.000000000000000,
                                -0.000000000000000,  0.224109575987041,  0.055240665936192,
                                 0.000000000000000, -0.000000000000000, -0.194758410054005,
                                -0.052510127874473, -0.000000000000000, -0.000000000000000,
                                -0.040859912849713, -0.010071541057413,  0.000000000000000,
                                 0.000000000000000,  0.114056075350927,  0.237366476764885,
                                 0.000000000000000,  0.000000000000000, -0.050770052072981,
                                -0.016479817256060,  0.000000000000000,  0.000000000000000,
                                 0.119755322957207,  0.051989677562029,  0.000000000000000,
                                 0.000000000000000, -0.134157720326956, -0.031972457194826,
                                 0.000000000000000, -0.000000000000000, -0.021833926719863,
                                -0.009478817158585, -0.053431010137091, -0.114056075350927,
                                 0.000000000000000, -0.000000000000000,  0.034952102486263,
                                 0.050770052072981,  0.000000000000000,  0.000000000000000,
                                -0.224109575987041, -0.119755322957207,  0.000000000000000,
                                -0.000000000000000,  0.194758410054005,  0.134157720326956,
                                 0.000000000000000, -0.000000000000000,  0.040859912849713,
                                 0.021833926719863, -0.000000000000000, -0.000000000000000,
                                -0.162566942306357, -0.237366476764885,  0.000000000000000,
                                 0.000000000000000,  0.025107293264223,  0.016479817256060,
                                 0.000000000000000,  0.000000000000000, -0.055240665936192,
                                -0.051989677562029,  0.000000000000000,  0.000000000000000,
                                 0.052510127874473,  0.031972457194826,  0.000000000000000,
                                 0.000000000000000,  0.010071541057413,  0.009478817158585,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000,  0.104058313477422,  0.056674340168207,
                                 0.000000000000000, -0.000000000000000,  0.209940888386877,
                                -0.042005763801192,  0.000000000000000, -0.000000000000000,
                                 0.322948500530364,  0.272411459868422,  0.000000000000000,
                                -0.000000000000000, -0.040859912849713, -0.010071541057413,
                                 0.000000000000000, -0.000000000000000,  0.282327794763574,
                                 0.399039939870581,  0.000000000000000,  0.000000000000000,
                                 0.083285982696233,  0.063646906122923,  0.000000000000000,
                                 0.000000000000000,  0.076325334236799, -0.105413442903083,
                                 0.000000000000000,  0.000000000000000,  0.314498629031644,
                                 0.342313746201875,  0.000000000000000,  0.000000000000000,
                                -0.021833926719863, -0.009478817158585,  0.000000000000000,
                                 0.000000000000000,  0.366604295262519,  0.541845452441272,
                                -0.104058313477422, -0.083285982696233,  0.000000000000000,
                                 0.000000000000000, -0.209940888386877, -0.076325334236799,
                                 0.000000000000000, -0.000000000000000, -0.322948500530364,
                                -0.314498629031644,  0.000000000000000, -0.000000000000000,
                                 0.040859912849713,  0.021833926719863,  0.000000000000000,
                                -0.000000000000000, -0.282327794763574, -0.366604295262519,
                                 0.000000000000000, -0.000000000000000, -0.056674340168207,
                                -0.063646906122923,  0.000000000000000,  0.000000000000000,
                                 0.042005763801192,  0.105413442903083,  0.000000000000000,
                                 0.000000000000000, -0.272411459868422, -0.342313746201875,
                                 0.000000000000000,  0.000000000000000,  0.010071541057413,
                                 0.009478817158585,  0.000000000000000,  0.000000000000000,
                                -0.399039939870581, -0.541845452441272,  0.000000000000000,
                                 0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 20, 20));
    
    std::vector<double> intzvals{ 0.000000000000000, -0.000000000000000,  0.053431010137091,
                                 0.162566942306357, -0.000000000000000, -0.000000000000000,
                                -0.034952102486263, -0.025107293264223, -0.000000000000000,
                                -0.000000000000000,  0.224109575987041,  0.055240665936192,
                                -0.000000000000000, -0.000000000000000, -0.194758410054006,
                                -0.052510127874473, -0.000000000000000, -0.000000000000000,
                                -0.040859912849713, -0.010071541057413,  0.000000000000000,
                                 0.000000000000000,  0.114056075350927,  0.237366476764885,
                                 0.000000000000000, -0.000000000000000, -0.050770052072981,
                                -0.016479817256060,  0.000000000000000, -0.000000000000000,
                                 0.119755322957207,  0.051989677562029,  0.000000000000000,
                                -0.000000000000000, -0.134157720326957, -0.031972457194826,
                                 0.000000000000000, -0.000000000000000, -0.021833926719863,
                                -0.009478817158585, -0.053431010137091, -0.114056075350927,
                                 0.000000000000000, -0.000000000000000,  0.034952102486263,
                                 0.050770052072981,  0.000000000000000,  0.000000000000000,
                                -0.224109575987041, -0.119755322957207, -0.000000000000000,
                                -0.000000000000000,  0.194758410054005,  0.134157720326956,
                                 0.000000000000000, -0.000000000000000,  0.040859912849713,
                                 0.021833926719863, -0.000000000000000, -0.000000000000000,
                                -0.162566942306357, -0.237366476764885,  0.000000000000000,
                                 0.000000000000000,  0.025107293264223,  0.016479817256060,
                                 0.000000000000000, -0.000000000000000, -0.055240665936192,
                                -0.051989677562029,  0.000000000000000, -0.000000000000000,
                                 0.052510127874473,  0.031972457194826,  0.000000000000000,
                                -0.000000000000000,  0.010071541057413,  0.009478817158585,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.034952102486263, -0.025107293264223,
                                 0.000000000000000, -0.000000000000000,  0.056320665514845,
                                 0.326675342050909, -0.000000000000000, -0.000000000000000,
                                -0.363491067029423, -0.279692556407260, -0.000000000000000,
                                -0.000000000000000, -0.049430199220616, -0.145726652933686,
                                -0.000000000000000, -0.000000000000000,  0.237457486951389,
                                 0.056964884267914,  0.000000000000000,  0.000000000000000,
                                -0.050770052072981, -0.016479817256060,  0.000000000000000,
                                 0.000000000000000,  0.165804593154984,  0.515565372028078,
                                 0.000000000000000, -0.000000000000000, -0.378893698196050,
                                -0.315453449271652,  0.000000000000000, -0.000000000000000,
                                -0.145563587985291, -0.181519348586903,  0.000000000000000,
                                -0.000000000000000,  0.151558512992202,  0.034148276588046,
                                 0.034952102486263,  0.050770052072981, -0.000000000000000,
                                -0.000000000000000, -0.056320665514845, -0.165804593154984,
                                 0.000000000000000, -0.000000000000000,  0.363491067029423,
                                 0.378893698196050,  0.000000000000000, -0.000000000000000,
                                 0.049430199220616,  0.145563587985291, -0.000000000000000,
                                -0.000000000000000, -0.237457486951389, -0.151558512992202,
                                 0.000000000000000, -0.000000000000000,  0.025107293264223,
                                 0.016479817256060, -0.000000000000000,  0.000000000000000,
                                -0.326675342050909, -0.515565372028078,  0.000000000000000,
                                 0.000000000000000,  0.279692556407260,  0.315453449271652,
                                 0.000000000000000, -0.000000000000000,  0.145726652933686,
                                 0.181519348586903,  0.000000000000000, -0.000000000000000,
                                -0.056964884267914, -0.034148276588046,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                 0.224109575987041,  0.055240665936192,  0.000000000000000,
                                -0.000000000000000, -0.363491067029423, -0.279692556407260,
                                 0.000000000000000, -0.000000000000000, -0.517593694690268,
                                 0.207527682273544, -0.000000000000000, -0.000000000000000,
                                -0.242327378019615, -0.186461704271507, -0.000000000000000,
                                -0.000000000000000, -0.093378989994600, -0.023016944140080,
                                 0.000000000000000,  0.000000000000000,  0.119755322957207,
                                 0.051989677562029,  0.000000000000000,  0.000000000000000,
                                -0.378893698196050, -0.315453449271652,  0.000000000000000,
                                 0.000000000000000, -0.152822085568758,  0.433997809929773,
                                 0.000000000000000, -0.000000000000000, -0.252595798797367,
                                -0.210302299514435,  0.000000000000000, -0.000000000000000,
                                -0.049898051232169, -0.021662365650845, -0.224109575987041,
                                -0.119755322957207,  0.000000000000000, -0.000000000000000,
                                 0.363491067029423,  0.378893698196050, -0.000000000000000,
                                -0.000000000000000,  0.517593694690268,  0.152822085568758,
                                 0.000000000000000, -0.000000000000000,  0.242327378019615,
                                 0.252595798797366, -0.000000000000000, -0.000000000000000,
                                 0.093378989994600,  0.049898051232169, -0.000000000000000,
                                -0.000000000000000, -0.055240665936192, -0.051989677562029,
                                 0.000000000000000,  0.000000000000000,  0.279692556407260,
                                 0.315453449271652,  0.000000000000000,  0.000000000000000,
                                -0.207527682273544, -0.433997809929773,  0.000000000000000,
                                 0.000000000000000,  0.186461704271507,  0.210302299514435,
                                -0.000000000000000, -0.000000000000000,  0.023016944140080,
                                 0.021662365650845,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.194758410054005,
                                -0.052510127874473,  0.000000000000000, -0.000000000000000,
                                -0.049430199220616, -0.145726652933686,  0.000000000000000,
                                -0.000000000000000, -0.242327378019615, -0.186461704271507,
                                 0.000000000000000, -0.000000000000000,  0.097512498198692,
                                 0.448114219495647, -0.000000000000000, -0.000000000000000,
                                -0.253191828850667, -0.047876048164034,  0.000000000000000,
                                 0.000000000000000, -0.134157720326956, -0.031972457194826,
                                 0.000000000000000,  0.000000000000000, -0.145563587985291,
                                -0.181519348586903,  0.000000000000000,  0.000000000000000,
                                -0.252595798797366, -0.210302299514435,  0.000000000000000,
                                 0.000000000000000,  0.287107583142727,  0.666831495850496,
                                 0.000000000000000, -0.000000000000000, -0.139707436806458,
                                -0.027600671932521,  0.194758410054006,  0.134157720326957,
                                -0.000000000000000, -0.000000000000000,  0.049430199220616,
                                 0.145563587985291,  0.000000000000000, -0.000000000000000,
                                 0.242327378019615,  0.252595798797367,  0.000000000000000,
                                 0.000000000000000, -0.097512498198692, -0.287107583142727,
                                 0.000000000000000, -0.000000000000000,  0.253191828850667,
                                 0.139707436806458, -0.000000000000000, -0.000000000000000,
                                 0.052510127874473,  0.031972457194826,  0.000000000000000,
                                 0.000000000000000,  0.145726652933686,  0.181519348586903,
                                 0.000000000000000,  0.000000000000000,  0.186461704271507,
                                 0.210302299514435,  0.000000000000000,  0.000000000000000,
                                -0.448114219495647, -0.666831495850496,  0.000000000000000,
                                 0.000000000000000,  0.047876048164034,  0.027600671932521,
                                -0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.040859912849713, -0.010071541057413,
                                 0.000000000000000, -0.000000000000000,  0.237457486951389,
                                 0.056964884267914,  0.000000000000000, -0.000000000000000,
                                -0.093378989994600, -0.023016944140080,  0.000000000000000,
                                -0.000000000000000, -0.253191828850667, -0.047876048164034,
                                 0.000000000000000, -0.000000000000000, -0.027607817014840,
                                 0.142591719209154,  0.000000000000000,  0.000000000000000,
                                -0.021833926719863, -0.009478817158585,  0.000000000000000,
                                 0.000000000000000,  0.151558512992202,  0.034148276588046,
                                 0.000000000000000,  0.000000000000000, -0.049898051232169,
                                -0.021662365650845,  0.000000000000000,  0.000000000000000,
                                -0.139707436806458, -0.027600671932521,  0.000000000000000,
                                 0.000000000000000,  0.070752120689865,  0.218566822733692,
                                 0.040859912849713,  0.021833926719863,  0.000000000000000,
                                -0.000000000000000, -0.237457486951389, -0.151558512992202,
                                -0.000000000000000, -0.000000000000000,  0.093378989994600,
                                 0.049898051232169,  0.000000000000000, -0.000000000000000,
                                 0.253191828850667,  0.139707436806458,  0.000000000000000,
                                 0.000000000000000,  0.027607817014840, -0.070752120689865,
                                 0.000000000000000, -0.000000000000000,  0.010071541057413,
                                 0.009478817158585,  0.000000000000000,  0.000000000000000,
                                -0.056964884267914, -0.034148276588046,  0.000000000000000,
                                 0.000000000000000,  0.023016944140080,  0.021662365650845,
                                 0.000000000000000,  0.000000000000000,  0.047876048164034,
                                 0.027600671932521,  0.000000000000000,  0.000000000000000,
                                -0.142591719209154, -0.218566822733692,  0.000000000000000,
                                 0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 20, 20));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeDFForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 2);
    
    CGtoBlock kgtos(mlih, mbas, 3);
    
    CDenseMatrix lmomxmat(20, 28);
    
    CDenseMatrix lmomymat(20, 28);
    
    CDenseMatrix lmomzmat(20, 28);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
   std::vector<double> intxvals{ 1.755567379083479,  1.479790672477243,  0.063542882946199,
                                 0.199416193147069, -0.000000000000000, -0.000000000000000,
                                -0.103832274128128, -0.278215765842039, -0.453285548155688,
                                -0.382080308691829, -0.015163758711278, -0.131292862910605,
                                -0.000000000000000, -0.000000000000000,  0.256781131224075,
                                 0.307134061197158, -0.000000000000000, -0.000000000000000,
                                 0.593624055846069,  0.353511838825413, -0.000000000000000,
                                -0.000000000000000,  0.063525123103292,  0.022015630904824,
                                -0.000000000000000, -0.000000000000000,  0.128201515973828,
                                 0.161211989919873,  1.163331357712261,  1.341640786499874,
                                 0.090084248928708,  0.288200242120518, -0.000000000000000,
                                -0.000000000000000, -0.174300438229372, -0.342709300481145,
                                -0.300370864969363, -0.346410161513776, -0.059440930056026,
                                -0.180356033852490, -0.000000000000000, -0.000000000000000,
                                 0.242174169600228,  0.353936968686070, -0.000000000000000,
                                -0.000000000000000,  0.374304066721771,  0.363101473229889,
                                -0.000000000000000, -0.000000000000000,  0.030167346556080,
                                 0.019965953301140, -0.000000000000000, -0.000000000000000,
                                 0.123378602378956,  0.188030515471267,  0.071981435482284,
                                 0.124633076433098,  1.917278333839847,  0.989069880866919,
                                -0.121393207849338, -0.242226072001024, -0.000000000000000,
                                -0.000000000000000, -0.020069098988699, -0.081906119545029,
                                -0.495039137133735, -0.255376745122196,  0.285029527745668,
                                 0.338742542944761, -0.000000000000000, -0.000000000000000,
                                 0.643603185680582,  0.527063308298692, -0.000000000000000,
                                -0.000000000000000,  0.067982639301078,  0.042698962176575,
                                -0.000000000000000, -0.000000000000000,  0.142436056716701,
                                 0.172471627286027,  0.000000000000000, -0.000000000000000,
                                 0.133397980185775,  0.235314512313946,  0.578368695600841,
                                 1.095445115010333, -0.183718704309178, -0.279820972094988,
                                -0.000000000000000, -0.000000000000000, -0.087521532455210,
                                -0.147260084990244, -0.149334155068651, -0.282842712474619,
                                 0.201567921764024,  0.288988324796100, -0.000000000000000,
                                -0.000000000000000,  0.229711097767726,  0.296471111422025,
                                -0.000000000000000, -0.000000000000000,  0.014161898038969,
                                 0.016302132605343, -0.000000000000000, -0.000000000000000,
                                 0.105911351957450,  0.153526272992367, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.109464394971919, -0.145686346437607,  1.433414762609910,
                                 1.208244024566410, -0.041141903450635, -0.057299117580974,
                                -0.000000000000000, -0.000000000000000, -0.036722104926828,
                                -0.039271641727915, -0.000000000000000, -0.000000000000000,
                                -0.179810342667837,  0.008240988342853, -0.000000000000000,
                                -0.000000000000000,  0.069272222859349, -0.050756498784875,
                                -0.000000000000000, -0.000000000000000,  0.042917330494807,
                                 0.003857484158424, -0.000000000000000, -0.000000000000000,
                                 0.196384681748780,  0.225329595074576, -0.000000000000000,
                                -0.000000000000000, -0.109809482954316, -0.170588030702560,
                                 0.949856076058071,  1.095445115010333, -0.061750689652548,
                                -0.038987291156521, -0.000000000000000, -0.000000000000000,
                                -0.018553436594442, -0.055379479377086, -0.000000000000000,
                                -0.000000000000000, -0.048397175987938,  0.033345830932072,
                                -0.000000000000000, -0.000000000000000,  0.004407664851340,
                                -0.081835952461784, -0.000000000000000, -0.000000000000000,
                                 0.011927344121941,  0.001556889622401, -0.000000000000000,
                                -0.000000000000000,  0.176657874427034,  0.261281478509113,
                                -0.121999696298422, -0.153432867594363, -0.000000000000000,
                                -0.000000000000000, -0.048007722494551, -0.086271396609858,
                                 1.565451204267042,  0.807572176026433, -0.038822145470608,
                                -0.025765916761329, -0.000000000000000, -0.000000000000000,
                                -0.189360061821680, -0.069806090284278,  0.000000000000000,
                                -0.000000000000000,  0.072246769442621,  0.007624212610289,
                                -0.000000000000000, -0.000000000000000,  0.045108790748425,
                                 0.017084876227266,  0.000000000000000, -0.000000000000000,
                                 0.217122058509563,  0.247134588615732, -0.000000000000000,
                                -0.000000000000000, -0.095747435996725, -0.139284543815834,
                                -0.000000000000000, -0.000000000000000, -0.036576367409186,
                                -0.031832989928933,  0.472236062473715,  0.894427190999916,
                                -0.026242799908041, -0.045217155564948, -0.000000000000000,
                                -0.000000000000000,  0.006663941708404,  0.027226756944231,
                                -0.000000000000000, -0.000000000000000, -0.034485426472250,
                                -0.066818775382011, -0.000000000000000, -0.000000000000000,
                                 0.002366497183228,  0.001271195053572, -0.000000000000000,
                                -0.000000000000000,  0.147949987356045,  0.213335433862432,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000,  0.365235977427790,  0.253727701768321,
                                -0.000000000000000, -0.000000000000000,  0.165425291709386,
                                 0.100287222042539, -0.000000000000000, -0.000000000000000,
                                -0.167617041155273, -0.100468527128465, -0.000000000000000,
                                -0.000000000000000, -0.065042043726562, -0.124651209063279,
                                 1.570227199484721,  1.323565014451698, -0.166078861204110,
                                -0.092412730418607, -0.000000000000000, -0.000000000000000,
                                 0.319923470548050,  0.125482875609761,  0.000000000000000,
                                -0.000000000000000, -0.054212195476873, -0.071189194066790,
                                -0.000000000000000, -0.000000000000000,  0.247532701036258,
                                 0.270913627443393, -0.000000000000000, -0.000000000000000,
                                 0.111522484410803,  0.098520894775467, -0.000000000000000,
                                -0.000000000000000, -0.093927765058811, -0.112835844775241,
                                -0.000000000000000, -0.000000000000000, -0.082013245011295,
                                -0.152376198631880,  1.040515198480697,  1.200000000000000,
                                -0.123257119562439, -0.061488132919169, -0.000000000000000,
                                -0.000000000000000,  0.163138116172787,  0.116374824160315,
                                 0.000000000000000,  0.000000000000000, -0.056170650918800,
                                -0.081463004232579,  0.397337599660744,  0.348009917799148,
                                -0.000000000000000, -0.000000000000000,  0.180230660367593,
                                 0.157058208218953, -0.000000000000000, -0.000000000000000,
                                -0.180215978548340, -0.132159729168670, -0.000000000000000,
                                -0.000000000000000, -0.073738221622595, -0.114193126191751,
                                -0.000000000000000, -0.000000000000000, -0.182141599626284,
                                -0.173448564440580,  1.714865874501374,  0.884650995246420,
                                 0.343459704364558,  0.230637202459019, -0.000000000000000,
                                -0.000000000000000, -0.060670406700353, -0.078536146991899,
                                -0.000000000000000, -0.000000000000000,  0.165398845791025,
                                 0.221200050534258, -0.000000000000000, -0.000000000000000,
                                 0.064959320384160,  0.080441973734109, -0.000000000000000,
                                -0.000000000000000, -0.065734893230743, -0.092130081465076,
                                -0.000000000000000, -0.000000000000000, -0.082244165726081,
                                -0.124414645197694, -0.000000000000000, -0.000000000000000,
                                -0.058731531361478, -0.050204850296131,  0.517308687768545,
                                 0.979795897113272,  0.080871170385157,  0.095019646032963,
                                -0.000000000000000, -0.000000000000000, -0.046697759845011,
                                -0.066514264428002, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.092648590115079,
                                -0.189378220353065, -0.000000000000000, -0.000000000000000,
                                 0.475206844175345,  0.093439406535888, -0.000000000000000,
                                -0.000000000000000,  0.069272222859350, -0.050756498784875,
                                -1.110318300759208, -0.935901797060066, -0.057337480534789,
                                -0.122240758560907, -0.000000000000000, -0.000000000000000,
                                 0.271190184651596, -0.092818636175618,  1.433414762609910,
                                 1.208244024566409, -0.136143162002825, -0.086974241657377,
                                -0.000000000000000, -0.000000000000000, -0.397902770425847,
                                -0.278361695206665, -0.000000000000000, -0.000000000000000,
                                -0.127394803789631, -0.228677213298426, -0.000000000000000,
                                -0.000000000000000,  0.204207200084934,  0.046161777304195,
                                -0.000000000000000, -0.000000000000000,  0.004407664851340,
                                -0.081835952461784, -0.735755352773367, -0.848528137423857,
                                -0.057579212291640, -0.177022614690734, -0.000000000000000,
                                -0.000000000000000,  0.043202337428549, -0.162356420546134,
                                 0.949856076058071,  1.095445115010333, -0.118211397128614,
                                -0.054484829939506, -0.000000000000000, -0.000000000000000,
                                -0.271888428467726, -0.296676315782020, -0.106106873406017,
                                -0.177407475363060, -0.000000000000000, -0.000000000000000,
                                 0.507478602223157,  0.290357753410554, -0.000000000000000,
                                -0.000000000000000,  0.072246769442621,  0.007624212610289,
                                -0.000000000000000, -0.000000000000000, -0.063146538811567,
                                -0.079862027699571, -1.212593288685320, -0.625542717722172,
                                 0.283672192377009,  0.064606385489677, -0.000000000000000,
                                -0.000000000000000, -0.151196042291313, -0.166250090918817,
                                 1.565451204267042,  0.807572176026433, -0.433112647873597,
                                -0.382237511290784, -0.000000000000000, -0.000000000000000,
                                -0.124823704699515, -0.186714162794245, -0.000000000000000,
                                -0.000000000000000,  0.058149192102400,  0.037690933338423,
                                -0.000000000000000, -0.000000000000000, -0.034485426472250,
                                -0.066818775382011, -0.000000000000000, -0.000000000000000,
                                -0.081769240577955, -0.144538359641871, -0.365792481087853,
                                -0.692820323027551, -0.063766827995368, -0.132563462267582,
                                -0.000000000000000, -0.000000000000000, -0.055125604212105,
                                -0.044486677358036,  0.472236062473715,  0.894427190999916,
                                -0.181434087885571, -0.242235197478254, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.207435717387622, -0.199217759674167, -0.000000000000000,
                                -0.000000000000000,  0.063525123103292,  0.022015630904824,
                                -0.000000000000000, -0.000000000000000,  0.060236678443460,
                                 0.017667572916489, -0.000000000000000, -0.000000000000000,
                                 0.463961296076680,  0.324309177761081, -0.453285548155688,
                                -0.382080308691829, -0.117939087049501, -0.236187287421620,
                                -0.000000000000000, -0.000000000000000, -0.457095695177847,
                                -0.440709218807033,  1.755567379083480,  1.479790672477243,
                                -0.036460497750393,  0.157199936415362, -0.000000000000000,
                                -0.000000000000000, -0.169098724287871, -0.224356487388304,
                                -0.000000000000000, -0.000000000000000,  0.030167346556080,
                                 0.019965953301140, -0.000000000000000, -0.000000000000000,
                                 0.026143645054560,  0.015457266406297, -0.000000000000000,
                                -0.000000000000000,  0.314364539141293,  0.347568324394683,
                                -0.300370864969363, -0.346410161513775, -0.152656209725820,
                                -0.294550874989833, -0.000000000000000, -0.000000000000000,
                                -0.372805795507478, -0.497135280974775,  1.163331357712262,
                                 1.341640786499874,  0.036793552568960,  0.248582273574233,
                                -0.228015084012204, -0.236989825994069, -0.000000000000000,
                                -0.000000000000000,  0.067982639301078,  0.042698962176575,
                                -0.000000000000000, -0.000000000000000,  0.064224620842703,
                                 0.037062887475823, -0.000000000000000, -0.000000000000000,
                                 0.504683722270002,  0.441931787040236, -0.000000000000000,
                                -0.000000000000000, -0.134098002999789, -0.212564901394176,
                                -0.495039137133735, -0.255376745122195, -0.502427199714534,
                                -0.522453385918795, -0.000000000000000, -0.000000000000000,
                                -0.035601755493048,  0.049344445735035,  1.917278333839848,
                                 0.989069880866919, -0.130469141307989, -0.183186304861505,
                                -0.000000000000000, -0.000000000000000,  0.014161898038969,
                                 0.016302132605343, -0.000000000000000, -0.000000000000000,
                                 0.011331481017280,  0.012620805171230, -0.000000000000000,
                                -0.000000000000000,  0.211471675037118,  0.283788348507037,
                                -0.000000000000000, -0.000000000000000, -0.156038935416957,
                                -0.240499782338469, -0.149334155068651, -0.282842712474619,
                                -0.288662991756759, -0.405909257174448, -0.000000000000000,
                                -0.000000000000000,  0.106162885475574,  0.202966576452602,
                                 0.578368695600840,  1.095445115010333};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 20, 28));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.213648243712300,
                                -0.200530221782848, -0.000000000000000, -0.000000000000000,
                                -0.417517140480083, -0.529926900975836, -0.000000000000000,
                                -0.000000000000000,  0.473150698959149,  0.318176692992435,
                                -0.000000000000000, -0.000000000000000, -0.054023252461359,
                                 0.112792089288124, -0.453285548155688, -0.382080308691829,
                                -0.015163758711278, -0.131292862910605, -0.000000000000000,
                                -0.000000000000000, -0.164299638555555, -0.078641445420436,
                                -1.755567379083479, -1.479790672477243,  0.091574673310346,
                                -0.046011454015295, -0.000000000000000, -0.000000000000000,
                                -0.171403932259042, -0.225398615610440, -0.000000000000000,
                                -0.000000000000000, -0.402554304834818, -0.620040348286155,
                                -0.000000000000000, -0.000000000000000,  0.322016776612652,
                                 0.332186940417297, -0.000000000000000, -0.000000000000000,
                                 0.043822451983890,  0.150103867377404, -0.300370864969363,
                                -0.346410161513776, -0.059440930056026, -0.180356033852490,
                                -0.000000000000000, -0.000000000000000, -0.094676763927549,
                                -0.075144330966357, -1.163331357712261, -1.341640786499874,
                                 0.037446881411133, -0.113811055020760, -0.234600967845136,
                                -0.240268105206569, -0.000000000000000, -0.000000000000000,
                                -0.463855615950065, -0.562654677724601, -0.000000000000000,
                                -0.000000000000000,  0.515153943995177,  0.452937533347046,
                                -0.000000000000000, -0.000000000000000, -0.052029574148700,
                                 0.059594958057742, -0.000000000000000, -0.000000000000000,
                                -0.020069098988699, -0.081906119545029, -0.495039137133735,
                                -0.255376745122196, -0.177443796856308, -0.133606163377177,
                                -0.000000000000000, -0.000000000000000,  0.098559527261060,
                                 0.054032985860467, -1.917278333839847, -0.989069880866919,
                                -0.131304636418216, -0.184037198991768, -0.000000000000000,
                                -0.000000000000000, -0.348240078434565, -0.506260824412883,
                                -0.000000000000000, -0.000000000000000,  0.207048135733166,
                                 0.271229501079565, -0.000000000000000, -0.000000000000000,
                                 0.075076260257219,  0.122559294497679, -0.000000000000000,
                                -0.000000000000000, -0.087521532455210, -0.147260084990244,
                                -0.149334155068651, -0.282842712474619, -0.050813658062588,
                                -0.061355089310132, -0.000000000000000, -0.000000000000000,
                                -0.032852687038567, -0.092926337296227, -0.578368695600841,
                                -1.095445115010333, -0.000000000000000, -0.000000000000000,
                                 0.201575700014953,  0.240462277362011, -0.000000000000000,
                                -0.000000000000000,  0.389372183185731,  0.085724438219041,
                                -0.000000000000000, -0.000000000000000,  0.282429896727803,
                                -0.147378918070425, -1.110318300759208, -0.935901797060066,
                                -0.207179432757986, -0.115373268275196, -0.000000000000000,
                                -0.000000000000000, -0.036722104926828, -0.039271641727915,
                                -1.433414762609910, -1.208244024566409, -0.224098099397623,
                                 0.012322639676157, -0.000000000000000, -0.000000000000000,
                                -0.158835791284624,  0.017265403827606, -0.000000000000000,
                                -0.000000000000000,  0.189355001231877,  0.277355173587503,
                                -0.000000000000000, -0.000000000000000,  0.180352511841053,
                                 0.043047998059393, -0.000000000000000, -0.000000000000000,
                                 0.032565686399821, -0.244767897423045, -0.735755352773367,
                                -0.848528137423857, -0.097910192281588, -0.149234422247341,
                                -0.000000000000000, -0.000000000000000, -0.018553436594442,
                                -0.055379479377086, -0.949856076058071, -1.095445115010333,
                                -0.042021816173881,  0.017314090204678, -0.000000000000000,
                                -0.000000000000000, -0.044797025125975,  0.047877852082296,
                                 0.223669854408121,  0.264860591751274, -0.000000000000000,
                                -0.000000000000000,  0.417261020726307,  0.256188000956022,
                                -0.000000000000000, -0.000000000000000,  0.295028300916982,
                                 0.050636490482234, -0.000000000000000, -0.000000000000000,
                                -0.220946590329633, -0.138033769603136, -1.212593288685320,
                                -0.625542717722172, -0.038822145470608, -0.025765916761329,
                                -0.000000000000000, -0.000000000000000, -0.234112133937630,
                                -0.061477306733923, -1.565451204267042, -0.807572176026433,
                                -0.167764810581598, -0.064745083582310, -0.000000000000000,
                                -0.000000000000000,  0.157823380184412,  0.226459550936812,
                                -0.000000000000000, -0.000000000000000,  0.053416197735944,
                                 0.035148543231278, -0.000000000000000, -0.000000000000000,
                                -0.100529015382864, -0.199852151366785, -0.000000000000000,
                                -0.000000000000000, -0.076215955820952, -0.121849395521678,
                                -0.365792481087853, -0.692820323027551, -0.026242799908041,
                                -0.045217155564948, -0.000000000000000, -0.000000000000000,
                                 0.008640025112795,  0.014136895453994, -0.472236062473715,
                                -0.894427190999916,  0.012769079851657,  0.039092102527358,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.192181023315690, -0.119818201389053,
                                -0.000000000000000, -0.000000000000000, -0.050977966610506,
                                 0.021762203734974,  1.570227199484721,  1.323565014451698,
                                -0.305759728833504, -0.176136503025661, -0.000000000000000,
                                -0.000000000000000, -0.097563065589843, -0.186976813594918,
                                -0.000000000000000, -0.000000000000000, -0.167617041155273,
                                -0.100468527128465, -0.000000000000000, -0.000000000000000,
                                -0.237992964196930, -0.120580396974563, -0.000000000000000,
                                -0.000000000000000, -0.226107747674361, -0.204690047325704,
                                -0.000000000000000, -0.000000000000000, -0.122314899049497,
                                -0.125708012402890, -0.000000000000000, -0.000000000000000,
                                 0.006048481992650,  0.026685036791335,  1.040515198480697,
                                 1.200000000000000, -0.201530257111448, -0.155518003565203,
                                -0.000000000000000, -0.000000000000000, -0.123019867516942,
                                -0.228564297947820, -0.000000000000000, -0.000000000000000,
                                -0.093927765058811, -0.112835844775241, -0.000000000000000,
                                -0.000000000000000, -0.142257412837352, -0.116068896652007,
                                -0.000000000000000, -0.000000000000000, -0.180832618887656,
                                -0.226296812481734, -0.208380989570214, -0.172141948950539,
                                 0.000000000000000, -0.000000000000000, -0.051620019334037,
                                 0.007834910366699, -0.000000000000000, -0.000000000000000,
                                -0.332321581749900, -0.283581672081139,  1.714865874501374,
                                 0.884650995246420, -0.110607332433892, -0.171289689287627,
                                -0.000000000000000, -0.000000000000000, -0.180215978548340,
                                -0.132159729168670, -0.000000000000000, -0.000000000000000,
                                -0.257528867178188, -0.200649961019624, -0.000000000000000,
                                -0.000000000000000, -0.248385751388615, -0.253617512462704,
                                 0.000000000000000, -0.000000000000000, -0.077987614072806,
                                -0.102640162322180, -0.000000000000000, -0.000000000000000,
                                 0.014410092977350,  0.021788241302055, -0.000000000000000,
                                -0.000000000000000, -0.113510609053764, -0.126979918183695,
                                 0.517308687768545,  0.979795897113272, -0.123366248589122,
                                -0.186621967796541, -0.000000000000000, -0.000000000000000,
                                -0.065734893230743, -0.092130081465076, -0.000000000000000,
                                -0.000000000000000, -0.077962574659601, -0.094769857268417,
                                -0.000000000000000, -0.000000000000000, -0.133846051611736,
                                -0.184770573666179, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.109464394971919,
                                -0.145686346437607,  1.433414762609910,  1.208244024566410,
                                -0.041141903450635, -0.057299117580974, -0.000000000000000,
                                -0.000000000000000, -0.036722104926828, -0.039271641727915,
                                -0.000000000000000, -0.000000000000000, -0.179810342667837,
                                 0.008240988342853, -0.000000000000000, -0.000000000000000,
                                 0.069272222859350, -0.050756498784875, -0.000000000000000,
                                -0.000000000000000,  0.042917330494807,  0.003857484158424,
                                -0.000000000000000, -0.000000000000000,  0.196384681748780,
                                 0.225329595074576, -0.000000000000000, -0.000000000000000,
                                -0.109809482954316, -0.170588030702560,  0.949856076058071,
                                 1.095445115010333, -0.061750689652548, -0.038987291156521,
                                -0.000000000000000, -0.000000000000000, -0.018553436594441,
                                -0.055379479377086, -0.000000000000000, -0.000000000000000,
                                -0.048397175987938,  0.033345830932072, -0.000000000000000,
                                -0.000000000000000,  0.004407664851340, -0.081835952461784,
                                -0.000000000000000, -0.000000000000000,  0.011927344121941,
                                 0.001556889622401, -0.000000000000000, -0.000000000000000,
                                 0.176657874427034,  0.261281478509113, -0.121999696298421,
                                -0.153432867594363, -0.000000000000000, -0.000000000000000,
                                -0.048007722494551, -0.086271396609858,  1.565451204267042,
                                 0.807572176026433, -0.038822145470608, -0.025765916761329,
                                -0.000000000000000, -0.000000000000000, -0.189360061821680,
                                -0.069806090284278,  0.000000000000000, -0.000000000000000,
                                 0.072246769442621,  0.007624212610289, -0.000000000000000,
                                -0.000000000000000,  0.045108790748425,  0.017084876227266,
                                -0.000000000000000, -0.000000000000000,  0.217122058509563,
                                 0.247134588615732, -0.000000000000000, -0.000000000000000,
                                -0.095747435996725, -0.139284543815834, -0.000000000000000,
                                -0.000000000000000, -0.036576367409186, -0.031832989928933,
                                 0.472236062473715,  0.894427190999916, -0.026242799908041,
                                -0.045217155564948, -0.000000000000000, -0.000000000000000,
                                 0.006663941708404,  0.027226756944231, -0.000000000000000,
                                -0.000000000000000, -0.034485426472250, -0.066818775382011,
                                -0.000000000000000, -0.000000000000000,  0.002366497183228,
                                 0.001271195053572, -0.000000000000000, -0.000000000000000,
                                 0.147949987356045,  0.213335433862432, -0.000000000000000,
                                -0.000000000000000,  1.755567379083480,  1.479790672477243,
                                -0.161040635961723,  0.010246550885437, -0.000000000000000,
                                -0.000000000000000, -0.164299638555555, -0.078641445420436,
                                 0.453285548155688,  0.382080308691829, -0.326550394119339,
                                -0.043682934169150, -0.000000000000000, -0.000000000000000,
                                -0.358125934198908, -0.348517839376650, -0.000000000000000,
                                -0.000000000000000,  0.060236678443460,  0.017667572916489,
                                -0.000000000000000, -0.000000000000000, -0.423874813478879,
                                -0.548460575997771, -0.000000000000000, -0.000000000000000,
                                -0.121988989649150, -0.159899527811193,  1.163331357712262,
                                 1.341640786499874, -0.079406422646889,  0.079315624957683,
                                -0.000000000000000, -0.000000000000000, -0.094676763927549,
                                -0.075144330966357,  0.300370864969363,  0.346410161513775,
                                -0.137477474996856,  0.004847369303505, -0.000000000000000,
                                -0.000000000000000, -0.295106317087546, -0.392571318972060,
                                -0.000000000000000, -0.000000000000000,  0.026143645054560,
                                 0.015457266406297, -0.000000000000000, -0.000000000000000,
                                -0.418105045770458, -0.639726523897725, -0.000000000000000,
                                -0.000000000000000, -0.121073394407785, -0.186988387249130,
                                -0.173770076690458, -0.113207369704813,  1.917278333839848,
                                 0.989069880866919, -0.177443796856308, -0.133606163377177,
                                -0.000000000000000, -0.000000000000000, -0.348717467698444,
                                -0.195768782624882,  0.495039137133735,  0.255376745122195,
                                -0.393951694436284, -0.413547574702205, -0.000000000000000,
                                -0.000000000000000,  0.064224620842703,  0.037062887475823,
                                -0.000000000000000, -0.000000000000000, -0.471874995395743,
                                -0.584364509155127, -0.000000000000000, -0.000000000000000,
                                -0.135850172883768, -0.169193348073526, -0.000000000000000,
                                -0.000000000000000,  0.009724434234915,  0.064760936592094,
                                 0.578368695600840,  1.095445115010333, -0.050813658062588,
                                -0.061355089310132, -0.000000000000000, -0.000000000000000,
                                -0.025944078541747,  0.003957860462806,  0.149334155068651,
                                 0.282842712474619, -0.228253981177482, -0.320533139710975,
                                -0.000000000000000, -0.000000000000000,  0.011331481017280,
                                 0.012620805171230, -0.000000000000000, -0.000000000000000,
                                -0.360332465664341, -0.522334519491272, -0.000000000000000,
                                -0.000000000000000, -0.105075856847223, -0.152675378862105,
                                -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 20, 28));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.109464394971919,
                                -0.145686346437607,  1.433414762609910,  1.208244024566410,
                                -0.041141903450635, -0.057299117580974, -0.000000000000000,
                                -0.000000000000000, -0.036722104926828, -0.039271641727915,
                                -0.000000000000000, -0.000000000000000, -0.179810342667837,
                                 0.008240988342853, -0.000000000000000, -0.000000000000000,
                                 0.069272222859350, -0.050756498784875, -0.000000000000000,
                                -0.000000000000000,  0.042917330494807,  0.003857484158424,
                                -0.000000000000000, -0.000000000000000,  0.196384681748780,
                                 0.225329595074576, -0.000000000000000, -0.000000000000000,
                                -0.109809482954316, -0.170588030702560,  0.949856076058071,
                                 1.095445115010333, -0.061750689652549, -0.038987291156521,
                                -0.000000000000000, -0.000000000000000, -0.018553436594441,
                                -0.055379479377086, -0.000000000000000, -0.000000000000000,
                                -0.048397175987938,  0.033345830932072, -0.000000000000000,
                                -0.000000000000000,  0.004407664851340, -0.081835952461784,
                                -0.000000000000000, -0.000000000000000,  0.011927344121941,
                                 0.001556889622401, -0.000000000000000, -0.000000000000000,
                                 0.176657874427034,  0.261281478509113, -0.121999696298421,
                                -0.153432867594363, -0.000000000000000, -0.000000000000000,
                                -0.048007722494551, -0.086271396609858,  1.565451204267042,
                                 0.807572176026433, -0.038822145470608, -0.025765916761329,
                                -0.000000000000000, -0.000000000000000, -0.189360061821680,
                                -0.069806090284278, -0.000000000000000, -0.000000000000000,
                                 0.072246769442621,  0.007624212610289, -0.000000000000000,
                                -0.000000000000000,  0.045108790748425,  0.017084876227266,
                                -0.000000000000000, -0.000000000000000,  0.217122058509563,
                                 0.247134588615732, -0.000000000000000, -0.000000000000000,
                                -0.095747435996725, -0.139284543815834, -0.000000000000000,
                                -0.000000000000000, -0.036576367409186, -0.031832989928933,
                                 0.472236062473715,  0.894427190999916, -0.026242799908041,
                                -0.045217155564948, -0.000000000000000, -0.000000000000000,
                                 0.006663941708404,  0.027226756944231, -0.000000000000000,
                                -0.000000000000000, -0.034485426472250, -0.066818775382011,
                                -0.000000000000000, -0.000000000000000,  0.002366497183228,
                                 0.001271195053572, -0.000000000000000, -0.000000000000000,
                                 0.147949987356045,  0.213335433862432, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.108283777725432, -0.018361570215727, -0.000000000000000,
                                -0.000000000000000, -0.027829063808520, -0.161881077867963,
                                 1.813142192622752,  1.528321234767317, -0.218204749840049,
                                -0.392687301049409, -0.000000000000000, -0.000000000000000,
                                 0.445922878879201,  0.331798559590075, -0.000000000000000,
                                -0.000000000000000,  0.243066145907314,  0.161827672360810,
                                -0.000000000000000, -0.000000000000000,  0.075184030749168,
                                 0.361624832945827, -0.000000000000000, -0.000000000000000,
                                -0.141439601333979, -0.033422044040730, -0.000000000000000,
                                -0.000000000000000, -0.042364948100791, -0.008848047237470,
                                -0.000000000000000, -0.000000000000000, -0.069147396181888,
                                -0.221345129990352,  1.201483459877454,  1.385640646055102,
                                -0.271024099638617, -0.454568486822606, -0.000000000000000,
                                -0.000000000000000,  0.324203825808039,  0.350623310816196,
                                -0.000000000000000, -0.000000000000000,  0.185472760343958,
                                 0.152206790757921, -0.000000000000000, -0.000000000000000,
                                 0.201875325538944,  0.458655251019128, -0.000000000000000,
                                -0.000000000000000, -0.068759286792417, -0.016938674088853,
                                -0.115174949094348, -0.060318155558351, -0.000000000000000,
                                -0.000000000000000, -0.033357907167270, -0.095049445795977,
                                -0.000000000000000, -0.000000000000000, -0.246949495332736,
                                -0.377315201060016,  1.980156548534942,  1.021506980488782,
                                 0.487403702716790,  0.455607672988110, -0.000000000000000,
                                -0.000000000000000,  0.267235333656412,  0.261093055188190,
                                 0.000000000000000, -0.000000000000000,  0.093804552328543,
                                 0.279527544308999, -0.000000000000000, -0.000000000000000,
                                -0.151930511680785, -0.097613441915083,  0.000000000000000,
                                -0.000000000000000, -0.011404963984315, -0.007224400317281,
                                -0.000000000000000, -0.000000000000000, -0.107946033068028,
                                -0.180727541842126, -0.000000000000000, -0.000000000000000,
                                -0.258183595992670, -0.371153615288148,  0.597336620274604,
                                 1.131370849898477,  0.216145292445974,  0.286282734474983,
                                -0.000000000000000, -0.000000000000000,  0.104523441844683,
                                 0.124276324247824, -0.000000000000000, -0.000000000000000,
                                 0.239459223303999,  0.374490444281666, -0.000000000000000,
                                -0.000000000000000, -0.020840952979339, -0.013830369478997,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.029625628235981, -0.008284653974083,
                                -0.000000000000000, -0.000000000000000,  0.097096784919807,
                                 0.121867704134709, -0.000000000000000, -0.000000000000000,
                                 0.398880540741514, -0.108775418302852,  1.923127709488490,
                                 1.621029463403051, -0.203640935223156, -0.626333520664029,
                                -0.000000000000000, -0.000000000000000,  0.265920360494343,
                                -0.072516945535235, -0.000000000000000, -0.000000000000000,
                                -0.040456993716587, -0.050778210056129, -0.000000000000000,
                                -0.000000000000000,  0.151419877650571,  0.042343786978645,
                                -0.000000000000000, -0.000000000000000, -0.012547481987668,
                                -0.007163941767154, -0.000000000000000, -0.000000000000000,
                                 0.113806277771904,  0.126068832550841, -0.000000000000000,
                                -0.000000000000000,  0.099925346192540, -0.220569651623975,
                                 1.274365652944235,  1.469693845669907, -0.417915951804459,
                                -0.730505545858919, -0.000000000000000, -0.000000000000000,
                                 0.066616897461693, -0.147046434415983, -0.000000000000000,
                                -0.000000000000000, -0.047419282404960, -0.052528680229517,
                                -0.000000000000000, -0.000000000000000,  0.064131574603635,
                                 0.036615702365454, -0.031556860786347, -0.017796258559197,
                                -0.000000000000000, -0.000000000000000,  0.110476699783347,
                                 0.159457175288857, -0.000000000000000, -0.000000000000000,
                                 0.421227060968516,  0.146013939266881, -0.000000000000000,
                                -0.000000000000000, -0.245361477065041, -0.580795602057602,
                                 2.100273184920010,  1.083471769399518,  0.280818040645677,
                                 0.097342626177921, -0.000000000000000, -0.000000000000000,
                                -0.046031958243061, -0.066440489703691, -0.000000000000000,
                                -0.000000000000000,  0.161290621796887,  0.090958654858120,
                                -0.000000000000000, -0.000000000000000, -0.005308556328416,
                                -0.005849333958847, -0.000000000000000, -0.000000000000000,
                                 0.079313334513501,  0.102934770739312, -0.000000000000000,
                                -0.000000000000000, -0.076205002601786, -0.180094366407395,
                                -0.000000000000000, -0.000000000000000, -0.412012444509274,
                                -0.596455280542550,  0.633571162270839,  1.200000000000001,
                                -0.050803335067857, -0.120062910938264, -0.000000000000000,
                                -0.000000000000000, -0.033047222713959, -0.042889487808047,
                                -0.000000000000000, -0.000000000000000,  0.027132621234124,
                                 0.029896595789660, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.211523308557089,
                                 0.039721289293402, -0.000000000000000, -0.000000000000000,
                                -0.067467007279233, -0.334208706143393, -0.000000000000000,
                                -0.000000000000000,  0.243066145907314,  0.161827672360810,
                                -0.000000000000000, -0.000000000000000,  0.297281919252800,
                                 0.221199039726717,  1.813142192622752,  1.528321234767317,
                                -0.420759871429477, -0.527543694683418, -0.000000000000000,
                                -0.000000000000000, -0.067271628210414, -0.302007948191517,
                                 0.000000000000000, -0.000000000000000, -0.038784101395847,
                                -0.012114818673495, -0.000000000000000, -0.000000000000000,
                                 0.088236558182643,  0.019481064195997, -0.000000000000000,
                                -0.000000000000000, -0.179224349092918, -0.429431199626758,
                                -0.000000000000000, -0.000000000000000,  0.185472760343958,
                                 0.152206790757921, -0.000000000000000, -0.000000000000000,
                                 0.216135883872026,  0.233748873877464,  1.201483459877454,
                                 1.385640646055102, -0.425584733258582, -0.581407479120873,
                                -0.000000000000000, -0.000000000000000, -0.184919053572687,
                                -0.370712503773572,  0.000000000000000,  0.000000000000000,
                                -0.023049987305484, -0.006326843714551,  0.225592858512531,
                                 0.125512927965355, -0.000000000000000, -0.000000000000000,
                                -0.083704315810627, -0.247922919167068, -0.000000000000000,
                                -0.000000000000000,  0.267235333656412,  0.261093055188190,
                                 0.000000000000000, -0.000000000000000,  0.324935801811193,
                                 0.303738448658740, -0.000000000000000, -0.000000000000000,
                                -0.469645606713080, -0.594892747050174,  1.980156548534942,
                                 1.021506980488782, -0.084981338258843, -0.256584196521401,
                                -0.000000000000000, -0.000000000000000, -0.042126455152866,
                                -0.032651165225165,  0.000000000000000,  0.000000000000000,
                                 0.024705426697100,  0.015906222308865, -0.000000000000000,
                                -0.000000000000000, -0.221565337065086, -0.350629106238940,
                                -0.000000000000000, -0.000000000000000,  0.104523441844683,
                                 0.124276324247824, -0.000000000000000, -0.000000000000000,
                                 0.144096861630650,  0.190855156316656, -0.000000000000000,
                                -0.000000000000000, -0.345286464196573, -0.474717218828001,
                                 0.597336620274604,  1.131370849898477, -0.199403673844696,
                                -0.302685491838279, -0.000000000000000, -0.000000000000000,
                                -0.007572694214201, -0.005165846260995,  0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.000000000000000,
                                -0.147112145065016, -0.214920248857538, -0.000000000000000,
                                -0.000000000000000,  0.042917330494807,  0.003857484158424,
                                -0.000000000000000, -0.000000000000000, -0.106578836934227,
                                 0.048311209642775, -0.000000000000000, -0.000000000000000,
                                 0.074920976111599, -0.003433745142855, -0.000000000000000,
                                -0.000000000000000,  0.153956144789212, -0.026773497223851,
                                 1.433414762609910,  1.208244024566410,  0.043977468697399,
                                -0.049648440666767, -0.000000000000000, -0.000000000000000,
                                -0.119533489570611, -0.147813549517135, -0.000000000000000,
                                -0.000000000000000, -0.158374902510754, -0.253016193442964,
                                -0.000000000000000, -0.000000000000000,  0.011927344121941,
                                 0.001556889622401, -0.000000000000000, -0.000000000000000,
                                -0.014079010774241,  0.081465972480631, -0.000000000000000,
                                -0.000000000000000,  0.020165489994974, -0.013894096221697,
                                -0.000000000000000, -0.000000000000000,  0.030877887011495,
                                -0.053488470584524,  0.949856076058071,  1.095445115010332,
                                -0.038094790477366, -0.035899460072092, -0.000000000000000,
                                -0.000000000000000, -0.113545701670876, -0.172277083932158,
                                -0.164888363907069, -0.221134033557167, -0.000000000000000,
                                -0.000000000000000,  0.045108790748425,  0.017084876227266,
                                -0.000000000000000, -0.000000000000000, -0.111390765737180,
                                -0.021506138935973, -0.000000000000000, -0.000000000000000,
                                 0.078900025759033,  0.029085870951782, -0.000000000000000,
                                -0.000000000000000,  0.161247168923809,  0.045186151125503,
                                -0.000000000000000, -0.000000000000000,  0.041458045823159,
                                -0.052386392092447,  1.565451204267042,  0.807572176026433,
                                -0.132673918646000, -0.158746213854237, -0.000000000000000,
                                -0.000000000000000, -0.141323542441964, -0.206586856865529,
                                -0.000000000000000, -0.000000000000000,  0.002366497183228,
                                 0.001271195053572, -0.000000000000000, -0.000000000000000,
                                 0.033021794455307,  0.066516687992387, -0.000000000000000,
                                -0.000000000000000, -0.002776642378502, -0.011344482060096,
                                -0.000000000000000, -0.000000000000000, -0.018762014043664,
                                -0.043673153351317, -0.000000000000000, -0.000000000000000,
                                -0.031882814662450, -0.029311786406015,  0.472236062473715,
                                 0.894427190999916, -0.097101583868614, -0.140663650002806,
                                -0.000000000000000, -0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 20, 28));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeFDForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 3);
    
    CGtoBlock kgtos(mlih, mbas, 2);
    
    CDenseMatrix lmomxmat(28, 20);
    
    CDenseMatrix lmomymat(28, 20);
    
    CDenseMatrix lmomzmat(28, 20);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

   std::vector<double> intxvals{-1.755567379083479, -1.163331357712261, -0.071981435482284,
                                -0.133397980185775,  0.000000000000000,  0.000000000000000,
                                 0.121999696298422,  0.095747435996725,  0.000000000000000,
                                 0.000000000000000, -0.397337599660744, -0.165398845791025,
                                 0.000000000000000,  0.000000000000000,  0.106106873406017,
                                 0.124823704699515,  0.000000000000000,  0.000000000000000,
                                 0.228015084012204,  0.130469141307989, -1.479790672477243,
                                -1.341640786499874, -0.124633076433098, -0.235314512313946,
                                 0.000000000000000,  0.000000000000000,  0.153432867594363,
                                 0.139284543815834,  0.000000000000000,  0.000000000000000,
                                -0.348009917799148, -0.221200050534258,  0.000000000000000,
                                 0.000000000000000,  0.177407475363060,  0.186714162794245,
                                 0.000000000000000,  0.000000000000000,  0.236989825994069,
                                 0.183186304861505, -0.063542882946199, -0.090084248928708,
                                -1.917278333839847, -0.578368695600841,  0.109464394971919,
                                 0.109809482954316,  0.000000000000000,  0.000000000000000,
                                -0.365235977427790, -0.247532701036258,  0.000000000000000,
                                 0.000000000000000,  0.092648590115079,  0.127394803789631,
                                 0.000000000000000,  0.000000000000000,  0.207435717387622,
                                 0.169098724287871,  0.000000000000000,  0.000000000000000,
                                -0.199416193147069, -0.288200242120518, -0.989069880866919,
                                -1.095445115010333,  0.145686346437607,  0.170588030702560,
                                 0.000000000000000,  0.000000000000000, -0.253727701768321,
                                -0.270913627443393,  0.000000000000000,  0.000000000000000,
                                 0.189378220353065,  0.228677213298426,  0.000000000000000,
                                 0.000000000000000,  0.199217759674167,  0.224356487388304,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.121393207849338,  0.183718704309178,
                                -1.433414762609910, -0.949856076058071,  0.048007722494551,
                                 0.036576367409186,  0.000000000000000,  0.000000000000000,
                                -0.180230660367593, -0.064959320384160,  0.000000000000000,
                                 0.000000000000000, -0.507478602223157, -0.058149192102400,
                                 0.000000000000000,  0.000000000000000, -0.067982639301078,
                                -0.014161898038969,  0.000000000000000,  0.000000000000000,
                                 0.242226072001024,  0.279820972094988, -1.208244024566410,
                                -1.095445115010333,  0.086271396609858,  0.031832989928933,
                                 0.000000000000000,  0.000000000000000, -0.157058208218953,
                                -0.080441973734109,  0.000000000000000,  0.000000000000000,
                                -0.290357753410554, -0.037690933338423,  0.000000000000000,
                                 0.000000000000000, -0.042698962176575, -0.016302132605343,
                                 0.103832274128128,  0.174300438229372,  0.000000000000000,
                                 0.000000000000000,  0.041141903450635,  0.061750689652548,
                                -1.565451204267042, -0.472236062473715, -0.165425291709386,
                                -0.111522484410803,  0.000000000000000,  0.000000000000000,
                                -0.475206844175345, -0.204207200084934,  0.000000000000000,
                                 0.000000000000000, -0.063525123103292, -0.030167346556080,
                                 0.000000000000000,  0.000000000000000,  0.278215765842039,
                                 0.342709300481145,  0.000000000000000,  0.000000000000000,
                                 0.057299117580974,  0.038987291156521, -0.807572176026433,
                                -0.894427190999916, -0.100287222042539, -0.098520894775467,
                                 0.000000000000000,  0.000000000000000, -0.093439406535888,
                                -0.046161777304195,  0.000000000000000,  0.000000000000000,
                                -0.022015630904824, -0.019965953301140,  0.000000000000000,
                                 0.000000000000000,  0.453285548155688,  0.300370864969363,
                                 0.020069098988699,  0.087521532455210,  0.000000000000000,
                                 0.000000000000000,  0.038822145470608,  0.026242799908041,
                                 0.000000000000000,  0.000000000000000,  0.180215978548340,
                                 0.065734893230743,  0.000000000000000,  0.000000000000000,
                                -0.072246769442621,  0.034485426472250,  0.000000000000000,
                                 0.000000000000000, -0.064224620842703, -0.011331481017280,
                                 0.382080308691829,  0.346410161513776,  0.081906119545029,
                                 0.147260084990244,  0.000000000000000,  0.000000000000000,
                                 0.025765916761329,  0.045217155564948,  0.000000000000000,
                                 0.000000000000000,  0.132159729168670,  0.092130081465076,
                                 0.000000000000000,  0.000000000000000, -0.007624212610289,
                                 0.066818775382011,  0.000000000000000,  0.000000000000000,
                                -0.037062887475823, -0.012620805171230,  0.015163758711278,
                                 0.059440930056026,  0.495039137133735,  0.149334155068651,
                                 0.036722104926828,  0.018553436594442,  0.000000000000000,
                                 0.000000000000000,  0.167617041155273,  0.093927765058811,
                                 0.000000000000000,  0.000000000000000, -0.069272222859350,
                                -0.004407664851340,  0.000000000000000,  0.000000000000000,
                                -0.060236678443460, -0.026143645054560,  0.000000000000000,
                                 0.000000000000000,  0.131292862910605,  0.180356033852490,
                                 0.255376745122196,  0.282842712474619,  0.039271641727915,
                                 0.055379479377086,  0.000000000000000,  0.000000000000000,
                                 0.100468527128465,  0.112835844775241,  0.000000000000000,
                                 0.000000000000000,  0.050756498784875,  0.081835952461784,
                                 0.000000000000000,  0.000000000000000, -0.017667572916489,
                                -0.015457266406297,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.285029527745668,
                                -0.201567921764024,  0.000000000000000,  0.000000000000000,
                                 0.189360061821680, -0.006663941708404,  0.000000000000000,
                                 0.000000000000000,  0.073738221622595,  0.082244165726081,
                                 1.110318300759208,  0.735755352773367,  0.063146538811567,
                                 0.081769240577955,  0.000000000000000,  0.000000000000000,
                                -0.504683722270002, -0.211471675037118,  0.000000000000000,
                                 0.000000000000000, -0.338742542944761, -0.288988324796100,
                                 0.000000000000000,  0.000000000000000,  0.069806090284278,
                                -0.027226756944231,  0.000000000000000,  0.000000000000000,
                                 0.114193126191751,  0.124414645197694,  0.935901797060066,
                                 0.848528137423857,  0.079862027699571,  0.144538359641871,
                                 0.000000000000000,  0.000000000000000, -0.441931787040236,
                                -0.283788348507037, -0.256781131224075, -0.242174169600228,
                                 0.000000000000000,  0.000000000000000,  0.179810342667837,
                                 0.048397175987938, -0.000000000000000,  0.000000000000000,
                                 0.065042043726562,  0.082013245011295,  0.000000000000000,
                                 0.000000000000000,  0.057337480534789,  0.057579212291640,
                                 1.212593288685320,  0.365792481087853, -0.463961296076680,
                                -0.314364539141293,  0.000000000000000,  0.000000000000000,
                                -0.307134061197158, -0.353936968686070,  0.000000000000000,
                                 0.000000000000000, -0.008240988342853, -0.033345830932072,
                                 0.000000000000000,  0.000000000000000,  0.124651209063279,
                                 0.152376198631880,  0.000000000000000,  0.000000000000000,
                                 0.122240758560907,  0.177022614690734,  0.625542717722172,
                                 0.692820323027551, -0.324309177761081, -0.347568324394683,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.643603185680582, -0.229711097767726,
                                 0.000000000000000,  0.000000000000000, -0.072246769442621,
                                 0.034485426472250, -1.570227199484721, -1.040515198480697,
                                 0.182141599626284,  0.058731531361478,  0.000000000000000,
                                 0.000000000000000, -0.283672192377009,  0.063766827995368,
                                 0.453285548155688,  0.300370864969363,  0.134098002999789,
                                 0.156038935416957,  0.000000000000000,  0.000000000000000,
                                -0.527063308298692, -0.296471111422025,  0.000000000000000,
                                 0.000000000000000, -0.007624212610289,  0.066818775382011,
                                -1.323565014451698, -1.200000000000000,  0.173448564440580,
                                 0.050204850296131,  0.000000000000000,  0.000000000000000,
                                -0.064606385489677,  0.132563462267582,  0.382080308691829,
                                 0.346410161513775,  0.212564901394176,  0.240499782338469,
                                -0.593624055846069, -0.374304066721771,  0.000000000000000,
                                 0.000000000000000, -0.069272222859349, -0.004407664851340,
                                 0.000000000000000,  0.000000000000000,  0.166078861204110,
                                 0.123257119562439, -1.714865874501374, -0.517308687768545,
                                -0.271190184651596, -0.043202337428549,  0.000000000000000,
                                 0.000000000000000,  0.117939087049501,  0.152656209725820,
                                 0.495039137133735,  0.149334155068651, -0.353511838825413,
                                -0.363101473229889,  0.000000000000000,  0.000000000000000,
                                 0.050756498784875,  0.081835952461784,  0.000000000000000,
                                 0.000000000000000,  0.092412730418607,  0.061488132919169,
                                -0.884650995246420, -0.979795897113272,  0.092818636175618,
                                 0.162356420546134,  0.000000000000000,  0.000000000000000,
                                 0.236187287421620,  0.294550874989833,  0.255376745122195,
                                 0.282842712474619,  0.000000000000000,  0.000000000000000,
                                -0.067982639301078, -0.014161898038969,  0.000000000000000,
                                 0.000000000000000, -0.045108790748425, -0.002366497183228,
                                 0.000000000000000,  0.000000000000000, -0.343459704364558,
                                -0.080871170385157, -1.433414762609910, -0.949856076058071,
                                 0.151196042291313,  0.055125604212105,  0.000000000000000,
                                 0.000000000000000,  0.502427199714534,  0.288662991756759,
                                 0.000000000000000,  0.000000000000000, -0.042698962176575,
                                -0.016302132605343,  0.000000000000000,  0.000000000000000,
                                -0.017084876227266, -0.001271195053572,  0.000000000000000,
                                 0.000000000000000, -0.230637202459019, -0.095019646032963,
                                -1.208244024566409, -1.095445115010333,  0.166250090918817,
                                 0.044486677358036,  0.000000000000000,  0.000000000000000,
                                 0.522453385918795,  0.405909257174448, -0.063525123103292,
                                -0.030167346556080,  0.000000000000000,  0.000000000000000,
                                -0.042917330494807, -0.011927344121941, -0.000000000000000,
                                 0.000000000000000, -0.319923470548050, -0.163138116172787,
                                 0.000000000000000,  0.000000000000000,  0.136143162002825,
                                 0.118211397128614, -1.565451204267042, -0.472236062473715,
                                 0.457095695177847,  0.372805795507478,  0.000000000000000,
                                 0.000000000000000, -0.022015630904824, -0.019965953301140,
                                 0.000000000000000,  0.000000000000000, -0.003857484158424,
                                -0.001556889622401,  0.000000000000000,  0.000000000000000,
                                -0.125482875609761, -0.116374824160315,  0.000000000000000,
                                 0.000000000000000,  0.086974241657377,  0.054484829939506,
                                -0.807572176026433, -0.894427190999916,  0.440709218807033,
                                 0.497135280974775,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.142436056716701,
                                -0.105911351957450,  0.000000000000000,  0.000000000000000,
                                -0.217122058509563, -0.147949987356045, -0.000000000000000,
                                -0.000000000000000,  0.060670406700353,  0.046697759845011,
                                 0.000000000000000,  0.000000000000000,  0.433112647873597,
                                 0.181434087885571, -1.755567379083480, -1.163331357712262,
                                 0.035601755493048, -0.106162885475574,  0.000000000000000,
                                 0.000000000000000, -0.172471627286027, -0.153526272992367,
                                 0.000000000000000,  0.000000000000000, -0.247134588615732,
                                -0.213335433862432,  0.000000000000000, -0.000000000000000,
                                 0.078536146991899,  0.066514264428002,  0.000000000000000,
                                 0.000000000000000,  0.382237511290784,  0.242235197478254,
                                -1.479790672477243, -1.341640786499874, -0.049344445735035,
                                -0.202966576452602, -0.128201515973828, -0.123378602378956,
                                -0.000000000000000,  0.000000000000000, -0.196384681748780,
                                -0.176657874427034,  0.000000000000000,  0.000000000000000,
                                 0.054212195476873,  0.056170650918800,  0.000000000000000,
                                 0.000000000000000,  0.397902770425847,  0.271888428467726,
                                 0.000000000000000,  0.000000000000000,  0.036460497750393,
                                -0.036793552568960, -1.917278333839848, -0.578368695600840,
                                -0.161211989919873, -0.188030515471267,  0.000000000000000,
                                 0.000000000000000, -0.225329595074576, -0.261281478509113,
                                 0.000000000000000,  0.000000000000000,  0.071189194066790,
                                 0.081463004232579,  0.000000000000000, -0.000000000000000,
                                 0.278361695206665,  0.296676315782020,  0.000000000000000,
                                 0.000000000000000, -0.157199936415362, -0.248582273574233,
                                -0.989069880866919, -1.095445115010333};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 28, 20));

    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.234600967845136,
                                 0.131304636418216,  0.000000000000000,  0.000000000000000,
                                -0.223669854408121, -0.157823380184412,  0.000000000000000,
                                 0.000000000000000,  0.208380989570214,  0.077987614072806,
                                 0.000000000000000,  0.000000000000000,  0.121999696298421,
                                 0.095747435996725, -1.755567379083480, -1.163331357712262,
                                 0.173770076690458, -0.009724434234915,  0.000000000000000,
                                 0.000000000000000,  0.240268105206569,  0.184037198991768,
                                 0.000000000000000,  0.000000000000000, -0.264860591751274,
                                -0.226459550936812, -0.000000000000000,  0.000000000000000,
                                 0.172141948950539,  0.102640162322180,  0.000000000000000,
                                 0.000000000000000,  0.153432867594363,  0.139284543815834,
                                -1.479790672477243, -1.341640786499874,  0.113207369704813,
                                -0.064760936592094,  0.213648243712300,  0.171403932259042,
                                 0.000000000000000,  0.000000000000000, -0.201575700014953,
                                -0.189355001231877,  0.000000000000000,  0.000000000000000,
                                 0.192181023315690,  0.122314899049497, -0.000000000000000,
                                 0.000000000000000,  0.109464394971919,  0.109809482954316,
                                 0.000000000000000,  0.000000000000000,  0.161040635961723,
                                 0.079406422646889, -1.917278333839848, -0.578368695600840,
                                 0.200530221782848,  0.225398615610440,  0.000000000000000,
                                 0.000000000000000, -0.240462277362011, -0.277355173587503,
                                 0.000000000000000,  0.000000000000000,  0.119818201389053,
                                 0.125708012402890,  0.000000000000000,  0.000000000000000,
                                 0.145686346437607,  0.170588030702560,  0.000000000000000,
                                 0.000000000000000, -0.010246550885437, -0.079315624957683,
                                -0.989069880866919, -1.095445115010333,  0.000000000000000,
                                 0.000000000000000,  0.463855615950065,  0.348240078434565,
                                 0.000000000000000,  0.000000000000000, -0.417261020726307,
                                -0.053416197735944,  0.000000000000000,  0.000000000000000,
                                 0.051620019334037, -0.014410092977350, -1.433414762609910,
                                -0.949856076058071,  0.048007722494551,  0.036576367409186,
                                 0.000000000000000,  0.000000000000000,  0.177443796856308,
                                 0.050813658062588,  0.000000000000000,  0.000000000000000,
                                 0.562654677724601,  0.506260824412883,  0.000000000000000,
                                 0.000000000000000, -0.256188000956022, -0.035148543231278,
                                 0.000000000000000,  0.000000000000000, -0.007834910366699,
                                -0.021788241302055, -1.208244024566410, -1.095445115010333,
                                 0.086271396609858,  0.031832989928933,  0.000000000000000,
                                 0.000000000000000,  0.133606163377177,  0.061355089310132,
                                 0.417517140480083,  0.402554304834818,  0.000000000000000,
                                 0.000000000000000, -0.389372183185731, -0.180352511841053,
                                 0.000000000000000,  0.000000000000000,  0.050977966610506,
                                -0.006048481992650,  0.000000000000000,  0.000000000000000,
                                 0.041141903450635,  0.061750689652548, -1.565451204267042,
                                -0.472236062473715,  0.164299638555555,  0.094676763927549,
                                 0.000000000000000,  0.000000000000000,  0.529926900975836,
                                 0.620040348286155,  0.000000000000000,  0.000000000000000,
                                -0.085724438219041, -0.043047998059393,  0.000000000000000,
                                 0.000000000000000, -0.021762203734974, -0.026685036791335,
                                 0.000000000000000,  0.000000000000000,  0.057299117580974,
                                 0.038987291156521, -0.807572176026433, -0.894427190999916,
                                 0.078641445420436,  0.075144330966357,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.515153943995177, -0.207048135733166,  0.000000000000000,
                                 0.000000000000000, -0.295028300916982,  0.100529015382864,
                                -1.570227199484721, -1.040515198480697,  0.332321581749900,
                                 0.113510609053764,  0.000000000000000,  0.000000000000000,
                                 0.038822145470608,  0.026242799908041, -0.453285548155688,
                                -0.300370864969363,  0.348717467698444,  0.025944078541747,
                                 0.000000000000000,  0.000000000000000, -0.452937533347046,
                                -0.271229501079565,  0.000000000000000,  0.000000000000000,
                                -0.050636490482234,  0.199852151366785, -1.323565014451698,
                                -1.200000000000000,  0.283581672081139,  0.126979918183695,
                                 0.000000000000000,  0.000000000000000,  0.025765916761329,
                                 0.045217155564948, -0.382080308691829, -0.346410161513775,
                                 0.195768782624882, -0.003957860462806, -0.473150698959149,
                                -0.322016776612652,  0.000000000000000,  0.000000000000000,
                                -0.282429896727803, -0.032565686399821,  0.000000000000000,
                                 0.000000000000000,  0.305759728833504,  0.201530257111448,
                                -1.714865874501374, -0.517308687768545,  0.036722104926828,
                                 0.018553436594441,  0.000000000000000,  0.000000000000000,
                                 0.326550394119339,  0.137477474996856, -0.495039137133735,
                                -0.149334155068651, -0.318176692992435, -0.332186940417297,
                                 0.000000000000000,  0.000000000000000,  0.147378918070425,
                                 0.244767897423045,  0.000000000000000,  0.000000000000000,
                                 0.176136503025661,  0.155518003565203, -0.884650995246420,
                                -0.979795897113272,  0.039271641727915,  0.055379479377086,
                                 0.000000000000000,  0.000000000000000,  0.043682934169150,
                                -0.004847369303505, -0.255376745122195, -0.282842712474619,
                                 0.000000000000000,  0.000000000000000,  0.052029574148700,
                                -0.075076260257219,  1.110318300759208,  0.735755352773367,
                                 0.220946590329633,  0.076215955820952,  0.000000000000000,
                                 0.000000000000000,  0.110607332433892,  0.123366248589122,
                                 0.000000000000000,  0.000000000000000,  0.189360061821680,
                                -0.006663941708404,  0.000000000000000,  0.000000000000000,
                                 0.393951694436284,  0.228253981177482,  0.000000000000000,
                                 0.000000000000000, -0.059594958057742, -0.122559294497679,
                                 0.935901797060066,  0.848528137423857,  0.138033769603136,
                                 0.121849395521678,  0.000000000000000,  0.000000000000000,
                                 0.171289689287627,  0.186621967796541,  0.000000000000000,
                                 0.000000000000000,  0.069806090284278, -0.027226756944231,
                                 0.000000000000000,  0.000000000000000,  0.413547574702205,
                                 0.320533139710975,  0.054023252461359, -0.043822451983890,
                                 0.000000000000000,  0.000000000000000,  0.207179432757986,
                                 0.097910192281588,  1.212593288685320,  0.365792481087853,
                                 0.097563065589843,  0.123019867516942,  0.000000000000000,
                                 0.000000000000000,  0.179810342667837,  0.048397175987938,
                                -0.000000000000000,  0.000000000000000,  0.358125934198908,
                                 0.295106317087546,  0.000000000000000,  0.000000000000000,
                                -0.112792089288124, -0.150103867377404,  0.000000000000000,
                                 0.000000000000000,  0.115373268275196,  0.149234422247341,
                                 0.625542717722172,  0.692820323027551,  0.186976813594918,
                                 0.228564297947820,  0.000000000000000,  0.000000000000000,
                                -0.008240988342853, -0.033345830932072,  0.000000000000000,
                                 0.000000000000000,  0.348517839376650,  0.392571318972060,
                                 0.000000000000000,  0.000000000000000,  0.453285548155688,
                                 0.300370864969363,  0.020069098988699,  0.087521532455210,
                                 0.000000000000000,  0.000000000000000,  0.038822145470608,
                                 0.026242799908041,  0.000000000000000,  0.000000000000000,
                                 0.180215978548340,  0.065734893230743,  0.000000000000000,
                                 0.000000000000000, -0.072246769442621,  0.034485426472250,
                                 0.000000000000000,  0.000000000000000, -0.064224620842703,
                                -0.011331481017280,  0.382080308691829,  0.346410161513776,
                                 0.081906119545029,  0.147260084990244,  0.000000000000000,
                                 0.000000000000000,  0.025765916761329,  0.045217155564948,
                                 0.000000000000000,  0.000000000000000,  0.132159729168670,
                                 0.092130081465076,  0.000000000000000,  0.000000000000000,
                                -0.007624212610289,  0.066818775382011,  0.000000000000000,
                                 0.000000000000000, -0.037062887475823, -0.012620805171230,
                                 0.015163758711278,  0.059440930056026,  0.495039137133735,
                                 0.149334155068651,  0.036722104926828,  0.018553436594442,
                                 0.000000000000000,  0.000000000000000,  0.167617041155273,
                                 0.093927765058811,  0.000000000000000,  0.000000000000000,
                                -0.069272222859350, -0.004407664851340,  0.000000000000000,
                                 0.000000000000000, -0.060236678443460, -0.026143645054560,
                                 0.000000000000000,  0.000000000000000,  0.131292862910605,
                                 0.180356033852490,  0.255376745122196,  0.282842712474619,
                                 0.039271641727915,  0.055379479377086,  0.000000000000000,
                                 0.000000000000000,  0.100468527128465,  0.112835844775241,
                                 0.000000000000000,  0.000000000000000,  0.050756498784875,
                                 0.081835952461784,  0.000000000000000,  0.000000000000000,
                                -0.017667572916489, -0.015457266406297,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.177443796856308,  0.050813658062588,  1.433414762609910,
                                 0.949856076058071,  0.234112133937630, -0.008640025112795,
                                 0.000000000000000,  0.000000000000000,  0.257528867178188,
                                 0.077962574659601,  0.000000000000000,  0.000000000000000,
                                -0.045108790748425, -0.002366497183228,  0.000000000000000,
                                 0.000000000000000,  0.471874995395743,  0.360332465664341,
                                 0.000000000000000,  0.000000000000000,  0.133606163377177,
                                 0.061355089310132,  1.208244024566409,  1.095445115010333,
                                 0.061477306733923, -0.014136895453994,  0.000000000000000,
                                 0.000000000000000,  0.200649961019624,  0.094769857268417,
                                 0.000000000000000,  0.000000000000000, -0.017084876227266,
                                -0.001271195053572,  0.000000000000000,  0.000000000000000,
                                 0.584364509155127,  0.522334519491272,  0.164299638555555,
                                 0.094676763927549,  0.000000000000000,  0.000000000000000,
                                 0.224098099397623,  0.042021816173881,  1.565451204267042,
                                 0.472236062473715,  0.237992964196930,  0.142257412837352,
                                 0.000000000000000,  0.000000000000000, -0.042917330494807,
                                -0.011927344121941,  0.000000000000000,  0.000000000000000,
                                 0.423874813478879,  0.418105045770458,  0.000000000000000,
                                 0.000000000000000,  0.078641445420436,  0.075144330966357,
                                 0.000000000000000,  0.000000000000000, -0.012322639676157,
                                -0.017314090204678,  0.807572176026433,  0.894427190999916,
                                 0.120580396974563,  0.116068896652007,  0.000000000000000,
                                 0.000000000000000, -0.003857484158424, -0.001556889622401,
                                 0.000000000000000,  0.000000000000000,  0.548460575997771,
                                 0.639726523897725,  0.000000000000000,  0.000000000000000,
                                 1.755567379083479,  1.163331357712261, -0.098559527261060,
                                 0.032852687038567,  0.000000000000000,  0.000000000000000,
                                 0.167764810581598, -0.012769079851657,  0.000000000000000,
                                 0.000000000000000,  0.248385751388615,  0.133846051611736,
                                 0.000000000000000,  0.000000000000000, -0.217122058509563,
                                -0.147949987356045,  0.000000000000000,  0.000000000000000,
                                 0.135850172883768,  0.105075856847223,  1.479790672477243,
                                 1.341640786499874, -0.054032985860467,  0.092926337296227,
                                 0.000000000000000,  0.000000000000000,  0.064745083582310,
                                -0.039092102527358,  0.000000000000000,  0.000000000000000,
                                 0.253617512462704,  0.184770573666179,  0.000000000000000,
                                 0.000000000000000, -0.247134588615732, -0.213335433862432,
                                 0.000000000000000,  0.000000000000000,  0.169193348073526,
                                 0.152675378862105, -0.091574673310346, -0.037446881411133,
                                 1.917278333839847,  0.578368695600841,  0.158835791284624,
                                 0.044797025125975,  0.000000000000000,  0.000000000000000,
                                 0.226107747674361,  0.180832618887656, -0.000000000000000,
                                 0.000000000000000, -0.196384681748780, -0.176657874427034,
                                 0.000000000000000,  0.000000000000000,  0.121988989649150,
                                 0.121073394407785,  0.000000000000000,  0.000000000000000,
                                 0.046011454015295,  0.113811055020760,  0.989069880866919,
                                 1.095445115010333, -0.017265403827606, -0.047877852082296,
                                 0.000000000000000,  0.000000000000000,  0.204690047325704,
                                 0.226296812481734,  0.000000000000000,  0.000000000000000,
                                -0.225329595074576, -0.261281478509113,  0.000000000000000,
                                 0.000000000000000,  0.159899527811193,  0.186988387249130,
                                 0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 28, 20));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.121999696298421,
                                 0.095747435996725,  0.000000000000000,  0.000000000000000,
                                 0.115174949094348,  0.011404963984315,  0.000000000000000,
                                 0.000000000000000,  0.031556860786347,  0.005308556328416,
                                 0.000000000000000,  0.000000000000000, -0.225592858512531,
                                -0.024705426697100,  0.000000000000000,  0.000000000000000,
                                 0.164888363907069,  0.141323542441964,  0.000000000000000,
                                 0.000000000000000,  0.153432867594363,  0.139284543815834,
                                 0.000000000000000,  0.000000000000000,  0.060318155558351,
                                 0.007224400317281,  0.000000000000000,  0.000000000000000,
                                 0.017796258559197,  0.005849333958847,  0.000000000000000,
                                 0.000000000000000, -0.125512927965355, -0.015906222308865,
                                 0.000000000000000,  0.000000000000000,  0.221134033557167,
                                 0.206586856865529,  0.109464394971919,  0.109809482954316,
                                 0.000000000000000,  0.000000000000000,  0.108283777725432,
                                 0.042364948100791,  0.000000000000000,  0.000000000000000,
                                 0.029625628235981,  0.012547481987668,  0.000000000000000,
                                 0.000000000000000, -0.211523308557089, -0.088236558182643,
                                 0.000000000000000,  0.000000000000000,  0.147112145065016,
                                 0.158374902510754,  0.000000000000000,  0.000000000000000,
                                 0.145686346437607,  0.170588030702560,  0.000000000000000,
                                 0.000000000000000,  0.018361570215727,  0.008848047237470,
                                 0.000000000000000,  0.000000000000000,  0.008284653974083,
                                 0.007163941767154,  0.000000000000000,  0.000000000000000,
                                -0.039721289293402, -0.019481064195997,  0.000000000000000,
                                 0.000000000000000,  0.214920248857538,  0.253016193442964,
                                 0.000000000000000,  0.000000000000000, -1.433414762609910,
                                -0.949856076058071,  0.048007722494551,  0.036576367409186,
                                 0.000000000000000,  0.000000000000000,  0.033357907167270,
                                 0.107946033068028,  0.000000000000000,  0.000000000000000,
                                -0.110476699783347, -0.079313334513501,  0.000000000000000,
                                 0.000000000000000,  0.083704315810627,  0.221565337065086,
                                 0.000000000000000,  0.000000000000000, -0.045108790748425,
                                -0.002366497183228, -1.208244024566410, -1.095445115010333,
                                 0.086271396609858,  0.031832989928933,  0.000000000000000,
                                 0.000000000000000,  0.095049445795977,  0.180727541842126,
                                 0.000000000000000,  0.000000000000000, -0.159457175288857,
                                -0.102934770739312,  0.000000000000000,  0.000000000000000,
                                 0.247922919167068,  0.350629106238940,  0.000000000000000,
                                 0.000000000000000, -0.017084876227266, -0.001271195053572,
                                 0.041141903450635,  0.061750689652549, -1.565451204267042,
                                -0.472236062473715,  0.027829063808520,  0.069147396181888,
                                 0.000000000000000,  0.000000000000000, -0.097096784919807,
                                -0.113806277771904,  0.000000000000000,  0.000000000000000,
                                 0.067467007279233,  0.179224349092918,  0.000000000000000,
                                 0.000000000000000, -0.042917330494807, -0.011927344121941,
                                 0.000000000000000,  0.000000000000000,  0.057299117580974,
                                 0.038987291156521, -0.807572176026433, -0.894427190999916,
                                 0.161881077867963,  0.221345129990352,  0.000000000000000,
                                 0.000000000000000, -0.121867704134709, -0.126068832550841,
                                 0.000000000000000,  0.000000000000000,  0.334208706143393,
                                 0.429431199626758,  0.000000000000000,  0.000000000000000,
                                -0.003857484158424, -0.001556889622401,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.038822145470608,  0.026242799908041, -1.813142192622752,
                                -1.201483459877454,  0.246949495332736,  0.258183595992670,
                                 0.000000000000000,  0.000000000000000, -0.421227060968516,
                                 0.076205002601786,  0.000000000000000,  0.000000000000000,
                                -0.267235333656412, -0.104523441844683,  0.000000000000000,
                                 0.000000000000000,  0.111390765737180, -0.033021794455307,
                                 0.000000000000000,  0.000000000000000,  0.025765916761329,
                                 0.045217155564948, -1.528321234767317, -1.385640646055102,
                                 0.377315201060016,  0.371153615288148,  0.000000000000000,
                                 0.000000000000000, -0.146013939266881,  0.180094366407395,
                                 0.000000000000000,  0.000000000000000, -0.261093055188190,
                                -0.124276324247824,  0.000000000000000,  0.000000000000000,
                                 0.021506138935973, -0.066516687992387,  0.036722104926828,
                                 0.018553436594441,  0.000000000000000,  0.000000000000000,
                                 0.218204749840049,  0.271024099638617, -1.980156548534942,
                                -0.597336620274604, -0.398880540741514, -0.099925346192540,
                                 0.000000000000000,  0.000000000000000, -0.243066145907314,
                                -0.185472760343958, -0.000000000000000,  0.000000000000000,
                                 0.106578836934227,  0.014079010774241,  0.000000000000000,
                                 0.000000000000000,  0.039271641727915,  0.055379479377086,
                                 0.000000000000000,  0.000000000000000,  0.392687301049409,
                                 0.454568486822606, -1.021506980488782, -1.131370849898477,
                                 0.108775418302852,  0.220569651623975,  0.000000000000000,
                                 0.000000000000000, -0.161827672360810, -0.152206790757921,
                                 0.000000000000000,  0.000000000000000, -0.048311209642775,
                                -0.081465972480631,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.189360061821680,
                                -0.006663941708404,  0.000000000000000,  0.000000000000000,
                                -0.487403702716790, -0.216145292445974, -1.923127709488490,
                                -1.274365652944235,  0.245361477065041,  0.412012444509274,
                                 0.000000000000000,  0.000000000000000, -0.324935801811193,
                                -0.144096861630650,  0.000000000000000,  0.000000000000000,
                                -0.078900025759033,  0.002776642378502,  0.000000000000000,
                                 0.000000000000000,  0.069806090284278, -0.027226756944231,
                                 0.000000000000000,  0.000000000000000, -0.455607672988110,
                                -0.286282734474983, -1.621029463403051, -1.469693845669907,
                                 0.580795602057602,  0.596455280542550,  0.000000000000000,
                                 0.000000000000000, -0.303738448658740, -0.190855156316656,
                                 0.000000000000000,  0.000000000000000, -0.029085870951782,
                                 0.011344482060096,  0.179810342667837,  0.048397175987938,
                                 0.000000000000000,  0.000000000000000, -0.445922878879201,
                                -0.324203825808039,  0.000000000000000,  0.000000000000000,
                                 0.203640935223156,  0.417915951804459, -2.100273184920010,
                                -0.633571162270839, -0.297281919252800, -0.216135883872026,
                                 0.000000000000000,  0.000000000000000, -0.074920976111599,
                                -0.020165489994974,  0.000000000000000,  0.000000000000000,
                                -0.008240988342853, -0.033345830932072,  0.000000000000000,
                                 0.000000000000000, -0.331798559590075, -0.350623310816196,
                                 0.000000000000000,  0.000000000000000,  0.626333520664029,
                                 0.730505545858919, -1.083471769399518, -1.200000000000001,
                                -0.221199039726717, -0.233748873877464,  0.000000000000000,
                                 0.000000000000000,  0.003433745142855,  0.013894096221697,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.072246769442621,  0.034485426472250,
                                 0.000000000000000,  0.000000000000000, -0.267235333656412,
                                -0.104523441844683,  0.000000000000000,  0.000000000000000,
                                -0.280818040645677,  0.050803335067857, -1.813142192622752,
                                -1.201483459877454,  0.469645606713080,  0.345286464196573,
                                 0.000000000000000,  0.000000000000000, -0.161247168923809,
                                 0.018762014043664,  0.000000000000000,  0.000000000000000,
                                -0.007624212610289,  0.066818775382011,  0.000000000000000,
                                 0.000000000000000, -0.261093055188190, -0.124276324247824,
                                 0.000000000000000,  0.000000000000000, -0.097342626177921,
                                 0.120062910938264, -1.528321234767317, -1.385640646055102,
                                 0.594892747050174,  0.474717218828001,  0.000000000000000,
                                 0.000000000000000, -0.045186151125503,  0.043673153351317,
                                -0.069272222859350, -0.004407664851340,  0.000000000000000,
                                 0.000000000000000, -0.243066145907314, -0.185472760343958,
                                -0.000000000000000,  0.000000000000000, -0.265920360494343,
                                -0.066616897461693,  0.000000000000000,  0.000000000000000,
                                 0.420759871429477,  0.425584733258582, -1.980156548534942,
                                -0.597336620274604, -0.153956144789212, -0.030877887011495,
                                 0.000000000000000,  0.000000000000000,  0.050756498784875,
                                 0.081835952461784,  0.000000000000000,  0.000000000000000,
                                -0.161827672360810, -0.152206790757921,  0.000000000000000,
                                 0.000000000000000,  0.072516945535235,  0.147046434415983,
                                 0.000000000000000,  0.000000000000000,  0.527543694683418,
                                 0.581407479120873, -1.021506980488782, -1.131370849898477,
                                 0.026773497223851,  0.053488470584524,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.045108790748425, -0.002366497183228,  0.000000000000000,
                                 0.000000000000000, -0.093804552328543, -0.239459223303999,
                                 0.000000000000000,  0.000000000000000,  0.046031958243061,
                                 0.033047222713959,  0.000000000000000,  0.000000000000000,
                                 0.084981338258843,  0.199403673844696, -1.433414762609910,
                                -0.949856076058071, -0.041458045823159,  0.031882814662450,
                                 0.000000000000000,  0.000000000000000, -0.017084876227266,
                                -0.001271195053572,  0.000000000000000,  0.000000000000000,
                                -0.279527544308999, -0.374490444281666,  0.000000000000000,
                                 0.000000000000000,  0.066440489703691,  0.042889487808047,
                                 0.000000000000000,  0.000000000000000,  0.256584196521401,
                                 0.302685491838279, -1.208244024566410, -1.095445115010332,
                                 0.052386392092447,  0.029311786406015, -0.042917330494807,
                                -0.011927344121941,  0.000000000000000,  0.000000000000000,
                                -0.075184030749168, -0.201875325538944,  0.000000000000000,
                                 0.000000000000000,  0.040456993716587,  0.047419282404960,
                                 0.000000000000000,  0.000000000000000,  0.067271628210414,
                                 0.184919053572687,  0.000000000000000,  0.000000000000000,
                                -0.043977468697399,  0.038094790477366, -1.565451204267042,
                                -0.472236062473715, -0.003857484158424, -0.001556889622401,
                                 0.000000000000000,  0.000000000000000, -0.361624832945827,
                                -0.458655251019128,  0.000000000000000,  0.000000000000000,
                                 0.050778210056129,  0.052528680229517,  0.000000000000000,
                                 0.000000000000000,  0.302007948191517,  0.370712503773572,
                                 0.000000000000000,  0.000000000000000,  0.049648440666767,
                                 0.035899460072092, -0.807572176026433, -0.894427190999916,
                                 0.000000000000000,  0.000000000000000, -0.217122058509563,
                                -0.147949987356045,  0.000000000000000,  0.000000000000000,
                                 0.151930511680785,  0.020840952979339,  0.000000000000000,
                                 0.000000000000000, -0.161290621796887, -0.027132621234124,
                                -0.000000000000000, -0.000000000000000,  0.042126455152866,
                                 0.007572694214201,  0.000000000000000,  0.000000000000000,
                                 0.132673918646000,  0.097101583868614,  0.000000000000000,
                                 0.000000000000000, -0.247134588615732, -0.213335433862432,
                                 0.000000000000000,  0.000000000000000,  0.097613441915083,
                                 0.013830369478997,  0.000000000000000,  0.000000000000000,
                                -0.090958654858120, -0.029896595789660,  0.000000000000000,
                                -0.000000000000000,  0.032651165225165,  0.005165846260995,
                                 0.000000000000000,  0.000000000000000,  0.158746213854237,
                                 0.140663650002806, -0.196384681748780, -0.176657874427034,
                                 0.000000000000000,  0.000000000000000,  0.141439601333979,
                                 0.068759286792417, -0.000000000000000,  0.000000000000000,
                                -0.151419877650571, -0.064131574603635,  0.000000000000000,
                                 0.000000000000000,  0.038784101395847,  0.023049987305484,
                                -0.000000000000000, -0.000000000000000,  0.119533489570611,
                                 0.113545701670876,  0.000000000000000,  0.000000000000000,
                                -0.225329595074576, -0.261281478509113,  0.000000000000000,
                                 0.000000000000000,  0.033422044040730,  0.016938674088853,
                                 0.000000000000000,  0.000000000000000, -0.042343786978645,
                                -0.036615702365454,  0.000000000000000,  0.000000000000000,
                                 0.012114818673495,  0.006326843714551, -0.000000000000000,
                                 0.000000000000000,  0.147813549517135,  0.172277083932158,
                                 0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 28, 20));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeDGForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 2);
    
    CGtoBlock kgtos(mlih, mbas, 4);
    
    CDenseMatrix lmomxmat(20, 36);
    
    CDenseMatrix lmomymat(20, 36);
    
    CDenseMatrix lmomzmat(20, 36);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{-0.000000000000000, -0.000000000000000, -0.180391701282824,
                                -0.282907530420044, -0.000000000000000, -0.000000000000000,
                                -0.095382143233882, -0.273173751031077, -0.000000000000000,
                                -0.000000000000000,  0.048262799533130,  0.248994014389027,
                                -0.000000000000000, -0.000000000000000, -0.040742364988703,
                                 0.074439105794478, -0.000000000000000, -0.000000000000000,
                                -0.198770602995543, -0.288676840022087, -0.000000000000000,
                                -0.000000000000000, -0.641754625191725, -0.419938063964819,
                                -0.000000000000000, -0.000000000000000, -0.082956203030931,
                                -0.029660972986601, -0.000000000000000, -0.000000000000000,
                                -0.198536441557903, -0.223249592118196, -0.000000000000000,
                                -0.000000000000000,  0.095883371075834,  0.253976040049989,
                                -0.000000000000000, -0.000000000000000, -0.144309278018775,
                                -0.315769341427014, -0.000000000000000, -0.000000000000000,
                                -0.103196864793256, -0.340261855567063, -0.000000000000000,
                                -0.000000000000000,  0.111898020892470,  0.277678638990386,
                                -0.000000000000000, -0.000000000000000,  0.007696671778040,
                                 0.107489429427782, -0.000000000000000, -0.000000000000000,
                                -0.165756404021745, -0.299515046403391, -0.000000000000000,
                                -0.000000000000000, -0.324801067416595, -0.385745450724189,
                                -0.000000000000000, -0.000000000000000, -0.029800777305883,
                                -0.024085935165432, -0.000000000000000, -0.000000000000000,
                                -0.140855560442935, -0.221997079623306, -0.000000000000000,
                                -0.000000000000000,  0.103720731242549,  0.307035511414369,
                                 0.220390383600852,  0.280922669986506,  0.000000000000000,
                                 0.000000000000000,  0.120214315683691,  0.198166231624365,
                                -0.000000000000000, -0.000000000000000, -0.074580201921790,
                                -0.215184467959690, -0.000000000000000, -0.000000000000000,
                                 0.042714305330314, -0.012210161689508, -0.000000000000000,
                                -0.000000000000000,  0.245634306555720,  0.323594656461282,
                                 0.000000000000000, -0.000000000000000,  0.748635629060931,
                                 0.643159161205622, -0.000000000000000, -0.000000000000000,
                                 0.093985581253507,  0.059681872960873, -0.000000000000000,
                                -0.000000000000000,  0.240269822003080,  0.276162360265594,
                                -0.000000000000000, -0.000000000000000, -0.121555306916179,
                                -0.199786234350836, -0.000000000000000, -0.000000000000000,
                                 0.123825218176087,  0.210512894284676,  0.000000000000000,
                                -0.000000000000000,  0.121803047184818,  0.226841237044708,
                                -0.000000000000000, -0.000000000000000, -0.109175944411187,
                                -0.185119092660257, -0.000000000000000, -0.000000000000000,
                                -0.034203013741014, -0.071659619618521, -0.000000000000000,
                                -0.000000000000000,  0.124975984630721,  0.199676697602261,
                                -0.000000000000000, -0.000000000000000,  0.178200896112991,
                                 0.257163633816126, -0.000000000000000, -0.000000000000000,
                                 0.012341321066475,  0.016057290110288, -0.000000000000000,
                                -0.000000000000000,  0.096005339181779,  0.147998053082204,
                                -0.000000000000000, -0.000000000000000, -0.112676459658541,
                                -0.204690340942913, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.086470500595766,
                                -0.075212773393199, -0.000000000000000, -0.000000000000000,
                                 0.102821505091306,  0.053629658399883, -0.000000000000000,
                                -0.000000000000000, -0.036091817774302, -0.154157808417014,
                                -0.000000000000000, -0.000000000000000,  0.080557427783240,
                                 0.068890541281514, -0.000000000000000, -0.000000000000000,
                                 0.049820639922480, -0.106035167054625, -0.000000000000000,
                                -0.000000000000000,  0.042441993164122,  0.125615268388731,
                                -0.000000000000000, -0.000000000000000, -0.033963163883738,
                                 0.000423772174817, -0.000000000000000, -0.000000000000000,
                                -0.189368112699927, -0.083122909291319, -0.000000000000000,
                                -0.000000000000000, -0.189520444493608, -0.177305025981432,
                                -0.000000000000000, -0.000000000000000, -0.051438672069565,
                                -0.072793648031345, -0.000000000000000, -0.000000000000000,
                                 0.059527465754171,  0.028018974336490, -0.000000000000000,
                                -0.000000000000000, -0.040642615234866, -0.215958239581077,
                                -0.000000000000000, -0.000000000000000,  0.036471168647061,
                                 0.078613253791579, -0.000000000000000, -0.000000000000000,
                                -0.035994390161107, -0.121485766578693, -0.000000000000000,
                                -0.000000000000000,  0.053165393708702,  0.146360868518263,
                                -0.000000000000000, -0.000000000000000, -0.004339044565433,
                                 0.001898338361336, -0.000000000000000, -0.000000000000000,
                                -0.095807099031087, -0.042915314813099, -0.000000000000000,
                                -0.000000000000000, -0.118921135706313, -0.172573857097291,
                                 0.102476793970642,  0.101293314289524, -0.000000000000000,
                                -0.000000000000000, -0.122611941379969, -0.118270254700219,
                                 0.000000000000000,  0.000000000000000,  0.044383003993619,
                                 0.076836488709540, -0.000000000000000, -0.000000000000000,
                                -0.091957290496773, -0.071519519880433, -0.000000000000000,
                                -0.000000000000000, -0.044838503027107,  0.067227808038722,
                                -0.000000000000000, -0.000000000000000, -0.055374603954894,
                                -0.102282705877772, -0.000000000000000, -0.000000000000000,
                                 0.036521103265140,  0.009150506559157, -0.000000000000000,
                                -0.000000000000000,  0.222210709223091,  0.190818151324591,
                                -0.000000000000000, -0.000000000000000,  0.226017168751111,
                                 0.233908703240082, -0.000000000000000, -0.000000000000000,
                                 0.032192328945797,  0.048529098687563, -0.000000000000000,
                                -0.000000000000000, -0.021463073810651, -0.018679316224326,
                                 0.000000000000000, -0.000000000000000,  0.070144190240895,
                                 0.143972159720718, -0.000000000000000, -0.000000000000000,
                                -0.030236783643543, -0.052408835861052, -0.000000000000000,
                                -0.000000000000000,  0.046808993056926,  0.080990511052462,
                                -0.000000000000000, -0.000000000000000, -0.055441926363210,
                                -0.097573912345509, -0.000000000000000, -0.000000000000000,
                                -0.000309618883052, -0.001265558907558, -0.000000000000000,
                                -0.000000000000000,  0.033199699414640,  0.028610209875399,
                                -0.000000000000000, -0.000000000000000,  0.075967049250725,
                                 0.115049238064861, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.081741458715702,
                                -0.039649287983960, -0.000000000000000, -0.000000000000000,
                                -0.357321542918646, -0.178991745658111, -0.000000000000000,
                                -0.000000000000000,  0.014397842745115, -0.046497571502689,
                                -0.000000000000000, -0.000000000000000,  0.154741226442700,
                                 0.151254406113592, -0.000000000000000, -0.000000000000000,
                                 0.029627876518545,  0.140469524987453, -0.000000000000000,
                                -0.000000000000000,  0.176118795306892, -0.125077769687256,
                                -0.000000000000000, -0.000000000000000, -0.169627797909638,
                                -0.110031468166585, -0.000000000000000, -0.000000000000000,
                                 0.039109215323060,  0.045198545007268, -0.000000000000000,
                                -0.000000000000000,  0.209282495677544,  0.138123978006860,
                                -0.000000000000000, -0.000000000000000, -0.034568283035268,
                                -0.034605610366822, -0.000000000000000, -0.000000000000000,
                                -0.155919076576358, -0.155506339498935, -0.000000000000000,
                                -0.000000000000000, -0.003022311808226, -0.074899484613764,
                                -0.000000000000000, -0.000000000000000,  0.095479574413678,
                                 0.151803451735813, -0.000000000000000, -0.000000000000000,
                                 0.058252497089443,  0.164852082264906, -0.000000000000000,
                                -0.000000000000000,  0.029527223027556, -0.222749569332723,
                                -0.000000000000000, -0.000000000000000, -0.069518591858966,
                                -0.121263189854893, -0.000000000000000, -0.000000000000000,
                                 0.030942719584672,  0.042804270906545, -0.000000000000000,
                                -0.000000000000000,  0.106386117557373,  0.127128808060609,
                                 0.093803926521932,  0.068829907520039, -0.000000000000000,
                                -0.000000000000000,  0.411345307529447,  0.310319709031109,
                                -0.000000000000000, -0.000000000000000, -0.015527179519232,
                                 0.004513683902065,  0.000000000000000, -0.000000000000000,
                                -0.183701027430938, -0.187428813222518, -0.000000000000000,
                                -0.000000000000000, -0.043192510978224, -0.111852533031937,
                                -0.000000000000000, -0.000000000000000, -0.196031877627964,
                                -0.065397404671583, -0.000000000000000, -0.000000000000000,
                                 0.193001270983341,  0.137566437199856,  0.000000000000000,
                                 0.000000000000000, -0.048312963663477, -0.060789003011506,
                                -0.000000000000000, -0.000000000000000, -0.244232416472301,
                                -0.210625525697729,  0.000000000000000,  0.000000000000000,
                                 0.016684613696234,  0.023070406911215, -0.000000000000000,
                                -0.000000000000000,  0.075280334556718,  0.103670892999290,
                                -0.000000000000000, -0.000000000000000,  0.021756352217819,
                                 0.049932989742509, -0.000000000000000, -0.000000000000000,
                                -0.065125339370810, -0.101202301157208, -0.000000000000000,
                                -0.000000000000000, -0.062058157958969, -0.109901388176604,
                                -0.000000000000000, -0.000000000000000,  0.060111767725926,
                                 0.148499712888482, -0.000000000000000, -0.000000000000000,
                                 0.047910624657077,  0.080842126569929,  0.000000000000000,
                                -0.000000000000000, -0.019290978199400, -0.028536180604363,
                                -0.000000000000000, -0.000000000000000, -0.058631573547522,
                                -0.084752538707073,  0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.280435717461150,
                                 0.214883669395448, -0.000000000000000, -0.000000000000000,
                                 0.079199287534772,  0.069262234842465, -0.000000000000000,
                                -0.000000000000000, -0.247976303301054,  0.095367334627414,
                                -0.000000000000000, -0.000000000000000,  0.042441993164122,
                                 0.125615268388731, -0.000000000000000, -0.000000000000000,
                                 0.130385590738876,  0.248448042624986, -0.000000000000000,
                                -0.000000000000000,  0.001263561250125,  0.274995290341686,
                                -0.000000000000000, -0.000000000000000, -0.014279951386501,
                                -0.192877144625542, -0.000000000000000, -0.000000000000000,
                                 0.401997300129139,  0.104355182655687, -0.000000000000000,
                                -0.000000000000000,  0.029049477782237, -0.033432689529138,
                                -0.000000000000000, -0.000000000000000,  0.155713351778934,
                                 0.202900278799259, -0.000000000000000, -0.000000000000000,
                                 0.068977455213440,  0.037560085220284, -0.000000000000000,
                                -0.000000000000000, -0.013511683201587,  0.133852512999095,
                                -0.000000000000000, -0.000000000000000,  0.053165393708702,
                                 0.146360868518263, -0.000000000000000, -0.000000000000000,
                                 0.101732395563679,  0.306813100788299, -0.000000000000000,
                                -0.000000000000000,  0.104686670871389,  0.323058790722813,
                                -0.000000000000000, -0.000000000000000, -0.045426454191244,
                                -0.267174107930159, -0.000000000000000, -0.000000000000000,
                                 0.147715104485646,  0.048728894072496, -0.000000000000000,
                                -0.000000000000000, -0.008570945655476, -0.039718931576300,
                                -0.330122733763516, -0.307419280316391, -0.000000000000000,
                                -0.000000000000000, -0.100320620723926, -0.136107182971085,
                                 0.000000000000000, -0.000000000000000,  0.265169657015133,
                                 0.034339181250273, -0.000000000000000, -0.000000000000000,
                                -0.055374603954894, -0.102282705877772, -0.000000000000000,
                                -0.000000000000000, -0.157035746962169, -0.196664397265976,
                                -0.000000000000000, -0.000000000000000, -0.022683787333504,
                                -0.199235732883142, -0.000000000000000, -0.000000000000000,
                                 0.021546294740317,  0.084489712263904, -0.000000000000000,
                                -0.000000000000000, -0.457984272869916, -0.297159292624790,
                                 0.000000000000000,  0.000000000000000, -0.028825275629615,
                                 0.015445346786709, -0.000000000000000, -0.000000000000000,
                                -0.091600554931584, -0.135266852532839, -0.000000000000000,
                                -0.000000000000000, -0.027891494394940, -0.025040056813523,
                                -0.000000000000000, -0.000000000000000, -0.043940645399055,
                                -0.089235008666063, -0.000000000000000, -0.000000000000000,
                                -0.055441926363211, -0.097573912345508, -0.000000000000000,
                                -0.000000000000000, -0.110540453776032, -0.204542067192200,
                                -0.000000000000000, -0.000000000000000, -0.121643053684177,
                                -0.215372527148542, -0.000000000000000, -0.000000000000000,
                                 0.087709707171177,  0.178116071953439, -0.000000000000000,
                                -0.000000000000000, -0.041044566574718, -0.032485929381664,
                                 0.000000000000000, -0.000000000000000,  0.014865958336922,
                                 0.026479287717533, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.037706032214246,
                                -0.232008395307345, -0.000000000000000, -0.000000000000000,
                                 0.327110053615453,  0.276393819289879, -0.000000000000000,
                                -0.000000000000000, -0.082956203030931, -0.029660972986602,
                                -0.000000000000000, -0.000000000000000, -0.077291229174584,
                                -0.024050818259079, -0.000000000000000, -0.000000000000000,
                                -0.469979863158281, -0.341037791743860, -0.000000000000000,
                                -0.000000000000000,  0.041156445488847,  0.191691335291362,
                                -0.000000000000000, -0.000000000000000,  0.482194096617488,
                                 0.456954686037515, -0.000000000000000, -0.000000000000000,
                                 0.067987776913337, -0.214087789793438, -0.000000000000000,
                                -0.000000000000000, -0.186255680232626, -0.286324282327791,
                                -0.000000000000000, -0.000000000000000, -0.081529340078388,
                                -0.289531111353590, -0.000000000000000, -0.000000000000000,
                                 0.192887611402597,  0.264885116492474, -0.000000000000000,
                                -0.000000000000000, -0.029800777305883, -0.024085935165432,
                                -0.000000000000000, -0.000000000000000, -0.026143232606206,
                                -0.018559508949901, -0.000000000000000, -0.000000000000000,
                                -0.248567348076549, -0.324329815258382, -0.000000000000000,
                                -0.000000000000000,  0.080286691613394,  0.223673879083098,
                                -0.000000000000000, -0.000000000000000,  0.298328421332475,
                                 0.455199238426705, -0.000000000000000, -0.000000000000000,
                                -0.042572744710351, -0.293487142984694, -0.000000000000000,
                                -0.000000000000000, -0.147328122544535, -0.318633559728315,
                                 0.055278074929091,  0.155378826416954,  0.000000000000000,
                                -0.000000000000000, -0.387497323962137, -0.380122015344783,
                                -0.000000000000000, -0.000000000000000,  0.093985581253507,
                                 0.059681872960873, -0.000000000000000, -0.000000000000000,
                                 0.087211083990605,  0.052496690349374, -0.000000000000000,
                                -0.000000000000000,  0.550232586497931,  0.491195700411085,
                                 0.000000000000000,  0.000000000000000, -0.059910605200957,
                                -0.154201088686685, -0.000000000000000, -0.000000000000000,
                                -0.573619549454870, -0.586578227925801, -0.000000000000000,
                                -0.000000000000000, -0.065474851912648,  0.076758871679719,
                                -0.000000000000000, -0.000000000000000,  0.227267820150945,
                                 0.286921265217194,  0.000000000000000,  0.000000000000000,
                                 0.103556625122395,  0.193020740902393, -0.000000000000000,
                                -0.000000000000000, -0.118114454943086, -0.176590077661649,
                                -0.000000000000000, -0.000000000000000,  0.012341321066475,
                                 0.016057290110288, -0.000000000000000, -0.000000000000000,
                                 0.009932850582475,  0.012373005966601, -0.000000000000000,
                                -0.000000000000000,  0.145474449474573,  0.216219876838921,
                                 0.000000000000000, -0.000000000000000, -0.084614545723487,
                                -0.149115919388732, -0.000000000000000, -0.000000000000000,
                                -0.196409442244973, -0.303466158951136, -0.000000000000000,
                                -0.000000000000000,  0.097299858883043,  0.195658095323129,
                                -0.000000000000000, -0.000000000000000,  0.125255812524488,
                                 0.212422373152210,  0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 20, 36));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000,  0.140335830119818,
                                 0.295782488132192, -0.000000000000000, -0.000000000000000,
                                 0.337508324341773,  0.278244752721515, -0.000000000000000,
                                -0.000000000000000,  0.399273270630985,  0.519210603598241,
                                -0.000000000000000, -0.000000000000000, -0.487172166842557,
                                -0.371836427446661, -0.000000000000000, -0.000000000000000,
                                 0.127075593768037, -0.078153868941032, -0.000000000000000,
                                -0.000000000000000, -0.040742364988703,  0.074439105794478,
                                -0.000000000000000, -0.000000000000000,  0.199720774523800,
                                 0.100013792684676, -0.000000000000000, -0.000000000000000,
                                -0.149193366141564,  0.060439902638366, -0.000000000000000,
                                -0.000000000000000, -0.070457618696630,  0.065020715766644,
                                -0.000000000000000, -0.000000000000000,  0.131917651085755,
                                 0.347576427155913, -0.000000000000000, -0.000000000000000,
                                 0.195504205494424,  0.266115498812745, -0.000000000000000,
                                -0.000000000000000,  0.301958242315495,  0.539571779613167,
                                -0.000000000000000, -0.000000000000000, -0.272514602204183,
                                -0.348626432824387, -0.000000000000000, -0.000000000000000,
                                -0.004301901094969, -0.103789684020629, -0.000000000000000,
                                -0.000000000000000,  0.007696671778040,  0.107489429427782,
                                -0.000000000000000, -0.000000000000000,  0.088292451593159,
                                 0.085899469870043, -0.000000000000000, -0.000000000000000,
                                -0.042293670549227,  0.134370326965980, -0.000000000000000,
                                -0.000000000000000, -0.005758999602902,  0.105762067403247,
                                -0.174656587545941, -0.255252474957906, -0.000000000000000,
                                -0.000000000000000, -0.399003268750900, -0.385431360692861,
                                -0.000000000000000, -0.000000000000000, -0.486259424604597,
                                -0.590284835579140, -0.000000000000000, -0.000000000000000,
                                 0.574213461079722,  0.538165780506873, -0.000000000000000,
                                -0.000000000000000, -0.133533320342944,  0.003832902176575,
                                 0.000000000000000,  0.000000000000000,  0.042714305330314,
                                -0.012210161689508, -0.000000000000000, -0.000000000000000,
                                -0.230290840493970, -0.175756089751298, -0.000000000000000,
                                -0.000000000000000,  0.169633828039899,  0.088334526067565,
                                -0.000000000000000, -0.000000000000000,  0.077183109124960,
                                 0.014646020763977, -0.000000000000000, -0.000000000000000,
                                -0.130578489866252, -0.231717618103942, -0.000000000000000,
                                -0.000000000000000, -0.118861923505902, -0.177410332541830,
                                -0.000000000000000, -0.000000000000000, -0.224780093921630,
                                -0.359714519742111, -0.000000000000000, -0.000000000000000,
                                 0.158335194948041,  0.232417621882925, -0.000000000000000,
                                -0.000000000000000,  0.035504148942973,  0.069193122680419,
                                 0.000000000000000, -0.000000000000000, -0.034203013741014,
                                -0.071659619618521, -0.000000000000000, -0.000000000000000,
                                -0.041995727560930, -0.057266313246696, -0.000000000000000,
                                -0.000000000000000, -0.030749390785772, -0.089580217977320,
                                -0.000000000000000, -0.000000000000000, -0.030626051372083,
                                -0.070508044935498, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.083899796039677,
                                -0.137108767405347, -0.000000000000000, -0.000000000000000,
                                -0.191967166210765, -0.088783492715443, -0.000000000000000,
                                -0.000000000000000, -0.180049975533577,  0.094519790277780,
                                -0.000000000000000, -0.000000000000000,  0.080289490385925,
                                 0.390213479046069, -0.000000000000000, -0.000000000000000,
                                 0.171902790674277,  0.160085403412798, -0.000000000000000,
                                -0.000000000000000,  0.080557427783240,  0.068890541281514,
                                -0.000000000000000, -0.000000000000000,  0.192624234234264,
                                 0.113757509248378, -0.000000000000000, -0.000000000000000,
                                 0.174371857548158, -0.004579864638245, -0.000000000000000,
                                -0.000000000000000,  0.165848644294057,  0.110559467335989,
                                -0.000000000000000, -0.000000000000000, -0.078428496781805,
                                -0.140507412031092, -0.000000000000000, -0.000000000000000,
                                -0.102688063163101, -0.045555408892614, -0.000000000000000,
                                -0.000000000000000, -0.004833594070721,  0.130055836276422,
                                -0.000000000000000, -0.000000000000000,  0.158571365568972,
                                 0.456147198253325, -0.000000000000000, -0.000000000000000,
                                 0.071737070429423,  0.205574961972722, -0.000000000000000,
                                -0.000000000000000,  0.036471168647061,  0.078613253791579,
                                -0.000000000000000, -0.000000000000000,  0.053070319721372,
                                 0.157212295732027, -0.000000000000000, -0.000000000000000,
                                 0.024583558368178, -0.007863906413922, -0.000000000000000,
                                -0.000000000000000,  0.085211760194296,  0.101591857788066,
                                 0.105639740570521,  0.152889577965199, -0.000000000000000,
                                -0.000000000000000,  0.226865926438036,  0.204465410669202,
                                -0.000000000000000, -0.000000000000000,  0.192127450484852,
                                 0.016038168131959, -0.000000000000000, -0.000000000000000,
                                -0.116587012790522, -0.303850173267590, -0.000000000000000,
                                -0.000000000000000, -0.194401166151425, -0.140641223900375,
                                -0.000000000000000, -0.000000000000000, -0.091957290496773,
                                -0.071519519880433, -0.000000000000000, -0.000000000000000,
                                -0.212086756198645, -0.105480274506501, -0.000000000000000,
                                -0.000000000000000, -0.188802845224425, -0.052227204498916,
                                -0.000000000000000, -0.000000000000000, -0.193787025953439,
                                -0.168687301618308, -0.000000000000000, -0.000000000000000,
                                 0.059276463390884,  0.093671608020728, -0.000000000000000,
                                -0.000000000000000,  0.035430786726126,  0.030370272595076,
                                -0.000000000000000, -0.000000000000000, -0.043321407632952,
                                -0.086703890850948, -0.000000000000000, -0.000000000000000,
                                -0.172377829628369, -0.304098132168883, -0.000000000000000,
                                -0.000000000000000, -0.071532959561927, -0.137049974648481,
                                -0.000000000000000, -0.000000000000000, -0.030236783643543,
                                -0.052408835861052, -0.000000000000000, -0.000000000000000,
                                -0.051350518407841, -0.104808197154684, -0.000000000000000,
                                -0.000000000000000,  0.002510405770876,  0.005242604275948,
                                -0.000000000000000, -0.000000000000000, -0.046920682448116,
                                -0.067727905192044, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.191914805944683,
                                 0.132749097388255, -0.000000000000000, -0.000000000000000,
                                 0.193703257290777,  0.086575829421663, -0.000000000000000,
                                -0.000000000000000,  0.147464992399088,  0.029796301432663,
                                -0.000000000000000, -0.000000000000000,  0.305069817342475,
                                 0.000967568740737, -0.000000000000000, -0.000000000000000,
                                 0.044441814777818,  0.210704287481180, -0.000000000000000,
                                -0.000000000000000,  0.154741226442700,  0.151254406113592,
                                -0.000000000000000, -0.000000000000000,  0.047642051010940,
                                 0.073855178598194, -0.000000000000000, -0.000000000000000,
                                 0.201428391354562,  0.137266752971326, -0.000000000000000,
                                -0.000000000000000, -0.003246334485267,  0.013347618071606,
                                -0.000000000000000, -0.000000000000000,  0.100530765765844,
                                 0.122985335588446, -0.000000000000000, -0.000000000000000,
                                 0.078857558831241,  0.073772489000549, -0.000000000000000,
                                -0.000000000000000,  0.049911061861297,  0.004936394959324,
                                -0.000000000000000, -0.000000000000000,  0.109093535038954,
                                -0.096246692886213, -0.000000000000000, -0.000000000000000,
                                 0.087378745634164,  0.247278123397360, -0.000000000000000,
                                -0.000000000000000,  0.095479574413678,  0.151803451735813,
                                -0.000000000000000, -0.000000000000000,  0.026388983188278,
                                 0.099590707729589, -0.000000000000000, -0.000000000000000,
                                 0.107601591621833,  0.124277884278091, -0.000000000000000,
                                -0.000000000000000,  0.005915455006231,  0.014329765564515,
                                -0.224640515216460, -0.198866565465113,  0.000000000000000,
                                -0.000000000000000, -0.221645849135445, -0.157271774779828,
                                -0.000000000000000, -0.000000000000000, -0.166776625317562,
                                -0.100496504012838,  0.000000000000000,  0.000000000000000,
                                -0.349116067153746, -0.221588082357015, -0.000000000000000,
                                -0.000000000000000, -0.064788766467337, -0.167778799547906,
                                -0.000000000000000, -0.000000000000000, -0.183701027430938,
                                -0.187428813222518, -0.000000000000000, -0.000000000000000,
                                -0.054864148017901, -0.051091215878462, -0.000000000000000,
                                -0.000000000000000, -0.236555843187967, -0.213026157668095,
                                -0.000000000000000, -0.000000000000000,  0.002067918148044,
                                -0.011288110316169,  0.000000000000000, -0.000000000000000,
                                -0.056412139143934, -0.081990223725631, -0.000000000000000,
                                -0.000000000000000, -0.036297173655518, -0.049181659333699,
                                -0.000000000000000, -0.000000000000000, -0.011192988145965,
                                -0.003290929972883,  0.000000000000000, -0.000000000000000,
                                 0.005840651583584,  0.064164461924142, -0.000000000000000,
                                -0.000000000000000, -0.093087236938453, -0.164852082264906,
                                -0.000000000000000, -0.000000000000000, -0.065125339370810,
                                -0.101202301157208, -0.000000000000000, -0.000000000000000,
                                -0.033320102548849, -0.066393805153059, -0.000000000000000,
                                -0.000000000000000, -0.058131229895086, -0.082851922852061,
                                -0.000000000000000, -0.000000000000000, -0.005823938786877,
                                -0.009553177043010, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.086470500595766,
                                -0.075212773393199, -0.000000000000000, -0.000000000000000,
                                 0.102821505091306,  0.053629658399883, -0.000000000000000,
                                -0.000000000000000, -0.036091817774302, -0.154157808417014,
                                -0.000000000000000, -0.000000000000000,  0.080557427783240,
                                 0.068890541281514, -0.000000000000000, -0.000000000000000,
                                 0.049820639922480, -0.106035167054625, -0.000000000000000,
                                -0.000000000000000,  0.042441993164122,  0.125615268388731,
                                -0.000000000000000, -0.000000000000000, -0.033963163883738,
                                 0.000423772174817, -0.000000000000000, -0.000000000000000,
                                -0.189368112699927, -0.083122909291319, -0.000000000000000,
                                -0.000000000000000, -0.189520444493608, -0.177305025981432,
                                -0.000000000000000, -0.000000000000000, -0.051438672069565,
                                -0.072793648031345, -0.000000000000000, -0.000000000000000,
                                 0.059527465754171,  0.028018974336490, -0.000000000000000,
                                -0.000000000000000, -0.040642615234866, -0.215958239581077,
                                -0.000000000000000, -0.000000000000000,  0.036471168647061,
                                 0.078613253791579, -0.000000000000000, -0.000000000000000,
                                -0.035994390161107, -0.121485766578693, -0.000000000000000,
                                -0.000000000000000,  0.053165393708702,  0.146360868518263,
                                -0.000000000000000, -0.000000000000000, -0.004339044565433,
                                 0.001898338361336, -0.000000000000000, -0.000000000000000,
                                -0.095807099031087, -0.042915314813099, -0.000000000000000,
                                -0.000000000000000, -0.118921135706313, -0.172573857097291,
                                 0.102476793970642,  0.101293314289524, -0.000000000000000,
                                -0.000000000000000, -0.122611941379969, -0.118270254700219,
                                 0.000000000000000,  0.000000000000000,  0.044383003993619,
                                 0.076836488709540, -0.000000000000000, -0.000000000000000,
                                -0.091957290496773, -0.071519519880433, -0.000000000000000,
                                -0.000000000000000, -0.044838503027107,  0.067227808038722,
                                -0.000000000000000, -0.000000000000000, -0.055374603954894,
                                -0.102282705877772, -0.000000000000000, -0.000000000000000,
                                 0.036521103265140,  0.009150506559157, -0.000000000000000,
                                -0.000000000000000,  0.222210709223091,  0.190818151324591,
                                -0.000000000000000, -0.000000000000000,  0.226017168751111,
                                 0.233908703240082, -0.000000000000000, -0.000000000000000,
                                 0.032192328945797,  0.048529098687563, -0.000000000000000,
                                -0.000000000000000, -0.021463073810651, -0.018679316224326,
                                 0.000000000000000, -0.000000000000000,  0.070144190240895,
                                 0.143972159720718, -0.000000000000000, -0.000000000000000,
                                -0.030236783643543, -0.052408835861052, -0.000000000000000,
                                -0.000000000000000,  0.046808993056926,  0.080990511052462,
                                -0.000000000000000, -0.000000000000000, -0.055441926363210,
                                -0.097573912345509, -0.000000000000000, -0.000000000000000,
                                -0.000309618883052, -0.001265558907558, -0.000000000000000,
                                -0.000000000000000,  0.033199699414640,  0.028610209875399,
                                -0.000000000000000, -0.000000000000000,  0.075967049250725,
                                 0.115049238064861, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.054011840126955,
                                -0.070321069977005, -0.000000000000000, -0.000000000000000,
                                 0.261451013515687, -0.010452128679420, -0.000000000000000,
                                -0.000000000000000,  0.199720774523800,  0.100013792684676,
                                -0.000000000000000, -0.000000000000000,  0.429229717858771,
                                 0.138214702796754, -0.000000000000000, -0.000000000000000,
                                 0.315585801089822,  0.340110651005250, -0.000000000000000,
                                -0.000000000000000, -0.077291229174584, -0.024050818259079,
                                -0.000000000000000, -0.000000000000000,  0.396412073594941,
                                 0.539712447041572, -0.000000000000000, -0.000000000000000,
                                 0.188138170831583,  0.221398658686560, -0.000000000000000,
                                -0.000000000000000,  0.089341650627899,  0.275093474247700,
                                -0.000000000000000, -0.000000000000000,  0.000077378246744,
                                -0.109878384203579, -0.000000000000000, -0.000000000000000,
                                 0.090056029818443, -0.093643508155960, -0.000000000000000,
                                -0.000000000000000,  0.088292451593159,  0.085899469870043,
                                -0.000000000000000, -0.000000000000000,  0.168594837395263,
                                 0.082314405728808, -0.000000000000000, -0.000000000000000,
                                 0.213547469735532,  0.342664202515125, -0.000000000000000,
                                -0.000000000000000, -0.026143232606206, -0.018559508949901,
                                -0.000000000000000, -0.000000000000000,  0.313381421021922,
                                 0.559745036512469, -0.000000000000000, -0.000000000000000,
                                 0.138238966351108,  0.220766697303034, -0.000000000000000,
                                -0.000000000000000,  0.111533811663804,  0.330921979219361,
                                -0.058596648507642, -0.003244370538399,  0.000000000000000,
                                 0.000000000000000, -0.298765996493404, -0.183644016970332,
                                -0.000000000000000, -0.000000000000000, -0.230290840493969,
                                -0.175756089751298,  0.000000000000000,  0.000000000000000,
                                -0.491276515690982, -0.338017637026855, -0.000000000000000,
                                -0.000000000000000, -0.379414592676761, -0.418948247420208,
                                -0.000000000000000, -0.000000000000000,  0.087211083990605,
                                 0.052496690349375, -0.000000000000000, -0.000000000000000,
                                -0.486040202460392, -0.612359208249097, -0.000000000000000,
                                -0.000000000000000, -0.228763877214316, -0.270853014917516,
                                -0.000000000000000, -0.000000000000000, -0.116327699787581,
                                -0.214512780126291, -0.000000000000000, -0.000000000000000,
                                 0.032817307061399,  0.073252256135719,  0.000000000000000,
                                -0.000000000000000,  0.009920353511368,  0.062429005437307,
                                -0.000000000000000, -0.000000000000000, -0.041995727560930,
                                -0.057266313246696,  0.000000000000000, -0.000000000000000,
                                -0.055608825551944, -0.054876270485872, -0.000000000000000,
                                -0.000000000000000, -0.146491912995599, -0.228442801676750,
                                -0.000000000000000, -0.000000000000000,  0.009932850582475,
                                 0.012373005966601, -0.000000000000000, -0.000000000000000,
                                -0.233597986062610, -0.373163357674979, -0.000000000000000,
                                -0.000000000000000, -0.095257870618962, -0.147177798202023,
                                -0.000000000000000, -0.000000000000000, -0.121975009053897,
                                -0.220614652812908, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 20, 36));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.086470500595766,
                                -0.075212773393199, -0.000000000000000, -0.000000000000000,
                                 0.102821505091306,  0.053629658399883, -0.000000000000000,
                                -0.000000000000000, -0.036091817774302, -0.154157808417014,
                                -0.000000000000000, -0.000000000000000,  0.080557427783240,
                                 0.068890541281514, -0.000000000000000, -0.000000000000000,
                                 0.049820639922480, -0.106035167054625, -0.000000000000000,
                                -0.000000000000000,  0.042441993164123,  0.125615268388731,
                                -0.000000000000000, -0.000000000000000, -0.033963163883738,
                                 0.000423772174817, -0.000000000000000, -0.000000000000000,
                                -0.189368112699927, -0.083122909291319, -0.000000000000000,
                                -0.000000000000000, -0.189520444493608, -0.177305025981432,
                                -0.000000000000000, -0.000000000000000, -0.051438672069565,
                                -0.072793648031345, -0.000000000000000, -0.000000000000000,
                                 0.059527465754171,  0.028018974336490, -0.000000000000000,
                                -0.000000000000000, -0.040642615234866, -0.215958239581077,
                                -0.000000000000000, -0.000000000000000,  0.036471168647061,
                                 0.078613253791579, -0.000000000000000, -0.000000000000000,
                                -0.035994390161107, -0.121485766578693, -0.000000000000000,
                                -0.000000000000000,  0.053165393708702,  0.146360868518263,
                                -0.000000000000000, -0.000000000000000, -0.004339044565433,
                                 0.001898338361336, -0.000000000000000, -0.000000000000000,
                                -0.095807099031087, -0.042915314813099, -0.000000000000000,
                                -0.000000000000000, -0.118921135706313, -0.172573857097291,
                                 0.102476793970642,  0.101293314289524, -0.000000000000000,
                                -0.000000000000000, -0.122611941379969, -0.118270254700219,
                                 0.000000000000000,  0.000000000000000,  0.044383003993619,
                                 0.076836488709540, -0.000000000000000, -0.000000000000000,
                                -0.091957290496773, -0.071519519880433, -0.000000000000000,
                                -0.000000000000000, -0.044838503027106,  0.067227808038722,
                                -0.000000000000000, -0.000000000000000, -0.055374603954894,
                                -0.102282705877772, -0.000000000000000, -0.000000000000000,
                                 0.036521103265140,  0.009150506559157, -0.000000000000000,
                                -0.000000000000000,  0.222210709223091,  0.190818151324591,
                                -0.000000000000000, -0.000000000000000,  0.226017168751111,
                                 0.233908703240082, -0.000000000000000, -0.000000000000000,
                                 0.032192328945797,  0.048529098687563, -0.000000000000000,
                                -0.000000000000000, -0.021463073810651, -0.018679316224326,
                                 0.000000000000000, -0.000000000000000,  0.070144190240895,
                                 0.143972159720718, -0.000000000000000, -0.000000000000000,
                                -0.030236783643543, -0.052408835861052, -0.000000000000000,
                                -0.000000000000000,  0.046808993056926,  0.080990511052462,
                                -0.000000000000000, -0.000000000000000, -0.055441926363210,
                                -0.097573912345508, -0.000000000000000, -0.000000000000000,
                                -0.000309618883052, -0.001265558907558, -0.000000000000000,
                                -0.000000000000000,  0.033199699414640,  0.028610209875399,
                                -0.000000000000000, -0.000000000000000,  0.075967049250725,
                                 0.115049238064861, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.098002653211133,
                                 0.017341720892328, -0.000000000000000, -0.000000000000000,
                                -0.021329273530357, -0.112767887085919, -0.000000000000000,
                                -0.000000000000000,  0.103958884182309,  0.200588929663361,
                                -0.000000000000000, -0.000000000000000,  0.058424340645450,
                                -0.062099718783504, -0.000000000000000, -0.000000000000000,
                                -0.437380922909619, -0.263836959737335, -0.000000000000000,
                                -0.000000000000000, -0.296443729792864, -0.133906929448343,
                                -0.000000000000000, -0.000000000000000, -0.396849823698136,
                                -0.441452498294028, -0.000000000000000, -0.000000000000000,
                                -0.037790404476516, -0.206895260468412, -0.000000000000000,
                                -0.000000000000000,  0.000918904181090,  0.002001318462335,
                                -0.000000000000000, -0.000000000000000,  0.029737737764729,
                                 0.007125892601662, -0.000000000000000, -0.000000000000000,
                                -0.056667596155137, -0.118840648261335, -0.000000000000000,
                                -0.000000000000000,  0.110054064302791,  0.200329255996119,
                                -0.000000000000000, -0.000000000000000,  0.028057379847541,
                                -0.141529138440425, -0.000000000000000, -0.000000000000000,
                                -0.227959446817269, -0.213880975594003, -0.000000000000000,
                                -0.000000000000000, -0.133282360840846, -0.104254650603531,
                                -0.000000000000000, -0.000000000000000, -0.297475138685627,
                                -0.411334805928510, -0.000000000000000, -0.000000000000000,
                                -0.092723103129750, -0.227508167099521, -0.000000000000000,
                                -0.000000000000000,  0.002432788199424,  0.000933414213298,
                                -0.110101753684864, -0.060279954787393, -0.000000000000000,
                                 0.000000000000000,  0.035078440187758,  0.109407544079504,
                                -0.000000000000000, -0.000000000000000, -0.133154949992716,
                                -0.213493429141677,  0.000000000000000,  0.000000000000000,
                                -0.070695945027619, -0.057994341656760, -0.000000000000000,
                                -0.000000000000000,  0.512831463951338,  0.451941498631603,
                                -0.000000000000000, -0.000000000000000,  0.343245032157339,
                                 0.266026243552509, -0.000000000000000, -0.000000000000000,
                                 0.484998291832916,  0.583548499488005, -0.000000000000000,
                                -0.000000000000000,  0.059306959988541,  0.178043246760791,
                                -0.000000000000000, -0.000000000000000, -0.001645867830292,
                                -0.004825034813593,  0.000000000000000, -0.000000000000000,
                                -0.006700780046251, -0.004750595067774, -0.000000000000000,
                                -0.000000000000000,  0.049014144730942,  0.079227098840890,
                                -0.000000000000000, -0.000000000000000, -0.086567041007584,
                                -0.133552837330746,  0.000000000000000, -0.000000000000000,
                                 0.031522117103004,  0.094352758960283, -0.000000000000000,
                                -0.000000000000000,  0.110236073712716,  0.142587317062669,
                                -0.000000000000000, -0.000000000000000,  0.055467648880107,
                                 0.069503100402354, -0.000000000000000, -0.000000000000000,
                                 0.188227196601073,  0.274223203952340, -0.000000000000000,
                                -0.000000000000000,  0.090576966115984,  0.151672111399681,
                                -0.000000000000000, -0.000000000000000, -0.000788808483685,
                                -0.000622276142199, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.055116552305753,
                                -0.014752012636892, -0.000000000000000, -0.000000000000000,
                                 0.001685714702221, -0.007922515656972, -0.000000000000000,
                                -0.000000000000000, -0.194406993092932,  0.025026311860077,
                                -0.000000000000000, -0.000000000000000,  0.070015742749406,
                                 0.410998724011078, -0.000000000000000, -0.000000000000000,
                                 0.480496591363278,  0.224651767899059, -0.000000000000000,
                                -0.000000000000000,  0.046677161832938,  0.273999149340718,
                                -0.000000000000000, -0.000000000000000,  0.081002913788722,
                                -0.010427629941699, -0.000000000000000, -0.000000000000000,
                                -0.008615875144687,  0.040492857802302, -0.000000000000000,
                                -0.000000000000000, -0.054657247703205, -0.014629079198252,
                                -0.000000000000000, -0.000000000000000, -0.017082810630612,
                                -0.011040926226320, -0.000000000000000, -0.000000000000000,
                                -0.004512537369034, -0.007670674547339, -0.000000000000000,
                                -0.000000000000000, -0.043958250084690,  0.060309573490222,
                                -0.000000000000000, -0.000000000000000,  0.213925076885934,
                                 0.411812490698240, -0.000000000000000, -0.000000000000000,
                                 0.270047447551961,  0.100613022275340, -0.000000000000000,
                                -0.000000000000000,  0.142616717923956,  0.274541660465493,
                                -0.000000000000000, -0.000000000000000,  0.018315937535288,
                                -0.025128988954259, -0.000000000000000, -0.000000000000000,
                                 0.023064079886175,  0.039205669908622, -0.000000000000000,
                                -0.000000000000000, -0.016940453875357, -0.010948918507767,
                                 0.061797407757912,  0.034398464967254, -0.000000000000000,
                                -0.000000000000000, -0.000651936040582,  0.008721801375274,
                                -0.000000000000000, -0.000000000000000,  0.216367304998231,
                                 0.091948677535003, -0.000000000000000, -0.000000000000000,
                                -0.121433757299335, -0.412607344554185,  0.000000000000000,
                                -0.000000000000000, -0.571629711121489, -0.537525299287755,
                                -0.000000000000000, -0.000000000000000, -0.080955838199557,
                                -0.275071563036123,  0.000000000000000,  0.000000000000000,
                                -0.090153043749263, -0.038311948972918, -0.000000000000000,
                                -0.000000000000000,  0.003332117540750, -0.044578095918069,
                                 0.000000000000000, -0.000000000000000,  0.061282429359930,
                                 0.034111811092527, -0.000000000000000, -0.000000000000000,
                                 0.006063124098759,  0.007360617484213, -0.000000000000000,
                                -0.000000000000000,  0.003399368089516,  0.005113783031559,
                                -0.000000000000000, -0.000000000000000, -0.013356615885486,
                                -0.040206382326815, -0.000000000000000, -0.000000000000000,
                                -0.177532885869594, -0.274541660465493, -0.000000000000000,
                                -0.000000000000000, -0.088785615374404, -0.067075348183560,
                                -0.000000000000000, -0.000000000000000, -0.118355257246396,
                                -0.183027773643662,  0.000000000000000, -0.000000000000000,
                                 0.005565256618952,  0.016752659302839, -0.000000000000000,
                                -0.000000000000000, -0.017374548013082, -0.026137113272415,
                                -0.000000000000000, -0.000000000000000,  0.006012598064602,
                                 0.007299279005178, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.038950561674818,
                                -0.004900488447302, -0.000000000000000, -0.000000000000000,
                                 0.045719310983227,  0.244615774396101, -0.000000000000000,
                                -0.000000000000000,  0.341254862753980,  0.409013474340416,
                                -0.000000000000000, -0.000000000000000, -0.296443729792864,
                                -0.133906929448343, -0.000000000000000, -0.000000000000000,
                                -0.291587281939746, -0.175891306491557, -0.000000000000000,
                                -0.000000000000000,  0.305460782139504,  0.049489389090115,
                                -0.000000000000000, -0.000000000000000,  0.388110906785769,
                                 0.366388385426268, -0.000000000000000, -0.000000000000000,
                                -0.013466441244536, -0.075361710774295, -0.000000000000000,
                                -0.000000000000000,  0.105774616719064,  0.017934181090261,
                                -0.000000000000000, -0.000000000000000, -0.009485711540139,
                                -0.001893359579945, -0.000000000000000, -0.000000000000000,
                                 0.118332054397547,  0.261655734394008, -0.000000000000000,
                                -0.000000000000000,  0.266922667401449,  0.385756131635972,
                                -0.000000000000000, -0.000000000000000, -0.133282360840846,
                                -0.104254650603531, -0.000000000000000, -0.000000000000000,
                                -0.151972964544846, -0.142587317062669, -0.000000000000000,
                                -0.000000000000000,  0.139126013881579, -0.054650262937482,
                                -0.000000000000000, -0.000000000000000,  0.266211139755260,
                                 0.331064702380203, -0.000000000000000, -0.000000000000000,
                                -0.031272052814570, -0.084977644027635, -0.000000000000000,
                                -0.000000000000000,  0.031179038681927,  0.007322062341580,
                                 0.043094654068594,  0.019343248364023, -0.000000000000000,
                                -0.000000000000000, -0.074029620616990, -0.228063873405773,
                                -0.000000000000000, -0.000000000000000, -0.419167707176644,
                                -0.522785032770584,  0.000000000000000, -0.000000000000000,
                                 0.343245032157339,  0.266026243552508, -0.000000000000000,
                                -0.000000000000000,  0.341887642634226,  0.301294332421069,
                                -0.000000000000000, -0.000000000000000, -0.356733471825402,
                                -0.279682877950517, -0.000000000000000, -0.000000000000000,
                                -0.469622382680324, -0.524062259030716,  0.000000000000000,
                                 0.000000000000000,  0.020478468397880,  0.059803755989897,
                                -0.000000000000000, -0.000000000000000, -0.118572024909442,
                                -0.063246825898201,  0.000000000000000, -0.000000000000000,
                                 0.001876733882679,  0.001262239719963, -0.000000000000000,
                                -0.000000000000000, -0.106587014185970, -0.174437156262672,
                                -0.000000000000000, -0.000000000000000, -0.174755665426527,
                                -0.257170754423982, -0.000000000000000, -0.000000000000000,
                                 0.055467648880107,  0.069503100402354, -0.000000000000000,
                                -0.000000000000000,  0.073490715808478,  0.095058211375113,
                                -0.000000000000000, -0.000000000000000, -0.014700923630418,
                                 0.036433508624988, -0.000000000000000, -0.000000000000000,
                                -0.155421533677483, -0.220709801586802,  0.000000000000000,
                                -0.000000000000000,  0.033137513728206,  0.056651762685090,
                                -0.000000000000000, -0.000000000000000, -0.006923103159613,
                                -0.004881374894386,  0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.182167756750413,
                                 0.175996218400398, -0.000000000000000, -0.000000000000000,
                                 0.135583226872768,  0.079022863778954, -0.000000000000000,
                                -0.000000000000000, -0.033963163883738,  0.000423772174817,
                                -0.000000000000000, -0.000000000000000, -0.018923748610901,
                                -0.132299105328669, -0.000000000000000, -0.000000000000000,
                                -0.020758599967700,  0.044181319606094, -0.000000000000000,
                                -0.000000000000000, -0.039646933266557,  0.103052374530086,
                                -0.000000000000000, -0.000000000000000, -0.103452092810383,
                                -0.153317326936960, -0.000000000000000, -0.000000000000000,
                                 0.113812721290491,  0.054467523646966, -0.000000000000000,
                                -0.000000000000000, -0.068399583255910, -0.071996078432564,
                                -0.000000000000000, -0.000000000000000,  0.117070924280370,
                                 0.171703845415175, -0.000000000000000, -0.000000000000000,
                                 0.085832759188270,  0.041557747056449, -0.000000000000000,
                                -0.000000000000000, -0.004339044565433,  0.001898338361336,
                                -0.000000000000000, -0.000000000000000, -0.052702985930135,
                                -0.154893164867531, -0.000000000000000, -0.000000000000000,
                                 0.014997662567128,  0.050619069407789, -0.000000000000000,
                                -0.000000000000000,  0.034107751112164,  0.122222768465617,
                                -0.000000000000000, -0.000000000000000, -0.049248386956308,
                                -0.212193201831093, -0.000000000000000, -0.000000000000000,
                                 0.061565773058734,  0.028296400243209, -0.000000000000000,
                                -0.000000000000000, -0.046891352924886, -0.070655394682183,
                                -0.217881237167018, -0.230154429140795, -0.000000000000000,
                                -0.000000000000000, -0.163593273580981, -0.170286296820144,
                                 0.000000000000000, -0.000000000000000,  0.036521103265140,
                                 0.009150506559157, -0.000000000000000, -0.000000000000000,
                                 0.030606204417814,  0.100783733694909,  0.000000000000000,
                                -0.000000000000000,  0.018682709594628, -0.028011586682801,
                                -0.000000000000000, -0.000000000000000,  0.034636751581634,
                                -0.063858106501355, -0.000000000000000, -0.000000000000000,
                                 0.116816525469481,  0.094984993385202, -0.000000000000000,
                                -0.000000000000000, -0.134590713822746, -0.122466044062937,
                                 0.000000000000000,  0.000000000000000,  0.082480875161912,
                                 0.092066324202508, -0.000000000000000, -0.000000000000000,
                                -0.075438509161234, -0.114469230276783, -0.000000000000000,
                                -0.000000000000000, -0.031661140560533, -0.027705164704299,
                                -0.000000000000000, -0.000000000000000, -0.000309618883052,
                                -0.001265558907558, -0.000000000000000, -0.000000000000000,
                                 0.058467951632579,  0.103262109911687, -0.000000000000000,
                                -0.000000000000000, -0.019503747107053, -0.033746046271859,
                                -0.000000000000000, -0.000000000000000, -0.045703135020317,
                                -0.081481845643745, -0.000000000000000, -0.000000000000000,
                                 0.069530112789509,  0.141462134554062, -0.000000000000000,
                                -0.000000000000000, -0.021777486172797, -0.018864266828806,
                                 0.000000000000000, -0.000000000000000,  0.030893320392519,
                                 0.047103596454789, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 20, 36));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeGDForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 4);
    
    CGtoBlock kgtos(mlih, mbas, 2);
    
    CDenseMatrix lmomxmat(36, 20);
    
    CDenseMatrix lmomymat(36, 20);
    
    CDenseMatrix lmomzmat(36, 20);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);

    std::vector<double> intxvals{ 0.000000000000000,  0.000000000000000, -0.220390383600852,
                                -0.123825218176087,  0.000000000000000,  0.000000000000000,
                                -0.102476793970642, -0.032192328945797,  0.000000000000000,
                                 0.000000000000000, -0.093803926521932, -0.016684613696234,
                                 0.000000000000000,  0.000000000000000,  0.330122733763516,
                                 0.091600554931584,  0.000000000000000,  0.000000000000000,
                                -0.055278074929091, -0.103556625122395,  0.000000000000000,
                                 0.000000000000000, -0.280922669986506, -0.210512894284676,
                                 0.000000000000000,  0.000000000000000, -0.101293314289524,
                                -0.048529098687563,  0.000000000000000,  0.000000000000000,
                                -0.068829907520039, -0.023070406911215,  0.000000000000000,
                                 0.000000000000000,  0.307419280316391,  0.135266852532839,
                                 0.000000000000000,  0.000000000000000, -0.155378826416954,
                                -0.193020740902393,  0.180391701282824,  0.144309278018775,
                                -0.000000000000000, -0.000000000000000,  0.086470500595766,
                                 0.051438672069565,  0.000000000000000,  0.000000000000000,
                                 0.081741458715702,  0.034568283035268,  0.000000000000000,
                                 0.000000000000000, -0.280435717461150, -0.155713351778934,
                                 0.000000000000000,  0.000000000000000,  0.037706032214246,
                                 0.081529340078388, -0.000000000000000,  0.000000000000000,
                                 0.282907530420044,  0.315769341427014, -0.000000000000000,
                                 0.000000000000000,  0.075212773393199,  0.072793648031345,
                                 0.000000000000000,  0.000000000000000,  0.039649287983960,
                                 0.034605610366822,  0.000000000000000,  0.000000000000000,
                                -0.214883669395448, -0.202900278799259,  0.000000000000000,
                                 0.000000000000000,  0.232008395307345,  0.289531111353590,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.120214315683691, -0.121803047184818,
                                 0.000000000000000,  0.000000000000000,  0.122611941379969,
                                 0.021463073810651,  0.000000000000000,  0.000000000000000,
                                -0.411345307529447, -0.075280334556718,  0.000000000000000,
                                 0.000000000000000,  0.100320620723926,  0.027891494394940,
                                 0.000000000000000,  0.000000000000000,  0.387497323962137,
                                 0.118114454943086,  0.000000000000000,  0.000000000000000,
                                -0.198166231624365, -0.226841237044708,  0.000000000000000,
                                 0.000000000000000,  0.118270254700219,  0.018679316224326,
                                 0.000000000000000,  0.000000000000000, -0.310319709031109,
                                -0.103670892999290,  0.000000000000000,  0.000000000000000,
                                 0.136107182971085,  0.025040056813523,  0.000000000000000,
                                 0.000000000000000,  0.380122015344783,  0.176590077661649,
                                 0.095382143233882,  0.103196864793256,  0.000000000000000,
                                 0.000000000000000, -0.102821505091306, -0.059527465754171,
                                -0.000000000000000, -0.000000000000000,  0.357321542918646,
                                 0.155919076576358,  0.000000000000000,  0.000000000000000,
                                -0.079199287534772, -0.068977455213440, -0.000000000000000,
                                 0.000000000000000, -0.327110053615453, -0.192887611402597,
                                 0.000000000000000,  0.000000000000000,  0.273173751031077,
                                 0.340261855567063,  0.000000000000000,  0.000000000000000,
                                -0.053629658399883, -0.028018974336490, -0.000000000000000,
                                 0.000000000000000,  0.178991745658111,  0.155506339498935,
                                 0.000000000000000,  0.000000000000000, -0.069262234842465,
                                -0.037560085220284,  0.000000000000000,  0.000000000000000,
                                -0.276393819289879, -0.264885116492474,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.074580201921790,  0.109175944411187,  0.000000000000000,
                                 0.000000000000000, -0.044383003993619, -0.070144190240895,
                                 0.000000000000000,  0.000000000000000,  0.015527179519232,
                                -0.021756352217819,  0.000000000000000,  0.000000000000000,
                                -0.265169657015133,  0.043940645399055,  0.000000000000000,
                                 0.000000000000000, -0.093985581253507, -0.012341321066475,
                                 0.000000000000000,  0.000000000000000,  0.215184467959690,
                                 0.185119092660257,  0.000000000000000,  0.000000000000000,
                                -0.076836488709540, -0.143972159720718,  0.000000000000000,
                                 0.000000000000000, -0.004513683902065, -0.049932989742509,
                                 0.000000000000000,  0.000000000000000, -0.034339181250273,
                                 0.089235008666063,  0.000000000000000,  0.000000000000000,
                                -0.059681872960873, -0.016057290110288, -0.048262799533130,
                                -0.111898020892470,  0.000000000000000,  0.000000000000000,
                                 0.036091817774302,  0.040642615234866,  0.000000000000000,
                                 0.000000000000000, -0.014397842745115,  0.003022311808226,
                                -0.000000000000000,  0.000000000000000,  0.247976303301054,
                                 0.013511683201587,  0.000000000000000,  0.000000000000000,
                                 0.082956203030931,  0.029800777305883,  0.000000000000000,
                                 0.000000000000000, -0.248994014389027, -0.277678638990386,
                                 0.000000000000000,  0.000000000000000,  0.154157808417014,
                                 0.215958239581077,  0.000000000000000,  0.000000000000000,
                                 0.046497571502689,  0.074899484613764,  0.000000000000000,
                                 0.000000000000000, -0.095367334627414, -0.133852512999095,
                                 0.000000000000000,  0.000000000000000,  0.029660972986602,
                                 0.024085935165432,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.042714305330314,
                                 0.034203013741014,  0.000000000000000,  0.000000000000000,
                                 0.091957290496773,  0.030236783643543,  0.000000000000000,
                                 0.000000000000000,  0.183701027430938,  0.065125339370810,
                                 0.000000000000000,  0.000000000000000,  0.055374603954894,
                                 0.055441926363211,  0.000000000000000,  0.000000000000000,
                                -0.087211083990605, -0.009932850582475,  0.000000000000000,
                                 0.000000000000000,  0.012210161689508,  0.071659619618521,
                                 0.000000000000000,  0.000000000000000,  0.071519519880433,
                                 0.052408835861052,  0.000000000000000,  0.000000000000000,
                                 0.187428813222518,  0.101202301157208,  0.000000000000000,
                                 0.000000000000000,  0.102282705877772,  0.097573912345508,
                                 0.000000000000000,  0.000000000000000, -0.052496690349374,
                                -0.012373005966601,  0.040742364988703, -0.007696671778040,
                                 0.000000000000000,  0.000000000000000, -0.080557427783240,
                                -0.036471168647061,  0.000000000000000,  0.000000000000000,
                                -0.154741226442700, -0.095479574413678,  0.000000000000000,
                                 0.000000000000000, -0.042441993164122, -0.053165393708702,
                                 0.000000000000000,  0.000000000000000,  0.077291229174584,
                                 0.026143232606206,  0.000000000000000,  0.000000000000000,
                                -0.074439105794478, -0.107489429427782,  0.000000000000000,
                                 0.000000000000000, -0.068890541281514, -0.078613253791579,
                                 0.000000000000000,  0.000000000000000, -0.151254406113592,
                                -0.151803451735813,  0.000000000000000,  0.000000000000000,
                                -0.125615268388731, -0.146360868518263,  0.000000000000000,
                                 0.000000000000000,  0.024050818259079,  0.018559508949901,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.245634306555720, -0.124975984630721,
                                 0.000000000000000,  0.000000000000000,  0.044838503027107,
                                -0.046808993056926,  0.000000000000000,  0.000000000000000,
                                 0.043192510978224,  0.062058157958969,  0.000000000000000,
                                 0.000000000000000,  0.157035746962169,  0.110540453776032,
                                 0.000000000000000,  0.000000000000000, -0.550232586497931,
                                -0.145474449474573,  0.000000000000000,  0.000000000000000,
                                -0.323594656461282, -0.199676697602261,  0.000000000000000,
                                 0.000000000000000, -0.067227808038722, -0.080990511052462,
                                 0.000000000000000,  0.000000000000000,  0.111852533031937,
                                 0.109901388176604,  0.000000000000000,  0.000000000000000,
                                 0.196664397265976,  0.204542067192200,  0.000000000000000,
                                 0.000000000000000, -0.491195700411085, -0.216219876838921,
                                 0.198770602995543,  0.165756404021745, -0.000000000000000,
                                 0.000000000000000, -0.049820639922480,  0.035994390161107,
                                 0.000000000000000,  0.000000000000000, -0.029627876518545,
                                -0.058252497089443,  0.000000000000000,  0.000000000000000,
                                -0.130385590738876, -0.101732395563679,  0.000000000000000,
                                 0.000000000000000,  0.469979863158281,  0.248567348076549,
                                -0.000000000000000, -0.000000000000000,  0.288676840022087,
                                 0.299515046403391,  0.000000000000000,  0.000000000000000,
                                 0.106035167054625,  0.121485766578693,  0.000000000000000,
                                 0.000000000000000, -0.140469524987453, -0.164852082264906,
                                 0.000000000000000,  0.000000000000000, -0.248448042624986,
                                -0.306813100788299,  0.000000000000000,  0.000000000000000,
                                 0.341037791743860,  0.324329815258382, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.748635629060931, -0.178200896112991,  0.000000000000000,
                                 0.000000000000000,  0.055374603954894,  0.055441926363210,
                                 0.000000000000000,  0.000000000000000,  0.196031877627964,
                                -0.060111767725926,  0.000000000000000,  0.000000000000000,
                                 0.022683787333504,  0.121643053684177,  0.000000000000000,
                                 0.000000000000000,  0.059910605200957,  0.084614545723487,
                                 0.000000000000000,  0.000000000000000, -0.643159161205622,
                                -0.257163633816126,  0.000000000000000,  0.000000000000000,
                                 0.102282705877772,  0.097573912345509,  0.000000000000000,
                                 0.000000000000000,  0.065397404671583, -0.148499712888482,
                                 0.000000000000000,  0.000000000000000,  0.199235732883142,
                                 0.215372527148542,  0.000000000000000,  0.000000000000000,
                                 0.154201088686685,  0.149115919388732,  0.641754625191725,
                                 0.324801067416595,  0.000000000000000,  0.000000000000000,
                                -0.042441993164122, -0.053165393708702,  0.000000000000000,
                                 0.000000000000000, -0.176118795306892, -0.029527223027556,
                                 0.000000000000000,  0.000000000000000, -0.001263561250125,
                                -0.104686670871389,  0.000000000000000,  0.000000000000000,
                                -0.041156445488847, -0.080286691613394,  0.000000000000000,
                                 0.000000000000000,  0.419938063964819,  0.385745450724189,
                                 0.000000000000000,  0.000000000000000, -0.125615268388731,
                                -0.146360868518263,  0.000000000000000,  0.000000000000000,
                                 0.125077769687256,  0.222749569332723,  0.000000000000000,
                                 0.000000000000000, -0.274995290341686, -0.323058790722813,
                                 0.000000000000000,  0.000000000000000, -0.191691335291362,
                                -0.223673879083098,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.093985581253507,
                                -0.012341321066475,  0.000000000000000,  0.000000000000000,
                                -0.036521103265140,  0.000309618883052,  0.000000000000000,
                                 0.000000000000000, -0.193001270983341, -0.047910624657077,
                                 0.000000000000000,  0.000000000000000, -0.021546294740317,
                                -0.087709707171177,  0.000000000000000,  0.000000000000000,
                                 0.573619549454870,  0.196409442244973,  0.000000000000000,
                                 0.000000000000000, -0.059681872960873, -0.016057290110288,
                                 0.000000000000000,  0.000000000000000, -0.009150506559157,
                                 0.001265558907558,  0.000000000000000,  0.000000000000000,
                                -0.137566437199856, -0.080842126569929,  0.000000000000000,
                                 0.000000000000000, -0.084489712263904, -0.178116071953439,
                                 0.000000000000000,  0.000000000000000,  0.586578227925801,
                                 0.303466158951136,  0.082956203030931,  0.029800777305883,
                                 0.000000000000000,  0.000000000000000,  0.033963163883738,
                                 0.004339044565433,  0.000000000000000,  0.000000000000000,
                                 0.169627797909638,  0.069518591858966, -0.000000000000000,
                                -0.000000000000000,  0.014279951386501,  0.045426454191244,
                                 0.000000000000000,  0.000000000000000, -0.482194096617488,
                                -0.298328421332475,  0.000000000000000,  0.000000000000000,
                                 0.029660972986601,  0.024085935165432,  0.000000000000000,
                                 0.000000000000000, -0.000423772174817, -0.001898338361336,
                                 0.000000000000000,  0.000000000000000,  0.110031468166585,
                                 0.121263189854893, -0.000000000000000,  0.000000000000000,
                                 0.192877144625542,  0.267174107930159,  0.000000000000000,
                                 0.000000000000000, -0.456954686037515, -0.455199238426705,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.240269822003080, -0.096005339181779,
                                 0.000000000000000,  0.000000000000000, -0.222210709223091,
                                -0.033199699414640,  0.000000000000000,  0.000000000000000,
                                 0.048312963663477,  0.019290978199400,  0.000000000000000,
                                 0.000000000000000,  0.457984272869916,  0.041044566574718,
                                 0.000000000000000,  0.000000000000000,  0.065474851912648,
                                -0.097299858883043,  0.000000000000000,  0.000000000000000,
                                -0.276162360265594, -0.147998053082204,  0.000000000000000,
                                 0.000000000000000, -0.190818151324591, -0.028610209875399,
                                 0.000000000000000,  0.000000000000000,  0.060789003011506,
                                 0.028536180604363,  0.000000000000000,  0.000000000000000,
                                 0.297159292624790,  0.032485929381664,  0.000000000000000,
                                 0.000000000000000, -0.076758871679719, -0.195658095323129,
                                 0.198536441557903,  0.140855560442935,  0.000000000000000,
                                 0.000000000000000,  0.189368112699927,  0.095807099031087,
                                 0.000000000000000,  0.000000000000000, -0.039109215323060,
                                -0.030942719584672,  0.000000000000000,  0.000000000000000,
                                -0.401997300129139, -0.147715104485646, -0.000000000000000,
                                -0.000000000000000, -0.067987776913337,  0.042572744710351,
                                 0.000000000000000,  0.000000000000000,  0.223249592118196,
                                 0.221997079623306,  0.000000000000000,  0.000000000000000,
                                 0.083122909291319,  0.042915314813099,  0.000000000000000,
                                 0.000000000000000, -0.045198545007268, -0.042804270906545,
                                 0.000000000000000,  0.000000000000000, -0.104355182655687,
                                -0.048728894072496, -0.000000000000000,  0.000000000000000,
                                 0.214087789793438,  0.293487142984694,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.121555306916179,  0.112676459658541,  0.000000000000000,
                                 0.000000000000000, -0.226017168751111, -0.075967049250725,
                                 0.000000000000000,  0.000000000000000,  0.244232416472301,
                                 0.058631573547522,  0.000000000000000,  0.000000000000000,
                                 0.028825275629615, -0.014865958336922,  0.000000000000000,
                                 0.000000000000000, -0.227267820150945, -0.125255812524488,
                                 0.000000000000000,  0.000000000000000,  0.199786234350836,
                                 0.204690340942913,  0.000000000000000,  0.000000000000000,
                                -0.233908703240082, -0.115049238064861,  0.000000000000000,
                                 0.000000000000000,  0.210625525697729,  0.084752538707073,
                                 0.000000000000000,  0.000000000000000, -0.015445346786709,
                                -0.026479287717533,  0.000000000000000,  0.000000000000000,
                                -0.286921265217194, -0.212422373152210, -0.095883371075834,
                                -0.103720731242549,  0.000000000000000,  0.000000000000000,
                                 0.189520444493608,  0.118921135706313,  0.000000000000000,
                                 0.000000000000000, -0.209282495677544, -0.106386117557373,
                                -0.000000000000000, -0.000000000000000, -0.029049477782237,
                                 0.008570945655476,  0.000000000000000,  0.000000000000000,
                                 0.186255680232626,  0.147328122544535, -0.000000000000000,
                                -0.000000000000000, -0.253976040049989, -0.307035511414369,
                                 0.000000000000000,  0.000000000000000,  0.177305025981432,
                                 0.172573857097291,  0.000000000000000,  0.000000000000000,
                                -0.138123978006860, -0.127128808060609, -0.000000000000000,
                                 0.000000000000000,  0.033432689529138,  0.039718931576300,
                                 0.000000000000000,  0.000000000000000,  0.286324282327791,
                                 0.318633559728315, -0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 36, 20));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.174656587545941,
                                 0.130578489866252,  0.000000000000000,  0.000000000000000,
                                -0.105639740570521, -0.059276463390884,  0.000000000000000,
                                 0.000000000000000,  0.224640515216460,  0.056412139143934,
                                 0.000000000000000,  0.000000000000000, -0.102476793970642,
                                -0.032192328945797,  0.000000000000000,  0.000000000000000,
                                 0.058596648507642, -0.032817307061399,  0.000000000000000,
                                 0.000000000000000,  0.255252474957906,  0.231717618103942,
                                 0.000000000000000,  0.000000000000000, -0.152889577965199,
                                -0.093671608020728,  0.000000000000000,  0.000000000000000,
                                 0.198866565465113,  0.081990223725631,  0.000000000000000,
                                 0.000000000000000, -0.101293314289524, -0.048529098687563,
                                 0.000000000000000,  0.000000000000000,  0.003244370538399,
                                -0.073252256135719, -0.140335830119818, -0.131917651085755,
                                 0.000000000000000,  0.000000000000000,  0.083899796039677,
                                 0.078428496781805,  0.000000000000000,  0.000000000000000,
                                -0.191914805944683, -0.100530765765844, -0.000000000000000,
                                 0.000000000000000,  0.086470500595766,  0.051438672069565,
                                 0.000000000000000,  0.000000000000000, -0.054011840126955,
                                -0.000077378246744, -0.000000000000000, -0.000000000000000,
                                -0.295782488132192, -0.347576427155913,  0.000000000000000,
                                 0.000000000000000,  0.137108767405347,  0.140507412031092,
                                 0.000000000000000,  0.000000000000000, -0.132749097388255,
                                -0.122985335588446,  0.000000000000000,  0.000000000000000,
                                 0.075212773393199,  0.072793648031345,  0.000000000000000,
                                 0.000000000000000,  0.070321069977005,  0.109878384203579,
                                -0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.399003268750900,  0.118861923505902,
                                 0.000000000000000,  0.000000000000000, -0.226865926438036,
                                -0.035430786726126,  0.000000000000000,  0.000000000000000,
                                 0.221645849135445,  0.036297173655518,  0.000000000000000,
                                 0.000000000000000,  0.122611941379969,  0.021463073810651,
                                 0.000000000000000,  0.000000000000000,  0.298765996493404,
                                -0.009920353511368,  0.000000000000000,  0.000000000000000,
                                 0.385431360692861,  0.177410332541830,  0.000000000000000,
                                 0.000000000000000, -0.204465410669202, -0.030370272595076,
                                 0.000000000000000,  0.000000000000000,  0.157271774779828,
                                 0.049181659333699,  0.000000000000000,  0.000000000000000,
                                 0.118270254700219,  0.018679316224326,  0.000000000000000,
                                 0.000000000000000,  0.183644016970332, -0.062429005437307,
                                -0.337508324341773, -0.195504205494424,  0.000000000000000,
                                 0.000000000000000,  0.191967166210765,  0.102688063163101,
                                 0.000000000000000,  0.000000000000000, -0.193703257290777,
                                -0.078857558831241,  0.000000000000000,  0.000000000000000,
                                -0.102821505091306, -0.059527465754171, -0.000000000000000,
                                -0.000000000000000, -0.261451013515687, -0.090056029818443,
                                 0.000000000000000,  0.000000000000000, -0.278244752721515,
                                -0.266115498812745,  0.000000000000000,  0.000000000000000,
                                 0.088783492715443,  0.045555408892614,  0.000000000000000,
                                 0.000000000000000, -0.086575829421663, -0.073772489000549,
                                 0.000000000000000,  0.000000000000000, -0.053629658399883,
                                -0.028018974336490, -0.000000000000000,  0.000000000000000,
                                 0.010452128679420,  0.093643508155960,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.486259424604597,  0.224780093921630,  0.000000000000000,
                                 0.000000000000000, -0.192127450484852,  0.043321407632952,
                                 0.000000000000000,  0.000000000000000,  0.166776625317562,
                                 0.011192988145965,  0.000000000000000,  0.000000000000000,
                                -0.044383003993619, -0.070144190240895,  0.000000000000000,
                                 0.000000000000000,  0.230290840493969,  0.041995727560930,
                                 0.000000000000000,  0.000000000000000,  0.590284835579140,
                                 0.359714519742111,  0.000000000000000,  0.000000000000000,
                                -0.016038168131959,  0.086703890850948,  0.000000000000000,
                                 0.000000000000000,  0.100496504012838,  0.003290929972883,
                                 0.000000000000000,  0.000000000000000, -0.076836488709540,
                                -0.143972159720718,  0.000000000000000,  0.000000000000000,
                                 0.175756089751298,  0.057266313246696, -0.399273270630985,
                                -0.301958242315495,  0.000000000000000,  0.000000000000000,
                                 0.180049975533577,  0.004833594070721,  0.000000000000000,
                                 0.000000000000000, -0.147464992399088, -0.049911061861297,
                                -0.000000000000000, -0.000000000000000,  0.036091817774302,
                                 0.040642615234866,  0.000000000000000,  0.000000000000000,
                                -0.199720774523800, -0.088292451593159, -0.000000000000000,
                                -0.000000000000000, -0.519210603598241, -0.539571779613167,
                                 0.000000000000000,  0.000000000000000, -0.094519790277780,
                                -0.130055836276422,  0.000000000000000,  0.000000000000000,
                                -0.029796301432663, -0.004936394959324, -0.000000000000000,
                                 0.000000000000000,  0.154157808417014,  0.215958239581077,
                                 0.000000000000000,  0.000000000000000, -0.100013792684676,
                                -0.085899469870043, -0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.574213461079722,
                                -0.158335194948041,  0.000000000000000,  0.000000000000000,
                                 0.116587012790522,  0.172377829628369,  0.000000000000000,
                                 0.000000000000000,  0.349116067153746, -0.005840651583584,
                                 0.000000000000000,  0.000000000000000,  0.091957290496773,
                                 0.030236783643543,  0.000000000000000,  0.000000000000000,
                                 0.491276515690982,  0.055608825551944,  0.000000000000000,
                                 0.000000000000000, -0.538165780506873, -0.232417621882925,
                                 0.000000000000000,  0.000000000000000,  0.303850173267590,
                                 0.304098132168883,  0.000000000000000,  0.000000000000000,
                                 0.221588082357015, -0.064164461924142,  0.000000000000000,
                                 0.000000000000000,  0.071519519880433,  0.052408835861052,
                                 0.000000000000000,  0.000000000000000,  0.338017637026855,
                                 0.054876270485872,  0.487172166842557,  0.272514602204183,
                                 0.000000000000000,  0.000000000000000, -0.080289490385925,
                                -0.158571365568972,  0.000000000000000,  0.000000000000000,
                                -0.305069817342475, -0.109093535038954,  0.000000000000000,
                                 0.000000000000000, -0.080557427783240, -0.036471168647061,
                                 0.000000000000000,  0.000000000000000, -0.429229717858771,
                                -0.168594837395263,  0.000000000000000,  0.000000000000000,
                                 0.371836427446661,  0.348626432824387,  0.000000000000000,
                                 0.000000000000000, -0.390213479046069, -0.456147198253325,
                                 0.000000000000000,  0.000000000000000, -0.000967568740737,
                                 0.096246692886213,  0.000000000000000,  0.000000000000000,
                                -0.068890541281514, -0.078613253791579,  0.000000000000000,
                                 0.000000000000000, -0.138214702796754, -0.082314405728808,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.133533320342944, -0.035504148942973,
                                 0.000000000000000,  0.000000000000000,  0.194401166151425,
                                 0.071532959561927,  0.000000000000000,  0.000000000000000,
                                 0.064788766467337,  0.093087236938453,  0.000000000000000,
                                 0.000000000000000,  0.044838503027107, -0.046808993056926,
                                 0.000000000000000,  0.000000000000000,  0.379414592676761,
                                 0.146491912995599,  0.000000000000000,  0.000000000000000,
                                -0.003832902176575, -0.069193122680419,  0.000000000000000,
                                 0.000000000000000,  0.140641223900375,  0.137049974648481,
                                 0.000000000000000,  0.000000000000000,  0.167778799547906,
                                 0.164852082264906,  0.000000000000000,  0.000000000000000,
                                -0.067227808038722, -0.080990511052462,  0.000000000000000,
                                 0.000000000000000,  0.418948247420208,  0.228442801676750,
                                -0.127075593768037,  0.004301901094969, -0.000000000000000,
                                -0.000000000000000, -0.171902790674277, -0.071737070429423,
                                 0.000000000000000,  0.000000000000000, -0.044441814777818,
                                -0.087378745634164,  0.000000000000000,  0.000000000000000,
                                -0.049820639922480,  0.035994390161107,  0.000000000000000,
                                 0.000000000000000, -0.315585801089822, -0.213547469735532,
                                 0.000000000000000,  0.000000000000000,  0.078153868941032,
                                 0.103789684020629, -0.000000000000000,  0.000000000000000,
                                -0.160085403412798, -0.205574961972722,  0.000000000000000,
                                 0.000000000000000, -0.210704287481180, -0.247278123397360,
                                 0.000000000000000,  0.000000000000000,  0.106035167054625,
                                 0.121485766578693,  0.000000000000000,  0.000000000000000,
                                -0.340110651005250, -0.342664202515125,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.042714305330314,  0.034203013741014,  0.000000000000000,
                                 0.000000000000000,  0.091957290496773,  0.030236783643543,
                                 0.000000000000000,  0.000000000000000,  0.183701027430938,
                                 0.065125339370810,  0.000000000000000,  0.000000000000000,
                                 0.055374603954894,  0.055441926363210,  0.000000000000000,
                                 0.000000000000000, -0.087211083990605, -0.009932850582475,
                                 0.000000000000000,  0.000000000000000,  0.012210161689508,
                                 0.071659619618521,  0.000000000000000,  0.000000000000000,
                                 0.071519519880433,  0.052408835861052,  0.000000000000000,
                                 0.000000000000000,  0.187428813222518,  0.101202301157208,
                                 0.000000000000000,  0.000000000000000,  0.102282705877772,
                                 0.097573912345509,  0.000000000000000,  0.000000000000000,
                                -0.052496690349375, -0.012373005966601,  0.040742364988703,
                                -0.007696671778040,  0.000000000000000,  0.000000000000000,
                                -0.080557427783240, -0.036471168647061,  0.000000000000000,
                                 0.000000000000000, -0.154741226442700, -0.095479574413678,
                                 0.000000000000000,  0.000000000000000, -0.042441993164122,
                                -0.053165393708702,  0.000000000000000,  0.000000000000000,
                                 0.077291229174584,  0.026143232606206,  0.000000000000000,
                                 0.000000000000000, -0.074439105794478, -0.107489429427782,
                                 0.000000000000000,  0.000000000000000, -0.068890541281514,
                                -0.078613253791579,  0.000000000000000,  0.000000000000000,
                                -0.151254406113592, -0.151803451735813,  0.000000000000000,
                                 0.000000000000000, -0.125615268388731, -0.146360868518263,
                                 0.000000000000000,  0.000000000000000,  0.024050818259079,
                                 0.018559508949901,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.230290840493970,
                                 0.041995727560930,  0.000000000000000,  0.000000000000000,
                                 0.212086756198645,  0.051350518407841,  0.000000000000000,
                                 0.000000000000000,  0.054864148017901,  0.033320102548849,
                                 0.000000000000000,  0.000000000000000, -0.036521103265140,
                                 0.000309618883052,  0.000000000000000,  0.000000000000000,
                                 0.486040202460392,  0.233597986062610,  0.000000000000000,
                                 0.000000000000000,  0.175756089751298,  0.057266313246696,
                                 0.000000000000000,  0.000000000000000,  0.105480274506501,
                                 0.104808197154684,  0.000000000000000,  0.000000000000000,
                                 0.051091215878462,  0.066393805153059,  0.000000000000000,
                                 0.000000000000000, -0.009150506559157,  0.001265558907558,
                                 0.000000000000000,  0.000000000000000,  0.612359208249097,
                                 0.373163357674979, -0.199720774523800, -0.088292451593159,
                                 0.000000000000000,  0.000000000000000, -0.192624234234264,
                                -0.053070319721372,  0.000000000000000,  0.000000000000000,
                                -0.047642051010940, -0.026388983188278,  0.000000000000000,
                                 0.000000000000000,  0.033963163883738,  0.004339044565433,
                                 0.000000000000000,  0.000000000000000, -0.396412073594941,
                                -0.313381421021922,  0.000000000000000,  0.000000000000000,
                                -0.100013792684676, -0.085899469870043,  0.000000000000000,
                                 0.000000000000000, -0.113757509248378, -0.157212295732027,
                                 0.000000000000000,  0.000000000000000, -0.073855178598194,
                                -0.099590707729589,  0.000000000000000,  0.000000000000000,
                                -0.000423772174817, -0.001898338361336,  0.000000000000000,
                                 0.000000000000000, -0.539712447041572, -0.559745036512469,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.169633828039899,  0.030749390785772,
                                 0.000000000000000,  0.000000000000000,  0.188802845224425,
                                -0.002510405770876,  0.000000000000000,  0.000000000000000,
                                 0.236555843187967,  0.058131229895086,  0.000000000000000,
                                 0.000000000000000, -0.222210709223091, -0.033199699414640,
                                 0.000000000000000,  0.000000000000000,  0.228763877214316,
                                 0.095257870618962,  0.000000000000000,  0.000000000000000,
                                -0.088334526067565,  0.089580217977320,  0.000000000000000,
                                 0.000000000000000,  0.052227204498916, -0.005242604275948,
                                 0.000000000000000,  0.000000000000000,  0.213026157668095,
                                 0.082851922852061,  0.000000000000000,  0.000000000000000,
                                -0.190818151324591, -0.028610209875399,  0.000000000000000,
                                 0.000000000000000,  0.270853014917516,  0.147177798202023,
                                 0.149193366141564,  0.042293670549227,  0.000000000000000,
                                 0.000000000000000, -0.174371857548158, -0.024583558368178,
                                 0.000000000000000,  0.000000000000000, -0.201428391354562,
                                -0.107601591621833,  0.000000000000000,  0.000000000000000,
                                 0.189368112699927,  0.095807099031087,  0.000000000000000,
                                 0.000000000000000, -0.188138170831583, -0.138238966351108,
                                 0.000000000000000,  0.000000000000000, -0.060439902638366,
                                -0.134370326965980,  0.000000000000000,  0.000000000000000,
                                 0.004579864638245,  0.007863906413922,  0.000000000000000,
                                 0.000000000000000, -0.137266752971326, -0.124277884278091,
                                 0.000000000000000,  0.000000000000000,  0.083122909291319,
                                 0.042915314813099,  0.000000000000000,  0.000000000000000,
                                -0.221398658686560, -0.220766697303034,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.077183109124960,  0.030626051372083,  0.000000000000000,
                                 0.000000000000000,  0.193787025953439,  0.046920682448116,
                                 0.000000000000000,  0.000000000000000, -0.002067918148044,
                                 0.005823938786877,  0.000000000000000,  0.000000000000000,
                                -0.226017168751111, -0.075967049250725,  0.000000000000000,
                                 0.000000000000000,  0.116327699787581,  0.121975009053897,
                                 0.000000000000000,  0.000000000000000, -0.014646020763977,
                                 0.070508044935498,  0.000000000000000,  0.000000000000000,
                                 0.168687301618308,  0.067727905192044,  0.000000000000000,
                                 0.000000000000000,  0.011288110316169,  0.009553177043010,
                                 0.000000000000000,  0.000000000000000, -0.233908703240082,
                                -0.115049238064861,  0.000000000000000,  0.000000000000000,
                                 0.214512780126291,  0.220614652812908,  0.070457618696630,
                                 0.005758999602902,  0.000000000000000,  0.000000000000000,
                                -0.165848644294057, -0.085211760194296,  0.000000000000000,
                                 0.000000000000000,  0.003246334485267, -0.005915455006231,
                                -0.000000000000000,  0.000000000000000,  0.189520444493608,
                                 0.118921135706313,  0.000000000000000,  0.000000000000000,
                                -0.089341650627899, -0.111533811663804,  0.000000000000000,
                                 0.000000000000000, -0.065020715766644, -0.105762067403247,
                                 0.000000000000000,  0.000000000000000, -0.110559467335989,
                                -0.101591857788066,  0.000000000000000,  0.000000000000000,
                                -0.013347618071606, -0.014329765564515,  0.000000000000000,
                                 0.000000000000000,  0.177305025981432,  0.172573857097291,
                                 0.000000000000000,  0.000000000000000, -0.275093474247700,
                                -0.330921979219361,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 36, 20));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000, -0.102476793970642,
                                -0.032192328945797,  0.000000000000000,  0.000000000000000,
                                 0.110101753684864,  0.006700780046251,  0.000000000000000,
                                 0.000000000000000, -0.061797407757912, -0.006063124098759,
                                 0.000000000000000,  0.000000000000000, -0.043094654068594,
                                -0.001876733882679,  0.000000000000000,  0.000000000000000,
                                 0.217881237167018,  0.075438509161234,  0.000000000000000,
                                 0.000000000000000, -0.101293314289524, -0.048529098687563,
                                 0.000000000000000,  0.000000000000000,  0.060279954787393,
                                 0.004750595067774,  0.000000000000000,  0.000000000000000,
                                -0.034398464967254, -0.007360617484213,  0.000000000000000,
                                 0.000000000000000, -0.019343248364023, -0.001262239719963,
                                 0.000000000000000,  0.000000000000000,  0.230154429140795,
                                 0.114469230276783,  0.086470500595766,  0.051438672069565,
                                 0.000000000000000,  0.000000000000000, -0.098002653211133,
                                -0.029737737764729,  0.000000000000000,  0.000000000000000,
                                 0.055116552305753,  0.017082810630612,  0.000000000000000,
                                 0.000000000000000,  0.038950561674818,  0.009485711540139,
                                 0.000000000000000,  0.000000000000000, -0.182167756750413,
                                -0.117070924280370,  0.000000000000000,  0.000000000000000,
                                 0.075212773393199,  0.072793648031345,  0.000000000000000,
                                 0.000000000000000, -0.017341720892328, -0.007125892601662,
                                -0.000000000000000,  0.000000000000000,  0.014752012636892,
                                 0.011040926226320,  0.000000000000000,  0.000000000000000,
                                 0.004900488447302,  0.001893359579945,  0.000000000000000,
                                 0.000000000000000, -0.175996218400398, -0.171703845415175,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.122611941379969,  0.021463073810651,
                                 0.000000000000000,  0.000000000000000, -0.035078440187758,
                                -0.049014144730942,  0.000000000000000,  0.000000000000000,
                                 0.000651936040582, -0.003399368089516,  0.000000000000000,
                                 0.000000000000000,  0.074029620616990,  0.106587014185970,
                                 0.000000000000000,  0.000000000000000,  0.163593273580981,
                                 0.031661140560533,  0.000000000000000,  0.000000000000000,
                                 0.118270254700219,  0.018679316224326,  0.000000000000000,
                                 0.000000000000000, -0.109407544079504, -0.079227098840890,
                                 0.000000000000000,  0.000000000000000, -0.008721801375274,
                                -0.005113783031559,  0.000000000000000,  0.000000000000000,
                                 0.228063873405773,  0.174437156262672,  0.000000000000000,
                                 0.000000000000000,  0.170286296820144,  0.027705164704299,
                                -0.102821505091306, -0.059527465754171, -0.000000000000000,
                                -0.000000000000000,  0.021329273530357,  0.056667596155137,
                                 0.000000000000000,  0.000000000000000, -0.001685714702221,
                                 0.004512537369034,  0.000000000000000,  0.000000000000000,
                                -0.045719310983227, -0.118332054397547,  0.000000000000000,
                                 0.000000000000000, -0.135583226872768, -0.085832759188270,
                                -0.000000000000000,  0.000000000000000, -0.053629658399883,
                                -0.028018974336490, -0.000000000000000,  0.000000000000000,
                                 0.112767887085919,  0.118840648261335,  0.000000000000000,
                                 0.000000000000000,  0.007922515656972,  0.007670674547339,
                                 0.000000000000000,  0.000000000000000, -0.244615774396101,
                                -0.261655734394008,  0.000000000000000,  0.000000000000000,
                                -0.079022863778954, -0.041557747056449,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.044383003993619, -0.070144190240895,  0.000000000000000,
                                 0.000000000000000,  0.133154949992716,  0.086567041007584,
                                 0.000000000000000,  0.000000000000000, -0.216367304998231,
                                 0.013356615885486,  0.000000000000000,  0.000000000000000,
                                 0.419167707176644,  0.174755665426527,  0.000000000000000,
                                 0.000000000000000, -0.036521103265140,  0.000309618883052,
                                 0.000000000000000,  0.000000000000000, -0.076836488709540,
                                -0.143972159720718,  0.000000000000000,  0.000000000000000,
                                 0.213493429141677,  0.133552837330746,  0.000000000000000,
                                 0.000000000000000, -0.091948677535003,  0.040206382326815,
                                 0.000000000000000,  0.000000000000000,  0.522785032770584,
                                 0.257170754423982,  0.000000000000000,  0.000000000000000,
                                -0.009150506559157,  0.001265558907558,  0.036091817774302,
                                 0.040642615234866,  0.000000000000000,  0.000000000000000,
                                -0.103958884182309, -0.110054064302791, -0.000000000000000,
                                -0.000000000000000,  0.194406993092932,  0.043958250084690,
                                 0.000000000000000,  0.000000000000000, -0.341254862753980,
                                -0.266922667401449, -0.000000000000000,  0.000000000000000,
                                 0.033963163883738,  0.004339044565433,  0.000000000000000,
                                 0.000000000000000,  0.154157808417014,  0.215958239581077,
                                 0.000000000000000,  0.000000000000000, -0.200588929663361,
                                -0.200329255996119, -0.000000000000000,  0.000000000000000,
                                -0.025026311860077, -0.060309573490222,  0.000000000000000,
                                 0.000000000000000, -0.409013474340416, -0.385756131635972,
                                 0.000000000000000,  0.000000000000000, -0.000423772174817,
                                -0.001898338361336,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.091957290496773,
                                 0.030236783643543,  0.000000000000000,  0.000000000000000,
                                 0.070695945027619, -0.031522117103004,  0.000000000000000,
                                 0.000000000000000,  0.121433757299335,  0.177532885869594,
                                 0.000000000000000,  0.000000000000000, -0.343245032157339,
                                -0.055467648880107,  0.000000000000000,  0.000000000000000,
                                -0.030606204417814, -0.058467951632579,  0.000000000000000,
                                 0.000000000000000,  0.071519519880433,  0.052408835861052,
                                 0.000000000000000,  0.000000000000000,  0.057994341656760,
                                -0.094352758960283,  0.000000000000000,  0.000000000000000,
                                 0.412607344554185,  0.274541660465493,  0.000000000000000,
                                 0.000000000000000, -0.266026243552508, -0.069503100402354,
                                 0.000000000000000,  0.000000000000000, -0.100783733694909,
                                -0.103262109911687, -0.080557427783240, -0.036471168647061,
                                 0.000000000000000,  0.000000000000000, -0.058424340645450,
                                -0.028057379847541,  0.000000000000000,  0.000000000000000,
                                -0.070015742749406, -0.213925076885934, -0.000000000000000,
                                 0.000000000000000,  0.296443729792864,  0.133282360840846,
                                 0.000000000000000,  0.000000000000000,  0.018923748610901,
                                 0.052702985930135, -0.000000000000000,  0.000000000000000,
                                -0.068890541281514, -0.078613253791579,  0.000000000000000,
                                 0.000000000000000,  0.062099718783504,  0.141529138440425,
                                 0.000000000000000,  0.000000000000000, -0.410998724011078,
                                -0.411812490698240,  0.000000000000000,  0.000000000000000,
                                 0.133906929448343,  0.104254650603531,  0.000000000000000,
                                 0.000000000000000,  0.132299105328669,  0.154893164867531,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.044838503027106, -0.046808993056926,
                                 0.000000000000000,  0.000000000000000, -0.512831463951338,
                                -0.110236073712716,  0.000000000000000,  0.000000000000000,
                                 0.571629711121489,  0.088785615374404,  0.000000000000000,
                                 0.000000000000000, -0.341887642634226, -0.073490715808478,
                                 0.000000000000000,  0.000000000000000, -0.018682709594628,
                                 0.019503747107053,  0.000000000000000,  0.000000000000000,
                                -0.067227808038722, -0.080990511052462,  0.000000000000000,
                                 0.000000000000000, -0.451941498631603, -0.142587317062669,
                                 0.000000000000000,  0.000000000000000,  0.537525299287755,
                                 0.067075348183560,  0.000000000000000,  0.000000000000000,
                                -0.301294332421069, -0.095058211375113,  0.000000000000000,
                                 0.000000000000000,  0.028011586682801,  0.033746046271859,
                                -0.049820639922480,  0.035994390161107,  0.000000000000000,
                                 0.000000000000000,  0.437380922909619,  0.227959446817269,
                                 0.000000000000000,  0.000000000000000, -0.480496591363278,
                                -0.270047447551961,  0.000000000000000,  0.000000000000000,
                                 0.291587281939746,  0.151972964544846,  0.000000000000000,
                                 0.000000000000000,  0.020758599967700, -0.014997662567128,
                                 0.000000000000000,  0.000000000000000,  0.106035167054625,
                                 0.121485766578693,  0.000000000000000,  0.000000000000000,
                                 0.263836959737335,  0.213880975594003,  0.000000000000000,
                                 0.000000000000000, -0.224651767899059, -0.100613022275340,
                                 0.000000000000000,  0.000000000000000,  0.175891306491557,
                                 0.142587317062669,  0.000000000000000,  0.000000000000000,
                                -0.044181319606094, -0.050619069407789,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.055374603954894,  0.055441926363210,  0.000000000000000,
                                 0.000000000000000, -0.343245032157339, -0.055467648880107,
                                 0.000000000000000,  0.000000000000000,  0.080955838199557,
                                 0.118355257246396,  0.000000000000000,  0.000000000000000,
                                 0.356733471825402,  0.014700923630418,  0.000000000000000,
                                 0.000000000000000, -0.034636751581634,  0.045703135020317,
                                 0.000000000000000,  0.000000000000000,  0.102282705877772,
                                 0.097573912345508,  0.000000000000000,  0.000000000000000,
                                -0.266026243552509, -0.069503100402354,  0.000000000000000,
                                 0.000000000000000,  0.275071563036123,  0.183027773643662,
                                 0.000000000000000,  0.000000000000000,  0.279682877950517,
                                -0.036433508624988,  0.000000000000000,  0.000000000000000,
                                 0.063858106501355,  0.081481845643745, -0.042441993164123,
                                -0.053165393708702,  0.000000000000000,  0.000000000000000,
                                 0.296443729792864,  0.133282360840846,  0.000000000000000,
                                 0.000000000000000, -0.046677161832938, -0.142616717923956,
                                -0.000000000000000, -0.000000000000000, -0.305460782139504,
                                -0.139126013881579,  0.000000000000000,  0.000000000000000,
                                 0.039646933266557, -0.034107751112164,  0.000000000000000,
                                 0.000000000000000, -0.125615268388731, -0.146360868518263,
                                 0.000000000000000,  0.000000000000000,  0.133906929448343,
                                 0.104254650603531,  0.000000000000000,  0.000000000000000,
                                -0.273999149340718, -0.274541660465493, -0.000000000000000,
                                 0.000000000000000, -0.049489389090115,  0.054650262937482,
                                 0.000000000000000,  0.000000000000000, -0.103052374530086,
                                -0.122222768465617,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.036521103265140,
                                 0.000309618883052,  0.000000000000000,  0.000000000000000,
                                -0.484998291832916, -0.188227196601073,  0.000000000000000,
                                 0.000000000000000,  0.090153043749263, -0.005565256618952,
                                 0.000000000000000,  0.000000000000000,  0.469622382680324,
                                 0.155421533677483,  0.000000000000000,  0.000000000000000,
                                -0.116816525469481, -0.069530112789509,  0.000000000000000,
                                 0.000000000000000, -0.009150506559157,  0.001265558907558,
                                 0.000000000000000,  0.000000000000000, -0.583548499488005,
                                -0.274223203952340,  0.000000000000000,  0.000000000000000,
                                 0.038311948972918, -0.016752659302839,  0.000000000000000,
                                 0.000000000000000,  0.524062259030716,  0.220709801586802,
                                 0.000000000000000,  0.000000000000000, -0.094984993385202,
                                -0.141462134554062,  0.033963163883738,  0.004339044565433,
                                 0.000000000000000,  0.000000000000000,  0.396849823698136,
                                 0.297475138685627,  0.000000000000000,  0.000000000000000,
                                -0.081002913788722, -0.018315937535288,  0.000000000000000,
                                 0.000000000000000, -0.388110906785769, -0.266211139755260,
                                -0.000000000000000, -0.000000000000000,  0.103452092810383,
                                 0.049248386956308,  0.000000000000000,  0.000000000000000,
                                -0.000423772174817, -0.001898338361336,  0.000000000000000,
                                 0.000000000000000,  0.441452498294028,  0.411334805928510,
                                 0.000000000000000,  0.000000000000000,  0.010427629941699,
                                 0.025128988954259,  0.000000000000000,  0.000000000000000,
                                -0.366388385426268, -0.331064702380203, -0.000000000000000,
                                 0.000000000000000,  0.153317326936960,  0.212193201831093,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.222210709223091, -0.033199699414640,
                                 0.000000000000000,  0.000000000000000, -0.059306959988541,
                                -0.090576966115984,  0.000000000000000,  0.000000000000000,
                                -0.003332117540750,  0.017374548013082,  0.000000000000000,
                                 0.000000000000000, -0.020478468397880, -0.033137513728206,
                                 0.000000000000000,  0.000000000000000,  0.134590713822746,
                                 0.021777486172797,  0.000000000000000,  0.000000000000000,
                                -0.190818151324591, -0.028610209875399,  0.000000000000000,
                                 0.000000000000000, -0.178043246760791, -0.151672111399681,
                                 0.000000000000000,  0.000000000000000,  0.044578095918069,
                                 0.026137113272415,  0.000000000000000,  0.000000000000000,
                                -0.059803755989897, -0.056651762685090,  0.000000000000000,
                                 0.000000000000000,  0.122466044062937,  0.018864266828806,
                                 0.189368112699927,  0.095807099031087,  0.000000000000000,
                                 0.000000000000000,  0.037790404476516,  0.092723103129750,
                                 0.000000000000000,  0.000000000000000,  0.008615875144687,
                                -0.023064079886175, -0.000000000000000,  0.000000000000000,
                                 0.013466441244536,  0.031272052814570,  0.000000000000000,
                                 0.000000000000000, -0.113812721290491, -0.061565773058734,
                                -0.000000000000000, -0.000000000000000,  0.083122909291319,
                                 0.042915314813099,  0.000000000000000,  0.000000000000000,
                                 0.206895260468412,  0.227508167099521,  0.000000000000000,
                                 0.000000000000000, -0.040492857802302, -0.039205669908622,
                                 0.000000000000000,  0.000000000000000,  0.075361710774295,
                                 0.084977644027635,  0.000000000000000,  0.000000000000000,
                                -0.054467523646966, -0.028296400243209, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.226017168751111, -0.075967049250725,  0.000000000000000,
                                 0.000000000000000,  0.001645867830292,  0.000788808483685,
                                 0.000000000000000,  0.000000000000000, -0.061282429359930,
                                -0.006012598064602,  0.000000000000000,  0.000000000000000,
                                 0.118572024909442,  0.006923103159613,  0.000000000000000,
                                 0.000000000000000, -0.082480875161912, -0.030893320392519,
                                 0.000000000000000,  0.000000000000000, -0.233908703240082,
                                -0.115049238064861,  0.000000000000000,  0.000000000000000,
                                 0.004825034813593,  0.000622276142199,  0.000000000000000,
                                 0.000000000000000, -0.034111811092527, -0.007299279005178,
                                 0.000000000000000,  0.000000000000000,  0.063246825898201,
                                 0.004881374894386,  0.000000000000000,  0.000000000000000,
                                -0.092066324202508, -0.047103596454789,  0.189520444493608,
                                 0.118921135706313,  0.000000000000000,  0.000000000000000,
                                -0.000918904181090, -0.002432788199424, -0.000000000000000,
                                 0.000000000000000,  0.054657247703205,  0.016940453875357,
                                 0.000000000000000,  0.000000000000000, -0.105774616719064,
                                -0.031179038681927, -0.000000000000000, -0.000000000000000,
                                 0.068399583255910,  0.046891352924886,  0.000000000000000,
                                 0.000000000000000,  0.177305025981432,  0.172573857097291,
                                 0.000000000000000,  0.000000000000000, -0.002001318462335,
                                -0.000933414213298,  0.000000000000000,  0.000000000000000,
                                 0.014629079198252,  0.010948918507767,  0.000000000000000,
                                 0.000000000000000, -0.017934181090261, -0.007322062341580,
                                 0.000000000000000,  0.000000000000000,  0.071996078432564,
                                 0.070655394682183,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 36, 20));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeFFForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 3);
    
    CGtoBlock kgtos(mlih, mbas, 3);
    
    CDenseMatrix lmomxmat(28, 28);
    
    CDenseMatrix lmomymat(28, 28);
    
    CDenseMatrix lmomzmat(28, 28);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.152581647893808,
                                 0.266812240752767, -0.000000000000000, -0.000000000000000,
                                 0.105450538365066,  0.180517820128233, -0.000000000000000,
                                -0.000000000000000, -0.125036606964113, -0.123784750198694,
                                -0.000000000000000, -0.000000000000000,  0.535977886964114,
                                 0.236407751606450, -0.000000000000000, -0.000000000000000,
                                -0.074329160192908, -0.152575815281518, -0.000000000000000,
                                -0.000000000000000, -0.350174213540895, -0.178636768134593,
                                -0.000000000000000, -0.000000000000000, -0.035295854777248,
                                -0.008076218372432,  0.000000000000000,  0.000000000000000,
                                 0.225353572329270,  0.399364073904680,  0.000000000000000,
                                -0.000000000000000,  0.142323004880931,  0.277822641690630,
                                 0.000000000000000, -0.000000000000000, -0.138287596332059,
                                -0.168390443673249,  0.000000000000000, -0.000000000000000,
                                 0.378046327792668,  0.280672404427797,  0.000000000000000,
                                -0.000000000000000, -0.143576221424391, -0.216036122953534,
                                 0.000000000000000, -0.000000000000000, -0.269421768586295,
                                -0.216277791954747,  0.000000000000000, -0.000000000000000,
                                -0.018032203012221, -0.008251653322386, -0.152581647893808,
                                -0.225353572329270,  0.000000000000000,  0.000000000000000,
                                -0.105450538365066, -0.142323004880931, -0.000000000000000,
                                -0.000000000000000,  0.125036606964113,  0.138287596332059,
                                 0.000000000000000, -0.000000000000000, -0.535977886964114,
                                -0.378046327792668, -0.000000000000000, -0.000000000000000,
                                 0.074329160192908,  0.143576221424391, -0.000000000000000,
                                -0.000000000000000,  0.350174213540895,  0.269421768586295,
                                -0.000000000000000, -0.000000000000000,  0.035295854777248,
                                 0.018032203012221,  0.000000000000001, -0.000000000000000,
                                -0.266812240752767, -0.399364073904680, -0.000000000000000,
                                 0.000000000000000, -0.180517820128233, -0.277822641690630,
                                 0.000000000000000, -0.000000000000000,  0.123784750198694,
                                 0.168390443673249,  0.000000000000000, -0.000000000000000,
                                -0.236407751606450, -0.280672404427797,  0.000000000000000,
                                -0.000000000000000,  0.152575815281518,  0.216036122953534,
                                 0.000000000000000, -0.000000000000000,  0.178636768134593,
                                 0.216277791954748,  0.000000000000000, -0.000000000000000,
                                 0.008076218372431,  0.008251653322386,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                 0.105450538365066,  0.180517820128233,  0.000000000000000,
                                -0.000000000000000, -0.093119198695301, -0.063663662630911,
                                -0.000000000000000, -0.000000000000000,  0.044732604902611,
                                 0.070635326850883, -0.000000000000000, -0.000000000000000,
                                 0.097243281386981, -0.023856614454696, -0.000000000000000,
                                -0.000000000000000,  0.409178873130007,  0.026068890335112,
                                -0.000000000000000, -0.000000000000000,  0.069955978060921,
                                 0.005191185503470, -0.000000000000000, -0.000000000000000,
                                 0.214752019010918,  0.144759640196495,  0.000000000000000,
                                 0.000000000000000,  0.142323004880931,  0.277822641690630,
                                 0.000000000000000,  0.000000000000000, -0.131529967209776,
                                -0.045960414711695,  0.000000000000000, -0.000000000000000,
                                 0.043220765441241,  0.120319531769879,  0.000000000000000,
                                -0.000000000000000,  0.048139153805018, -0.068815519173781,
                                 0.000000000000000, -0.000000000000000,  0.151000416490274,
                                 0.001709983031397,  0.000000000000000, -0.000000000000000,
                                 0.023342550734071,  0.002677614796407,  0.000000000000000,
                                -0.000000000000000,  0.196247368412175,  0.181259856488369,
                                -0.105450538365066, -0.142323004880931,  0.000000000000000,
                                -0.000000000000000,  0.093119198695301,  0.131529967209776,
                                 0.000000000000000,  0.000000000000000, -0.044732604902611,
                                -0.043220765441241, -0.000000000000000, -0.000000000000000,
                                -0.097243281386981, -0.048139153805018,  0.000000000000000,
                                -0.000000000000000, -0.409178873130007, -0.151000416490274,
                                -0.000000000000000, -0.000000000000000, -0.069955978060921,
                                -0.023342550734071,  0.000000000000001, -0.000000000000000,
                                -0.214752019010918, -0.196247368412175, -0.000000000000000,
                                -0.000000000000000, -0.180517820128233, -0.277822641690630,
                                 0.000000000000000,  0.000000000000000,  0.063663662630911,
                                 0.045960414711695, -0.000000000000000,  0.000000000000000,
                                -0.070635326850883, -0.120319531769879,  0.000000000000000,
                                -0.000000000000000,  0.023856614454696,  0.068815519173781,
                                 0.000000000000000, -0.000000000000000, -0.026068890335112,
                                -0.001709983031397,  0.000000000000000, -0.000000000000000,
                                -0.005191185503470, -0.002677614796407,  0.000000000000000,
                                -0.000000000000000, -0.144759640196495, -0.181259856488369,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.125036606964113, -0.123784750198694,
                                 0.000000000000000, -0.000000000000000,  0.044732604902611,
                                 0.070635326850883,  0.000000000000000, -0.000000000000000,
                                -0.137486723961716, -0.035740589832401, -0.000000000000000,
                                -0.000000000000000, -0.131153591264050, -0.030923404757480,
                                -0.000000000000000, -0.000000000000000, -0.080278854740725,
                                -0.019244255142092, -0.000000000000000, -0.000000000000000,
                                 0.052480405293751,  0.004161822815120, -0.000000000000000,
                                -0.000000000000000,  0.243992924752861,  0.194641800502342,
                                 0.000000000000000,  0.000000000000000, -0.138287596332059,
                                -0.168390443673249,  0.000000000000000,  0.000000000000000,
                                 0.043220765441241,  0.120319531769879,  0.000000000000000,
                                 0.000000000000000, -0.081180476967024, -0.029380693612805,
                                 0.000000000000000, -0.000000000000000, -0.063722878498586,
                                -0.033719170688470,  0.000000000000000, -0.000000000000000,
                                -0.063255722876013, -0.002254342159463,  0.000000000000000,
                                -0.000000000000000,  0.015983371431252,  0.003153060220026,
                                 0.000000000000000, -0.000000000000000,  0.230814951890418,
                                 0.261191856720537,  0.125036606964113,  0.138287596332059,
                                -0.000000000000000, -0.000000000000000, -0.044732604902611,
                                -0.043220765441241,  0.000000000000000, -0.000000000000000,
                                 0.137486723961716,  0.081180476967024,  0.000000000000000,
                                -0.000000000000000,  0.131153591264050,  0.063722878498586,
                                -0.000000000000000, -0.000000000000000,  0.080278854740725,
                                 0.063255722876013,  0.000000000000000, -0.000000000000000,
                                -0.052480405293751, -0.015983371431252, -0.000000000000000,
                                -0.000000000000000, -0.243992924752861, -0.230814951890418,
                                 0.000000000000000, -0.000000000000000,  0.123784750198694,
                                 0.168390443673249,  0.000000000000000,  0.000000000000000,
                                -0.070635326850883, -0.120319531769879,  0.000000000000000,
                                 0.000000000000000,  0.035740589832401,  0.029380693612805,
                                 0.000000000000000,  0.000000000000000,  0.030923404757480,
                                 0.033719170688470,  0.000000000000000, -0.000000000000000,
                                 0.019244255142092,  0.002254342159463,  0.000000000000000,
                                -0.000000000000000, -0.004161822815120, -0.003153060220026,
                                 0.000000000000000, -0.000000000000000, -0.194641800502342,
                                -0.261191856720537,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.535977886964114,
                                 0.236407751606450,  0.000000000000000, -0.000000000000000,
                                 0.097243281386981, -0.023856614454696,  0.000000000000000,
                                -0.000000000000000, -0.131153591264050, -0.030923404757480,
                                 0.000000000000000, -0.000000000000000, -0.072012845869782,
                                -0.005972430001121, -0.000000000000000, -0.000000000000000,
                                -0.187056593798544, -0.022070287961446, -0.000000000000000,
                                -0.000000000000000,  0.283712470670729, -0.010238217576702,
                                -0.000000000000000, -0.000000000000000, -0.065774112872151,
                                -0.064696061788076,  0.000000000000000,  0.000000000000000,
                                 0.378046327792668,  0.280672404427797,  0.000000000000000,
                                 0.000000000000000,  0.048139153805018, -0.068815519173781,
                                 0.000000000000000,  0.000000000000000, -0.063722878498586,
                                -0.033719170688470,  0.000000000000000,  0.000000000000000,
                                -0.062612797605516,  0.023216031071685,  0.000000000000000,
                                -0.000000000000000, -0.095948001153754, -0.000702917905704,
                                 0.000000000000000, -0.000000000000000,  0.099597201576322,
                                -0.053769724442605,  0.000000000000000, -0.000000000000000,
                                -0.080123849823621, -0.082719450175798, -0.535977886964114,
                                -0.378046327792668,  0.000000000000000, -0.000000000000000,
                                -0.097243281386981, -0.048139153805018, -0.000000000000000,
                                -0.000000000000000,  0.131153591264050,  0.063722878498586,
                                 0.000000000000000, -0.000000000000000,  0.072012845869782,
                                 0.062612797605516,  0.000000000000000, -0.000000000000000,
                                 0.187056593798544,  0.095948001153754, -0.000000000000000,
                                -0.000000000000000, -0.283712470670729, -0.099597201576322,
                                -0.000000000000000, -0.000000000000000,  0.065774112872151,
                                 0.080123849823620, -0.000000000000000, -0.000000000000000,
                                -0.236407751606450, -0.280672404427797,  0.000000000000000,
                                 0.000000000000000,  0.023856614454696,  0.068815519173781,
                                 0.000000000000000,  0.000000000000000,  0.030923404757480,
                                 0.033719170688470,  0.000000000000000,  0.000000000000000,
                                 0.005972430001121, -0.023216031071685,  0.000000000000000,
                                 0.000000000000000,  0.022070287961445,  0.000702917905704,
                                 0.000000000000000, -0.000000000000000,  0.010238217576702,
                                 0.053769724442605,  0.000000000000000, -0.000000000000000,
                                 0.064696061788077,  0.082719450175798,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.074329160192908, -0.152575815281518,  0.000000000000000,
                                -0.000000000000000,  0.409178873130007,  0.026068890335112,
                                 0.000000000000000, -0.000000000000000, -0.080278854740725,
                                -0.019244255142092,  0.000000000000000, -0.000000000000000,
                                -0.187056593798544, -0.022070287961445,  0.000000000000000,
                                -0.000000000000000, -0.026209729532813, -0.001830772037239,
                                -0.000000000000000, -0.000000000000000,  0.000194380470112,
                                 0.069761663967540, -0.000000000000000, -0.000000000000000,
                                -0.568294762811389, -0.271454003126149,  0.000000000000000,
                                 0.000000000000000, -0.143576221424391, -0.216036122953534,
                                 0.000000000000000,  0.000000000000000,  0.151000416490274,
                                 0.001709983031397,  0.000000000000000,  0.000000000000000,
                                -0.063255722876013, -0.002254342159463,  0.000000000000000,
                                 0.000000000000000, -0.095948001153754, -0.000702917905704,
                                 0.000000000000000,  0.000000000000000, -0.064095453672536,
                                 0.040095793824802,  0.000000000000000, -0.000000000000000,
                                 0.018664016671964,  0.127174383368192,  0.000000000000000,
                                -0.000000000000000, -0.408537943189367, -0.334544357833399,
                                 0.074329160192908,  0.143576221424391,  0.000000000000000,
                                -0.000000000000000, -0.409178873130007, -0.151000416490274,
                                 0.000000000000000, -0.000000000000000,  0.080278854740725,
                                 0.063255722876013, -0.000000000000000, -0.000000000000000,
                                 0.187056593798544,  0.095948001153754,  0.000000000000000,
                                -0.000000000000000,  0.026209729532813,  0.064095453672536,
                                 0.000000000000000,  0.000000000000000, -0.000194380470112,
                                -0.018664016671964, -0.000000000000000, -0.000000000000000,
                                 0.568294762811389,  0.408537943189366,  0.000000000000000,
                                -0.000000000000000,  0.152575815281518,  0.216036122953534,
                                 0.000000000000000,  0.000000000000000, -0.026068890335112,
                                -0.001709983031397,  0.000000000000000,  0.000000000000000,
                                 0.019244255142092,  0.002254342159463,  0.000000000000000,
                                 0.000000000000000,  0.022070287961446,  0.000702917905704,
                                 0.000000000000000,  0.000000000000000,  0.001830772037239,
                                -0.040095793824802, -0.000000000000000,  0.000000000000000,
                                -0.069761663967540, -0.127174383368192,  0.000000000000000,
                                -0.000000000000000,  0.271454003126149,  0.334544357833399,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.350174213540895, -0.178636768134593,
                                 0.000000000000000, -0.000000000000000,  0.069955978060921,
                                 0.005191185503470,  0.000000000000000, -0.000000000000000,
                                 0.052480405293751,  0.004161822815120,  0.000000000000000,
                                -0.000000000000000,  0.283712470670729, -0.010238217576702,
                                 0.000000000000000, -0.000000000000000,  0.000194380470112,
                                 0.069761663967540,  0.000000000000000, -0.000000000000000,
                                -0.475227484903041, -0.101808444335945, -0.000000000000000,
                                -0.000000000000000, -0.066044985047894,  0.142913971584091,
                                 0.000000000000000,  0.000000000000000, -0.269421768586295,
                                -0.216277791954748,  0.000000000000000,  0.000000000000000,
                                 0.023342550734071,  0.002677614796407,  0.000000000000000,
                                 0.000000000000000,  0.015983371431252,  0.003153060220026,
                                 0.000000000000000,  0.000000000000000,  0.099597201576322,
                                -0.053769724442605,  0.000000000000000,  0.000000000000000,
                                 0.018664016671964,  0.127174383368192,  0.000000000000000,
                                 0.000000000000000, -0.284577343149557, -0.066670334447702,
                                 0.000000000000000, -0.000000000000000,  0.056967041099042,
                                 0.239631248793249,  0.350174213540895,  0.269421768586295,
                                 0.000000000000000, -0.000000000000000, -0.069955978060921,
                                -0.023342550734071, -0.000000000000001, -0.000000000000000,
                                -0.052480405293751, -0.015983371431252,  0.000000000000000,
                                -0.000000000000000, -0.283712470670729, -0.099597201576322,
                                 0.000000000000000, -0.000000000000000, -0.000194380470112,
                                -0.018664016671964,  0.000000000000000, -0.000000000000000,
                                 0.475227484903041,  0.284577343149557,  0.000000000000000,
                                 0.000000000000000,  0.066044985047894, -0.056967041099042,
                                -0.000000000000000, -0.000000000000000,  0.178636768134593,
                                 0.216277791954747,  0.000000000000000,  0.000000000000000,
                                -0.005191185503470, -0.002677614796407,  0.000000000000000,
                                 0.000000000000000, -0.004161822815120, -0.003153060220026,
                                 0.000000000000000,  0.000000000000000,  0.010238217576702,
                                 0.053769724442605,  0.000000000000000,  0.000000000000000,
                                -0.069761663967540, -0.127174383368192,  0.000000000000000,
                                 0.000000000000000,  0.101808444335945,  0.066670334447702,
                                -0.000000000000000,  0.000000000000000, -0.142913971584091,
                                -0.239631248793249,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.035295854777248,
                                -0.008076218372431,  0.000000000000000, -0.000000000000000,
                                 0.214752019010918,  0.144759640196495,  0.000000000000000,
                                -0.000000000000000,  0.243992924752861,  0.194641800502342,
                                 0.000000000000000, -0.000000000000000, -0.065774112872151,
                                -0.064696061788077,  0.000000000000000, -0.000000000000000,
                                -0.568294762811389, -0.271454003126149,  0.000000000000000,
                                -0.000000000000000, -0.066044985047894,  0.142913971584091,
                                 0.000000000000000, -0.000000000000000,  0.159791757811935,
                                 0.269335482661636,  0.000000000000000,  0.000000000000000,
                                -0.018032203012221, -0.008251653322386,  0.000000000000000,
                                 0.000000000000000,  0.196247368412175,  0.181259856488369,
                                 0.000000000000000,  0.000000000000000,  0.230814951890418,
                                 0.261191856720537,  0.000000000000000,  0.000000000000000,
                                -0.080123849823620, -0.082719450175798,  0.000000000000000,
                                 0.000000000000000, -0.408537943189366, -0.334544357833399,
                                 0.000000000000000,  0.000000000000000,  0.056967041099042,
                                 0.239631248793249,  0.000000000000000,  0.000000000000000,
                                 0.230242508922888,  0.402064484816211,  0.035295854777248,
                                 0.018032203012221, -0.000000000000001, -0.000000000000000,
                                -0.214752019010918, -0.196247368412175,  0.000000000000000,
                                -0.000000000000000, -0.243992924752861, -0.230814951890418,
                                -0.000000000000000, -0.000000000000000,  0.065774112872151,
                                 0.080123849823621,  0.000000000000000, -0.000000000000000,
                                 0.568294762811389,  0.408537943189367, -0.000000000000000,
                                -0.000000000000000,  0.066044985047894, -0.056967041099042,
                                 0.000000000000000, -0.000000000000000, -0.159791757811935,
                                -0.230242508922888,  0.000000000000000,  0.000000000000000,
                                 0.008076218372432,  0.008251653322386,  0.000000000000000,
                                 0.000000000000000, -0.144759640196495, -0.181259856488369,
                                 0.000000000000000,  0.000000000000000, -0.194641800502342,
                                -0.261191856720537,  0.000000000000000,  0.000000000000000,
                                 0.064696061788076,  0.082719450175798,  0.000000000000000,
                                 0.000000000000000,  0.271454003126149,  0.334544357833399,
                                 0.000000000000000,  0.000000000000000, -0.142913971584091,
                                -0.239631248793249,  0.000000000000000,  0.000000000000000,
                                -0.269335482661636, -0.402064484816211, -0.000000000000000,
                                 0.000000000000000};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 28, 28));
    
    std::vector<double> intyvals{ 0.000000000000000, -0.000000000000000,  0.203285652543683,
                                 0.394498117147195, -0.000000000000000, -0.000000000000000,
                                -0.360959245387597, -0.179799009248201, -0.000000000000000,
                                -0.000000000000000,  0.240869537820020,  0.209262087789996,
                                -0.000000000000000, -0.000000000000000, -0.287649270231338,
                                -0.112306156435477, -0.000000000000000, -0.000000000000000,
                                -0.125036606964113, -0.123784750198694, -0.000000000000000,
                                -0.000000000000000, -0.274924224688396,  0.011021942347338,
                                -0.000000000000000, -0.000000000000000,  0.009941697628157,
                                 0.001944484643383,  0.000000000000000,  0.000000000000000,
                                 0.325143854179373,  0.593220436992099,  0.000000000000000,
                                -0.000000000000000, -0.273130055420941, -0.217282394912483,
                                 0.000000000000000, -0.000000000000000,  0.246464022032236,
                                 0.279999405088742,  0.000000000000000, -0.000000000000000,
                                -0.189118630384279, -0.130921329646705,  0.000000000000000,
                                -0.000000000000000, -0.138287596332059, -0.168390443673249,
                                 0.000000000000000, -0.000000000000000, -0.127947800152125,
                                 0.076459604235419,  0.000000000000000, -0.000000000000000,
                                 0.004623236882721,  0.001940450348684, -0.203285652543683,
                                -0.325143854179373,  0.000000000000000, -0.000000000000000,
                                 0.360959245387597,  0.273130055420941, -0.000000000000000,
                                -0.000000000000000, -0.240869537820020, -0.246464022032236,
                                -0.000000000000000, -0.000000000000000,  0.287649270231339,
                                 0.189118630384279, -0.000000000000000, -0.000000000000000,
                                 0.125036606964113,  0.138287596332059, -0.000000000000000,
                                -0.000000000000000,  0.274924224688396,  0.127947800152125,
                                -0.000000000000000, -0.000000000000000, -0.009941697628157,
                                -0.004623236882722, -0.000000000000000, -0.000000000000000,
                                -0.394498117147195, -0.593220436992099,  0.000000000000000,
                                 0.000000000000000,  0.179799009248201,  0.217282394912483,
                                 0.000000000000000, -0.000000000000000, -0.209262087789996,
                                -0.279999405088742,  0.000000000000000, -0.000000000000000,
                                 0.112306156435478,  0.130921329646705,  0.000000000000000,
                                -0.000000000000000,  0.123784750198694,  0.168390443673249,
                                 0.000000000000000, -0.000000000000000, -0.011021942347338,
                                -0.076459604235419,  0.000000000000000, -0.000000000000000,
                                -0.001944484643383, -0.001940450348684, -0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.360959245387597, -0.179799009248201,  0.000000000000000,
                                -0.000000000000000, -0.424169089911081, -0.121953736797663,
                                -0.000000000000000, -0.000000000000000,  0.304218062542504,
                                 0.017745244704872, -0.000000000000000, -0.000000000000000,
                                -0.103543158367198, -0.020263018913204, -0.000000000000000,
                                -0.000000000000000,  0.044732604902611,  0.070635326850883,
                                -0.000000000000000, -0.000000000000000, -0.177185572344514,
                                -0.018450979238998, -0.000000000000000, -0.000000000000000,
                                 0.156442082454276, -0.042912842422413,  0.000000000000000,
                                 0.000000000000000, -0.273130055420941, -0.217282394912483,
                                 0.000000000000000,  0.000000000000000, -0.306176207926556,
                                -0.083153014829790,  0.000000000000000, -0.000000000000000,
                                 0.119033673627770, -0.004596137408654,  0.000000000000000,
                                -0.000000000000000, -0.019833717237406, -0.039805696120917,
                                 0.000000000000000, -0.000000000000000,  0.043220765441241,
                                 0.120319531769879,  0.000000000000000, -0.000000000000000,
                                -0.072960087201520, -0.010077533961284,  0.000000000000000,
                                -0.000000000000000,  0.060819768033293, -0.109712912545863,
                                 0.360959245387597,  0.273130055420941,  0.000000000000000,
                                -0.000000000000000,  0.424169089911081,  0.306176207926556,
                                 0.000000000000000, -0.000000000000000, -0.304218062542504,
                                -0.119033673627770, -0.000000000000000, -0.000000000000000,
                                 0.103543158367198,  0.019833717237406,  0.000000000000000,
                                -0.000000000000000, -0.044732604902611, -0.043220765441241,
                                -0.000000000000000, -0.000000000000000,  0.177185572344514,
                                 0.072960087201520, -0.000000000000000, -0.000000000000000,
                                -0.156442082454276, -0.060819768033293, -0.000000000000000,
                                -0.000000000000000,  0.179799009248201,  0.217282394912483,
                                 0.000000000000000,  0.000000000000000,  0.121953736797663,
                                 0.083153014829790,  0.000000000000000,  0.000000000000000,
                                -0.017745244704872,  0.004596137408654,  0.000000000000000,
                                -0.000000000000000,  0.020263018913204,  0.039805696120917,
                                 0.000000000000000, -0.000000000000000, -0.070635326850883,
                                -0.120319531769879,  0.000000000000000, -0.000000000000000,
                                 0.018450979238998,  0.010077533961284, -0.000000000000000,
                                -0.000000000000000,  0.042912842422413,  0.109712912545863,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000,  0.240869537820020,  0.209262087789996,
                                 0.000000000000000, -0.000000000000000,  0.304218062542504,
                                 0.017745244704872,  0.000000000000000, -0.000000000000000,
                                -0.165265825501067, -0.037112787662369, -0.000000000000000,
                                -0.000000000000000, -0.296351253185253, -0.047839791926012,
                                -0.000000000000000, -0.000000000000000, -0.137486723961716,
                                -0.035740589832401, -0.000000000000000, -0.000000000000000,
                                -0.297443103666991, -0.088017553567533, -0.000000000000000,
                                -0.000000000000000, -0.282911611727181, -0.018275834139404,
                                 0.000000000000000,  0.000000000000000,  0.246464022032236,
                                 0.279999405088742,  0.000000000000000,  0.000000000000000,
                                 0.119033673627770, -0.004596137408654,  0.000000000000000,
                                 0.000000000000000, -0.154658173083327,  0.018326992477458,
                                 0.000000000000000, -0.000000000000000, -0.149050399902576,
                                -0.028802226812763,  0.000000000000000, -0.000000000000000,
                                -0.081180476967024, -0.029380693612805,  0.000000000000000,
                                -0.000000000000000, -0.131178220887816, -0.125971819044334,
                                 0.000000000000000, -0.000000000000000, -0.117333037695176,
                                 0.007620915809002, -0.240869537820020, -0.246464022032236,
                                 0.000000000000000, -0.000000000000000, -0.304218062542504,
                                -0.119033673627770,  0.000000000000000, -0.000000000000000,
                                 0.165265825501067,  0.154658173083327,  0.000000000000000,
                                -0.000000000000000,  0.296351253185253,  0.149050399902576,
                                -0.000000000000000, -0.000000000000000,  0.137486723961716,
                                 0.081180476967024, -0.000000000000000, -0.000000000000000,
                                 0.297443103666991,  0.131178220887816, -0.000000000000000,
                                -0.000000000000000,  0.282911611727181,  0.117333037695176,
                                 0.000000000000000,  0.000000000000000, -0.209262087789996,
                                -0.279999405088742,  0.000000000000000,  0.000000000000000,
                                -0.017745244704872,  0.004596137408654,  0.000000000000000,
                                 0.000000000000000,  0.037112787662369, -0.018326992477458,
                                 0.000000000000000,  0.000000000000000,  0.047839791926012,
                                 0.028802226812763,  0.000000000000000, -0.000000000000000,
                                 0.035740589832401,  0.029380693612805, -0.000000000000000,
                                -0.000000000000000,  0.088017553567534,  0.125971819044334,
                                 0.000000000000000, -0.000000000000000,  0.018275834139404,
                                -0.007620915809002, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.287649270231339,
                                -0.112306156435478,  0.000000000000000, -0.000000000000000,
                                -0.103543158367198, -0.020263018913204,  0.000000000000000,
                                -0.000000000000000, -0.296351253185253, -0.047839791926012,
                                 0.000000000000000, -0.000000000000000, -0.108019268804672,
                                -0.008958645001681, -0.000000000000000, -0.000000000000000,
                                -0.131153591264050, -0.030923404757480, -0.000000000000000,
                                -0.000000000000000, -0.173010687068315,  0.021895240280163,
                                -0.000000000000000, -0.000000000000000, -0.312238232484262,
                                -0.188397572130079,  0.000000000000000,  0.000000000000000,
                                -0.189118630384279, -0.130921329646705,  0.000000000000000,
                                 0.000000000000000, -0.019833717237406, -0.039805696120917,
                                 0.000000000000000,  0.000000000000000, -0.149050399902576,
                                -0.028802226812763,  0.000000000000000,  0.000000000000000,
                                -0.093919196408274,  0.034824046607528,  0.000000000000000,
                                -0.000000000000000, -0.063722878498586, -0.033719170688470,
                                 0.000000000000000, -0.000000000000000, -0.071506072703356,
                                 0.071547611671503,  0.000000000000000, -0.000000000000000,
                                -0.268135624706290, -0.232065467146210,  0.287649270231338,
                                 0.189118630384279,  0.000000000000000, -0.000000000000000,
                                 0.103543158367198,  0.019833717237406, -0.000000000000000,
                                -0.000000000000000,  0.296351253185253,  0.149050399902576,
                                 0.000000000000000, -0.000000000000000,  0.108019268804672,
                                 0.093919196408274,  0.000000000000000, -0.000000000000000,
                                 0.131153591264051,  0.063722878498586, -0.000000000000000,
                                -0.000000000000000,  0.173010687068315,  0.071506072703356,
                                -0.000000000000000, -0.000000000000000,  0.312238232484261,
                                 0.268135624706290, -0.000000000000000, -0.000000000000000,
                                 0.112306156435477,  0.130921329646705,  0.000000000000000,
                                 0.000000000000000,  0.020263018913204,  0.039805696120917,
                                 0.000000000000000,  0.000000000000000,  0.047839791926012,
                                 0.028802226812763,  0.000000000000000,  0.000000000000000,
                                 0.008958645001681, -0.034824046607528,  0.000000000000000,
                                 0.000000000000000,  0.030923404757480,  0.033719170688470,
                                 0.000000000000000, -0.000000000000000, -0.021895240280163,
                                -0.071547611671503,  0.000000000000000, -0.000000000000000,
                                 0.188397572130079,  0.232065467146210,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.125036606964113, -0.123784750198694,  0.000000000000000,
                                -0.000000000000000,  0.044732604902611,  0.070635326850883,
                                 0.000000000000000, -0.000000000000000, -0.137486723961716,
                                -0.035740589832401,  0.000000000000000, -0.000000000000000,
                                -0.131153591264051, -0.030923404757480,  0.000000000000000,
                                -0.000000000000000, -0.080278854740725, -0.019244255142092,
                                -0.000000000000000, -0.000000000000000,  0.052480405293751,
                                 0.004161822815120, -0.000000000000000, -0.000000000000000,
                                 0.243992924752862,  0.194641800502342,  0.000000000000000,
                                 0.000000000000000, -0.138287596332059, -0.168390443673249,
                                 0.000000000000000,  0.000000000000000,  0.043220765441241,
                                 0.120319531769879,  0.000000000000000,  0.000000000000000,
                                -0.081180476967024, -0.029380693612805,  0.000000000000000,
                                 0.000000000000000, -0.063722878498586, -0.033719170688470,
                                 0.000000000000000,  0.000000000000000, -0.063255722876013,
                                -0.002254342159463,  0.000000000000000, -0.000000000000000,
                                 0.015983371431252,  0.003153060220026,  0.000000000000000,
                                -0.000000000000000,  0.230814951890418,  0.261191856720537,
                                 0.125036606964113,  0.138287596332059,  0.000000000000000,
                                -0.000000000000000, -0.044732604902611, -0.043220765441241,
                                 0.000000000000000, -0.000000000000000,  0.137486723961716,
                                 0.081180476967024,  0.000000000000000,  0.000000000000000,
                                 0.131153591264050,  0.063722878498586,  0.000000000000000,
                                -0.000000000000000,  0.080278854740725,  0.063255722876013,
                                 0.000000000000000, -0.000000000000000, -0.052480405293751,
                                -0.015983371431252, -0.000000000000000, -0.000000000000000,
                                -0.243992924752861, -0.230814951890418,  0.000000000000000,
                                -0.000000000000000,  0.123784750198694,  0.168390443673249,
                                 0.000000000000000,  0.000000000000000, -0.070635326850883,
                                -0.120319531769879,  0.000000000000000,  0.000000000000000,
                                 0.035740589832401,  0.029380693612805,  0.000000000000000,
                                 0.000000000000000,  0.030923404757480,  0.033719170688470,
                                 0.000000000000000,  0.000000000000000,  0.019244255142092,
                                 0.002254342159463,  0.000000000000000,  0.000000000000000,
                                -0.004161822815120, -0.003153060220026,  0.000000000000000,
                                -0.000000000000000, -0.194641800502342, -0.261191856720537,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.274924224688396,  0.011021942347338,
                                 0.000000000000000, -0.000000000000000, -0.177185572344514,
                                -0.018450979238998,  0.000000000000000, -0.000000000000000,
                                -0.297443103666991, -0.088017553567534,  0.000000000000000,
                                -0.000000000000000, -0.173010687068315,  0.021895240280163,
                                 0.000000000000000, -0.000000000000000,  0.052480405293751,
                                 0.004161822815120,  0.000000000000000, -0.000000000000000,
                                -0.428350935486433, -0.126254423652620, -0.000000000000000,
                                -0.000000000000000, -0.203966987164216, -0.143597399082886,
                                 0.000000000000000,  0.000000000000000, -0.127947800152125,
                                 0.076459604235419,  0.000000000000000,  0.000000000000000,
                                -0.072960087201520, -0.010077533961284,  0.000000000000000,
                                 0.000000000000000, -0.131178220887816, -0.125971819044334,
                                 0.000000000000000,  0.000000000000000, -0.071506072703356,
                                 0.071547611671503,  0.000000000000000,  0.000000000000000,
                                 0.015983371431252,  0.003153060220026,  0.000000000000000,
                                 0.000000000000000, -0.317984757612444, -0.085793108909305,
                                 0.000000000000000, -0.000000000000000, -0.192539081577528,
                                -0.180255253530634,  0.274924224688396,  0.127947800152125,
                                 0.000000000000000, -0.000000000000000,  0.177185572344514,
                                 0.072960087201520,  0.000000000000000,  0.000000000000000,
                                 0.297443103666991,  0.131178220887816,  0.000000000000000,
                                -0.000000000000000,  0.173010687068315,  0.071506072703356,
                                 0.000000000000000, -0.000000000000000, -0.052480405293751,
                                -0.015983371431252,  0.000000000000000, -0.000000000000000,
                                 0.428350935486433,  0.317984757612444,  0.000000000000000,
                                -0.000000000000000,  0.203966987164216,  0.192539081577528,
                                -0.000000000000000, -0.000000000000000, -0.011021942347338,
                                -0.076459604235419,  0.000000000000000,  0.000000000000000,
                                 0.018450979238998,  0.010077533961284,  0.000000000000000,
                                 0.000000000000000,  0.088017553567533,  0.125971819044334,
                                 0.000000000000000,  0.000000000000000, -0.021895240280163,
                                -0.071547611671503,  0.000000000000000,  0.000000000000000,
                                -0.004161822815120, -0.003153060220026,  0.000000000000000,
                                 0.000000000000000,  0.126254423652620,  0.085793108909305,
                                 0.000000000000000,  0.000000000000000,  0.143597399082886,
                                 0.180255253530634,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.009941697628157,
                                 0.001944484643383,  0.000000000000000, -0.000000000000000,
                                 0.156442082454276, -0.042912842422413,  0.000000000000000,
                                -0.000000000000000, -0.282911611727181, -0.018275834139404,
                                 0.000000000000000, -0.000000000000000, -0.312238232484261,
                                -0.188397572130079,  0.000000000000000, -0.000000000000000,
                                 0.243992924752861,  0.194641800502342,  0.000000000000000,
                                -0.000000000000000, -0.203966987164216, -0.143597399082886,
                                 0.000000000000000, -0.000000000000000,  0.265274456014932,
                                 0.409723467974410,  0.000000000000000,  0.000000000000000,
                                 0.004623236882722,  0.001940450348684,  0.000000000000000,
                                 0.000000000000000,  0.060819768033293, -0.109712912545863,
                                 0.000000000000000,  0.000000000000000, -0.117333037695176,
                                 0.007620915809002,  0.000000000000000,  0.000000000000000,
                                -0.268135624706290, -0.232065467146210,  0.000000000000000,
                                 0.000000000000000,  0.230814951890418,  0.261191856720537,
                                 0.000000000000000,  0.000000000000000, -0.192539081577528,
                                -0.180255253530634,  0.000000000000000,  0.000000000000000,
                                 0.358250267698864,  0.608922401089238, -0.009941697628157,
                                -0.004623236882721,  0.000000000000000,  0.000000000000000,
                                -0.156442082454276, -0.060819768033293,  0.000000000000000,
                                -0.000000000000000,  0.282911611727181,  0.117333037695176,
                                -0.000000000000000,  0.000000000000000,  0.312238232484262,
                                 0.268135624706290,  0.000000000000000, -0.000000000000000,
                                -0.243992924752862, -0.230814951890418, -0.000000000000000,
                                -0.000000000000000,  0.203966987164216,  0.192539081577528,
                                 0.000000000000000, -0.000000000000000, -0.265274456014932,
                                -0.358250267698864,  0.000000000000000, -0.000000000000000,
                                -0.001944484643383, -0.001940450348684,  0.000000000000000,
                                 0.000000000000000,  0.042912842422413,  0.109712912545863,
                                 0.000000000000000,  0.000000000000000,  0.018275834139404,
                                -0.007620915809002, -0.000000000000000,  0.000000000000000,
                                 0.188397572130079,  0.232065467146210,  0.000000000000000,
                                 0.000000000000000, -0.194641800502342, -0.261191856720537,
                                 0.000000000000000,  0.000000000000000,  0.143597399082886,
                                 0.180255253530634,  0.000000000000000,  0.000000000000000,
                                -0.409723467974410, -0.608922401089238,  0.000000000000000,
                                 0.000000000000000};
    
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 28, 28));
    
    std::vector<double> intzvals{ 0.000000000000000, -0.000000000000000, -0.069187342720109,
                                 0.078195780586506, -0.000000000000000, -0.000000000000000,
                                -0.110351460681230, -0.033523162165443, -0.000000000000000,
                                -0.000000000000000, -0.103168629102828, -0.007096264341528,
                                -0.000000000000000, -0.000000000000000, -0.030931913842286,
                                -0.000800727653713, -0.000000000000000, -0.000000000000000,
                                 0.188471611193280,  0.012341636963085, -0.000000000000000,
                                -0.000000000000000, -0.146314128679834, -0.049423860012410,
                                -0.000000000000000, -0.000000000000000,  0.004402970814015,
                                 0.000474482947738,  0.000000000000000,  0.000000000000000,
                                 0.005868652755603,  0.144635121241007,  0.000000000000000,
                                -0.000000000000000, -0.083482715130274, -0.022877396746846,
                                 0.000000000000000, -0.000000000000000, -0.035908480819616,
                                -0.002307536617007,  0.000000000000000, -0.000000000000000,
                                -0.009539504693654,  0.001115372091584,  0.000000000000000,
                                -0.000000000000000,  0.068170845954143,  0.001985329093845,
                                 0.000000000000000, -0.000000000000000, -0.120287177256596,
                                -0.033931758382650,  0.000000000000000, -0.000000000000000,
                                 0.001513901760794,  0.000410127440090,  0.069187342720109,
                                -0.005868652755603,  0.000000000000000, -0.000000000000000,
                                 0.110351460681230,  0.083482715130274,  0.000000000000000,
                                 0.000000000000000,  0.103168629102828,  0.035908480819616,
                                -0.000000000000000, -0.000000000000000,  0.030931913842286,
                                 0.009539504693654, -0.000000000000000, -0.000000000000000,
                                -0.188471611193280, -0.068170845954143, -0.000000000000000,
                                -0.000000000000000,  0.146314128679834,  0.120287177256596,
                                 0.000000000000000, -0.000000000000000, -0.004402970814015,
                                -0.001513901760794, -0.000000000000000, -0.000000000000000,
                                -0.078195780586506, -0.144635121241007,  0.000000000000000,
                                 0.000000000000000,  0.033523162165443,  0.022877396746846,
                                 0.000000000000000, -0.000000000000000,  0.007096264341528,
                                 0.002307536617007,  0.000000000000000, -0.000000000000000,
                                 0.000800727653713, -0.001115372091584,  0.000000000000000,
                                -0.000000000000000, -0.012341636963085, -0.001985329093845,
                                 0.000000000000000, -0.000000000000000,  0.049423860012410,
                                 0.033931758382650,  0.000000000000000, -0.000000000000000,
                                -0.000474482947738, -0.000410127440090,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                -0.110351460681230, -0.033523162165443,  0.000000000000000,
                                -0.000000000000000,  0.039502642528534,  0.248507037094883,
                                -0.000000000000000, -0.000000000000000, -0.120707296674690,
                                -0.121121586308972, -0.000000000000000, -0.000000000000000,
                                 0.312052135210456,  0.211244874772618, -0.000000000000000,
                                -0.000000000000000, -0.321863684959253, -0.243054336155257,
                                -0.000000000000000, -0.000000000000000, -0.006554468704107,
                                -0.014876724114521, -0.000000000000000, -0.000000000000000,
                                 0.201725714274910,  0.051906697170599,  0.000000000000000,
                                 0.000000000000000, -0.083482715130274, -0.022877396746846,
                                 0.000000000000000,  0.000000000000000,  0.118248366170586,
                                 0.427557974965425,  0.000000000000000, -0.000000000000000,
                                -0.141189598488715, -0.154239460442287,  0.000000000000000,
                                -0.000000000000000,  0.294949298595600,  0.260671849195475,
                                 0.000000000000000, -0.000000000000000, -0.329282914370105,
                                -0.295805688219816,  0.000000000000000, -0.000000000000000,
                                -0.021808909100785, -0.017073783647244,  0.000000000000000,
                                -0.000000000000000,  0.134525469898975,  0.035040207814332,
                                 0.110351460681230,  0.083482715130274, -0.000000000000000,
                                -0.000000000000000, -0.039502642528534, -0.118248366170586,
                                 0.000000000000000, -0.000000000000000,  0.120707296674690,
                                 0.141189598488715,  0.000000000000000,  0.000000000000000,
                                -0.312052135210456, -0.294949298595599, -0.000000000000000,
                                -0.000000000000000,  0.321863684959254,  0.329282914370105,
                                 0.000000000000000, -0.000000000000000,  0.006554468704107,
                                 0.021808909100785, -0.000000000000000, -0.000000000000000,
                                -0.201725714274910, -0.134525469898975,  0.000000000000000,
                                -0.000000000000000,  0.033523162165443,  0.022877396746846,
                                -0.000000000000000,  0.000000000000000, -0.248507037094883,
                                -0.427557974965425,  0.000000000000000,  0.000000000000000,
                                 0.121121586308972,  0.154239460442287,  0.000000000000000,
                                -0.000000000000000, -0.211244874772618, -0.260671849195475,
                                 0.000000000000000, -0.000000000000000,  0.243054336155257,
                                 0.295805688219816,  0.000000000000000, -0.000000000000000,
                                 0.014876724114521,  0.017073783647244,  0.000000000000000,
                                -0.000000000000000, -0.051906697170598, -0.035040207814332,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.103168629102828, -0.007096264341528,
                                 0.000000000000000, -0.000000000000000, -0.120707296674690,
                                -0.121121586308972,  0.000000000000000, -0.000000000000000,
                                -0.184882055407248,  0.133669150114614, -0.000000000000000,
                                -0.000000000000000,  0.162716952549032, -0.094284143110511,
                                -0.000000000000000, -0.000000000000000,  0.242730421596971,
                                -0.041108447656243, -0.000000000000000, -0.000000000000000,
                                 0.364104506943419,  0.261465923162797, -0.000000000000000,
                                -0.000000000000000, -0.102771468217181, -0.005545408765141,
                                 0.000000000000000,  0.000000000000000, -0.035908480819616,
                                -0.002307536617007,  0.000000000000000,  0.000000000000000,
                                -0.141189598488715, -0.154239460442287,  0.000000000000000,
                                 0.000000000000000, -0.089348416506897,  0.318870059139063,
                                 0.000000000000000, -0.000000000000000, -0.040878394785897,
                                -0.136632451524324,  0.000000000000000, -0.000000000000000,
                                 0.057392155403141, -0.084876468114312,  0.000000000000000,
                                -0.000000000000000,  0.364532469361215,  0.315139637486732,
                                 0.000000000000000, -0.000000000000000, -0.042070109703513,
                                 0.003163596684375,  0.103168629102828,  0.035908480819616,
                                 0.000000000000000, -0.000000000000000,  0.120707296674690,
                                 0.141189598488715, -0.000000000000000, -0.000000000000000,
                                 0.184882055407248,  0.089348416506897,  0.000000000000000,
                                -0.000000000000000, -0.162716952549032,  0.040878394785898,
                                 0.000000000000001, -0.000000000000000, -0.242730421596971,
                                -0.057392155403141, -0.000000000000000, -0.000000000000000,
                                -0.364104506943419, -0.364532469361215,  0.000000000000000,
                                -0.000000000000000,  0.102771468217181,  0.042070109703513,
                                -0.000000000000000, -0.000000000000000,  0.007096264341528,
                                 0.002307536617007,  0.000000000000000,  0.000000000000000,
                                 0.121121586308972,  0.154239460442287, -0.000000000000000,
                                 0.000000000000000, -0.133669150114614, -0.318870059139063,
                                 0.000000000000000,  0.000000000000000,  0.094284143110511,
                                 0.136632451524324,  0.000000000000000, -0.000000000000000,
                                 0.041108447656243,  0.084876468114312,  0.000000000000000,
                                -0.000000000000000, -0.261465923162797, -0.315139637486732,
                                 0.000000000000000, -0.000000000000000,  0.005545408765141,
                                -0.003163596684375,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.030931913842286,
                                -0.000800727653713,  0.000000000000000, -0.000000000000000,
                                 0.312052135210456,  0.211244874772618,  0.000000000000000,
                                -0.000000000000000,  0.162716952549032, -0.094284143110511,
                                 0.000000000000000, -0.000000000000000, -0.686075906426928,
                                -0.023550653446240, -0.000000000000000, -0.000000000000000,
                                 0.108477968366021, -0.062856095407007, -0.000000000000000,
                                -0.000000000000000, -0.130021723004357, -0.088018697821924,
                                -0.000000000000000, -0.000000000000000,  0.158096448527241,
                                 0.004092608007867,  0.000000000000000,  0.000000000000000,
                                -0.009539504693654,  0.001115372091584,  0.000000000000000,
                                 0.000000000000000,  0.294949298595599,  0.260671849195475,
                                 0.000000000000000,  0.000000000000000, -0.040878394785898,
                                -0.136632451524324,  0.000000000000000,  0.000000000000000,
                                -0.434114433064633,  0.170526855362468,  0.000000000000000,
                                -0.000000000000000, -0.027252263190598, -0.091088301016216,
                                 0.000000000000000, -0.000000000000000, -0.122895541081500,
                                -0.108613270498115,  0.000000000000000, -0.000000000000000,
                                 0.048757468434233, -0.005700790690318,  0.030931913842286,
                                 0.009539504693654,  0.000000000000000, -0.000000000000000,
                                -0.312052135210456, -0.294949298595600,  0.000000000000000,
                                -0.000000000000000, -0.162716952549032,  0.040878394785897,
                                -0.000000000000001, -0.000000000000000,  0.686075906426928,
                                 0.434114433064633,  0.000000000000000, -0.000000000000000,
                                -0.108477968366021,  0.027252263190598, -0.000000000000000,
                                -0.000000000000000,  0.130021723004357,  0.122895541081500,
                                -0.000000000000000, -0.000000000000000, -0.158096448527241,
                                -0.048757468434233, -0.000000000000000,  0.000000000000000,
                                 0.000800727653713, -0.001115372091584,  0.000000000000000,
                                 0.000000000000000, -0.211244874772618, -0.260671849195475,
                                 0.000000000000000,  0.000000000000000,  0.094284143110511,
                                 0.136632451524324,  0.000000000000000,  0.000000000000000,
                                 0.023550653446240, -0.170526855362468,  0.000000000000000,
                                 0.000000000000000,  0.062856095407007,  0.091088301016216,
                                -0.000000000000000, -0.000000000000000,  0.088018697821924,
                                 0.108613270498115,  0.000000000000000, -0.000000000000000,
                                -0.004092608007867,  0.005700790690318,  0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.000000000000000,
                                 0.188471611193280,  0.012341636963085,  0.000000000000000,
                                -0.000000000000000, -0.321863684959254, -0.243054336155257,
                                 0.000000000000000, -0.000000000000000,  0.242730421596971,
                                -0.041108447656243,  0.000000000000000, -0.000000000000000,
                                 0.108477968366021, -0.062856095407007,  0.000000000000000,
                                -0.000000000000000, -0.387157406738057,  0.167926189828150,
                                -0.000000000000000, -0.000000000000000, -0.336604831260426,
                                -0.215225253236398, -0.000000000000000, -0.000000000000000,
                                -0.018182653984864, -0.000356671378566,  0.000000000000000,
                                 0.000000000000000,  0.068170845954143,  0.001985329093845,
                                 0.000000000000000,  0.000000000000000, -0.329282914370105,
                                -0.295805688219816,  0.000000000000000,  0.000000000000000,
                                 0.057392155403141, -0.084876468114312,  0.000000000000000,
                                 0.000000000000000, -0.027252263190598, -0.091088301016216,
                                 0.000000000000000,  0.000000000000000, -0.137175212676181,
                                 0.389600449234323,  0.000000000000000, -0.000000000000000,
                                -0.321353990665499, -0.253057423362079,  0.000000000000000,
                                -0.000000000000000, -0.010025250704408,  0.002798481446395,
                                -0.188471611193280, -0.068170845954143,  0.000000000000000,
                                -0.000000000000000,  0.321863684959253,  0.329282914370105,
                                -0.000000000000000, -0.000000000000000, -0.242730421596971,
                                -0.057392155403141,  0.000000000000000, -0.000000000000000,
                                -0.108477968366021,  0.027252263190598,  0.000000000000000,
                                 0.000000000000000,  0.387157406738057,  0.137175212676181,
                                 0.000000000000000, -0.000000000000000,  0.336604831260425,
                                 0.321353990665499, -0.000000000000000, -0.000000000000000,
                                 0.018182653984864,  0.010025250704408, -0.000000000000000,
                                -0.000000000000000, -0.012341636963085, -0.001985329093845,
                                 0.000000000000000,  0.000000000000000,  0.243054336155257,
                                 0.295805688219816,  0.000000000000000,  0.000000000000000,
                                 0.041108447656243,  0.084876468114312,  0.000000000000000,
                                 0.000000000000000,  0.062856095407007,  0.091088301016216,
                                 0.000000000000000,  0.000000000000000, -0.167926189828150,
                                -0.389600449234323,  0.000000000000000,  0.000000000000000,
                                 0.215225253236398,  0.253057423362079, -0.000000000000000,
                                -0.000000000000000,  0.000356671378566, -0.002798481446395,
                                 0.000000000000000, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.146314128679834, -0.049423860012410,
                                 0.000000000000000, -0.000000000000000, -0.006554468704107,
                                -0.014876724114521,  0.000000000000000, -0.000000000000000,
                                 0.364104506943419,  0.261465923162797,  0.000000000000000,
                                -0.000000000000000, -0.130021723004357, -0.088018697821924,
                                 0.000000000000000, -0.000000000000000, -0.336604831260425,
                                -0.215225253236398,  0.000000000000000, -0.000000000000000,
                                 0.026502946265388,  0.219001534267750, -0.000000000000000,
                                -0.000000000000000, -0.121675101288599, -0.034030542623230,
                                 0.000000000000000,  0.000000000000000, -0.120287177256596,
                                -0.033931758382650,  0.000000000000000,  0.000000000000000,
                                -0.021808909100785, -0.017073783647244,  0.000000000000000,
                                 0.000000000000000,  0.364532469361215,  0.315139637486732,
                                 0.000000000000000,  0.000000000000000, -0.122895541081500,
                                -0.108613270498115,  0.000000000000000,  0.000000000000000,
                                -0.321353990665499, -0.253057423362079,  0.000000000000000,
                                 0.000000000000000,  0.074994029787362,  0.393694970731725,
                                 0.000000000000000, -0.000000000000000, -0.086392382973440,
                                -0.023103914051142,  0.146314128679834,  0.120287177256596,
                                -0.000000000000000, -0.000000000000000,  0.006554468704107,
                                 0.021808909100785,  0.000000000000000, -0.000000000000000,
                                -0.364104506943419, -0.364532469361215, -0.000000000000000,
                                -0.000000000000000,  0.130021723004357,  0.122895541081500,
                                 0.000000000000000, -0.000000000000000,  0.336604831260426,
                                 0.321353990665499,  0.000000000000000,  0.000000000000000,
                                -0.026502946265388, -0.074994029787362,  0.000000000000000,
                                -0.000000000000000,  0.121675101288599,  0.086392382973440,
                                -0.000000000000000, -0.000000000000000,  0.049423860012410,
                                 0.033931758382650,  0.000000000000000,  0.000000000000000,
                                 0.014876724114521,  0.017073783647244,  0.000000000000000,
                                 0.000000000000000, -0.261465923162797, -0.315139637486732,
                                 0.000000000000000,  0.000000000000000,  0.088018697821924,
                                 0.108613270498115,  0.000000000000000,  0.000000000000000,
                                 0.215225253236398,  0.253057423362079,  0.000000000000000,
                                 0.000000000000000, -0.219001534267750, -0.393694970731725,
                                 0.000000000000000,  0.000000000000000,  0.034030542623230,
                                 0.023103914051142, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.004402970814015,
                                 0.000474482947738,  0.000000000000000, -0.000000000000000,
                                 0.201725714274910,  0.051906697170598,  0.000000000000000,
                                -0.000000000000000, -0.102771468217181, -0.005545408765141,
                                 0.000000000000000, -0.000000000000000,  0.158096448527241,
                                 0.004092608007867,  0.000000000000000, -0.000000000000000,
                                -0.018182653984864, -0.000356671378566,  0.000000000000000,
                                -0.000000000000000, -0.121675101288599, -0.034030542623230,
                                 0.000000000000000, -0.000000000000000, -0.090829964958079,
                                 0.075863479140502,  0.000000000000000,  0.000000000000000,
                                 0.001513901760794,  0.000410127440090,  0.000000000000000,
                                 0.000000000000000,  0.134525469898975,  0.035040207814332,
                                 0.000000000000000,  0.000000000000000, -0.042070109703513,
                                 0.003163596684375,  0.000000000000000,  0.000000000000000,
                                 0.048757468434233, -0.005700790690318,  0.000000000000000,
                                 0.000000000000000, -0.010025250704408,  0.002798481446395,
                                 0.000000000000000,  0.000000000000000, -0.086392382973440,
                                -0.023103914051142,  0.000000000000000,  0.000000000000000,
                                -0.001572869184532,  0.142619156650225, -0.004402970814015,
                                -0.001513901760794,  0.000000000000000, -0.000000000000000,
                                -0.201725714274910, -0.134525469898975, -0.000000000000000,
                                -0.000000000000000,  0.102771468217181,  0.042070109703513,
                                 0.000000000000000, -0.000000000000000, -0.158096448527241,
                                -0.048757468434233,  0.000000000000000, -0.000000000000000,
                                 0.018182653984864,  0.010025250704408,  0.000000000000000,
                                -0.000000000000000,  0.121675101288599,  0.086392382973440,
                                 0.000000000000000,  0.000000000000000,  0.090829964958079,
                                 0.001572869184532,  0.000000000000000, -0.000000000000000,
                                -0.000474482947738, -0.000410127440090,  0.000000000000000,
                                 0.000000000000000, -0.051906697170599, -0.035040207814332,
                                 0.000000000000000,  0.000000000000000,  0.005545408765141,
                                -0.003163596684375,  0.000000000000000,  0.000000000000000,
                                -0.004092608007867,  0.005700790690318, -0.000000000000000,
                                 0.000000000000000,  0.000356671378566, -0.002798481446395,
                                 0.000000000000000,  0.000000000000000,  0.034030542623230,
                                 0.023103914051142,  0.000000000000000,  0.000000000000000,
                                -0.075863479140502, -0.142619156650225,  0.000000000000000,
                                 0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 28, 28));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeFGForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 3);
    
    CGtoBlock kgtos(mlih, mbas, 4);
    
    CDenseMatrix lmomxmat(28, 36);
    
    CDenseMatrix lmomymat(28, 36);
    
    CDenseMatrix lmomzmat(28, 36);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 2.027729922424561,  1.651625589006949, -0.020213249016394,
                                 0.125811150698599, -0.000000000000000, -0.000000000000000,
                                -0.224011221969573, -0.364025018504012, -0.383204935767120,
                                -0.312127897678783, -0.095643429650498, -0.157738370681347,
                                -0.000000000000000, -0.000000000000000,  0.103868996769930,
                                 0.137307611256223, -0.000000000000000, -0.000000000000000,
                                -0.601987427817012, -0.289754632978375, -0.000000000000000,
                                -0.000000000000000,  0.010965284291491,  0.161108040547993,
                                -0.000000000000000, -0.000000000000000,  0.414487452282503,
                                 0.224420238939029, -0.000000000000000, -0.000000000000000,
                                 0.057696275478819,  0.011232808242957, -0.000000000000000,
                                -0.000000000000000,  0.196307481829701,  0.214146450474742,
                                 1.306132720335507,  1.549193338482968,  0.024793318114591,
                                 0.220971691567425, -0.000000000000000, -0.000000000000000,
                                -0.257539070937831, -0.471506754587677, -0.246835882660860,
                                -0.292770021884560, -0.096155253441783, -0.219483780391312,
                                -0.000000000000000, -0.000000000000000,  0.108095013658314,
                                 0.171193879860988, -0.000000000000000, -0.000000000000000,
                                -0.339298710410908, -0.312005260730399, -0.000000000000000,
                                -0.000000000000000,  0.097826914147819,  0.212733337760871,
                                -0.000000000000000, -0.000000000000000,  0.250192722950890,
                                 0.246491613338411, -0.000000000000000, -0.000000000000000,
                                 0.020469421983974,  0.009742264094966, -0.000000000000000,
                                -0.000000000000000,  0.172541308250993,  0.267289686234935,
                                -0.019837745896611,  0.032938933199277,  2.213997372857088,
                                 0.992879171027782, -0.252383364802722, -0.357726637012134,
                                -0.000000000000000, -0.000000000000000, -0.106010482167719,
                                -0.133310329830911, -0.418406175137871, -0.187636526319677,
                                 0.116312508665715,  0.150493761194078, -0.000000000000000,
                                -0.000000000000000, -0.649036291290921, -0.476688907405175,
                                 0.000000000000000, -0.000000000000000,  0.019960721501854,
                                 0.135012083171405, -0.000000000000000, -0.000000000000000,
                                 0.448433879420062,  0.351126049956849, -0.000000000000000,
                                -0.000000000000000,  0.061040916887282,  0.029003661031402,
                                -0.000000000000000, -0.000000000000000,  0.216799988023258,
                                 0.240497740585370,  0.000000000000000, -0.000000000000000,
                                 0.086012393442062,  0.180422630646618,  0.583466417776202,
                                 1.264911064067353, -0.242175532071592, -0.384983653005166,
                                -0.000000000000000, -0.000000000000000, -0.105547993377004,
                                -0.179207756258598, -0.110264788556682, -0.239045721866879,
                                 0.091042256903475,  0.139779217582248, -0.000000000000000,
                                -0.000000000000000, -0.189693950064828, -0.254751228617835,
                                -0.000000000000000, -0.000000000000000,  0.107420712052036,
                                 0.173696042931094, -0.000000000000000, -0.000000000000000,
                                 0.147169369388071,  0.201259559518171, -0.000000000000000,
                                -0.000000000000000,  0.007226227345846,  0.007954525324035,
                                -0.000000000000000, -0.000000000000000,  0.141978229976667,
                                 0.218241114928069, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.301974554930538,
                                -0.253594531524640,  1.756065624833518,  1.430349717620454,
                                -0.095252095550747, -0.062457454982913, -0.000000000000000,
                                -0.000000000000000, -0.062636758647664, -0.109930609453701,
                                -0.663730418459820, -0.540621377239312, -0.093163249440195,
                                -0.109056301422091, -0.000000000000000, -0.000000000000000,
                                 0.055981540024449,  0.165482771000061, -0.000000000000000,
                                -0.000000000000000, -0.224928349964955,  0.096238686217759,
                                -0.000000000000000, -0.000000000000000, -0.059789848684447,
                                -0.000219054787695, -0.000000000000000, -0.000000000000000,
                                -0.205349657832177, -0.052171807886316, -0.000000000000000,
                                -0.000000000000000,  0.158600900695275,  0.228381561314685,
                                -0.000000000000000, -0.000000000000000, -0.228507367240858,
                                -0.304399024631902,  1.131144116524625,  1.341640786499874,
                                -0.077056109838152, -0.045632190227920, -0.000000000000000,
                                -0.000000000000000, -0.040143086741780, -0.171966080065572,
                                -0.427532289899718, -0.507092552837110, -0.071366065506885,
                                -0.155061111895812, -0.000000000000000, -0.000000000000000,
                                 0.084109922905692,  0.235561116339287, -0.000000000000000,
                                -0.000000000000000,  0.000720088476627,  0.148931709397717,
                                -0.000000000000000, -0.000000000000000, -0.010357031267045,
                                 0.002394760665758, -0.000000000000000, -0.000000000000000,
                                -0.106656785105641, -0.029771814858680, -0.000000000000000,
                                -0.000000000000000,  0.163683415348658,  0.295979684979941,
                                -0.330532117383415, -0.319317200394777, -0.000000000000000,
                                -0.000000000000000, -0.104876973627305, -0.107681975895618,
                                 1.917377968806246,  0.859858584998493, -0.066266901352265,
                                -0.054966491078235, -0.000000000000000, -0.000000000000000,
                                -0.101544938076463, -0.099352230676421, -0.724700753539356,
                                -0.324995996941415,  0.063844265944911,  0.115857996405091,
                                -0.000000000000000, -0.000000000000000, -0.230907416283980,
                                -0.002160291829955, -0.000000000000000, -0.000000000000000,
                                -0.062108583314369, -0.014939810616502, -0.000000000000000,
                                -0.000000000000000, -0.221330886714766, -0.150652593631886,
                                 0.000000000000000, -0.000000000000000,  0.176976732214413,
                                 0.227515104533509, -0.000000000000000, -0.000000000000000,
                                -0.167552858052284, -0.248540762849683, -0.000000000000000,
                                -0.000000000000000, -0.040222044744599, -0.037258527301341,
                                 0.505296740049295,  1.095445115010333, -0.074421040851039,
                                -0.140409716409083, -0.000000000000000, -0.000000000000000,
                                -0.073029493404278, -0.126606867697782, -0.190984216066012,
                                -0.414039335605413,  0.111050987672508,  0.192334846090546,
                                -0.000000000000000, -0.000000000000000,  0.065296279174351,
                                 0.121602231514958, -0.000000000000000, -0.000000000000000,
                                 0.000008180931957,  0.001955313895732, -0.000000000000000,
                                -0.000000000000000, -0.032935836276501, -0.024308585040125,
                                -0.000000000000000, -0.000000000000000,  0.151929466657168,
                                 0.241666400810188, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.129874516161874,
                                -0.082026403542435, -0.000000000000000, -0.000000000000000,
                                 0.052030879670738,  0.001521698097620,  1.484146334410539,
                                 1.208866149596659, -0.130356340327007, -0.134758270231150,
                                -0.000000000000000, -0.000000000000000,  0.143940762485981,
                                -0.002652493076467, -0.000000000000000, -0.000000000000000,
                                 0.041771290384635,  0.057961369668454, -0.000000000000000,
                                -0.000000000000000,  0.103013192861509, -0.043414374824481,
                                -0.000000000000000, -0.000000000000000, -0.046821359464653,
                                -0.009767819554331, -0.000000000000000, -0.000000000000000,
                                -0.130997885373323, -0.007047978055453, -0.000000000000000,
                                -0.000000000000000, -0.276975959793898, -0.192035606427718,
                                 0.000000000000000,  0.000000000000000, -0.083545577792112,
                                -0.093982973252327, -0.000000000000000, -0.000000000000000,
                                 0.026103159922511, -0.012609923817287,  0.955991262791916,
                                 1.133893419027682, -0.119564643560459, -0.149060295988230,
                                -0.000000000000000, -0.000000000000000,  0.043546738926159,
                                -0.026261790512413, -0.000000000000000, -0.000000000000000,
                                 0.032986006760695,  0.082125993439447, -0.000000000000000,
                                -0.000000000000000,  0.016163820739671, -0.081127305581604,
                                -0.000000000000000, -0.000000000000000, -0.014573316998124,
                                -0.009890548057995, -0.000000000000000, -0.000000000000000,
                                -0.051437419366783,  0.015445850471683, -0.000000000000000,
                                -0.000000000000000, -0.190457387599574, -0.221603467319318,
                                -0.140893623541292, -0.117059626814323,  0.000000000000000,
                                -0.000000000000000,  0.056241934493085,  0.037091991629939,
                                -0.000000000000000, -0.000000000000000, -0.144453592355474,
                                -0.166614016517734,  1.620480148259320,  0.726713141576318,
                                 0.152001763830502,  0.062259032099308, -0.000000000000000,
                                -0.000000000000000,  0.045357297982552,  0.045694527718069,
                                -0.000000000000000, -0.000000000000000,  0.107838119872088,
                                 0.024183458229569, -0.000000000000000, -0.000000000000000,
                                -0.049234965237474, -0.020619559073027,  0.000000000000000,
                                -0.000000000000000, -0.139657125924959, -0.073163296623323,
                                -0.000000000000000, -0.000000000000000, -0.301662331862252,
                                -0.266657755727390,  0.000000000000000, -0.000000000000000,
                                -0.053978239330442, -0.076736776325947, -0.000000000000000,
                                -0.000000000000000,  0.000339191007589, -0.010295959682574,
                                -0.000000000000000, -0.000000000000000, -0.088698498684313,
                                -0.121707222026465,  0.427053689753111,  0.925820099772553,
                                -0.002848520339492, -0.021442662162426, -0.000000000000000,
                                -0.000000000000000,  0.038861348501764,  0.067055592848601,
                                -0.000000000000000, -0.000000000000000, -0.030052051568299,
                                -0.066240167627259, -0.000000000000000, -0.000000000000000,
                                -0.006356852099547, -0.008075598672854, -0.000000000000000,
                                -0.000000000000000, -0.003532075021676,  0.012611484099650,
                                -0.000000000000000, -0.000000000000000, -0.126456778867182,
                                -0.180938473387952, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.134010310938082,
                                -0.039118437960009, -0.000000000000000, -0.000000000000000,
                                -0.365320291259646, -0.016808086603581, -0.000000000000000,
                                -0.000000000000000,  0.091795651831441,  0.070476221391517,
                                -0.000000000000000, -0.000000000000000,  0.092503065197437,
                                -0.023928382469421, -0.000000000000000, -0.000000000000000,
                                -0.015756456962068, -0.084457424249476,  1.713744571377442,
                                 1.395878393767715,  0.053900769988551, -0.075369467256997,
                                -0.000000000000000, -0.000000000000000, -0.074025579691510,
                                 0.045603057079914,  0.000000000000000,  0.000000000000000,
                                 0.025222516532140,  0.001854840525777, -0.000000000000000,
                                -0.000000000000000,  0.330823762437542,  0.134932483964298,
                                -0.000000000000000, -0.000000000000000, -0.057614939658587,
                                -0.037981545594220, -0.000000000000000, -0.000000000000000,
                                -0.116022704360149,  0.024751051752830, -0.000000000000000,
                                -0.000000000000000,  0.057893072886302,  0.089162402212928,
                                -0.000000000000000, -0.000000000000000,  0.021638761467232,
                                -0.051017565509715, -0.000000000000000, -0.000000000000000,
                                -0.031968918607308, -0.127247479574914,  1.103883625831686,
                                 1.309307341415955, -0.047953682614285, -0.077527097130854,
                                -0.000000000000000, -0.000000000000000,  0.012770416019562,
                                 0.064634974997011, -0.000000000000000,  0.000000000000000,
                                 0.019960594687952, -0.009423686439202, -0.000000000000000,
                                -0.000000000000000,  0.173460869954325,  0.138219271594484,
                                -0.142769122617147, -0.081321490766053, -0.000000000000000,
                                -0.000000000000000, -0.386040328113641, -0.165501221387177,
                                -0.000000000000000, -0.000000000000000,  0.099120871666561,
                                 0.080852971531028, -0.000000000000000, -0.000000000000000,
                                 0.097410905670854,  0.031501019223641, -0.000000000000000,
                                -0.000000000000000, -0.018128847617871, -0.043589801199356,
                                -0.000000000000000, -0.000000000000000,  0.050823299117405,
                                -0.065524167756926,  1.871169299627926,  0.839136055825452,
                                -0.074690011543222,  0.016723274884782, -0.000000000000000,
                                -0.000000000000000,  0.028194176069627,  0.028279092205010,
                                 0.000000000000000, -0.000000000000000,  0.355579075525773,
                                 0.244086765686098, -0.000000000000000, -0.000000000000000,
                                -0.025391676750149, -0.031011802116031, -0.000000000000000,
                                -0.000000000000000, -0.008893340695557,  0.020209149130551,
                                -0.000000000000000, -0.000000000000000,  0.046764757563838,
                                 0.072800796554158, -0.000000000000000, -0.000000000000000,
                                -0.016866208255038, -0.041655667805939, -0.000000000000000,
                                -0.000000000000000, -0.056996174306317, -0.103897132004588,
                                -0.000000000000000, -0.000000000000000, -0.049578379187643,
                                -0.063300609736594,  0.493119125474763,  1.069044967649699,
                                 0.030651559451898,  0.052774236093409, -0.000000000000000,
                                -0.000000000000000,  0.000695936307975, -0.007694407757343,
                                -0.000000000000000, -0.000000000000000,  0.087990352162870,
                                 0.112855562675217, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.431657256834654,
                                 0.240867753109659, -0.000000000000000, -0.000000000000000,
                                -0.015460660206553, -0.010214788859633, -0.000000000000000,
                                -0.000000000000000, -0.136240758524319, -0.053618725450014,
                                -0.000000000000000, -0.000000000000000,  0.103013192861509,
                                -0.043414374824481, -1.327460836919640, -1.081242754478624,
                                 0.153403545757179, -0.003456673557676, -0.000000000000000,
                                -0.000000000000000,  0.085601904797725, -0.128893427206062,
                                 1.484146334410539,  1.208866149596659, -0.185960620323708,
                                -0.135859901557371, -0.000000000000000, -0.000000000000000,
                                 0.402871684565232,  0.053959936835840, -0.000000000000000,
                                 0.000000000000000,  0.072419157987605, -0.026802093161783,
                                -0.000000000000000, -0.000000000000000,  0.260844214025615,
                                 0.269282467246734, -0.000000000000000, -0.000000000000000,
                                 0.011171162852888, -0.028350443361465, -0.000000000000000,
                                -0.000000000000000, -0.033954631400227, -0.083408809382354,
                                -0.000000000000000, -0.000000000000000,  0.016163820739671,
                                -0.081127305581604, -0.855064579799435, -1.014185105674220,
                                 0.058852089798884, -0.048410908176720, -0.000000000000000,
                                -0.000000000000000, -0.020105732013530, -0.206771538963725,
                                 0.955991262791916,  1.133893419027682, -0.140392841272529,
                                -0.138043940751437, -0.000000000000000, -0.000000000000000,
                                 0.139651900654429,  0.027290575043033, -0.000000000000000,
                                 0.000000000000000,  0.000411257148319, -0.041130398539480,
                                 0.466876491987970,  0.365944403263515, -0.000000000000000,
                                -0.000000000000000, -0.014023551132048,  0.015853780296906,
                                -0.000000000000000, -0.000000000000000, -0.141647972075321,
                                -0.047737000159902, -0.000000000000000, -0.000000000000000,
                                 0.107838119872088,  0.024183458229569, -0.000000000000000,
                                -0.000000000000000,  0.163333764009326,  0.083693564982299,
                                -1.449401507078711, -0.649991993882830,  0.087500745478933,
                                -0.025451846121546, -0.000000000000000, -0.000000000000000,
                                -0.203597520560695, -0.196210541559708,  1.620480148259320,
                                 0.726713141576318,  0.426399888903513,  0.198372752802648,
                                -0.000000000000000, -0.000000000000000,  0.074323082113607,
                                 0.001518164642004, -0.000000000000000,  0.000000000000000,
                                 0.158170943503992,  0.219868213810741, -0.000000000000000,
                                -0.000000000000000, -0.007450743771941, -0.023148040072422,
                                -0.000000000000000, -0.000000000000000, -0.036197365295672,
                                -0.068103007679944, -0.000000000000000, -0.000000000000000,
                                -0.030052051568299, -0.066240167627259, -0.000000000000000,
                                -0.000000000000000, -0.004141968314443, -0.039527341005898,
                                -0.381968432132024, -0.828078671210825, -0.087601992266265,
                                -0.168828254597046, -0.000000000000000, -0.000000000000000,
                                -0.088872708183362, -0.112712405641338,  0.427053689753111,
                                 0.925820099772552,  0.033765342253211,  0.022282661214188,
                                -0.000000000000000, -0.000000000000000, -0.018175207366661,
                                -0.033582829779680, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.058668020158470,
                                -0.208925766726204, -0.000000000000000, -0.000000000000000,
                                 0.346568362432765,  0.064828902202257, -0.000000000000000,
                                -0.000000000000000, -0.059789848684447, -0.000219054787695,
                                -0.000000000000000, -0.000000000000000, -0.045197085458343,
                                 0.002078420033168, -0.000000000000000, -0.000000000000000,
                                -0.099046636241306,  0.142107278907673, -0.663730418459820,
                                -0.540621377239312, -0.107916108721486, -0.144167545933221,
                                -0.000000000000000, -0.000000000000000,  0.218076039397127,
                                -0.118029541091910,  1.756065624833518,  1.430349717620454,
                                 0.085796102722888, -0.048360416673986, -0.000000000000000,
                                -0.000000000000000, -0.311906503239313, -0.256626377977759,
                                -0.000000000000000, -0.000000000000000, -0.128229336470847,
                                -0.279105588586706, -0.000000000000000, -0.000000000000000,
                                 0.146563012594541,  0.035523488238743, -0.000000000000000,
                                -0.000000000000000, -0.010357031267045,  0.002394760665758,
                                -0.000000000000000, -0.000000000000000, -0.005726538028868,
                                 0.004278747830870, -0.000000000000000, -0.000000000000000,
                                 0.053945244849518,  0.202205934866424, -0.427532289899718,
                                -0.507092552837110, -0.085409793641429, -0.206846996017439,
                                -0.000000000000000, -0.000000000000000,  0.011834550030768,
                                -0.198943676200600,  1.131144116524625,  1.341640786499874,
                                -0.030486935275010, -0.039359278505689, -0.000000000000000,
                                -0.000000000000000, -0.233319357837348, -0.307160107304808,
                                -0.071250762825052, -0.177279290021616, -0.000000000000000,
                                -0.000000000000000,  0.369783748262185,  0.207562093082159,
                                -0.000000000000000, -0.000000000000000, -0.062108583314369,
                                -0.014939810616502, -0.000000000000000, -0.000000000000000,
                                -0.046728626911456, -0.008366313141746,  0.000000000000000,
                                -0.000000000000000, -0.097116385634982,  0.072821000879810,
                                -0.000000000000000, -0.000000000000000, -0.117482219212300,
                                -0.118531260620798, -0.724700753539355, -0.324995996941415,
                                 0.226072223347516,  0.020202327876014, -0.000000000000000,
                                -0.000000000000000,  0.084878008594569, -0.041193329585882,
                                 1.917377968806246,  0.859858584998493, -0.341183826136754,
                                -0.326111335266007, -0.000000000000000, -0.000000000000000,
                                -0.139413273747119, -0.227888758798866, -0.000000000000000,
                                -0.000000000000000,  0.040789766630993,  0.029004806689560,
                                -0.000000000000000, -0.000000000000000,  0.000008180931957,
                                 0.001955313895732, -0.000000000000000, -0.000000000000000,
                                 0.001479814290660,  0.003493582974557, -0.000000000000000,
                                -0.000000000000000,  0.095466794265293,  0.165100454461729,
                                -0.000000000000000, -0.000000000000000, -0.096684722096006,
                                -0.168889865023410, -0.190984216066013, -0.414039335605413,
                                -0.080742509196648, -0.162436831414982, -0.000000000000000,
                                -0.000000000000000, -0.031488592702258, -0.032136716327677,
                                 0.505296740049295,  1.095445115010333, -0.169511684502797,
                                -0.250795177411768, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.181889187749947,
                                -0.211592285038629, -0.000000000000000, -0.000000000000000,
                                 0.057696275478819,  0.011232808242957, -0.000000000000000,
                                -0.000000000000000, -0.232717515436854, -0.174002939011747,
                                -0.000000000000000, -0.000000000000000, -0.235058971032990,
                                -0.219059844043887, -0.000000000000000,  0.000000000000000,
                                 0.047146576299664,  0.071946038666888, -0.000000000000000,
                                -0.000000000000000,  0.653940043519903,  0.335121976236822,
                                -0.383204935767120, -0.312127897678783,  0.141282937567306,
                                -0.100768736193986, -0.000000000000000, -0.000000000000000,
                                -0.235479648028870, -0.367525893235712,  2.027729922424561,
                                 1.651625589006949, -0.048351274944154,  0.120190515720666,
                                -0.000000000000000, -0.000000000000000, -0.167722701193950,
                                -0.265104742376713, -0.000000000000000, -0.000000000000000,
                                 0.020469421983974,  0.009742264094966, -0.000000000000000,
                                -0.000000000000000, -0.172793961137195, -0.198706555800808,
                                -0.000000000000000, -0.000000000000000, -0.187525285170012,
                                -0.267871839479816,  0.000000000000000, -0.000000000000000,
                                 0.061968583823456,  0.084890646126441, -0.000000000000000,
                                -0.000000000000000,  0.375900588600654,  0.369782118543216,
                                -0.246835882660859, -0.292770021884560, -0.004059545075688,
                                -0.166536087311865, -0.000000000000000, -0.000000000000000,
                                -0.263095479070274, -0.474694978236590,  1.306132720335508,
                                 1.549193338482968,  0.014643390099911,  0.216079822940649,
                                -0.201579032576308, -0.233664579517590, -0.000000000000000,
                                -0.000000000000000,  0.061040916887282,  0.029003661031402,
                                -0.000000000000000, -0.000000000000000, -0.254806298254869,
                                -0.241813532479105,  0.000000000000000, -0.000000000000000,
                                -0.258012906965050, -0.261757317795356, -0.000000000000000,
                                -0.000000000000000,  0.054237046206737,  0.086328134512521,
                                 0.000000000000000, -0.000000000000000,  0.705514330796064,
                                 0.527777482840215, -0.000000000000000, -0.000000000000000,
                                 0.145427448462866, -0.003081242376248, -0.418406175137872,
                                -0.187636526319677, -0.264682898634862, -0.365571828205765,
                                -0.000000000000000, -0.000000000000000, -0.049625610997921,
                                 0.018560360750201,  2.213997372857089,  0.992879171027781,
                                -0.140337032108563, -0.216457115738312, -0.000000000000000,
                                -0.000000000000000,  0.007226227345846,  0.007954525324035,
                                -0.000000000000000, -0.000000000000000, -0.114505645693489,
                                -0.162243223419284, -0.000000000000000, -0.000000000000000,
                                -0.144971965974725, -0.218716441062090, -0.000000000000000,
                                -0.000000000000000,  0.047498557934382,  0.069312922314984,
                                 0.000000000000000, -0.000000000000000,  0.219813104743989,
                                 0.301925835478747, -0.000000000000000, -0.000000000000000,
                                -0.068702016392616, -0.135976145891219, -0.110264788556682,
                                -0.239045721866879, -0.244437390028592, -0.387586826713737,
                                -0.000000000000000, -0.000000000000000,  0.082395468707880,
                                 0.176428436638508,  0.583466417776202,  1.264911064067352};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 28, 36));
    
    std::vector<double> intyvals{-0.000000000000000, -0.000000000000000, -0.184868838343578,
                                -0.211860441774023, -0.000000000000000, -0.000000000000000,
                                -0.294142542501545, -0.538080206816225, -0.000000000000000,
                                -0.000000000000000,  0.430916756898020,  0.226441601071042,
                                -0.000000000000000, -0.000000000000000, -0.216508970086168,
                                -0.236910309005152, -0.000000000000000, -0.000000000000000,
                                 0.333988004894538,  0.140649257015820, -0.000000000000000,
                                -0.000000000000000,  0.103868996769930,  0.137307611256223,
                                -0.383204935767120, -0.312127897678783,  0.370572888014890,
                                 0.060272960006945, -0.000000000000000, -0.000000000000000,
                                -0.016371264404329, -0.002707729800391, -2.027729922424561,
                                -1.651625589006949,  0.177820129425697,  0.051582233127341,
                                -0.000000000000000, -0.000000000000000, -0.168413862873752,
                                -0.265299949313191, -0.000000000000000, -0.000000000000000,
                                -0.371681400759625, -0.700382085615414, -0.000000000000000,
                                -0.000000000000000,  0.254640439488092,  0.248103734456599,
                                -0.000000000000000, -0.000000000000000, -0.199513345856424,
                                -0.289085373229860, -0.000000000000000,  0.000000000000000,
                                 0.173794614390118,  0.148420515422329, -0.000000000000000,
                                -0.000000000000000,  0.108095013658314,  0.171193879860988,
                                -0.246835882660859, -0.292770021884560,  0.161253622626225,
                                 0.015000992250355, -0.000000000000000, -0.000000000000000,
                                -0.005245581386228, -0.002290980852136, -1.306132720335508,
                                -1.549193338482968,  0.116989136368472,  0.000860953913542,
                                -0.204690507472657, -0.234650750503128, -0.000000000000000,
                                -0.000000000000000, -0.334298899464811, -0.515860001912359,
                                -0.000000000000000, -0.000000000000000,  0.465661217281966,
                                 0.357453971357180, -0.000000000000000, -0.000000000000000,
                                -0.240291482438569, -0.278236113575561, -0.000000000000000,
                                -0.000000000000000,  0.358700647128707,  0.244467507118240,
                                -0.000000000000000,  0.000000000000000,  0.116312508665715,
                                 0.150493761194078, -0.000000000000000, -0.000000000000000,
                                 0.396104053232040,  0.228424598071494, -0.418406175137872,
                                -0.187636526319677, -0.017257417723931, -0.007443126312667,
                                -0.000000000000000, -0.000000000000000,  0.194188375715766,
                                 0.164636952798299, -2.213997372857089, -0.992879171027781,
                                -0.140507156320319, -0.216616501534520, -0.000000000000000,
                                -0.000000000000000, -0.358145730696382, -0.571859578248015,
                                -0.000000000000000, -0.000000000000000,  0.148460740634685,
                                 0.202575850899213, -0.000000000000000, -0.000000000000000,
                                -0.156780026923829, -0.236037218838396, -0.000000000000000,
                                -0.000000000000000,  0.091916664007632,  0.121184843381862,
                                -0.000000000000000, -0.000000000000000,  0.091042256903475,
                                 0.139779217582248, -0.000000000000000, -0.000000000000000,
                                 0.037155398723665,  0.012248258882938, -0.110264788556682,
                                -0.239045721866879, -0.001738255214802, -0.001870578032740,
                                -0.000000000000000, -0.000000000000000,  0.031620389418612,
                                 0.000702965926744, -0.583466417776202, -1.264911064067353,
                                -0.000000000000000, -0.000000000000000,  0.233526774771543,
                                 0.265667718195522, -0.000000000000000, -0.000000000000000,
                                 0.358456331979709,  0.065276928383754, -0.000000000000000,
                                -0.000000000000000,  0.124140081656511, -0.169082244435961,
                                -0.000000000000000, -0.000000000000000, -0.134534179048270,
                                 0.092081846151423, -0.000000000000000, -0.000000000000000,
                                 0.142219228932406,  0.085871515353144, -0.663730418459820,
                                -0.540621377239312, -0.093163249440195, -0.109056301422091,
                                -0.000000000000000, -0.000000000000000,  0.126592986437771,
                                -0.004480026351491, -1.756065624833518, -1.430349717620454,
                                -0.163931159303644,  0.012606031963706, -0.000000000000000,
                                -0.000000000000000, -0.122153076838315,  0.059315419319212,
                                -0.000000000000000, -0.000000000000000,  0.208482208510576,
                                 0.335060791314207, -0.000000000000000, -0.000000000000000,
                                 0.148591048429122,  0.035688493628484, -0.000000000000000,
                                -0.000000000000000, -0.020604753670875, -0.275278499136382,
                                -0.000000000000000, -0.000000000000000,  0.012173164534362,
                                 0.140374213735977, -0.000000000000000, -0.000000000000000,
                                 0.057710233542982,  0.122298289887551, -0.427532289899718,
                                -0.507092552837110, -0.071366065506885, -0.155061111895812,
                                -0.000000000000000, -0.000000000000000,  0.023744247237546,
                                -0.013592826547402, -1.131144116524625, -1.341640786499874,
                                -0.033436502637614,  0.018020275328484, -0.000000000000000,
                                -0.000000000000000, -0.010014796079746,  0.101953755279447,
                                 0.258063692451828,  0.290447204365539, -0.000000000000000,
                                -0.000000000000000,  0.382116117809164,  0.210476630089211,
                                -0.000000000000000, -0.000000000000000,  0.127557034374851,
                                -0.025208347444675, -0.000000000000000, -0.000000000000000,
                                -0.137450162461067,  0.014572334453538, -0.000000000000000,
                                -0.000000000000000,  0.150008405192701,  0.080636866877946,
                                -0.000000000000000, -0.000000000000000, -0.101544938076463,
                                -0.099352230676421, -0.724700753539356, -0.324995996941415,
                                 0.131903199878333,  0.034354661671486, -0.000000000000000,
                                -0.000000000000000, -0.171730418999687, -0.048737287058122,
                                -1.917377968806246, -0.859858584998493, -0.126907074124306,
                                -0.015962781602240, -0.000000000000000, -0.000000000000000,
                                 0.176294057280655,  0.273575990510988, -0.000000000000000,
                                -0.000000000000000,  0.041063719250643,  0.029139533026118,
                                -0.000000000000000, -0.000000000000000, -0.115093205624665,
                                -0.224763953347772, -0.000000000000000, -0.000000000000000,
                                 0.062336650593030,  0.114615065565843, -0.000000000000000,
                                -0.000000000000000,  0.057547220640426,  0.099856135546493,
                                -0.000000000000000, -0.000000000000000, -0.073029493404278,
                                -0.126606867697782, -0.190984216066012, -0.414039335605413,
                                -0.003420525913936, -0.011098496401098, -0.000000000000000,
                                -0.000000000000000,  0.008829742106828,  0.014713493193084,
                                -0.505296740049295, -1.095445115010333,  0.040671931722448,
                                 0.083244892598411, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.093941069254591,
                                -0.139261263495899, -0.000000000000000, -0.000000000000000,
                                -0.115343175452028, -0.009721194956760, -0.000000000000000,
                                -0.000000000000000, -0.042598039595013, -0.034083086341353,
                                -0.000000000000000, -0.000000000000000,  0.241300808064050,
                                -0.153904505599312, -1.327460836919640, -1.081242754478624,
                                 0.188212954411042,  0.044844467832702, -0.000000000000000,
                                -0.000000000000000,  0.143940762485981, -0.002652493076467,
                                -1.484146334410539, -1.208866149596659,  0.260476786206763,
                                 0.172402323137107, -0.000000000000000, -0.000000000000000,
                                 0.265681253245293,  0.047935091559058, -0.000000000000000,
                                 0.000000000000000,  0.262482728029291,  0.127561862028761,
                                -0.000000000000000, -0.000000000000000, -0.111862419895388,
                                -0.170694394900157, -0.000000000000000, -0.000000000000000,
                                -0.054099780232674,  0.013161842437211, -0.000000000000000,
                                -0.000000000000000, -0.004807997403978, -0.063627713266365,
                                -0.000000000000000, -0.000000000000000,  0.018997689629274,
                                -0.268422688632603, -0.855064579799435, -1.014185105674220,
                                 0.086340428766130,  0.020027419689486, -0.000000000000000,
                                -0.000000000000000,  0.043546738926160, -0.026261790512413,
                                -0.955991262791916, -1.133893419027682,  0.156543936607614,
                                 0.199309158521736, -0.000000000000000, -0.000000000000000,
                                 0.079761032620032,  0.050340051903155, -0.000000000000000,
                                 0.000000000000000,  0.147329022030823,  0.138896903616503,
                                -0.106657838482776, -0.155706148957397,  0.000000000000000,
                                -0.000000000000000, -0.124052408937641, -0.076818404849671,
                                -0.000000000000000, -0.000000000000000, -0.043178041600373,
                                -0.006497882013847, -0.000000000000000, -0.000000000000000,
                                 0.251415644092064,  0.031027320737073, -0.000000000000000,
                                -0.000000000000000,  0.201131512328119,  0.121772338080690,
                                -1.449401507078711, -0.649991993882830,  0.152001763830502,
                                 0.062259032099308, -0.000000000000000, -0.000000000000000,
                                 0.280608359592234,  0.218808409132103, -1.620480148259320,
                                -0.726713141576318,  0.279321684786008,  0.113224217133710,
                                -0.000000000000000, -0.000000000000000,  0.282893749279044,
                                 0.206968104211563, -0.000000000000000,  0.000000000000000,
                                -0.092218606049478, -0.139371389819505, -0.000000000000000,
                                -0.000000000000000, -0.005258979760705,  0.010746599348692,
                                -0.000000000000000, -0.000000000000000, -0.023483661096579,
                                -0.051951810334236, -0.000000000000000, -0.000000000000000,
                                -0.105623717340335, -0.219166207511948, -0.000000000000000,
                                -0.000000000000000,  0.028242488770361,  0.016352319701270,
                                -0.381968432132024, -0.828078671210825, -0.002848520339492,
                                -0.021442662162426, -0.000000000000000, -0.000000000000000,
                                 0.113739802513466,  0.162735246480580, -0.427053689753111,
                                -0.925820099772552,  0.031195466913645,  0.041102480262650,
                                -0.000000000000000, -0.000000000000000,  0.083577942009054,
                                 0.113408846904322, -0.000000000000000,  0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.301327375407645,
                                 0.129517766437460, -0.000000000000000, -0.000000000000000,
                                 0.204066520172765,  0.009105431510315, -0.000000000000000,
                                -0.000000000000000,  0.165214548076707,  0.048046524913137,
                                 1.713744571377442,  1.395878393767715,  0.130986657653082,
                                -0.095309785981515, -0.000000000000000, -0.000000000000000,
                                -0.023634685443102, -0.126686136374215, -0.000000000000000,
                                -0.000000000000000,  0.092503065197437, -0.023928382469421,
                                -0.000000000000000, -0.000000000000000, -0.044987800746355,
                                -0.069998151598060, -0.000000000000000, -0.000000000000000,
                                 0.184973396832126,  0.009496566283039, -0.000000000000000,
                                -0.000000000000000, -0.010328566577067,  0.012621828422944,
                                -0.000000000000000, -0.000000000000000,  0.163380836108616,
                                 0.133562339894893,  0.000000000000000, -0.000000000000000,
                                 0.059930791808162, -0.010676005529689, -0.000000000000000,
                                -0.000000000000000,  0.058460740312385,  0.055446698766265,
                                 1.103883625831686,  1.309307341415955, -0.029921381391592,
                                -0.120041735055617, -0.000000000000000, -0.000000000000000,
                                -0.047953377910962, -0.190871219362371, -0.000000000000000,
                                -0.000000000000000,  0.021638761467232, -0.051017565509715,
                                -0.000000000000000, -0.000000000000000, -0.048953661611619,
                                -0.090960108431987, -0.000000000000000, -0.000000000000000,
                                 0.075716623230525, -0.023488208972508, -0.000000000000000,
                                -0.000000000000000,  0.008288872397206,  0.015193117523267,
                                 0.324415785342180,  0.229796905463388, -0.000000000000000,
                                -0.000000000000000,  0.215011446089537,  0.085567734272679,
                                -0.000000000000000,  0.000000000000000,  0.174365652383551,
                                 0.082500985740611, -0.000000000000000, -0.000000000000000,
                                 0.131999053843116, -0.039273318403893,  1.871169299627926,
                                 0.839136055825452, -0.027193271426806, -0.065384701799034,
                                -0.000000000000000, -0.000000000000000,  0.097410905670854,
                                 0.031501019223641, -0.000000000000000, -0.000000000000000,
                                -0.050392589593932, -0.067983419407062, -0.000000000000000,
                                -0.000000000000000,  0.197653165068353,  0.107731162159275,
                                 0.000000000000000, -0.000000000000000, -0.009726649838634,
                                 0.011394879676238, -0.000000000000000, -0.000000000000000,
                                 0.084509493169773,  0.109053193864887, -0.000000000000000,
                                -0.000000000000000,  0.004934339331711, -0.008716922012956,
                                 0.000000000000000,  0.000000000000000,  0.031580309343067,
                                 0.045272039966385, -0.000000000000000, -0.000000000000000,
                                -0.063633552733508, -0.098013666241543,  0.493119125474763,
                                 1.069044967649699, -0.085494261459476, -0.155845698006882,
                                -0.000000000000000, -0.000000000000000, -0.016866208255038,
                                -0.041655667805939, -0.000000000000000, -0.000000000000000,
                                -0.046583045628610, -0.074268617535533, -0.000000000000000,
                                -0.000000000000000,  0.004619320839690, -0.019178042318168,
                                -0.000000000000000, -0.000000000000000,  0.008358292988846,
                                 0.012405128511381, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000,  0.000000000000000, -0.129874516161874,
                                -0.082026403542435, -0.000000000000000, -0.000000000000000,
                                 0.052030879670738,  0.001521698097620,  1.484146334410540,
                                 1.208866149596659, -0.130356340327007, -0.134758270231150,
                                -0.000000000000000, -0.000000000000000,  0.143940762485981,
                                -0.002652493076467, -0.000000000000000, -0.000000000000000,
                                 0.041771290384635,  0.057961369668454, -0.000000000000000,
                                -0.000000000000000,  0.103013192861509, -0.043414374824481,
                                -0.000000000000000, -0.000000000000000, -0.046821359464653,
                                -0.009767819554331, -0.000000000000000, -0.000000000000000,
                                -0.130997885373323, -0.007047978055453, -0.000000000000000,
                                -0.000000000000000, -0.276975959793898, -0.192035606427718,
                                -0.000000000000000, -0.000000000000000, -0.083545577792112,
                                -0.093982973252327, -0.000000000000000, -0.000000000000000,
                                 0.026103159922511, -0.012609923817287,  0.955991262791915,
                                 1.133893419027682, -0.119564643560459, -0.149060295988230,
                                -0.000000000000000, -0.000000000000000,  0.043546738926160,
                                -0.026261790512413, -0.000000000000000, -0.000000000000000,
                                 0.032986006760695,  0.082125993439447, -0.000000000000000,
                                -0.000000000000000,  0.016163820739671, -0.081127305581604,
                                -0.000000000000000, -0.000000000000000, -0.014573316998124,
                                -0.009890548057995, -0.000000000000000, -0.000000000000000,
                                -0.051437419366783,  0.015445850471683, -0.000000000000000,
                                -0.000000000000000, -0.190457387599574, -0.221603467319318,
                                -0.140893623541292, -0.117059626814323, -0.000000000000000,
                                 0.000000000000000,  0.056241934493085,  0.037091991629939,
                                -0.000000000000000, -0.000000000000000, -0.144453592355474,
                                -0.166614016517734,  1.620480148259320,  0.726713141576318,
                                 0.152001763830502,  0.062259032099308, -0.000000000000000,
                                -0.000000000000000,  0.045357297982552,  0.045694527718069,
                                -0.000000000000000, -0.000000000000000,  0.107838119872088,
                                 0.024183458229569, -0.000000000000000, -0.000000000000000,
                                -0.049234965237474, -0.020619559073028, -0.000000000000000,
                                -0.000000000000000, -0.139657125924959, -0.073163296623323,
                                -0.000000000000000, -0.000000000000000, -0.301662331862252,
                                -0.266657755727390,  0.000000000000000, -0.000000000000000,
                                -0.053978239330441, -0.076736776325947,  0.000000000000000,
                                 0.000000000000000,  0.000339191007589, -0.010295959682574,
                                -0.000000000000000, -0.000000000000000, -0.088698498684313,
                                -0.121707222026465,  0.427053689753111,  0.925820099772552,
                                -0.002848520339492, -0.021442662162426, -0.000000000000000,
                                -0.000000000000000,  0.038861348501764,  0.067055592848601,
                                -0.000000000000000, -0.000000000000000, -0.030052051568299,
                                -0.066240167627259, -0.000000000000000, -0.000000000000000,
                                -0.006356852099547, -0.008075598672854, -0.000000000000000,
                                -0.000000000000000, -0.003532075021676,  0.012611484099650,
                                -0.000000000000000, -0.000000000000000, -0.126456778867182,
                                -0.180938473387952, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.093797215105872,
                                -0.064005344906657,  1.756065624833518,  1.430349717620454,
                                 0.286544531422614, -0.000711247952714, -0.000000000000000,
                                -0.000000000000000,  0.126592986437771, -0.004480026351491,
                                 0.663730418459820,  0.540621377239312,  0.257692162476997,
                                 0.065700657446061, -0.000000000000000, -0.000000000000000,
                                -0.008777349012201, -0.176485420391164, -0.000000000000000,
                                -0.000000000000000, -0.045197085458343,  0.002078420033168,
                                -0.000000000000000, -0.000000000000000,  0.109018839467683,
                                -0.172857981382455, -0.000000000000000, -0.000000000000000,
                                 0.193461688285233,  0.051723781704820, -0.000000000000000,
                                -0.000000000000000,  0.146100453713210,  0.247337464355991,
                                -0.000000000000000, -0.000000000000000,  0.000929182603562,
                                -0.105921850514514,  1.131144116524625,  1.341640786499874,
                                 0.070036950332708, -0.012558440823939, -0.000000000000000,
                                -0.000000000000000,  0.023744247237547, -0.013592826547402,
                                 0.427532289899718,  0.507092552837110,  0.080037604886850,
                                 0.086302861378400, -0.000000000000000, -0.000000000000000,
                                -0.083373294683057, -0.251195220791675, -0.000000000000000,
                                -0.000000000000000, -0.005726538028868,  0.004278747830870,
                                -0.000000000000000, -0.000000000000000, -0.021858051395643,
                                -0.281086135262876, -0.000000000000000, -0.000000000000000,
                                 0.104628749271060,  0.029606809468939, -0.000000000000000,
                                -0.000000000000000,  0.175929159262268,  0.319006041715152,
                                 0.097016349819019,  0.003070908661548, -0.000000000000000,
                                -0.000000000000000,  0.300866145115036,  0.100899646388748,
                                 1.917377968806246,  0.859858584998493,  0.131903199878333,
                                 0.034354661671486, -0.000000000000000, -0.000000000000000,
                                 0.270964543689403,  0.113359576194305,  0.724700753539355,
                                 0.324995996941415, -0.015493763391669, -0.114328805231543,
                                -0.000000000000000, -0.000000000000000, -0.046728626911456,
                                -0.008366313141746, -0.000000000000000, -0.000000000000000,
                                 0.112150948618025, -0.026937897358657, -0.000000000000000,
                                -0.000000000000000,  0.208998517167787,  0.147738056624834,
                                -0.000000000000000, -0.000000000000000,  0.165397591873974,
                                 0.244350669174829, -0.000000000000000, -0.000000000000000,
                                -0.043682678071008, -0.086484828790639, -0.000000000000000,
                                -0.000000000000000, -0.001442892917118, -0.010253923994529,
                                 0.505296740049295,  1.095445115010333, -0.003420525913936,
                                -0.011098496401098, -0.000000000000000, -0.000000000000000,
                                 0.043504334692931,  0.070465991239743,  0.190984216066013,
                                 0.414039335605413, -0.118470034686069, -0.205100038921788,
                                -0.000000000000000, -0.000000000000000,  0.001479814290660,
                                 0.003493582974557, -0.000000000000000, -0.000000000000000,
                                -0.117652119446866, -0.229505868388327, -0.000000000000000,
                                -0.000000000000000,  0.032661883656850,  0.024173858703568,
                                -0.000000000000000, -0.000000000000000,  0.164491930837863,
                                 0.260467342355709, -0.000000000000000, -0.000000000000000,
                                 2.027729922424561,  1.651625589006949, -0.205908285851224,
                                -0.057198380047869, -0.000000000000000, -0.000000000000000,
                                -0.016371264404329, -0.002707729800391,  0.383204935767120,
                                 0.312127897678783, -0.214404093001382, -0.013239248076703,
                                -0.000000000000000, -0.000000000000000,  0.396616572764003,
                                 0.052311840321989, -0.000000000000000, -0.000000000000000,
                                 0.312735567049072,  0.220474076660125, -0.000000000000000,
                                -0.000000000000000, -0.235058971032991, -0.219059844043887,
                                -0.000000000000000, -0.000000000000000,  0.216288210821337,
                                 0.171981576879733, -0.000000000000000, -0.000000000000000,
                                -0.395093762496120, -0.559246160793360, -0.000000000000000,
                                -0.000000000000000, -0.193327831236070, -0.213878293739347,
                                 1.306132720335507,  1.549193338482968, -0.127127496621145,
                                -0.005749555421424, -0.000000000000000, -0.000000000000000,
                                -0.005245581386228, -0.002290980852136,  0.246835882660860,
                                 0.292770021884560, -0.091020482263041,  0.030022385670850,
                                -0.000000000000000, -0.000000000000000,  0.143830062354437,
                                 0.020461618298283, -0.000000000000000, -0.000000000000000,
                                 0.226532965301670,  0.247941526986647, -0.000000000000000,
                                -0.000000000000000, -0.187525285170012, -0.267871839479816,
                                -0.000000000000000, -0.000000000000000,  0.168346244599993,
                                 0.197094434682620, -0.000000000000000, -0.000000000000000,
                                -0.409270424252533, -0.718920513620986, -0.000000000000000,
                                -0.000000000000000, -0.171850146571190, -0.267094479298457,
                                -0.223924165011738, -0.178999020004690,  2.213997372857088,
                                 0.992879171027782, -0.017257417723931, -0.007443126312667,
                                -0.000000000000000, -0.000000000000000, -0.229346394458882,
                                -0.129300148417975,  0.418406175137871,  0.187636526319677,
                                 0.420620669547145,  0.204256450336586, -0.000000000000000,
                                -0.000000000000000,  0.342014172714145,  0.317220632508652,
                                -0.000000000000000, -0.000000000000000, -0.258012906965050,
                                -0.261757317795356, -0.000000000000000, -0.000000000000000,
                                 0.237578960392965,  0.235485611078774, -0.000000000000000,
                                -0.000000000000000, -0.441300495691565, -0.569087695914490,
                                -0.000000000000000, -0.000000000000000, -0.213688513126910,
                                -0.239511569599833, -0.000000000000000, -0.000000000000000,
                                -0.035234466835805, -0.004694492343447,  0.583466417776202,
                                 1.264911064067353, -0.001738255214802, -0.001870578032740,
                                -0.000000000000000, -0.000000000000000, -0.006657104074682,
                                 0.024513175251542,  0.110264788556682,  0.239045721866879,
                                 0.032467837934062,  0.016706841380796, -0.000000000000000,
                                -0.000000000000000,  0.144902582596005,  0.202443409054596,
                                -0.000000000000000, -0.000000000000000, -0.144971965974725,
                                -0.218716441062090, -0.000000000000000, -0.000000000000000,
                                 0.113214274446876,  0.160926932038242, -0.000000000000000,
                                -0.000000000000000, -0.371773652453893, -0.586996141330340,
                                -0.000000000000000, -0.000000000000000, -0.141808105764911,
                                -0.218081729131861, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 28, 36));
    
    std::vector<double> intzvals{-0.000000000000000, -0.000000000000000, -0.084988043096735,
                                -0.129659606604611,  1.433821578561278,  1.167875653968039,
                                 0.078094809923358, -0.025788514984289, -0.000000000000000,
                                -0.000000000000000,  0.026110020659828, -0.046707946478353,
                                -0.000000000000000, -0.000000000000000,  0.067168647479152,
                                -0.017699867535174, -0.000000000000000, -0.000000000000000,
                                 0.019271030283480, -0.004491812804491, -0.000000000000000,
                                -0.000000000000000, -0.110278247222368,  0.040137790550295,
                                -0.000000000000000, -0.000000000000000,  0.020097651328518,
                                -0.070658404135016, -0.000000000000000, -0.000000000000000,
                                -0.004853243244626, -0.000182905922679, -0.000000000000000,
                                -0.000000000000000,  0.124393807039287,  0.194211478971188,
                                -0.000000000000000, -0.000000000000000, -0.092908404825046,
                                -0.167512795820161,  0.923575303678869,  1.095445115010333,
                                -0.002865559868591, -0.023756225647935, -0.000000000000000,
                                -0.000000000000000, -0.006694798193195, -0.075754106405091,
                                 0.000000000000000,  0.000000000000000,  0.003540141127561,
                                -0.028070438229020, -0.000000000000000, -0.000000000000000,
                                 0.000300727212598, -0.006382596415621, -0.000000000000000,
                                -0.000000000000000, -0.002043874470996,  0.062547907244758,
                                -0.000000000000000, -0.000000000000000, -0.013151752424194,
                                -0.113775277246297, -0.000000000000000, -0.000000000000000,
                                -0.000827942162467, -0.000067363168279, -0.000000000000000,
                                -0.000000000000000,  0.138646253004941,  0.251066871582949,
                                -0.095332412904522, -0.129107007965627, -0.000000000000000,
                                -0.000000000000000,  0.080012244209295, -0.002768874426542,
                                 1.565532555876448,  0.702071594732622,  0.026795906665643,
                                -0.008414744118638, -0.000000000000000, -0.000000000000000,
                                 0.069165264362544,  0.005718474861613, -0.000000000000000,
                                 0.000000000000000,  0.019739010010430,  0.000624289682394,
                                -0.000000000000000, -0.000000000000000, -0.113344440005688,
                                -0.004297468484085, -0.000000000000000, -0.000000000000000,
                                 0.020429710085986, -0.017096502689403, -0.000000000000000,
                                -0.000000000000000, -0.005034668784923, -0.001189854750623,
                                -0.000000000000000, -0.000000000000000,  0.139773732507805,
                                 0.192638395444837, -0.000000000000000, -0.000000000000000,
                                -0.086236546507551, -0.136773625048806, -0.000000000000000,
                                -0.000000000000000, -0.017009639572679, -0.019396877017286,
                                 0.412573060604175,  0.894427190999917, -0.031778686558830,
                                -0.061852968870992, -0.000000000000000, -0.000000000000000,
                                -0.012053595569582, -0.022919416839137,  0.000000000000000,
                                -0.000000000000000, -0.003028813260157, -0.005211368150796,
                                -0.000000000000000, -0.000000000000000,  0.027261226000946,
                                 0.051070152409529, -0.000000000000000, -0.000000000000000,
                                -0.048027936782147, -0.092897124865706, -0.000000000000000,
                                -0.000000000000000, -0.000111840688640, -0.000055001796580,
                                -0.000000000000000, -0.000000000000000,  0.129178494593533,
                                 0.204995242231698, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.091635118538771,
                                -0.017625139634340, -0.000000000000000, -0.000000000000000,
                                -0.044884942351158, -0.218854732192625,  1.877313119090894,
                                 1.529108167601312, -0.133385714757671, -0.301558813402760,
                                -0.000000000000000, -0.000000000000000,  0.048319782642980,
                                 0.047855107471108, -0.000000000000000, -0.000000000000000,
                                -0.494104939143227, -0.220805025455593, -0.000000000000000,
                                -0.000000000000000,  0.313536631717580,  0.164160179642031,
                                -0.000000000000000, -0.000000000000000,  0.047340682719740,
                                 0.016667712427272, -0.000000000000000, -0.000000000000000,
                                 0.070150295190826,  0.338201764004938, -0.000000000000000,
                                -0.000000000000000, -0.199335519334789, -0.041524398929178,
                                -0.000000000000000, -0.000000000000000, -0.039065037776316,
                                -0.009762286133469, -0.000000000000000, -0.000000000000000,
                                -0.113224858965527, -0.307272846421235,  1.209243925457213,
                                 1.434274331201273, -0.192192692972083, -0.388475720643439,
                                -0.000000000000000, -0.000000000000000,  0.046970281029937,
                                 0.050780745424376, -0.000000000000000, -0.000000000000000,
                                -0.294344265311190, -0.213043381067974, -0.000000000000000,
                                -0.000000000000000,  0.200299065941427,  0.166035829959708,
                                -0.000000000000000, -0.000000000000000,  0.027078089912001,
                                 0.014611141024638, -0.000000000000000, -0.000000000000000,
                                 0.181831135275241,  0.470635033935234, -0.000000000000000,
                                -0.000000000000000, -0.090243736987803, -0.023143714014918,
                                -0.097795481526438, -0.055302560771396, -0.000000000000000,
                                -0.000000000000000, -0.055058342401853, -0.155856378379852,
                                -0.000000000000000, -0.000000000000000, -0.152873670999890,
                                -0.265895615711899,  2.049763268634716,  0.919227493183029,
                                 0.053985961352624,  0.065517384275920, -0.000000000000000,
                                -0.000000000000000, -0.535175801472318, -0.413918926581761,
                                -0.000000000000000, -0.000000000000000,  0.340730426616507,
                                 0.281208049332067, -0.000000000000000, -0.000000000000000,
                                 0.051274425008247,  0.038212631711119, -0.000000000000000,
                                -0.000000000000000,  0.086802729673864,  0.250573331793454,
                                -0.000000000000000, -0.000000000000000, -0.213350734492790,
                                -0.127678461488911,  0.000000000000000, -0.000000000000000,
                                -0.011098855036114, -0.007970873250015, -0.000000000000000,
                                -0.000000000000000, -0.146700852787942, -0.250887228514869,
                                -0.000000000000000, -0.000000000000000, -0.200802695190125,
                                -0.317189097678802,  0.540184937119496,  1.171080087538241,
                                 0.031365453496711,  0.041462305015964, -0.000000000000000,
                                -0.000000000000000, -0.143452506575309, -0.173949192231283,
                                -0.000000000000000, -0.000000000000000,  0.107041853336702,
                                 0.135567687473599, -0.000000000000000, -0.000000000000000,
                                 0.010742098501726,  0.011929946690070, -0.000000000000000,
                                -0.000000000000000,  0.226504378553838,  0.384271896072922,
                                -0.000000000000000, -0.000000000000000, -0.026162793759017,
                                -0.018896763363150, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.112328201825084,
                                 0.017485615670977,  0.000000000000000, -0.000000000000000,
                                -0.103814624094108, -0.075325664457733, -0.000000000000000,
                                -0.000000000000000,  0.105492843110936, -0.049042541646818,
                                 2.098899874669700,  1.709594903853338, -0.233900641164779,
                                -0.509775356642441, -0.000000000000000, -0.000000000000000,
                                 0.044499874482174,  0.230382794460859, -0.000000000000000,
                                -0.000000000000000, -0.057594771914410,  0.090268125695281,
                                -0.000000000000000, -0.000000000000000, -0.377107128171475,
                                 0.101506356069798, -0.000000000000000, -0.000000000000000,
                                -0.177485666996328, -0.141011609275071, -0.000000000000000,
                                -0.000000000000000, -0.005534775771428,  0.000945124899249,
                                -0.000000000000000, -0.000000000000000,  0.037428644215835,
                                 0.013339614712277, -0.000000000000000, -0.000000000000000,
                                -0.085774689261091, -0.078444955477978, -0.000000000000000,
                                -0.000000000000000,  0.042184239245429, -0.114593980885192,
                                 1.351975809350508,  1.603567451474547, -0.312682339085410,
                                -0.675670949051889, -0.000000000000000, -0.000000000000000,
                                 0.147352911392305,  0.302092251406670, -0.000000000000000,
                                -0.000000000000000,  0.063196935751404,  0.103749411002201,
                                -0.000000000000000, -0.000000000000000, -0.101726782478433,
                                 0.225416799533222, -0.000000000000000, -0.000000000000000,
                                -0.148604670676741, -0.151419975555886, -0.000000000000000,
                                -0.000000000000000,  0.000941286711118,  0.000807518784730,
                                 0.118639655355874,  0.053144805269515, -0.000000000000000,
                                -0.000000000000000, -0.114867868305676, -0.120199214821641,
                                 0.000000000000000,  0.000000000000000,  0.113772434989791,
                                 0.060856175380663, -0.000000000000000, -0.000000000000000,
                                -0.265658877748751, -0.432526488056067,  2.291705003224694,
                                 1.027727580771989,  0.058834799453743,  0.203798133848900,
                                -0.000000000000000, -0.000000000000000, -0.052605221278818,
                                 0.086974004751927,  0.000000000000000, -0.000000000000000,
                                -0.398964643773224, -0.147554047682185, -0.000000000000000,
                                -0.000000000000000, -0.196261129742125, -0.207910666967715,
                                 0.000000000000000, -0.000000000000000, -0.005517100600115,
                                 0.001292275906411, -0.000000000000000, -0.000000000000000,
                                 0.011149185229251,  0.010891749803467, -0.000000000000000,
                                -0.000000000000000, -0.049228609171722, -0.064050037938797,
                                 0.000000000000000,  0.000000000000000, -0.034906027313265,
                                -0.093565593587656, -0.000000000000000, -0.000000000000000,
                                -0.340125895340434, -0.551683019733059,  0.603945119910322,
                                 1.309307341415956,  0.153487284259960,  0.246657290398305,
                                -0.000000000000000, -0.000000000000000,  0.059589086505946,
                                 0.084711039356563, -0.000000000000000, -0.000000000000000,
                                 0.071932577233447,  0.184052046102546, -0.000000000000000,
                                -0.000000000000000, -0.092404123136164, -0.123633892325541,
                                -0.000000000000000, -0.000000000000000,  0.000610553025716,
                                 0.000659336326767, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.063762256007817,
                                -0.002585012799719, -0.000000000000000, -0.000000000000000,
                                -0.029114309802515, -0.024092466584176, -0.000000000000000,
                                -0.000000000000000, -0.318523976690965, -0.075365514215796,
                                -0.000000000000000, -0.000000000000000,  0.215422082833773,
                                -0.102625593737648,  2.167734469320689,  1.765662024369346,
                                 0.239653540053136, -0.523269246444351, -0.000000000000000,
                                -0.000000000000000,  0.143614721889182, -0.068417062491766,
                                -0.000000000000000, -0.000000000000000,  0.132718323621236,
                                 0.031402297589915, -0.000000000000000, -0.000000000000000,
                                 0.148806472323967,  0.123139273652455, -0.000000000000000,
                                -0.000000000000000, -0.063230903874419, -0.002563471026388,
                                -0.000000000000000, -0.000000000000000, -0.014250351644906,
                                 0.000446482346769, -0.000000000000000, -0.000000000000000,
                                -0.025492652568909, -0.026187843377422, -0.000000000000000,
                                -0.000000000000000, -0.133452972943806, -0.063100903038277,
                                -0.000000000000000, -0.000000000000000,  0.075014255835909,
                                -0.221490246794628,  1.396314611757284,  1.656157342421651,
                                -0.194884233251827, -0.740231513068814, -0.000000000000000,
                                -0.000000000000000,  0.050009503890606, -0.147660164529752,
                                -0.000000000000000, -0.000000000000000,  0.055605405393252,
                                 0.026292042932615, -0.000000000000000, -0.000000000000000,
                                 0.130295779796645,  0.133848977262379,  0.000000000000000,
                                 0.000000000000000, -0.014131598714532,  0.000442761660546,
                                -0.066604920238909, -0.020424800314799, -0.000000000000000,
                                -0.000000000000000, -0.032329400364699, -0.035681340382980,
                                -0.000000000000000, -0.000000000000000, -0.339355531709922,
                                -0.188761738628637, -0.000000000000000, -0.000000000000000,
                                 0.231173272268016,  0.108965082143110, -0.000000000000000,
                                -0.000000000000000,  0.231519054038005, -0.263099867109439,
                                 2.366862749842523,  1.061432481271453,  0.154115514845344,
                                 0.072643388095407, -0.000000000000000, -0.000000000000000,
                                 0.141398138212468,  0.078650724428599, -0.000000000000000,
                                -0.000000000000000,  0.165239157419572,  0.182371295290786,
                                -0.000000000000000, -0.000000000000000, -0.066049879236918,
                                -0.020254593645509, -0.000000000000000, -0.000000000000000,
                                -0.001511094211505,  0.000364551309582, -0.000000000000000,
                                -0.000000000000000, -0.015796571010737, -0.021382284579536,
                                -0.000000000000000, -0.000000000000000, -0.048418568152210,
                                -0.051521671584205, -0.000000000000000, -0.000000000000000,
                                -0.072335999147152, -0.180846029216652, -0.000000000000000,
                                -0.000000000000000, -0.351569016488730, -0.604396499515644,
                                 0.623751837716245,  1.352246807565627, -0.048223999431435,
                                -0.120564019477768, -0.000000000000000, -0.000000000000000,
                                 0.020174403396754,  0.021467363160086, -0.000000000000000,
                                -0.000000000000000,  0.080738029610436,  0.109287232295406,
                                -0.000000000000000, -0.000000000000000, -0.001498501759742,
                                 0.000361513382002, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.051780915371125,
                                -0.006103309773850, -0.000000000000000, -0.000000000000000,
                                 0.219893614232736,  0.164544145028614, -0.000000000000000,
                                -0.000000000000000,  0.326599159670305, -0.095058076777589,
                                -0.000000000000000, -0.000000000000000, -0.057594771914410,
                                 0.090268125695281, -0.000000000000000, -0.000000000000000,
                                 0.029666582988116,  0.153588529640573,  2.098899874669700,
                                 1.709594903853338, -0.185904997902771, -0.584998794721842,
                                -0.000000000000000, -0.000000000000000,  0.363644682116917,
                                -0.082000413584773,  0.000000000000000,  0.000000000000000,
                                -0.061760076418002, -0.051989233168803, -0.000000000000000,
                                -0.000000000000000,  0.124040956128922,  0.018539717102637,
                                -0.000000000000000, -0.000000000000000, -0.014236271516986,
                                -0.004562462570408, -0.000000000000000, -0.000000000000000,
                                 0.182483122481402,  0.173223477089177, -0.000000000000000,
                                -0.000000000000000,  0.092853607799135, -0.213064685331967,
                                -0.000000000000000, -0.000000000000000,  0.063196935751404,
                                 0.103749411002201, -0.000000000000000, -0.000000000000000,
                                 0.098235274261537,  0.201394834271113,  1.351975809350508,
                                 1.603567451474547, -0.365346452211581, -0.762128791553723,
                                -0.000000000000000, -0.000000000000000,  0.087536020939617,
                                -0.177727009024934,  0.000000000000000, -0.000000000000000,
                                -0.052178557888135, -0.056823149790798, -0.000000000000000,
                                -0.000000000000000,  0.040145542283366,  0.014106956658429,
                                -0.054334324442175, -0.020261973810466, -0.000000000000000,
                                -0.000000000000000,  0.243256250565496,  0.255583713479090,
                                -0.000000000000000, -0.000000000000000,  0.346278645783561,
                                 0.134568712771910, -0.000000000000000, -0.000000000000000,
                                -0.052605221278818,  0.086974004751927,  0.000000000000000,
                                -0.000000000000000,  0.039223199635829,  0.135865422565933,
                                -0.000000000000000, -0.000000000000000, -0.221821193349736,
                                -0.505004825349340,  2.291705003224694,  1.027727580771989,
                                 0.383056424714732,  0.127225664922067, -0.000000000000000,
                                -0.000000000000000, -0.068264373489166, -0.072923443697861,
                                -0.000000000000000, -0.000000000000000,  0.130870599836877,
                                 0.057021359950075, -0.000000000000000, -0.000000000000000,
                                -0.003883012822755, -0.003725235089349, -0.000000000000000,
                                -0.000000000000000,  0.107637578092359,  0.141436376779725,
                                -0.000000000000000, -0.000000000000000, -0.067415607326474,
                                -0.173966587089993, -0.000000000000000, -0.000000000000000,
                                 0.059589086505946,  0.084711039356563, -0.000000000000000,
                                -0.000000000000000,  0.102324856173307,  0.164438193598870,
                                -0.000000000000000, -0.000000000000000, -0.389783467428722,
                                -0.622275552530195,  0.603945119910322,  1.309307341415956,
                                -0.057992762393350, -0.145113495207370, -0.000000000000000,
                                -0.000000000000000, -0.034122099673496, -0.046395907521730,
                                -0.000000000000000, -0.000000000000000,  0.011817929107373,
                                 0.011518281878903, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000,  0.190929455453606,
                                 0.041207596578093, -0.000000000000000, -0.000000000000000,
                                -0.065829114797336, -0.323017044947367, -0.000000000000000,
                                -0.000000000000000,  0.047340682719740,  0.016667712427272,
                                -0.000000000000000, -0.000000000000000, -0.385853719043513,
                                -0.191873435172641,  0.000000000000000, -0.000000000000000,
                                 0.205877057976344,  0.092002093939831, -0.000000000000000,
                                -0.000000000000000,  0.417940451197749,  0.189500635738673,
                                 1.877313119090894,  1.529108167601312, -0.039493360696854,
                                -0.268501183755338, -0.000000000000000, -0.000000000000000,
                                -0.045767997640950, -0.221957807108912, -0.000000000000000,
                                -0.000000000000000, -0.070975287623060, -0.016846525160356,
                                -0.000000000000000, -0.000000000000000,  0.088809699096682,
                                 0.023027037584900, -0.000000000000000, -0.000000000000000,
                                -0.163471323593986, -0.455747133193905, -0.000000000000000,
                                -0.000000000000000,  0.027078089912001,  0.014611141024638,
                                -0.000000000000000, -0.000000000000000, -0.239252159260383,
                                -0.192995243506652, -0.000000000000000, -0.000000000000000,
                                 0.122643443879662,  0.088768075444989, -0.000000000000000,
                                -0.000000000000000,  0.246063869104603,  0.188573303553198,
                                 1.209243925457213,  1.434274331201273, -0.138487814646614,
                                -0.359496957611241, -0.000000000000000, -0.000000000000000,
                                -0.116976780280624, -0.310315264998190, -0.000000000000000,
                                -0.000000000000000, -0.035540560592219, -0.009475527033123,
                                 0.204630432358023,  0.125617572607205, -0.000000000000000,
                                -0.000000000000000, -0.080350206611203, -0.224873608097211,
                                -0.000000000000000, -0.000000000000000,  0.051274425008247,
                                 0.038212631711119, -0.000000000000000, -0.000000000000000,
                                -0.418655871992778, -0.336087641207524, -0.000000000000000,
                                -0.000000000000000,  0.222989917280133,  0.172466219409067,
                                -0.000000000000000, -0.000000000000000,  0.452271571053566,
                                 0.346013076083808, -0.000000000000000, -0.000000000000000,
                                -0.051179394733533, -0.190107229484847,  2.049763268634716,
                                 0.919227493183029, -0.056376948454859, -0.161108248213925,
                                -0.000000000000000, -0.000000000000000, -0.076363337994734,
                                -0.050237453435319, -0.000000000000000, -0.000000000000000,
                                 0.025969080003938,  0.018801497456965, -0.000000000000000,
                                -0.000000000000000, -0.216626172592199, -0.372115976020436,
                                -0.000000000000000, -0.000000000000000,  0.010742098501726,
                                 0.011929946690070, -0.000000000000000, -0.000000000000000,
                                -0.125039955264193, -0.157579956458495, -0.000000000000000,
                                -0.000000000000000,  0.059771877739712,  0.072478830096368,
                                -0.000000000000000, -0.000000000000000,  0.123355752237219,
                                 0.153969457605432, -0.000000000000000, -0.000000000000000,
                                -0.179497533161700, -0.293528036743497,  0.540184937119496,
                                 1.171080087538241, -0.148719514642749, -0.253371352880704,
                                -0.000000000000000, -0.000000000000000, -0.010622759031784,
                                -0.007736735425033, -0.000000000000000, -0.000000000000000,
                                -0.000000000000000, -0.000000000000000, -0.119288025512617,
                                -0.193751978884582, -0.000000000000000, -0.000000000000000,
                                -0.004853243244626, -0.000182905922679, -0.000000000000000,
                                -0.000000000000000, -0.075089079626834,  0.068938108496180,
                                -0.000000000000000, -0.000000000000000,  0.036471715733098,
                                -0.036743744848668, -0.000000000000000, -0.000000000000000,
                                -0.098496377004453,  0.022958154334066,  0.000000000000000,
                                 0.000000000000000, -0.006022829581041, -0.014334105547727,
                                -0.000000000000000, -0.000000000000000,  0.037347799977072,
                                -0.046356395275777,  1.433821578561278,  1.167875653968039,
                                 0.101950727804553, -0.024889448431991, -0.000000000000000,
                                -0.000000000000000, -0.077466511937868, -0.128982698632569,
                                -0.000000000000000, -0.000000000000000, -0.137461912618112,
                                -0.250732374654927, -0.000000000000000, -0.000000000000000,
                                -0.000827942162467, -0.000067363168279, -0.000000000000000,
                                -0.000000000000000,  0.004183615152512,  0.113359633621752,
                                -0.000000000000000, -0.000000000000000, -0.007307522971250,
                                -0.055560741295643, -0.000000000000000, -0.000000000000000,
                                -0.001537050197722,  0.032622159457618, -0.000000000000000,
                                -0.000000000000000, -0.005733328002667, -0.021141498662814,
                                -0.000000000000000, -0.000000000000000, -0.004862113524610,
                                -0.075669167506942,  0.923575303678869,  1.095445115010333,
                                 0.001204155833391, -0.023425104760380, -0.000000000000000,
                                -0.000000000000000, -0.091163705590323, -0.167020035005090,
                                -0.134442063391825, -0.190948541738212, -0.000000000000000,
                                -0.000000000000000, -0.005034668784922, -0.001189854750623,
                                -0.000000000000000, -0.000000000000000, -0.077430664181397,
                                 0.004192112605667, -0.000000000000000, -0.000000000000000,
                                 0.037036911796385, -0.009364663666328,  0.000000000000000,
                                -0.000000000000000, -0.100888273386641, -0.003190813932234,
                                -0.000000000000000, -0.000000000000000, -0.006506367778347,
                                -0.007829806187547, -0.000000000000000, -0.000000000000000,
                                 0.038444342845945, -0.005777666078075, -0.000000000000000,
                                -0.000000000000000,  0.104759951883975,  0.003079807741374,
                                 1.565532555876448,  0.702071594732622, -0.087478117695231,
                                -0.126617616823073, -0.000000000000000, -0.000000000000000,
                                -0.128886978178998, -0.204722126633638, -0.000000000000000,
                                -0.000000000000000, -0.000111840688640, -0.000055001796580,
                                -0.000000000000000, -0.000000000000000,  0.046989944291761,
                                 0.092557753267380, -0.000000000000000, -0.000000000000000,
                                -0.024844699383482, -0.045365155301702, -0.000000000000000,
                                -0.000000000000000,  0.015480601107471,  0.026635881659624,
                                -0.000000000000000, -0.000000000000000, -0.009657206673930,
                                -0.017261961373876, -0.000000000000000,  0.000000000000000,
                                -0.031566567490443, -0.061783616551066, -0.000000000000000,
                                -0.000000000000000, -0.016459891260159, -0.019126517944724,
                                 0.412573060604175,  0.894427190999917, -0.085807102007469,
                                -0.136371287528085, -0.000000000000000, -0.000000000000000};

    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 28, 36));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeGFForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 4);
    
    CGtoBlock kgtos(mlih, mbas, 3);
    
    CDenseMatrix lmomxmat(36, 28);
    
    CDenseMatrix lmomymat(36, 28);
    
    CDenseMatrix lmomzmat(36, 28);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{-2.027729922424561, -1.306132720335507,  0.019837745896611,
                                -0.086012393442062,  0.000000000000000,  0.000000000000000,
                                 0.330532117383415,  0.167552858052284,  0.000000000000000,
                                -0.000000000000000,  0.140893623541292,  0.053978239330442,
                                 0.000000000000000,  0.000000000000000,  0.142769122617147,
                                 0.025391676750149,  0.000000000000000,  0.000000000000000,
                                -0.466876491987970, -0.158170943503992,  0.000000000000000,
                                 0.000000000000000,  0.071250762825052,  0.139413273747119,
                                 0.000000000000000,  0.000000000000000,  0.201579032576308,
                                 0.140337032108563, -1.651625589006949, -1.549193338482968,
                                -0.032938933199277, -0.180422630646618,  0.000000000000000,
                                 0.000000000000000,  0.319317200394777,  0.248540762849683,
                                 0.000000000000000, -0.000000000000000,  0.117059626814323,
                                 0.076736776325947,  0.000000000000000,  0.000000000000000,
                                 0.081321490766053,  0.031011802116031,  0.000000000000000,
                                 0.000000000000000, -0.365944403263515, -0.219868213810741,
                                 0.000000000000000,  0.000000000000000,  0.177279290021616,
                                 0.227888758798866,  0.000000000000000,  0.000000000000000,
                                 0.233664579517590,  0.216457115738312,  0.020213249016394,
                                -0.024793318114591, -2.213997372857088, -0.583466417776202,
                                 0.301974554930538,  0.228507367240858,  0.000000000000000,
                                 0.000000000000000,  0.129874516161874,  0.083545577792112,
                                -0.000000000000000,  0.000000000000000,  0.134010310938082,
                                 0.057614939658587,  0.000000000000000,  0.000000000000000,
                                -0.431657256834654, -0.260844214025615,  0.000000000000000,
                                 0.000000000000000,  0.058668020158470,  0.128229336470847,
                                 0.000000000000000,  0.000000000000000,  0.181889187749947,
                                 0.167722701193950,  0.000000000000000,  0.000000000000000,
                                -0.125811150698599, -0.220971691567425, -0.992879171027782,
                                -1.264911064067353,  0.253594531524640,  0.304399024631902,
                                 0.000000000000000,  0.000000000000000,  0.082026403542435,
                                 0.093982973252327,  0.000000000000000,  0.000000000000000,
                                 0.039118437960009,  0.037981545594220,  0.000000000000000,
                                 0.000000000000000, -0.240867753109659, -0.269282467246734,
                                 0.000000000000000,  0.000000000000000,  0.208925766726204,
                                 0.279105588586706,  0.000000000000000,  0.000000000000000,
                                 0.211592285038629,  0.265104742376713,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.252383364802722,  0.242175532071592, -1.756065624833518,
                                -1.131144116524625,  0.104876973627305,  0.040222044744599,
                                 0.000000000000000,  0.000000000000000, -0.056241934493085,
                                -0.000339191007589,  0.000000000000000,  0.000000000000000,
                                 0.386040328113641,  0.008893340695557,  0.000000000000000,
                                 0.000000000000000,  0.014023551132048,  0.007450743771941,
                                 0.000000000000000,  0.000000000000000, -0.369783748262185,
                                -0.040789766630993,  0.000000000000000,  0.000000000000000,
                                -0.061040916887282, -0.007226227345846,  0.000000000000000,
                                 0.000000000000000,  0.357726637012134,  0.384983653005166,
                                -1.430349717620454, -1.341640786499874,  0.107681975895618,
                                 0.037258527301341,  0.000000000000000,  0.000000000000000,
                                -0.037091991629939,  0.010295959682574,  0.000000000000000,
                                 0.000000000000000,  0.165501221387177, -0.020209149130551,
                                 0.000000000000000,  0.000000000000000, -0.015853780296906,
                                 0.023148040072422,  0.000000000000000,  0.000000000000000,
                                -0.207562093082159, -0.029004806689560,  0.000000000000000,
                                 0.000000000000000, -0.029003661031402, -0.007954525324035,
                                 0.224011221969573,  0.257539070937831,  0.000000000000000,
                                 0.000000000000000,  0.095252095550747,  0.077056109838152,
                                -1.917377968806246, -0.505296740049295, -0.052030879670738,
                                -0.026103159922511,  0.000000000000000,  0.000000000000000,
                                 0.365320291259646,  0.116022704360149,  0.000000000000000,
                                 0.000000000000000,  0.015460660206553, -0.011171162852888,
                                 0.000000000000000,  0.000000000000000, -0.346568362432765,
                                -0.146563012594541,  0.000000000000000,  0.000000000000000,
                                -0.057696275478819, -0.020469421983974,  0.000000000000000,
                                 0.000000000000000,  0.364025018504012,  0.471506754587677,
                                 0.000000000000000,  0.000000000000000,  0.062457454982913,
                                 0.045632190227920, -0.859858584998493, -1.095445115010333,
                                -0.001521698097620,  0.012609923817287,  0.000000000000000,
                                 0.000000000000000,  0.016808086603581, -0.024751051752830,
                                 0.000000000000000,  0.000000000000000,  0.010214788859633,
                                 0.028350443361465,  0.000000000000000,  0.000000000000000,
                                -0.064828902202257, -0.035523488238743,  0.000000000000000,
                                 0.000000000000000, -0.011232808242957, -0.009742264094966,
                                 0.000000000000000,  0.000000000000000,  0.383204935767120,
                                 0.246835882660860,  0.106010482167719,  0.105547993377004,
                                 0.000000000000000,  0.000000000000000,  0.066266901352265,
                                 0.074421040851039, -1.484146334410539, -0.955991262791916,
                                 0.144453592355474,  0.088698498684313,  0.000000000000000,
                                 0.000000000000000, -0.099120871666561, -0.046764757563838,
                                 0.000000000000000,  0.000000000000000,  0.141647972075321,
                                 0.036197365295672,  0.000000000000000,  0.000000000000000,
                                 0.062108583314369, -0.000008180931957,  0.000000000000000,
                                 0.000000000000000,  0.254806298254869,  0.114505645693489,
                                 0.312127897678783,  0.292770021884560,  0.133310329830911,
                                 0.179207756258598,  0.000000000000000,  0.000000000000000,
                                 0.054966491078235,  0.140409716409083, -1.208866149596659,
                                -1.133893419027682,  0.166614016517734,  0.121707222026465,
                                 0.000000000000000,  0.000000000000000, -0.080852971531028,
                                -0.072800796554158,  0.000000000000000,  0.000000000000000,
                                 0.047737000159902,  0.068103007679944,  0.000000000000000,
                                 0.000000000000000,  0.014939810616502, -0.001955313895732,
                                 0.000000000000000,  0.000000000000000,  0.241813532479105,
                                 0.162243223419284,  0.095643429650498,  0.096155253441783,
                                 0.418406175137871,  0.110264788556682,  0.062636758647664,
                                 0.040143086741780,  0.000000000000000,  0.000000000000000,
                                 0.130356340327007,  0.119564643560459, -1.620480148259320,
                                -0.427053689753111, -0.091795651831441, -0.057893072886302,
                                 0.000000000000000,  0.000000000000000,  0.136240758524319,
                                 0.033954631400227,  0.000000000000000,  0.000000000000000,
                                 0.059789848684447,  0.010357031267045,  0.000000000000000,
                                 0.000000000000000,  0.232717515436854,  0.172793961137195,
                                -0.000000000000000,  0.000000000000000,  0.157738370681347,
                                 0.219483780391312,  0.187636526319677,  0.239045721866879,
                                 0.109930609453701,  0.171966080065572,  0.000000000000000,
                                 0.000000000000000,  0.134758270231150,  0.149060295988230,
                                -0.726713141576318, -0.925820099772553, -0.070476221391517,
                                -0.089162402212928,  0.000000000000000,  0.000000000000000,
                                 0.053618725450014,  0.083408809382354,  0.000000000000000,
                                 0.000000000000000,  0.000219054787695, -0.002394760665758,
                                 0.000000000000000,  0.000000000000000,  0.174002939011747,
                                 0.198706555800808,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.116312508665715,
                                -0.091042256903475,  0.663730418459820,  0.427532289899718,
                                 0.101544938076463,  0.073029493404278,  0.000000000000000,
                                 0.000000000000000, -0.152001763830502,  0.002848520339492,
                                 0.000000000000000,  0.000000000000000, -0.097410905670854,
                                 0.016866208255038,  0.000000000000000,  0.000000000000000,
                                -0.107838119872088,  0.030052051568299,  0.000000000000000,
                                 0.000000000000000,  0.046728626911456, -0.001479814290660,
                                 0.000000000000000,  0.000000000000000,  0.258012906965050,
                                 0.144971965974725,  0.000000000000000,  0.000000000000000,
                                -0.150493761194078, -0.139779217582248,  0.540621377239312,
                                 0.507092552837110,  0.099352230676421,  0.126606867697782,
                                 0.000000000000000,  0.000000000000000, -0.062259032099308,
                                 0.021442662162426,  0.000000000000000,  0.000000000000000,
                                -0.031501019223641,  0.041655667805939,  0.000000000000000,
                                 0.000000000000000, -0.024183458229569,  0.066240167627259,
                                 0.000000000000000,  0.000000000000000,  0.008366313141746,
                                -0.003493582974557,  0.000000000000000,  0.000000000000000,
                                 0.261757317795356,  0.218716441062090, -0.103868996769930,
                                -0.108095013658314,  0.000000000000000,  0.000000000000000,
                                 0.093163249440195,  0.071366065506885,  0.724700753539356,
                                 0.190984216066012, -0.143940762485981, -0.043546738926159,
                                 0.000000000000000,  0.000000000000000, -0.092503065197437,
                                -0.021638761467232,  0.000000000000000,  0.000000000000000,
                                -0.103013192861509, -0.016163820739671,  0.000000000000000,
                                 0.000000000000000,  0.045197085458343,  0.005726538028868,
                                -0.000000000000000,  0.000000000000000,  0.235058971032990,
                                 0.187525285170012,  0.000000000000000,  0.000000000000000,
                                -0.137307611256223, -0.171193879860988,  0.000000000000000,
                                 0.000000000000000,  0.109056301422091,  0.155061111895812,
                                 0.324995996941415,  0.414039335605413,  0.002652493076467,
                                 0.026261790512413,  0.000000000000000,  0.000000000000000,
                                 0.023928382469421,  0.051017565509715,  0.000000000000000,
                                 0.000000000000000,  0.043414374824481,  0.081127305581604,
                                 0.000000000000000,  0.000000000000000, -0.002078420033168,
                                -0.004278747830870,  0.000000000000000,  0.000000000000000,
                                 0.219059844043887,  0.267871839479816,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.649036291290921,  0.189693950064828,  0.000000000000000,
                                 0.000000000000000, -0.063844265944911, -0.111050987672508,
                                 0.000000000000000,  0.000000000000000, -0.045357297982552,
                                -0.038861348501764,  0.000000000000000,  0.000000000000000,
                                 0.018128847617871,  0.056996174306317,  1.327460836919640,
                                 0.855064579799435, -0.163333764009326,  0.004141968314443,
                                 0.000000000000000,  0.000000000000000,  0.097116385634982,
                                -0.095466794265293,  0.000000000000000, -0.000000000000000,
                                -0.054237046206737, -0.047498557934382,  0.000000000000000,
                                 0.000000000000000,  0.476688907405175,  0.254751228617835,
                                 0.000000000000000,  0.000000000000000, -0.115857996405091,
                                -0.192334846090546,  0.000000000000000,  0.000000000000000,
                                -0.045694527718069, -0.067055592848601,  0.000000000000000,
                                 0.000000000000000,  0.043589801199356,  0.103897132004588,
                                 1.081242754478624,  1.014185105674220, -0.083693564982299,
                                 0.039527341005898,  0.000000000000000,  0.000000000000000,
                                -0.072821000879810, -0.165100454461729, -0.000000000000000,
                                 0.000000000000000, -0.086328134512521, -0.069312922314984,
                                 0.601987427817012,  0.339298710410908, -0.000000000000000,
                                 0.000000000000000, -0.055981540024449, -0.084109922905692,
                                 0.000000000000000,  0.000000000000000, -0.041771290384635,
                                -0.032986006760695,  0.000000000000000,  0.000000000000000,
                                 0.015756456962068,  0.031968918607308,  0.000000000000000,
                                 0.000000000000000, -0.153403545757179, -0.058852089798884,
                                 1.449401507078711,  0.381968432132024,  0.099046636241306,
                                -0.053945244849518,  0.000000000000000,  0.000000000000000,
                                -0.047146576299664, -0.061968583823456, -0.000000000000000,
                                -0.000000000000000,  0.289754632978375,  0.312005260730399,
                                 0.000000000000000,  0.000000000000000, -0.165482771000061,
                                -0.235561116339287,  0.000000000000000,  0.000000000000000,
                                -0.057961369668454, -0.082125993439447,  0.000000000000000,
                                 0.000000000000000,  0.084457424249476,  0.127247479574914,
                                 0.000000000000000,  0.000000000000000,  0.003456673557676,
                                 0.048410908176720,  0.649991993882830,  0.828078671210825,
                                -0.142107278907673, -0.202205934866424,  0.000000000000000,
                                 0.000000000000000, -0.071946038666888, -0.084890646126441,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.019960721501854, -0.107420712052036,
                                 0.000000000000000,  0.000000000000000,  0.230907416283980,
                                -0.065296279174351,  0.000000000000000,  0.000000000000000,
                                -0.107838119872088,  0.030052051568299, -1.713744571377442,
                                -1.103883625831686, -0.050823299117405,  0.049578379187643,
                                 0.000000000000000,  0.000000000000000, -0.087500745478933,
                                 0.087601992266265,  0.663730418459820,  0.427532289899718,
                                 0.117482219212300,  0.096684722096006,  0.000000000000000,
                                 0.000000000000000, -0.705514330796064, -0.219813104743989,
                                 0.000000000000000,  0.000000000000000, -0.135012083171405,
                                -0.173696042931094,  0.000000000000000,  0.000000000000000,
                                 0.002160291829955, -0.121602231514958,  0.000000000000000,
                                 0.000000000000000, -0.024183458229569,  0.066240167627259,
                                -1.395878393767715, -1.309307341415955,  0.065524167756926,
                                 0.063300609736594,  0.000000000000000,  0.000000000000000,
                                 0.025451846121546,  0.168828254597046,  0.540621377239312,
                                 0.507092552837110,  0.118531260620798,  0.168889865023410,
                                 0.000000000000000,  0.000000000000000, -0.527777482840215,
                                -0.301925835478747, -0.010965284291491, -0.097826914147819,
                                 0.000000000000000,  0.000000000000000,  0.224928349964955,
                                -0.000720088476627,  0.000000000000000,  0.000000000000000,
                                -0.103013192861509, -0.016163820739671,  0.000000000000000,
                                 0.000000000000000, -0.053900769988551,  0.047953682614285,
                                -1.871169299627926, -0.493119125474763, -0.085601904797725,
                                 0.020105732013530,  0.000000000000000,  0.000000000000000,
                                 0.107916108721486,  0.085409793641429,  0.724700753539355,
                                 0.190984216066013, -0.653940043519903, -0.375900588600654,
                                 0.000000000000000,  0.000000000000000, -0.161108040547993,
                                -0.212733337760871,  0.000000000000000,  0.000000000000000,
                                -0.096238686217759, -0.148931709397717,  0.000000000000000,
                                 0.000000000000000,  0.043414374824481,  0.081127305581604,
                                 0.000000000000000,  0.000000000000000,  0.075369467256997,
                                 0.077527097130854, -0.839136055825452, -1.069044967649699,
                                 0.128893427206062,  0.206771538963725,  0.000000000000000,
                                 0.000000000000000,  0.144167545933221,  0.206846996017439,
                                 0.324995996941415,  0.414039335605413, -0.335121976236822,
                                -0.369782118543216,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.448433879420062,
                                -0.147169369388071,  0.000000000000000,  0.000000000000000,
                                 0.062108583314369, -0.000008180931957,  0.000000000000000,
                                 0.000000000000000,  0.049234965237474,  0.006356852099547,
                                 0.000000000000000,  0.000000000000000,  0.074690011543222,
                                -0.030651559451898, -1.484146334410539, -0.955991262791916,
                                 0.203597520560695,  0.088872708183362,  0.000000000000000,
                                 0.000000000000000, -0.226072223347516,  0.080742509196648,
                                 0.383204935767120,  0.246835882660859, -0.145427448462866,
                                 0.068702016392616,  0.000000000000000,  0.000000000000000,
                                -0.351126049956849, -0.201259559518171,  0.000000000000000,
                                 0.000000000000000,  0.014939810616502, -0.001955313895732,
                                 0.000000000000000,  0.000000000000000,  0.020619559073027,
                                 0.008075598672854,  0.000000000000000,  0.000000000000000,
                                -0.016723274884782, -0.052774236093409, -1.208866149596659,
                                -1.133893419027682,  0.196210541559708,  0.112712405641338,
                                 0.000000000000000,  0.000000000000000, -0.020202327876014,
                                 0.162436831414982,  0.312127897678783,  0.292770021884560,
                                 0.003081242376248,  0.135976145891219, -0.414487452282503,
                                -0.250192722950890,  0.000000000000000,  0.000000000000000,
                                 0.059789848684447,  0.010357031267045,  0.000000000000000,
                                 0.000000000000000,  0.046821359464653,  0.014573316998124,
                                -0.000000000000000,  0.000000000000000,  0.074025579691510,
                                -0.012770416019562,  0.000000000000000,  0.000000000000000,
                                 0.185960620323708,  0.140392841272529, -1.620480148259320,
                                -0.427053689753111, -0.218076039397127, -0.011834550030768,
                                 0.000000000000000,  0.000000000000000, -0.141282937567306,
                                 0.004059545075688,  0.418406175137872,  0.110264788556682,
                                -0.224420238939029, -0.246491613338411,  0.000000000000000,
                                 0.000000000000000,  0.000219054787695, -0.002394760665758,
                                 0.000000000000000,  0.000000000000000,  0.009767819554331,
                                 0.009890548057995,  0.000000000000000,  0.000000000000000,
                                -0.045603057079914, -0.064634974997011,  0.000000000000000,
                                 0.000000000000000,  0.135859901557371,  0.138043940751437,
                                -0.726713141576318, -0.925820099772552,  0.118029541091910,
                                 0.198943676200600,  0.000000000000000,  0.000000000000000,
                                 0.100768736193986,  0.166536087311865,  0.187636526319677,
                                 0.239045721866879,  0.000000000000000,  0.000000000000000,
                                -0.061040916887282, -0.007226227345846,  0.000000000000000,
                                 0.000000000000000,  0.221330886714766,  0.032935836276501,
                                 0.000000000000000,  0.000000000000000,  0.139657125924959,
                                 0.003532075021676, -0.000000000000000,  0.000000000000000,
                                -0.028194176069627, -0.000695936307975,  0.000000000000000,
                                 0.000000000000000, -0.426399888903513, -0.033765342253211,
                                -1.756065624833518, -1.131144116524625, -0.084878008594569,
                                 0.031488592702258,  0.000000000000000,  0.000000000000000,
                                 0.264682898634862,  0.244437390028592,  0.000000000000000,
                                 0.000000000000000, -0.029003661031402, -0.007954525324035,
                                 0.000000000000000,  0.000000000000000,  0.150652593631886,
                                 0.024308585040125,  0.000000000000000,  0.000000000000000,
                                 0.073163296623323, -0.012611484099650, -0.000000000000000,
                                -0.000000000000000, -0.028279092205010,  0.007694407757343,
                                 0.000000000000000,  0.000000000000000, -0.198372752802648,
                                -0.022282661214188, -1.430349717620454, -1.341640786499874,
                                 0.041193329585882,  0.032136716327677,  0.000000000000000,
                                 0.000000000000000,  0.365571828205765,  0.387586826713737,
                                -0.057696275478819, -0.020469421983974,  0.000000000000000,
                                 0.000000000000000,  0.205349657832177,  0.106656785105641,
                                -0.000000000000000,  0.000000000000000,  0.130997885373323,
                                 0.051437419366783,  0.000000000000000,  0.000000000000000,
                                -0.025222516532140, -0.019960594687952, -0.000000000000000,
                                 0.000000000000000, -0.402871684565232, -0.139651900654429,
                                 0.000000000000000,  0.000000000000000, -0.085796102722888,
                                 0.030486935275010, -1.917377968806246, -0.505296740049295,
                                 0.235479648028870,  0.263095479070274,  0.000000000000000,
                                 0.000000000000000, -0.011232808242957, -0.009742264094966,
                                 0.000000000000000,  0.000000000000000,  0.052171807886316,
                                 0.029771814858680,  0.000000000000000,  0.000000000000000,
                                 0.007047978055453, -0.015445850471683,  0.000000000000000,
                                 0.000000000000000, -0.001854840525777,  0.009423686439202,
                                 0.000000000000000,  0.000000000000000, -0.053959936835840,
                                -0.027290575043033,  0.000000000000000,  0.000000000000000,
                                 0.048360416673986,  0.039359278505689, -0.859858584998493,
                                -1.095445115010333,  0.367525893235712,  0.474694978236590,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.216799988023258, -0.141978229976667,
                                 0.000000000000000,  0.000000000000000, -0.176976732214413,
                                -0.151929466657168,  0.000000000000000,  0.000000000000000,
                                 0.301662331862252,  0.126456778867182,  0.000000000000000,
                                 0.000000000000000, -0.355579075525773, -0.087990352162870,
                                 0.000000000000000,  0.000000000000000, -0.074323082113607,
                                 0.018175207366661,  0.000000000000000,  0.000000000000000,
                                 0.341183826136754,  0.169511684502797, -2.027729922424561,
                                -1.306132720335508,  0.049625610997921, -0.082395468707880,
                                 0.000000000000000,  0.000000000000000, -0.240497740585370,
                                -0.218241114928069,  0.000000000000000,  0.000000000000000,
                                -0.227515104533509, -0.241666400810188,  0.000000000000000,
                                 0.000000000000000,  0.266657755727390,  0.180938473387952,
                                 0.000000000000000,  0.000000000000000, -0.244086765686098,
                                -0.112855562675217, -0.000000000000000, -0.000000000000000,
                                -0.001518164642004,  0.033582829779680,  0.000000000000000,
                                 0.000000000000000,  0.326111335266007,  0.250795177411768,
                                -1.651625589006949, -1.549193338482968, -0.018560360750201,
                                -0.176428436638508, -0.196307481829701, -0.172541308250993,
                                -0.000000000000000,  0.000000000000000, -0.158600900695275,
                                -0.163683415348658,  0.000000000000000,  0.000000000000000,
                                 0.276975959793898,  0.190457387599574, -0.000000000000000,
                                 0.000000000000000, -0.330823762437542, -0.173460869954325,
                                 0.000000000000000,  0.000000000000000, -0.072419157987605,
                                -0.000411257148319,  0.000000000000000,  0.000000000000000,
                                 0.311906503239313,  0.233319357837348,  0.000000000000000,
                                 0.000000000000000,  0.048351274944154, -0.014643390099911,
                                -2.213997372857089, -0.583466417776202, -0.214146450474742,
                                -0.267289686234935,  0.000000000000000,  0.000000000000000,
                                -0.228381561314685, -0.295979684979941,  0.000000000000000,
                                 0.000000000000000,  0.192035606427718,  0.221603467319318,
                                 0.000000000000000,  0.000000000000000, -0.134932483964298,
                                -0.138219271594484,  0.000000000000000,  0.000000000000000,
                                 0.026802093161783,  0.041130398539480, -0.000000000000000,
                                -0.000000000000000,  0.256626377977759,  0.307160107304808,
                                 0.000000000000000,  0.000000000000000, -0.120190515720666,
                                -0.216079822940649, -0.992879171027781, -1.264911064067352};

    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 36, 28));
    
    std::vector<double> intyvals{ 0.000000000000000,  0.000000000000000,  0.204690507472657,
                                 0.140507156320319,  0.000000000000000,  0.000000000000000,
                                -0.258063692451828, -0.176294057280655,  0.000000000000000,
                                 0.000000000000000,  0.106657838482776,  0.092218606049478,
                                 0.000000000000000,  0.000000000000000, -0.324415785342180,
                                -0.084509493169773,  0.000000000000000,  0.000000000000000,
                                 0.140893623541292,  0.053978239330441,  0.000000000000000,
                                 0.000000000000000, -0.097016349819019,  0.043682678071008,
                                -2.027729922424561, -1.306132720335507,  0.223924165011738,
                                 0.035234466835805,  0.000000000000000,  0.000000000000000,
                                 0.234650750503128,  0.216616501534520,  0.000000000000000,
                                 0.000000000000000, -0.290447204365539, -0.273575990510988,
                                 0.000000000000000,  0.000000000000000,  0.155706148957397,
                                 0.139371389819505,  0.000000000000000,  0.000000000000000,
                                -0.229796905463388, -0.109053193864887, -0.000000000000000,
                                 0.000000000000000,  0.117059626814323,  0.076736776325947,
                                 0.000000000000000,  0.000000000000000, -0.003070908661548,
                                 0.086484828790639, -1.651625589006949, -1.549193338482968,
                                 0.178999020004690,  0.004694492343447,  0.184868838343578,
                                 0.168413862873752,  0.000000000000000,  0.000000000000000,
                                -0.233526774771543, -0.208482208510576,  0.000000000000000,
                                 0.000000000000000,  0.093941069254591,  0.111862419895388,
                                -0.000000000000000,  0.000000000000000, -0.301327375407645,
                                -0.163380836108616,  0.000000000000000,  0.000000000000000,
                                 0.129874516161874,  0.083545577792112,  0.000000000000000,
                                -0.000000000000000, -0.093797215105872, -0.000929182603562,
                                 0.000000000000000,  0.000000000000000,  0.205908285851224,
                                 0.127127496621145, -2.213997372857088, -0.583466417776202,
                                 0.211860441774023,  0.265299949313191,  0.000000000000000,
                                 0.000000000000000, -0.265667718195522, -0.335060791314207,
                                 0.000000000000000,  0.000000000000000,  0.139261263495899,
                                 0.170694394900157,  0.000000000000000,  0.000000000000000,
                                -0.129517766437460, -0.133562339894893,  0.000000000000000,
                                 0.000000000000000,  0.082026403542435,  0.093982973252327,
                                -0.000000000000000, -0.000000000000000,  0.064005344906657,
                                 0.105921850514514,  0.000000000000000,  0.000000000000000,
                                 0.057198380047869,  0.005749555421424, -0.992879171027782,
                                -1.264911064067353,  0.000000000000000,  0.000000000000000,
                                 0.334298899464811,  0.358145730696382,  0.000000000000000,
                                 0.000000000000000, -0.382116117809164, -0.041063719250643,
                                 0.000000000000000,  0.000000000000000,  0.124052408937641,
                                 0.005258979760705,  0.000000000000000, -0.000000000000000,
                                -0.215011446089537, -0.004934339331711,  0.000000000000000,
                                 0.000000000000000, -0.056241934493085, -0.000339191007589,
                                -1.756065624833518, -1.131144116524625, -0.300866145115036,
                                 0.001442892917118,  0.000000000000000,  0.000000000000000,
                                 0.017257417723931,  0.001738255214802,  0.000000000000000,
                                 0.000000000000000,  0.515860001912359,  0.571859578248015,
                                 0.000000000000000,  0.000000000000000, -0.210476630089211,
                                -0.029139533026118,  0.000000000000000,  0.000000000000000,
                                 0.076818404849671, -0.010746599348692,  0.000000000000000,
                                 0.000000000000000, -0.085567734272679,  0.008716922012956,
                                 0.000000000000000,  0.000000000000000, -0.037091991629939,
                                 0.010295959682574, -1.430349717620454, -1.341640786499874,
                                -0.100899646388748,  0.010253923994529,  0.000000000000000,
                                 0.000000000000000,  0.007443126312667,  0.001870578032740,
                                 0.294142542501545,  0.371681400759625,  0.000000000000000,
                                 0.000000000000000, -0.358456331979709, -0.148591048429122,
                                 0.000000000000000,  0.000000000000000,  0.115343175452028,
                                 0.054099780232674,  0.000000000000000,  0.000000000000000,
                                -0.204066520172765, -0.059930791808162,  0.000000000000000,
                                -0.000000000000000, -0.052030879670738, -0.026103159922511,
                                 0.000000000000000,  0.000000000000000, -0.286544531422614,
                                -0.070036950332708, -1.917377968806246, -0.505296740049295,
                                 0.016371264404329,  0.005245581386228,  0.000000000000000,
                                 0.000000000000000,  0.538080206816225,  0.700382085615414,
                                 0.000000000000000,  0.000000000000000, -0.065276928383754,
                                -0.035688493628484,  0.000000000000000,  0.000000000000000,
                                 0.009721194956760, -0.013161842437211,  0.000000000000000,
                                 0.000000000000000, -0.009105431510315,  0.010676005529689,
                                -0.000000000000000, -0.000000000000000, -0.001521698097620,
                                 0.012609923817287,  0.000000000000000,  0.000000000000000,
                                 0.000711247952714,  0.012558440823939, -0.859858584998493,
                                -1.095445115010333,  0.002707729800391,  0.002290980852136,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.465661217281966, -0.148460740634685,
                                 0.000000000000000,  0.000000000000000, -0.127557034374851,
                                 0.115093205624665,  0.000000000000000,  0.000000000000000,
                                 0.043178041600373,  0.023483661096579,  0.000000000000000,
                                 0.000000000000000, -0.174365652383551, -0.031580309343067,
                                -1.484146334410540, -0.955991262791915,  0.144453592355474,
                                 0.088698498684313,  0.000000000000000,  0.000000000000000,
                                -0.131903199878333,  0.003420525913936, -0.383204935767120,
                                -0.246835882660860,  0.229346394458882,  0.006657104074682,
                                 0.000000000000000,  0.000000000000000, -0.357453971357180,
                                -0.202575850899213,  0.000000000000000,  0.000000000000000,
                                 0.025208347444675,  0.224763953347772,  0.000000000000000,
                                 0.000000000000000,  0.006497882013847,  0.051951810334236,
                                 0.000000000000000,  0.000000000000000, -0.082500985740611,
                                -0.045272039966385, -1.208866149596659, -1.133893419027682,
                                 0.166614016517734,  0.121707222026465,  0.000000000000000,
                                 0.000000000000000, -0.034354661671486,  0.011098496401098,
                                -0.312127897678783, -0.292770021884560,  0.129300148417975,
                                -0.024513175251542, -0.430916756898020, -0.254640439488092,
                                 0.000000000000000,  0.000000000000000, -0.124140081656511,
                                 0.020604753670875,  0.000000000000000,  0.000000000000000,
                                 0.042598039595013,  0.004807997403978,  0.000000000000000,
                                 0.000000000000000, -0.165214548076707, -0.058460740312385,
                                 0.000000000000000,  0.000000000000000,  0.130356340327007,
                                 0.119564643560459, -1.620480148259320, -0.427053689753111,
                                -0.126592986437771, -0.023744247237547,  0.000000000000000,
                                 0.000000000000000,  0.214404093001382,  0.091020482263041,
                                -0.418406175137871, -0.110264788556682, -0.226441601071042,
                                -0.248103734456599,  0.000000000000000,  0.000000000000000,
                                 0.169082244435961,  0.275278499136382,  0.000000000000000,
                                 0.000000000000000,  0.034083086341353,  0.063627713266365,
                                 0.000000000000000,  0.000000000000000, -0.048046524913137,
                                -0.055446698766265,  0.000000000000000,  0.000000000000000,
                                 0.134758270231150,  0.149060295988230, -0.726713141576318,
                                -0.925820099772552,  0.004480026351491,  0.013592826547402,
                                 0.000000000000000,  0.000000000000000,  0.013239248076703,
                                -0.030022385670850, -0.187636526319677, -0.239045721866879,
                                 0.000000000000000,  0.000000000000000,  0.240291482438569,
                                 0.156780026923829,  0.000000000000000,  0.000000000000000,
                                 0.137450162461067, -0.062336650593030,  0.000000000000000,
                                 0.000000000000000, -0.251415644092064,  0.105623717340335,
                                -1.713744571377442, -1.103883625831686, -0.131999053843116,
                                 0.063633552733508,  0.000000000000000,  0.000000000000000,
                                -0.152001763830502,  0.002848520339492, -0.663730418459820,
                                -0.427532289899718, -0.270964543689403, -0.043504334692931,
                                 0.000000000000000,  0.000000000000000, -0.420620669547145,
                                -0.032467837934062,  0.000000000000000,  0.000000000000000,
                                 0.278236113575561,  0.236037218838396,  0.000000000000000,
                                 0.000000000000000, -0.014572334453538, -0.114615065565843,
                                 0.000000000000000,  0.000000000000000, -0.031027320737073,
                                 0.219166207511948, -1.395878393767715, -1.309307341415955,
                                 0.039273318403893,  0.098013666241543,  0.000000000000000,
                                 0.000000000000000, -0.062259032099308,  0.021442662162426,
                                -0.540621377239312, -0.507092552837110, -0.113359576194305,
                                -0.070465991239743,  0.000000000000000,  0.000000000000000,
                                -0.204256450336586, -0.016706841380796,  0.216508970086168,
                                 0.199513345856424,  0.000000000000000,  0.000000000000000,
                                 0.134534179048270, -0.012173164534362,  0.000000000000000,
                                 0.000000000000000, -0.241300808064050, -0.018997689629274,
                                 0.000000000000000,  0.000000000000000, -0.130986657653082,
                                 0.029921381391592, -1.871169299627926, -0.493119125474763,
                                -0.143940762485981, -0.043546738926160,  0.000000000000000,
                                 0.000000000000000, -0.257692162476997, -0.080037604886850,
                                -0.724700753539355, -0.190984216066013, -0.396616572764003,
                                -0.143830062354437,  0.000000000000000,  0.000000000000000,
                                 0.236910309005152,  0.289085373229860,  0.000000000000000,
                                 0.000000000000000, -0.092081846151423, -0.140374213735977,
                                 0.000000000000000,  0.000000000000000,  0.153904505599312,
                                 0.268422688632603,  0.000000000000000,  0.000000000000000,
                                 0.095309785981515,  0.120041735055617, -0.839136055825452,
                                -1.069044967649699,  0.002652493076467,  0.026261790512413,
                                 0.000000000000000,  0.000000000000000, -0.065700657446061,
                                -0.086302861378400, -0.324995996941415, -0.414039335605413,
                                -0.052311840321989, -0.020461618298283,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.358700647128707, -0.091916664007632,  0.000000000000000,
                                 0.000000000000000, -0.150008405192701, -0.057547220640426,
                                 1.327460836919640,  0.855064579799435, -0.201131512328119,
                                -0.028242488770361,  0.000000000000000,  0.000000000000000,
                                 0.027193271426806,  0.085494261459476,  0.000000000000000,
                                 0.000000000000000, -0.045357297982552, -0.038861348501764,
                                 0.000000000000000,  0.000000000000000,  0.015493763391669,
                                 0.118470034686069,  0.000000000000000,  0.000000000000000,
                                -0.342014172714145, -0.144902582596005,  0.000000000000000,
                                -0.000000000000000, -0.244467507118240, -0.121184843381862,
                                 0.000000000000000,  0.000000000000000, -0.080636866877946,
                                -0.099856135546493,  1.081242754478624,  1.014185105674220,
                                -0.121772338080690, -0.016352319701270,  0.000000000000000,
                                 0.000000000000000,  0.065384701799034,  0.155845698006882,
                                 0.000000000000000,  0.000000000000000, -0.045694527718069,
                                -0.067055592848601,  0.000000000000000,  0.000000000000000,
                                 0.114328805231543,  0.205100038921788,  0.000000000000000,
                                 0.000000000000000, -0.317220632508652, -0.202443409054596,
                                -0.333988004894538, -0.173794614390118,  0.000000000000000,
                                 0.000000000000000, -0.142219228932406, -0.057710233542982,
                                 0.000000000000000,  0.000000000000000, -0.188212954411042,
                                -0.086340428766130,  1.449401507078711,  0.381968432132024,
                                 0.023634685443102,  0.047953377910962,  0.000000000000000,
                                 0.000000000000000, -0.041771290384635, -0.032986006760695,
                                 0.000000000000000,  0.000000000000000,  0.008777349012201,
                                 0.083373294683057,  0.000000000000000,  0.000000000000000,
                                -0.312735567049072, -0.226532965301670,  0.000000000000000,
                                 0.000000000000000, -0.140649257015820, -0.148420515422329,
                                -0.000000000000000,  0.000000000000000, -0.085871515353144,
                                -0.122298289887551,  0.000000000000000,  0.000000000000000,
                                -0.044844467832702, -0.020027419689486,  0.649991993882830,
                                 0.828078671210825,  0.126686136374215,  0.190871219362371,
                                 0.000000000000000,  0.000000000000000, -0.057961369668454,
                                -0.082125993439447,  0.000000000000000,  0.000000000000000,
                                 0.176485420391164,  0.251195220791675,  0.000000000000000,
                                 0.000000000000000, -0.220474076660125, -0.247941526986647,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.116312508665715, -0.091042256903475,
                                 0.663730418459820,  0.427532289899718,  0.101544938076463,
                                 0.073029493404278,  0.000000000000000,  0.000000000000000,
                                -0.152001763830502,  0.002848520339492,  0.000000000000000,
                                 0.000000000000000, -0.097410905670854,  0.016866208255038,
                                 0.000000000000000,  0.000000000000000, -0.107838119872088,
                                 0.030052051568299,  0.000000000000000,  0.000000000000000,
                                 0.046728626911456, -0.001479814290660,  0.000000000000000,
                                 0.000000000000000,  0.258012906965050,  0.144971965974725,
                                 0.000000000000000,  0.000000000000000, -0.150493761194078,
                                -0.139779217582248,  0.540621377239312,  0.507092552837110,
                                 0.099352230676421,  0.126606867697782,  0.000000000000000,
                                 0.000000000000000, -0.062259032099308,  0.021442662162426,
                                 0.000000000000000,  0.000000000000000, -0.031501019223641,
                                 0.041655667805939,  0.000000000000000,  0.000000000000000,
                                -0.024183458229569,  0.066240167627259,  0.000000000000000,
                                 0.000000000000000,  0.008366313141746, -0.003493582974557,
                                 0.000000000000000,  0.000000000000000,  0.261757317795356,
                                 0.218716441062090, -0.103868996769930, -0.108095013658314,
                                 0.000000000000000,  0.000000000000000,  0.093163249440195,
                                 0.071366065506885,  0.724700753539356,  0.190984216066012,
                                -0.143940762485981, -0.043546738926160,  0.000000000000000,
                                 0.000000000000000, -0.092503065197437, -0.021638761467232,
                                 0.000000000000000,  0.000000000000000, -0.103013192861509,
                                -0.016163820739671,  0.000000000000000,  0.000000000000000,
                                 0.045197085458343,  0.005726538028868,  0.000000000000000,
                                 0.000000000000000,  0.235058971032991,  0.187525285170012,
                                 0.000000000000000,  0.000000000000000, -0.137307611256223,
                                -0.171193879860988,  0.000000000000000,  0.000000000000000,
                                 0.109056301422091,  0.155061111895812,  0.324995996941415,
                                 0.414039335605413,  0.002652493076467,  0.026261790512413,
                                 0.000000000000000,  0.000000000000000,  0.023928382469421,
                                 0.051017565509715,  0.000000000000000,  0.000000000000000,
                                 0.043414374824481,  0.081127305581604,  0.000000000000000,
                                 0.000000000000000, -0.002078420033168, -0.004278747830870,
                                 0.000000000000000,  0.000000000000000,  0.219059844043887,
                                 0.267871839479816,  0.000000000000000,  0.000000000000000,
                                 0.383204935767120,  0.246835882660859, -0.396104053232040,
                                -0.037155398723665,  0.000000000000000,  0.000000000000000,
                                -0.131903199878333,  0.003420525913936,  1.484146334410539,
                                 0.955991262791916, -0.280608359592234, -0.113739802513466,
                                 0.000000000000000,  0.000000000000000,  0.050392589593932,
                                 0.046583045628610,  0.000000000000000,  0.000000000000000,
                                 0.049234965237474,  0.006356852099547,  0.000000000000000,
                                 0.000000000000000, -0.112150948618025,  0.117652119446866,
                                 0.000000000000000,  0.000000000000000, -0.237578960392965,
                                -0.113214274446876,  0.312127897678783,  0.292770021884560,
                                -0.228424598071494, -0.012248258882938,  0.000000000000000,
                                 0.000000000000000, -0.034354661671486,  0.011098496401098,
                                 1.208866149596659,  1.133893419027682, -0.218808409132103,
                                -0.162735246480580,  0.000000000000000,  0.000000000000000,
                                 0.067983419407062,  0.074268617535533,  0.000000000000000,
                                 0.000000000000000,  0.020619559073028,  0.008075598672854,
                                 0.000000000000000,  0.000000000000000,  0.026937897358657,
                                 0.229505868388327,  0.000000000000000,  0.000000000000000,
                                -0.235485611078774, -0.160926932038242, -0.370572888014890,
                                -0.161253622626225,  0.418406175137872,  0.110264788556682,
                                -0.126592986437771, -0.023744247237546,  0.000000000000000,
                                 0.000000000000000, -0.260476786206763, -0.156543936607614,
                                 1.620480148259320,  0.427053689753111,  0.044987800746355,
                                 0.048953661611619,  0.000000000000000,  0.000000000000000,
                                 0.046821359464653,  0.014573316998124,  0.000000000000000,
                                 0.000000000000000, -0.109018839467683,  0.021858051395643,
                                 0.000000000000000,  0.000000000000000, -0.216288210821337,
                                -0.168346244599993,  0.000000000000000,  0.000000000000000,
                                -0.060272960006945, -0.015000992250355,  0.187636526319677,
                                 0.239045721866879,  0.004480026351491,  0.013592826547402,
                                 0.000000000000000,  0.000000000000000, -0.172402323137107,
                                -0.199309158521736,  0.726713141576318,  0.925820099772552,
                                 0.069998151598060,  0.090960108431987,  0.000000000000000,
                                 0.000000000000000,  0.009767819554331,  0.009890548057995,
                                 0.000000000000000,  0.000000000000000,  0.172857981382455,
                                 0.281086135262876,  0.000000000000000,  0.000000000000000,
                                -0.171981576879733, -0.197094434682620,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.017257417723931,  0.001738255214802,  1.756065624833518,
                                 1.131144116524625,  0.171730418999687, -0.008829742106828,
                                 0.000000000000000,  0.000000000000000, -0.279321684786008,
                                -0.031195466913645,  0.000000000000000,  0.000000000000000,
                                -0.197653165068353, -0.004619320839690,  0.000000000000000,
                                 0.000000000000000,  0.139657125924959,  0.003532075021676,
                                 0.000000000000000,  0.000000000000000, -0.208998517167787,
                                -0.032661883656850,  0.000000000000000,  0.000000000000000,
                                 0.441300495691565,  0.371773652453893,  0.000000000000000,
                                 0.000000000000000,  0.007443126312667,  0.001870578032740,
                                 1.430349717620454,  1.341640786499874,  0.048737287058122,
                                -0.014713493193084,  0.000000000000000,  0.000000000000000,
                                -0.113224217133710, -0.041102480262650,  0.000000000000000,
                                 0.000000000000000, -0.107731162159275,  0.019178042318168,
                                 0.000000000000000,  0.000000000000000,  0.073163296623323,
                                -0.012611484099650,  0.000000000000000,  0.000000000000000,
                                -0.147738056624834, -0.024173858703568,  0.000000000000000,
                                 0.000000000000000,  0.569087695914490,  0.586996141330340,
                                 0.016371264404329,  0.005245581386228,  0.000000000000000,
                                 0.000000000000000,  0.163931159303644,  0.033436502637614,
                                 1.917377968806246,  0.505296740049295, -0.265681253245293,
                                -0.079761032620032,  0.000000000000000,  0.000000000000000,
                                -0.184973396832126, -0.075716623230525, -0.000000000000000,
                                 0.000000000000000,  0.130997885373323,  0.051437419366783,
                                 0.000000000000000,  0.000000000000000, -0.193461688285233,
                                -0.104628749271060,  0.000000000000000,  0.000000000000000,
                                 0.395093762496120,  0.409270424252533,  0.000000000000000,
                                 0.000000000000000,  0.002707729800391,  0.002290980852136,
                                 0.000000000000000,  0.000000000000000, -0.012606031963706,
                                -0.018020275328484,  0.859858584998493,  1.095445115010333,
                                -0.047935091559058, -0.050340051903155,  0.000000000000000,
                                 0.000000000000000, -0.009496566283039,  0.023488208972508,
                                 0.000000000000000,  0.000000000000000,  0.007047978055453,
                                -0.015445850471683,  0.000000000000000,  0.000000000000000,
                                -0.051723781704820, -0.029606809468939,  0.000000000000000,
                                 0.000000000000000,  0.559246160793360,  0.718920513620986,
                                 0.000000000000000,  0.000000000000000,  2.027729922424561,
                                 1.306132720335508, -0.194188375715766, -0.031620389418612,
                                 0.000000000000000,  0.000000000000000,  0.126907074124306,
                                -0.040671931722448,  0.000000000000000,  0.000000000000000,
                                -0.282893749279044, -0.083577942009054,  0.000000000000000,
                                 0.000000000000000,  0.009726649838634, -0.008358292988846,
                                 0.000000000000000,  0.000000000000000,  0.301662331862252,
                                 0.126456778867182,  0.000000000000000,  0.000000000000000,
                                -0.165397591873974, -0.164491930837863,  0.000000000000000,
                                 0.000000000000000,  0.213688513126910,  0.141808105764911,
                                 1.651625589006949,  1.549193338482968, -0.164636952798299,
                                -0.000702965926744,  0.000000000000000,  0.000000000000000,
                                 0.015962781602240, -0.083244892598411, -0.000000000000000,
                                -0.000000000000000, -0.206968104211563, -0.113408846904322,
                                 0.000000000000000,  0.000000000000000, -0.011394879676238,
                                -0.012405128511381,  0.000000000000000,  0.000000000000000,
                                 0.266657755727390,  0.180938473387952,  0.000000000000000,
                                 0.000000000000000, -0.244350669174829, -0.260467342355709,
                                 0.000000000000000,  0.000000000000000,  0.239511569599833,
                                 0.218081729131861, -0.177820129425697, -0.116989136368472,
                                 2.213997372857089,  0.583466417776202,  0.122153076838315,
                                 0.010014796079746,  0.000000000000000,  0.000000000000000,
                                -0.262482728029291, -0.147329022030823,  0.000000000000000,
                                 0.000000000000000,  0.010328566577067, -0.008288872397206,
                                 0.000000000000000,  0.000000000000000,  0.276975959793898,
                                 0.190457387599574, -0.000000000000000,  0.000000000000000,
                                -0.146100453713210, -0.175929159262268,  0.000000000000000,
                                 0.000000000000000,  0.193327831236070,  0.171850146571190,
                                 0.000000000000000,  0.000000000000000, -0.051582233127341,
                                -0.000860953913542,  0.992879171027781,  1.264911064067353,
                                -0.059315419319212, -0.101953755279447,  0.000000000000000,
                                 0.000000000000000, -0.127561862028761, -0.138896903616503,
                                -0.000000000000000, -0.000000000000000, -0.012621828422944,
                                -0.015193117523267,  0.000000000000000,  0.000000000000000,
                                 0.192035606427718,  0.221603467319318,  0.000000000000000,
                                 0.000000000000000, -0.247337464355991, -0.319006041715152,
                                 0.000000000000000,  0.000000000000000,  0.213878293739347,
                                 0.267094479298457,  0.000000000000000,  0.000000000000000};

    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 36, 28));
    
    std::vector<double> intzvals{ 0.000000000000000,  0.000000000000000,  0.095332412904522,
                                 0.086236546507551,  0.000000000000000,  0.000000000000000,
                                 0.097795481526438,  0.011098855036114,  0.000000000000000,
                                 0.000000000000000, -0.118639655355874, -0.011149185229251,
                                 0.000000000000000,  0.000000000000000,  0.066604920238909,
                                 0.001511094211505,  0.000000000000000,  0.000000000000000,
                                 0.054334324442175,  0.003883012822755,  0.000000000000000,
                                 0.000000000000000, -0.204630432358023, -0.025969080003938,
                                 0.000000000000000,  0.000000000000000,  0.134442063391825,
                                 0.128886978178998,  0.000000000000000,  0.000000000000000,
                                 0.129107007965627,  0.136773625048806,  0.000000000000000,
                                 0.000000000000000,  0.055302560771396,  0.007970873250015,
                                 0.000000000000000,  0.000000000000000, -0.053144805269515,
                                -0.010891749803467,  0.000000000000000,  0.000000000000000,
                                 0.020424800314799, -0.000364551309582,  0.000000000000000,
                                 0.000000000000000,  0.020261973810466,  0.003725235089349,
                                 0.000000000000000,  0.000000000000000, -0.125617572607205,
                                -0.018801497456965,  0.000000000000000,  0.000000000000000,
                                 0.190948541738212,  0.204722126633638,  0.084988043096735,
                                 0.092908404825046,  0.000000000000000,  0.000000000000000,
                                 0.091635118538771,  0.039065037776316,  0.000000000000000,
                                 0.000000000000000, -0.112328201825084, -0.037428644215835,
                                 0.000000000000000,  0.000000000000000,  0.063762256007817,
                                 0.014250351644906,  0.000000000000000,  0.000000000000000,
                                 0.051780915371125,  0.014236271516986,  0.000000000000000,
                                 0.000000000000000, -0.190929455453606, -0.088809699096682,
                                 0.000000000000000,  0.000000000000000,  0.119288025512617,
                                 0.137461912618112,  0.000000000000000,  0.000000000000000,
                                 0.129659606604611,  0.167512795820161,  0.000000000000000,
                                 0.000000000000000,  0.017625139634340,  0.009762286133469,
                                 0.000000000000000,  0.000000000000000, -0.017485615670977,
                                -0.013339614712277,  0.000000000000000,  0.000000000000000,
                                 0.002585012799719, -0.000446482346769,  0.000000000000000,
                                 0.000000000000000,  0.006103309773850,  0.004562462570408,
                                 0.000000000000000,  0.000000000000000, -0.041207596578093,
                                -0.023027037584900,  0.000000000000000,  0.000000000000000,
                                 0.193751978884582,  0.250732374654927,  0.000000000000000,
                                 0.000000000000000, -1.433821578561278, -0.923575303678869,
                                -0.080012244209295,  0.017009639572679,  0.000000000000000,
                                 0.000000000000000,  0.055058342401853,  0.146700852787942,
                                -0.000000000000000,  0.000000000000000,  0.114867868305676,
                                 0.049228609171722,  0.000000000000000,  0.000000000000000,
                                 0.032329400364699,  0.015796571010737,  0.000000000000000,
                                 0.000000000000000, -0.243256250565496, -0.107637578092359,
                                 0.000000000000000,  0.000000000000000,  0.080350206611203,
                                 0.216626172592199,  0.000000000000000,  0.000000000000000,
                                 0.005034668784922,  0.000111840688640, -1.167875653968039,
                                -1.095445115010333,  0.002768874426542,  0.019396877017286,
                                 0.000000000000000,  0.000000000000000,  0.155856378379852,
                                 0.250887228514869,  0.000000000000000,  0.000000000000000,
                                 0.120199214821641,  0.064050037938797,  0.000000000000000,
                                 0.000000000000000,  0.035681340382980,  0.021382284579536,
                                 0.000000000000000,  0.000000000000000, -0.255583713479090,
                                -0.141436376779725,  0.000000000000000,  0.000000000000000,
                                 0.224873608097211,  0.372115976020436,  0.000000000000000,
                                 0.000000000000000,  0.001189854750623,  0.000055001796580,
                                -0.078094809923358,  0.002865559868591, -1.565532555876448,
                                -0.412573060604175,  0.044884942351158,  0.113224858965527,
                                 0.000000000000000,  0.000000000000000,  0.103814624094108,
                                 0.085774689261091, -0.000000000000000, -0.000000000000000,
                                 0.029114309802515,  0.025492652568909,  0.000000000000000,
                                 0.000000000000000, -0.219893614232736, -0.182483122481402,
                                 0.000000000000000,  0.000000000000000,  0.065829114797336,
                                 0.163471323593986,  0.000000000000000,  0.000000000000000,
                                 0.004853243244626,  0.000827942162467,  0.000000000000000,
                                 0.000000000000000,  0.025788514984289,  0.023756225647935,
                                -0.702071594732622, -0.894427190999917,  0.218854732192625,
                                 0.307272846421235,  0.000000000000000,  0.000000000000000,
                                 0.075325664457733,  0.078444955477978, -0.000000000000000,
                                -0.000000000000000,  0.024092466584176,  0.026187843377422,
                                 0.000000000000000,  0.000000000000000, -0.164544145028614,
                                -0.173223477089177,  0.000000000000000,  0.000000000000000,
                                 0.323017044947367,  0.455747133193905,  0.000000000000000,
                                 0.000000000000000,  0.000182905922679,  0.000067363168279,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.026795906665643,  0.031778686558830,
                                -1.877313119090894, -1.209243925457213,  0.152873670999890,
                                 0.200802695190125,  0.000000000000000,  0.000000000000000,
                                -0.113772434989791,  0.034906027313265,  0.000000000000000,
                                 0.000000000000000,  0.339355531709922,  0.048418568152210,
                                 0.000000000000000,  0.000000000000000, -0.346278645783561,
                                 0.067415607326474,  0.000000000000000,  0.000000000000000,
                                -0.051274425008247, -0.010742098501726,  0.000000000000000,
                                 0.000000000000000,  0.077430664181397, -0.046989944291761,
                                 0.000000000000000,  0.000000000000000,  0.008414744118638,
                                 0.061852968870992, -1.529108167601312, -1.434274331201273,
                                 0.265895615711899,  0.317189097678802,  0.000000000000000,
                                 0.000000000000000, -0.060856175380663,  0.093565593587656,
                                 0.000000000000000,  0.000000000000000,  0.188761738628637,
                                 0.051521671584205,  0.000000000000000,  0.000000000000000,
                                -0.134568712771910,  0.173966587089993,  0.000000000000000,
                                 0.000000000000000, -0.038212631711119, -0.011929946690070,
                                 0.000000000000000,  0.000000000000000, -0.004192112605667,
                                -0.092557753267380, -0.026110020659828,  0.006694798193195,
                                 0.000000000000000,  0.000000000000000,  0.133385714757671,
                                 0.192192692972083, -2.049763268634716, -0.540184937119496,
                                -0.105492843110936, -0.042184239245429,  0.000000000000000,
                                 0.000000000000000,  0.318523976690965,  0.133452972943806,
                                 0.000000000000000,  0.000000000000000, -0.326599159670305,
                                -0.092853607799135,  0.000000000000000,  0.000000000000000,
                                -0.047340682719740, -0.027078089912001,  0.000000000000000,
                                 0.000000000000000,  0.075089079626834, -0.004183615152512,
                                 0.000000000000000,  0.000000000000000,  0.046707946478353,
                                 0.075754106405091,  0.000000000000000,  0.000000000000000,
                                 0.301558813402760,  0.388475720643439, -0.919227493183029,
                                -1.171080087538241,  0.049042541646818,  0.114593980885192,
                                 0.000000000000000,  0.000000000000000,  0.075365514215796,
                                 0.063100903038277,  0.000000000000000,  0.000000000000000,
                                 0.095058076777589,  0.213064685331967,  0.000000000000000,
                                 0.000000000000000, -0.016667712427272, -0.014611141024638,
                                 0.000000000000000,  0.000000000000000, -0.068938108496180,
                                -0.113359633621752,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.069165264362544,
                                 0.012053595569582,  0.000000000000000,  0.000000000000000,
                                -0.053985961352624, -0.031365453496711, -2.098899874669700,
                                -1.351975809350508,  0.265658877748751,  0.340125895340434,
                                 0.000000000000000,  0.000000000000000, -0.231173272268016,
                                 0.072335999147152,  0.000000000000000,  0.000000000000000,
                                 0.052605221278818, -0.059589086505946,  0.000000000000000,
                                 0.000000000000000,  0.418655871992778,  0.125039955264193,
                                 0.000000000000000,  0.000000000000000, -0.037036911796385,
                                 0.024844699383482,  0.000000000000000, -0.000000000000000,
                                -0.005718474861613,  0.022919416839137,  0.000000000000000,
                                 0.000000000000000, -0.065517384275920, -0.041462305015964,
                                -1.709594903853338, -1.603567451474547,  0.432526488056067,
                                 0.551683019733059,  0.000000000000000,  0.000000000000000,
                                -0.108965082143110,  0.180846029216652,  0.000000000000000,
                                 0.000000000000000, -0.086974004751927, -0.084711039356563,
                                 0.000000000000000,  0.000000000000000,  0.336087641207524,
                                 0.157579956458495,  0.000000000000000,  0.000000000000000,
                                 0.009364663666328,  0.045365155301702, -0.067168647479152,
                                -0.003540141127561,  0.000000000000000, -0.000000000000000,
                                -0.048319782642980, -0.046970281029937,  0.000000000000000,
                                 0.000000000000000,  0.233900641164779,  0.312682339085410,
                                -2.291705003224694, -0.603945119910322, -0.215422082833773,
                                -0.075014255835909,  0.000000000000000,  0.000000000000000,
                                 0.057594771914410, -0.063196935751404, -0.000000000000000,
                                 0.000000000000000,  0.385853719043513,  0.239252159260383,
                                 0.000000000000000,  0.000000000000000, -0.036471715733098,
                                 0.007307522971250, -0.000000000000000,  0.000000000000000,
                                 0.017699867535174,  0.028070438229020, -0.000000000000000,
                                 0.000000000000000, -0.047855107471108, -0.050780745424376,
                                 0.000000000000000,  0.000000000000000,  0.509775356642441,
                                 0.675670949051889, -1.027727580771989, -1.309307341415956,
                                 0.102625593737648,  0.221490246794628,  0.000000000000000,
                                 0.000000000000000, -0.090268125695281, -0.103749411002201,
                                 0.000000000000000,  0.000000000000000,  0.191873435172641,
                                 0.192995243506652,  0.000000000000000,  0.000000000000000,
                                 0.036743744848668,  0.055560741295643,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                -0.019739010010430,  0.003028813260157,  0.000000000000000,
                                 0.000000000000000,  0.535175801472318,  0.143452506575309,
                                 0.000000000000000,  0.000000000000000, -0.058834799453743,
                                -0.153487284259960, -2.167734469320689, -1.396314611757284,
                                -0.231519054038005,  0.351569016488730,  0.000000000000000,
                                 0.000000000000000, -0.039223199635829, -0.102324856173307,
                                -0.000000000000000,  0.000000000000000, -0.222989917280133,
                                -0.059771877739712,  0.000000000000000,  0.000000000000000,
                                 0.100888273386641, -0.015480601107471,  0.000000000000000,
                                 0.000000000000000, -0.000624289682394,  0.005211368150796,
                                 0.000000000000000,  0.000000000000000,  0.413918926581761,
                                 0.173949192231283,  0.000000000000000,  0.000000000000000,
                                -0.203798133848900, -0.246657290398305, -1.765662024369346,
                                -1.656157342421651,  0.263099867109439,  0.604396499515644,
                                 0.000000000000000,  0.000000000000000, -0.135865422565933,
                                -0.164438193598870,  0.000000000000000,  0.000000000000000,
                                -0.172466219409067, -0.072478830096368,  0.000000000000000,
                                 0.000000000000000,  0.003190813932234, -0.026635881659624,
                                -0.019271030283480, -0.000300727212598,  0.000000000000000,
                                 0.000000000000000,  0.494104939143227,  0.294344265311190,
                                 0.000000000000000,  0.000000000000000, -0.044499874482174,
                                -0.147352911392305,  0.000000000000000,  0.000000000000000,
                                -0.239653540053136,  0.194884233251827, -2.366862749842523,
                                -0.623751837716245, -0.029666582988116, -0.098235274261537,
                                 0.000000000000000,  0.000000000000000, -0.205877057976344,
                                -0.122643443879662,  0.000000000000000,  0.000000000000000,
                                 0.098496377004453,  0.001537050197722,  0.000000000000000,
                                 0.000000000000000,  0.004491812804491,  0.006382596415621,
                                 0.000000000000000,  0.000000000000000,  0.220805025455593,
                                 0.213043381067974,  0.000000000000000,  0.000000000000000,
                                -0.230382794460859, -0.302092251406670,  0.000000000000000,
                                 0.000000000000000,  0.523269246444351,  0.740231513068814,
                                -1.061432481271453, -1.352246807565627, -0.153588529640573,
                                -0.201394834271113,  0.000000000000000,  0.000000000000000,
                                -0.092002093939831, -0.088768075444989,  0.000000000000000,
                                 0.000000000000000, -0.022958154334066, -0.032622159457618,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.000000000000000,  0.113344440005688, -0.027261226000946,
                                 0.000000000000000,  0.000000000000000, -0.340730426616507,
                                -0.107041853336702,  0.000000000000000,  0.000000000000000,
                                 0.052605221278818, -0.059589086505946,  0.000000000000000,
                                 0.000000000000000, -0.154115514845344,  0.048223999431435,
                                -2.098899874669700, -1.351975809350508,  0.221821193349736,
                                 0.389783467428722,  0.000000000000000,  0.000000000000000,
                                -0.452271571053566, -0.123355752237219, -0.000000000000000,
                                 0.000000000000000,  0.006506367778347,  0.009657206673930,
                                 0.000000000000000,  0.000000000000000,  0.004297468484085,
                                -0.051070152409529,  0.000000000000000,  0.000000000000000,
                                -0.281208049332067, -0.135567687473599,  0.000000000000000,
                                 0.000000000000000, -0.086974004751927, -0.084711039356563,
                                 0.000000000000000,  0.000000000000000, -0.072643388095407,
                                 0.120564019477768, -1.709594903853338, -1.603567451474547,
                                 0.505004825349340,  0.622275552530195,  0.000000000000000,
                                 0.000000000000000, -0.346013076083808, -0.153969457605432,
                                -0.000000000000000,  0.000000000000000,  0.007829806187547,
                                 0.017261961373876,  0.110278247222368,  0.002043874470996,
                                 0.000000000000000,  0.000000000000000, -0.313536631717580,
                                -0.200299065941427,  0.000000000000000,  0.000000000000000,
                                 0.057594771914410, -0.063196935751404, -0.000000000000000,
                                 0.000000000000000, -0.143614721889182, -0.050009503890606,
                                 0.000000000000000,  0.000000000000000,  0.185904997902771,
                                 0.365346452211581, -2.291705003224694, -0.603945119910322,
                                -0.417940451197749, -0.246063869104603,  0.000000000000000,
                                 0.000000000000000,  0.006022829581041,  0.005733328002667,
                                 0.000000000000000,  0.000000000000000, -0.040137790550295,
                                -0.062547907244758,  0.000000000000000,  0.000000000000000,
                                -0.164160179642031, -0.166035829959708,  0.000000000000000,
                                 0.000000000000000, -0.090268125695281, -0.103749411002201,
                                 0.000000000000000,  0.000000000000000,  0.068417062491766,
                                 0.147660164529752,  0.000000000000000,  0.000000000000000,
                                 0.584998794721842,  0.762128791553723, -1.027727580771989,
                                -1.309307341415956, -0.189500635738673, -0.188573303553198,
                                 0.000000000000000,  0.000000000000000,  0.014334105547727,
                                 0.021141498662814,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000,  0.000000000000000, -0.020429710085986,
                                 0.048027936782147,  0.000000000000000,  0.000000000000000,
                                -0.051274425008247, -0.010742098501726,  0.000000000000000,
                                 0.000000000000000,  0.398964643773224, -0.071932577233447,
                                 0.000000000000000,  0.000000000000000, -0.141398138212468,
                                -0.020174403396754,  0.000000000000000,  0.000000000000000,
                                -0.383056424714732,  0.057992762393350, -1.877313119090894,
                                -1.209243925457213,  0.051179394733533,  0.179497533161700,
                                 0.000000000000000,  0.000000000000000, -0.038444342845945,
                                 0.031566567490443,  0.000000000000000,  0.000000000000000,
                                 0.017096502689403,  0.092897124865706,  0.000000000000000,
                                 0.000000000000000, -0.038212631711119, -0.011929946690070,
                                 0.000000000000000,  0.000000000000000,  0.147554047682185,
                                -0.184052046102546,  0.000000000000000,  0.000000000000000,
                                -0.078650724428599, -0.021467363160086,  0.000000000000000,
                                 0.000000000000000, -0.127225664922067,  0.145113495207370,
                                -1.529108167601312, -1.434274331201273,  0.190107229484847,
                                 0.293528036743497,  0.000000000000000,  0.000000000000000,
                                 0.005777666078075,  0.061783616551066, -0.020097651328518,
                                 0.013151752424194,  0.000000000000000,  0.000000000000000,
                                -0.047340682719740, -0.027078089912001,  0.000000000000000,
                                 0.000000000000000,  0.377107128171475,  0.101726782478433,
                                 0.000000000000000,  0.000000000000000, -0.132718323621236,
                                -0.055605405393252,  0.000000000000000,  0.000000000000000,
                                -0.363644682116917, -0.087536020939617,  0.000000000000000,
                                 0.000000000000000,  0.039493360696854,  0.138487814646614,
                                -2.049763268634716, -0.540184937119496, -0.037347799977072,
                                 0.004862113524610,  0.000000000000000,  0.000000000000000,
                                 0.070658404135016,  0.113775277246297,  0.000000000000000,
                                 0.000000000000000, -0.016667712427272, -0.014611141024638,
                                 0.000000000000000,  0.000000000000000, -0.101506356069798,
                                -0.225416799533222,  0.000000000000000,  0.000000000000000,
                                -0.031402297589915, -0.026292042932615,  0.000000000000000,
                                 0.000000000000000,  0.082000413584773,  0.177727009024934,
                                 0.000000000000000,  0.000000000000000,  0.268501183755338,
                                 0.359496957611241, -0.919227493183029, -1.171080087538241,
                                 0.046356395275777,  0.075669167506942,  0.000000000000000,
                                 0.000000000000000,  0.000000000000000,  0.000000000000000,
                                 0.005034668784923,  0.000111840688640,  0.000000000000000,
                                 0.000000000000000, -0.086802729673864, -0.226504378553838,
                                 0.000000000000000,  0.000000000000000,  0.196261129742125,
                                 0.092404123136164,  0.000000000000000,  0.000000000000000,
                                -0.165239157419572, -0.080738029610436, -0.000000000000000,
                                -0.000000000000000,  0.068264373489166,  0.034122099673496,
                                 0.000000000000000,  0.000000000000000,  0.056376948454859,
                                 0.148719514642749, -1.433821578561278, -0.923575303678869,
                                -0.104759951883975,  0.016459891260159,  0.000000000000000,
                                 0.000000000000000,  0.001189854750623,  0.000055001796580,
                                 0.000000000000000,  0.000000000000000, -0.250573331793454,
                                -0.384271896072922,  0.000000000000000,  0.000000000000000,
                                 0.207910666967715,  0.123633892325541,  0.000000000000000,
                                 0.000000000000000, -0.182371295290786, -0.109287232295406,
                                -0.000000000000000,  0.000000000000000,  0.072923443697861,
                                 0.046395907521730,  0.000000000000000,  0.000000000000000,
                                 0.161108248213925,  0.253371352880704, -1.167875653968039,
                                -1.095445115010333, -0.003079807741374,  0.019126517944724,
                                 0.004853243244626,  0.000827942162467,  0.000000000000000,
                                 0.000000000000000, -0.070150295190826, -0.181831135275241,
                                 0.000000000000000,  0.000000000000000,  0.177485666996328,
                                 0.148604670676741, -0.000000000000000,  0.000000000000000,
                                -0.148806472323967, -0.130295779796645,  0.000000000000000,
                                 0.000000000000000,  0.061760076418002,  0.052178557888135,
                                 0.000000000000000,  0.000000000000000,  0.045767997640950,
                                 0.116976780280624,  0.000000000000000,  0.000000000000000,
                                -0.101950727804553, -0.001204155833391, -1.565532555876448,
                                -0.412573060604175,  0.000182905922679,  0.000067363168279,
                                 0.000000000000000,  0.000000000000000, -0.338201764004938,
                                -0.470635033935234,  0.000000000000000,  0.000000000000000,
                                 0.141011609275071,  0.151419975555886,  0.000000000000000,
                                 0.000000000000000, -0.123139273652455, -0.133848977262379,
                                 0.000000000000000,  0.000000000000000,  0.051989233168803,
                                 0.056823149790798,  0.000000000000000,  0.000000000000000,
                                 0.221957807108912,  0.310315264998190,  0.000000000000000,
                                 0.000000000000000,  0.024889448431991,  0.023425104760380,
                                -0.702071594732622, -0.894427190999917,  0.000000000000000,
                                 0.000000000000000, -0.139773732507805, -0.129178494593533,
                                 0.000000000000000,  0.000000000000000,  0.213350734492790,
                                 0.026162793759017,  0.000000000000000,  0.000000000000000,
                                 0.005517100600115, -0.000610553025716,  0.000000000000000,
                                -0.000000000000000,  0.066049879236918,  0.001498501759742,
                                 0.000000000000000,  0.000000000000000, -0.130870599836877,
                                -0.011817929107373,  0.000000000000000,  0.000000000000000,
                                 0.076363337994734,  0.010622759031784,  0.000000000000000,
                                 0.000000000000000,  0.087478117695231,  0.085807102007469,
                                 0.000000000000000,  0.000000000000000, -0.192638395444837,
                                -0.204995242231698,  0.000000000000000,  0.000000000000000,
                                 0.127678461488911,  0.018896763363150,  0.000000000000000,
                                 0.000000000000000, -0.001292275906411, -0.000659336326767,
                                 0.000000000000000, -0.000000000000000,  0.020254593645509,
                                -0.000361513382002,  0.000000000000000,  0.000000000000000,
                                -0.057021359950075, -0.011518281878903,  0.000000000000000,
                                 0.000000000000000,  0.050237453435319,  0.007736735425033,
                                 0.000000000000000,  0.000000000000000,  0.126617616823073,
                                 0.136371287528085, -0.124393807039287, -0.138646253004941,
                                 0.000000000000000,  0.000000000000000,  0.199335519334789,
                                 0.090243736987803, -0.000000000000000,  0.000000000000000,
                                 0.005534775771428, -0.000941286711118,  0.000000000000000,
                                 0.000000000000000,  0.063230903874419,  0.014131598714532,
                                 0.000000000000000,  0.000000000000000, -0.124040956128922,
                                -0.040145542283366,  0.000000000000000,  0.000000000000000,
                                 0.070975287623060,  0.035540560592219,  0.000000000000000,
                                 0.000000000000000,  0.077466511937868,  0.091163705590323,
                                 0.000000000000000,  0.000000000000000, -0.194211478971188,
                                -0.251066871582949,  0.000000000000000,  0.000000000000000,
                                 0.041524398929178,  0.023143714014918,  0.000000000000000,
                                 0.000000000000000, -0.000945124899249, -0.000807518784730,
                                 0.000000000000000,  0.000000000000000,  0.002563471026388,
                                -0.000442761660546,  0.000000000000000,  0.000000000000000,
                                -0.018539717102637, -0.014106956658429,  0.000000000000000,
                                 0.000000000000000,  0.016846525160356,  0.009475527033123,
                                 0.000000000000000,  0.000000000000000,  0.128982698632569,
                                 0.167020035005090,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 36, 28));
}

TEST_F(CLinearMomentumIntegralsDriverTest, ComputeGGForLiH)
{
    CLinearMomentumIntegralsDriver lmomdrv(MPI_COMM_WORLD);
    
    auto mlih = vlxmol::getTestLiH();
    
    auto mbas = vlxbas::getTestBasisForLiH();
    
    CGtoBlock bgtos(mlih, mbas, 4);
    
    CGtoBlock kgtos(mlih, mbas, 4);
    
    CDenseMatrix lmomxmat(36, 36);
    
    CDenseMatrix lmomymat(36, 36);
    
    CDenseMatrix lmomzmat(36, 36);
    
    lmomdrv.compute(lmomxmat.values(), lmomymat.values(), lmomzmat.values(),
                   bgtos, kgtos);
    
    std::vector<double> intxvals{ 0.000000000000000, -0.000000000000000,  0.111893751501877,
                                 0.256278378774255, -0.000000000000000, -0.000000000000000,
                                -0.036086679910354,  0.114997349707130, -0.000000000000000,
                                -0.000000000000000, -0.387183837045240, -0.210972370311804,
                                -0.000000000000000, -0.000000000000000, -0.169032468264508,
                                -0.070807538321545, -0.000000000000000, -0.000000000000000,
                                -0.190692642879141, -0.037774858371608, -0.000000000000000,
                                -0.000000000000000,  0.574023468220456,  0.210766534435215,
                                -0.000000000000000, -0.000000000000000, -0.019651358622366,
                                -0.151337543643598, -0.000000000000000, -0.000000000000000,
                                -0.304297192567312, -0.190776210819750, -0.000000000000000,
                                -0.000000000000000, -0.003630076021569, -0.000388546125550,
                                 0.000000000000000,  0.000000000000000,  0.196866080143870,
                                 0.419870182325357,  0.000000000000000, -0.000000000000000,
                                 0.038153567949280,  0.213014876873133,  0.000000000000000,
                                -0.000000000000000, -0.299255735768779, -0.286211002897772,
                                 0.000000000000000, -0.000000000000000, -0.114272969815404,
                                -0.090871251567422,  0.000000000000000, -0.000000000000000,
                                -0.086691842196548, -0.042351563264709,  0.000000000000000,
                                -0.000000000000000,  0.364529756679082,  0.263618778412802,
                                 0.000000000000000, -0.000000000000000, -0.129898331932618,
                                -0.231854174734868,  0.000000000000000, -0.000000000000000,
                                -0.266179376295925, -0.255558771602326,  0.000000000000000,
                                -0.000000000000000, -0.001246728054130, -0.000368383007327,
                                -0.111893751501877, -0.196866080143870,  0.000000000000000,
                                 0.000000000000000,  0.036086679910354, -0.038153567949280,
                                -0.000000000000000, -0.000000000000000,  0.387183837045240,
                                 0.299255735768779, -0.000000000000000, -0.000000000000000,
                                 0.169032468264508,  0.114272969815404, -0.000000000000000,
                                -0.000000000000000,  0.190692642879141,  0.086691842196548,
                                -0.000000000000000, -0.000000000000000, -0.574023468220456,
                                -0.364529756679082, -0.000000000000000, -0.000000000000000,
                                 0.019651358622366,  0.129898331932618,  0.000000000000000,
                                -0.000000000000000,  0.304297192567312,  0.266179376295925,
                                -0.000000000000000, -0.000000000000000,  0.003630076021569,
                                 0.001246728054130,  0.000000000000001, -0.000000000000000,
                                -0.256278378774255, -0.419870182325357, -0.000000000000000,
                                 0.000000000000000, -0.114997349707130, -0.213014876873133,
                                 0.000000000000000, -0.000000000000000,  0.210972370311804,
                                 0.286211002897772,  0.000000000000000, -0.000000000000000,
                                 0.070807538321545,  0.090871251567422,  0.000000000000000,
                                -0.000000000000000,  0.037774858371608,  0.042351563264709,
                                 0.000000000000000, -0.000000000000000, -0.210766534435215,
                                -0.263618778412802,  0.000000000000000, -0.000000000000000,
                                 0.151337543643598,  0.231854174734868,  0.000000000000000,
                                -0.000000000000000,  0.190776210819750,  0.255558771602326,
                                 0.000000000000000, -0.000000000000000,  0.000388546125550,
                                 0.000368383007328,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.036086679910354,
                                 0.114997349707130,  0.000000000000000, -0.000000000000000,
                                -0.218825802282568, -0.082516436301181, -0.000000000000000,
                                -0.000000000000000, -0.023523639621356,  0.075490264021221,
                                -0.000000000000000, -0.000000000000000, -0.009736926780168,
                                -0.042766695858344, -0.000000000000000, -0.000000000000000,
                                -0.220398107007853,  0.067092314915386, -0.000000000000000,
                                -0.000000000000000, -0.098745653462901, -0.060036007839013,
                                -0.000000000000000, -0.000000000000000,  0.249082700054654,
                                -0.012719865108260, -0.000000000000000, -0.000000000000000,
                                 0.064855468171459,  0.002646833682865, -0.000000000000000,
                                -0.000000000000000,  0.329367541961199,  0.193046952755571,
                                 0.000000000000000,  0.000000000000000,  0.038153567949280,
                                 0.213014876873133,  0.000000000000000,  0.000000000000000,
                                -0.194197795201184, -0.063233317420306,  0.000000000000000,
                                -0.000000000000000,  0.024665883078637,  0.144825333550992,
                                 0.000000000000000, -0.000000000000000, -0.020129455341430,
                                -0.076488611496357,  0.000000000000000, -0.000000000000000,
                                -0.001857982614256,  0.114992963475508,  0.000000000000000,
                                -0.000000000000000, -0.044974732400472, -0.104781893592505,
                                 0.000000000000000, -0.000000000000000,  0.065791247092908,
                                -0.039836952448465,  0.000000000000000, -0.000000000000000,
                                 0.015860708550064,  0.001306525668860,  0.000000000000000,
                                -0.000000000000000,  0.273916083198242,  0.257665039349259,
                                 0.036086679910354, -0.038153567949280,  0.000000000000000,
                                -0.000000000000000,  0.218825802282568,  0.194197795201184,
                                 0.000000000000000,  0.000000000000000,  0.023523639621356,
                                -0.024665883078637, -0.000000000000000, -0.000000000000000,
                                 0.009736926780168,  0.020129455341430,  0.000000000000000,
                                -0.000000000000000,  0.220398107007853,  0.001857982614256,
                                -0.000000000000000, -0.000000000000000,  0.098745653462900,
                                 0.044974732400472, -0.000000000000000, -0.000000000000000,
                                -0.249082700054654, -0.065791247092908, -0.000000000000000,
                                -0.000000000000000, -0.064855468171459, -0.015860708550064,
                                 0.000000000000001, -0.000000000000000, -0.329367541961200,
                                -0.273916083198242, -0.000000000000000, -0.000000000000000,
                                -0.114997349707130, -0.213014876873133,  0.000000000000000,
                                 0.000000000000000,  0.082516436301181,  0.063233317420306,
                                -0.000000000000000,  0.000000000000000, -0.075490264021221,
                                -0.144825333550993,  0.000000000000000, -0.000000000000000,
                                 0.042766695858344,  0.076488611496357,  0.000000000000000,
                                -0.000000000000000, -0.067092314915386, -0.114992963475508,
                                 0.000000000000000, -0.000000000000000,  0.060036007839013,
                                 0.104781893592505,  0.000000000000000, -0.000000000000000,
                                 0.012719865108260,  0.039836952448465,  0.000000000000000,
                                -0.000000000000000, -0.002646833682865, -0.001306525668860,
                                 0.000000000000000, -0.000000000000000, -0.193046952755571,
                                -0.257665039349259,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.387183837045240,
                                -0.210972370311804,  0.000000000000000, -0.000000000000000,
                                -0.023523639621356,  0.075490264021221,  0.000000000000000,
                                -0.000000000000000, -0.263713197481690, -0.102947227748799,
                                -0.000000000000000, -0.000000000000000, -0.106491569532025,
                                -0.011015696374842, -0.000000000000000, -0.000000000000000,
                                 0.202812688389351,  0.034531498472293, -0.000000000000000,
                                -0.000000000000000, -0.030386306682486, -0.025097106462256,
                                -0.000000000000000, -0.000000000000000, -0.050889455695432,
                                -0.006389146917915, -0.000000000000000, -0.000000000000000,
                                -0.112632533019234,  0.017349132296702, -0.000000000000000,
                                -0.000000000000000,  0.177682005753488,  0.172900597216915,
                                 0.000000000000000,  0.000000000000000, -0.299255735768779,
                                -0.286211002897772,  0.000000000000000,  0.000000000000000,
                                 0.024665883078637,  0.144825333550993,  0.000000000000000,
                                 0.000000000000000, -0.184009844764062, -0.111697089038449,
                                 0.000000000000000, -0.000000000000000, -0.070207227560110,
                                 0.014838269227749,  0.000000000000000, -0.000000000000000,
                                 0.117546678736569,  0.011153605100007,  0.000000000000000,
                                -0.000000000000000, -0.011557596195712, -0.043696894503398,
                                 0.000000000000000, -0.000000000000000, -0.013723689440602,
                                -0.008219558954515,  0.000000000000000, -0.000000000000000,
                                -0.032131840043757,  0.040978454131137,  0.000000000000000,
                                -0.000000000000000,  0.189963329673229,  0.253908403770195,
                                 0.387183837045240,  0.299255735768779,  0.000000000000000,
                                -0.000000000000000,  0.023523639621356, -0.024665883078637,
                                 0.000000000000000, -0.000000000000000,  0.263713197481690,
                                 0.184009844764062,  0.000000000000000,  0.000000000000000,
                                 0.106491569532025,  0.070207227560110, -0.000000000000000,
                                -0.000000000000000, -0.202812688389351, -0.117546678736569,
                                 0.000000000000000, -0.000000000000000,  0.030386306682486,
                                 0.011557596195712, -0.000000000000000, -0.000000000000000,
                                 0.050889455695432,  0.013723689440602,  0.000000000000001,
                                -0.000000000000000,  0.112632533019234,  0.032131840043758,
                                -0.000000000000000, -0.000000000000000, -0.177682005753488,
                                -0.189963329673229, -0.000000000000000, -0.000000000000000,
                                 0.210972370311804,  0.286211002897772,  0.000000000000000,
                                 0.000000000000000, -0.075490264021221, -0.144825333550992,
                                 0.000000000000000,  0.000000000000000,  0.102947227748799,
                                 0.111697089038449, -0.000000000000000,  0.000000000000000,
                                 0.011015696374842, -0.014838269227749,  0.000000000000000,
                                -0.000000000000000, -0.034531498472293, -0.011153605100007,
                                 0.000000000000000, -0.000000000000000,  0.025097106462256,
                                 0.043696894503398,  0.000000000000000, -0.000000000000000,
                                 0.006389146917915,  0.008219558954514,  0.000000000000000,
                                -0.000000000000000, -0.017349132296702, -0.040978454131137,
                                 0.000000000000000, -0.000000000000000, -0.172900597216915,
                                -0.253908403770195,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.169032468264508,
                                -0.070807538321545,  0.000000000000000, -0.000000000000000,
                                -0.009736926780168, -0.042766695858344,  0.000000000000000,
                                -0.000000000000000, -0.106491569532025, -0.011015696374842,
                                 0.000000000000000, -0.000000000000000,  0.078108936058709,
                                -0.025575035914479, -0.000000000000000, -0.000000000000000,
                                 0.013964458261972, -0.004638839241007, -0.000000000000000,
                                -0.000000000000000,  0.023155876819279, -0.031619106690814,
                                -0.000000000000000, -0.000000000000000, -0.042002924977437,
                                -0.004009990711062, -0.000000000000000, -0.000000000000000,
                                -0.040833684222308,  0.064416100092911, -0.000000000000000,
                                -0.000000000000000, -0.350890226607171, -0.165204858591598,
                                 0.000000000000000,  0.000000000000000, -0.114272969815404,
                                -0.090871251567422,  0.000000000000000,  0.000000000000000,
                                -0.020129455341430, -0.076488611496357,  0.000000000000000,
                                 0.000000000000000, -0.070207227560110,  0.014838269227749,
                                 0.000000000000000,  0.000000000000000, -0.016052165189794,
                                -0.031235543098639,  0.000000000000000, -0.000000000000000,
                                 0.002223192220894, -0.008810119043436,  0.000000000000000,
                                -0.000000000000000, -0.047276473020110, -0.028410230692311,
                                 0.000000000000000, -0.000000000000000, -0.011901793029321,
                                -0.004147666746587,  0.000000000000000, -0.000000000000000,
                                 0.021633158331970,  0.116394545366910,  0.000000000000000,
                                -0.000000000000000, -0.257832727903338, -0.213731210904300,
                                 0.169032468264508,  0.114272969815404,  0.000000000000000,
                                -0.000000000000000,  0.009736926780168,  0.020129455341430,
                                -0.000000000000000, -0.000000000000000,  0.106491569532025,
                                 0.070207227560110,  0.000000000000000, -0.000000000000000,
                                -0.078108936058709,  0.016052165189794,  0.000000000000000,
                                -0.000000000000000, -0.013964458261972, -0.002223192220894,
                                -0.000000000000000, -0.000000000000000, -0.023155876819279,
                                 0.047276473020110,  0.000000000000000, -0.000000000000000,
                                 0.042002924977437,  0.011901793029321, -0.000000000000000,
                                -0.000000000000000,  0.040833684222308, -0.021633158331970,
                                -0.000000000000000, -0.000000000000000,  0.350890226607171,
                                 0.257832727903338, -0.000000000000000, -0.000000000000000,
                                 0.070807538321545,  0.090871251567422,  0.000000000000000,
                                 0.000000000000000,  0.042766695858344,  0.076488611496357,
                                 0.000000000000000,  0.000000000000000,  0.011015696374842,
                                -0.014838269227749,  0.000000000000000,  0.000000000000000,
                                 0.025575035914479,  0.031235543098639,  0.000000000000000,
                                 0.000000000000000,  0.004638839241007,  0.008810119043436,
                                 0.000000000000000, -0.000000000000000,  0.031619106690814,
                                 0.028410230692311,  0.000000000000000, -0.000000000000000,
                                 0.004009990711062,  0.004147666746587,  0.000000000000000,
                                -0.000000000000000, -0.064416100092911, -0.116394545366911,
                                 0.000000000000000, -0.000000000000000,  0.165204858591598,
                                 0.213731210904300,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.190692642879141,
                                -0.037774858371608,  0.000000000000000, -0.000000000000000,
                                -0.220398107007853,  0.067092314915386,  0.000000000000000,
                                -0.000000000000000,  0.202812688389351,  0.034531498472293,
                                 0.000000000000000, -0.000000000000000,  0.013964458261972,
                                -0.004638839241007,  0.000000000000000, -0.000000000000000,
                                -0.135358167399398, -0.041761584982812, -0.000000000000000,
                                -0.000000000000000,  0.002774028888773, -0.010662396220339,
                                -0.000000000000000, -0.000000000000000,  0.065236220077411,
                                -0.000801373104907, -0.000000000000000, -0.000000000000000,
                                -0.022698288500661, -0.024978813565834, -0.000000000000000,
                                -0.000000000000000,  0.443314205528081,  0.124617589068450,
                                 0.000000000000000,  0.000000000000000, -0.086691842196548,
                                -0.042351563264709,  0.000000000000000,  0.000000000000000,
                                -0.001857982614256,  0.114992963475508,  0.000000000000000,
                                 0.000000000000000,  0.117546678736569,  0.011153605100007,
                                 0.000000000000000,  0.000000000000000,  0.002223192220894,
                                -0.008810119043436,  0.000000000000000,  0.000000000000000,
                                -0.101572536372928, -0.028812345456276,  0.000000000000000,
                                -0.000000000000000, -0.029273125491537, -0.001597613847309,
                                 0.000000000000000, -0.000000000000000,  0.053547665233262,
                                -0.029821986323890,  0.000000000000000, -0.000000000000000,
                                -0.016278503843101, -0.040699449007654,  0.000000000000000,
                                -0.000000000000000,  0.247196373387439,  0.147277321021618,
                                 0.190692642879141,  0.086691842196548,  0.000000000000000,
                                -0.000000000000000,  0.220398107007853,  0.001857982614256,
                                 0.000000000000000, -0.000000000000000, -0.202812688389351,
                                -0.117546678736569, -0.000000000000000, -0.000000000000000,
                                -0.013964458261972, -0.002223192220894,  0.000000000000000,
                                -0.000000000000000,  0.135358167399398,  0.101572536372928,
                                 0.000000000000000,  0.000000000000000, -0.002774028888773,
                                 0.029273125491537, -0.000000000000000, -0.000000000000000,
                                -0.065236220077411, -0.053547665233262,  0.000000000000000,
                                -0.000000000000000,  0.022698288500661,  0.016278503843101,
                                -0.000000000000000, -0.000000000000000, -0.443314205528081,
                                -0.247196373387439, -0.000000000000000, -0.000000000000000,
                                 0.037774858371608,  0.042351563264709,  0.000000000000000,
                                 0.000000000000000, -0.067092314915386, -0.114992963475508,
                                 0.000000000000000,  0.000000000000000, -0.034531498472293,
                                -0.011153605100007,  0.000000000000000,  0.000000000000000,
                                 0.004638839241007,  0.008810119043436,  0.000000000000000,
                                 0.000000000000000,  0.041761584982812,  0.028812345456276,
                                -0.000000000000000,  0.000000000000000,  0.010662396220339,
                                 0.001597613847309,  0.000000000000000, -0.000000000000000,
                                 0.000801373104907,  0.029821986323890,  0.000000000000000,
                                -0.000000000000000,  0.024978813565834,  0.040699449007654,
                                 0.000000000000000, -0.000000000000000, -0.124617589068450,
                                -0.147277321021618, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.574023468220456,
                                 0.210766534435215,  0.000000000000000, -0.000000000000000,
                                -0.098745653462900, -0.060036007839013,  0.000000000000000,
                                -0.000000000000000, -0.030386306682486, -0.025097106462256,
                                 0.000000000000000, -0.000000000000000,  0.023155876819279,
                                -0.031619106690814,  0.000000000000000, -0.000000000000000,
                                 0.002774028888773, -0.010662396220339,  0.000000000000000,
                                -0.000000000000000, -0.053962942114811, -0.056045203055329,
                                -0.000000000000000, -0.000000000000000, -0.194637628360171,
                                -0.010182546388784, -0.000000000000000, -0.000000000000000,
                                 0.287259529284552, -0.063155455573298, -0.000000000000000,
                                -0.000000000000000,  0.129400669930938, -0.018959572766302,
                                 0.000000000000000,  0.000000000000000,  0.364529756679082,
                                 0.263618778412802,  0.000000000000000,  0.000000000000000,
                                -0.044974732400472, -0.104781893592505,  0.000000000000000,
                                 0.000000000000000, -0.011557596195712, -0.043696894503398,
                                 0.000000000000000,  0.000000000000000, -0.047276473020110,
                                -0.028410230692311,  0.000000000000000,  0.000000000000000,
                                -0.029273125491537, -0.001597613847309,  0.000000000000000,
                                 0.000000000000000, -0.119297719624668, -0.037147838498599,
                                 0.000000000000000, -0.000000000000000, -0.093955865748934,
                                 0.023090908412356,  0.000000000000000, -0.000000000000000,
                                 0.034869115633149, -0.123361491557480,  0.000000000000000,
                                -0.000000000000000,  0.014663129899406, -0.035259372180495,
                                -0.574023468220456, -0.364529756679082,  0.000000000000000,
                                -0.000000000000000,  0.098745653462901,  0.044974732400472,
                                 0.000000000000000, -0.000000000000000,  0.030386306682486,
                                 0.011557596195712,  0.000000000000000, -0.000000000000000,
                                -0.023155876819279,  0.047276473020110, -0.000000000000000,
                                -0.000000000000000, -0.002774028888773,  0.029273125491537,
                                 0.000000000000000, -0.000000000000000,  0.053962942114811,
                                 0.119297719624668,  0.000000000000000,  0.000000000000000,
                                 0.194637628360170,  0.093955865748934, -0.000000000000000,
                                -0.000000000000000, -0.287259529284552, -0.034869115633149,
                                 0.000000000000000, -0.000000000000000, -0.129400669930938,
                                -0.014663129899406, -0.000000000000000, -0.000000000000000,
                                -0.210766534435215, -0.263618778412802,  0.000000000000000,
                                 0.000000000000000,  0.060036007839013,  0.104781893592505,
                                 0.000000000000000,  0.000000000000000,  0.025097106462256,
                                 0.043696894503398,  0.000000000000000,  0.000000000000000,
                                 0.031619106690814,  0.028410230692311,  0.000000000000000,
                                 0.000000000000000,  0.010662396220339,  0.001597613847309,
                                 0.000000000000000,  0.000000000000000,  0.056045203055329,
                                 0.037147838498599, -0.000000000000000,  0.000000000000000,
                                 0.010182546388784, -0.023090908412356,  0.000000000000000,
                                -0.000000000000000,  0.063155455573298,  0.123361491557480,
                                 0.000000000000000, -0.000000000000000,  0.018959572766302,
                                 0.035259372180495,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.019651358622366,
                                -0.151337543643598,  0.000000000000000, -0.000000000000000,
                                 0.249082700054654, -0.012719865108260,  0.000000000000000,
                                -0.000000000000000, -0.050889455695432, -0.006389146917915,
                                 0.000000000000000, -0.000000000000000, -0.042002924977437,
                                -0.004009990711062,  0.000000000000000, -0.000000000000000,
                                 0.065236220077411, -0.000801373104907,  0.000000000000000,
                                -0.000000000000000, -0.194637628360170, -0.010182546388784,
                                 0.000000000000000, -0.000000000000000, -0.105136059074566,
                                -0.073809865952411, -0.000000000000000, -0.000000000000000,
                                 0.162290817537872,  0.081519105341513, -0.000000000000000,
                                -0.000000000000000, -0.401444740003684, -0.214207451590918,
                                 0.000000000000000,  0.000000000000000, -0.129898331932618,
                                -0.231854174734868,  0.000000000000000,  0.000000000000000,
                                 0.065791247092908, -0.039836952448465,  0.000000000000000,
                                 0.000000000000000, -0.013723689440602, -0.008219558954514,
                                 0.000000000000000,  0.000000000000000, -0.011901793029321,
                                -0.004147666746587,  0.000000000000000,  0.000000000000000,
                                 0.053547665233262, -0.029821986323890,  0.000000000000000,
                                 0.000000000000000, -0.093955865748934,  0.023090908412356,
                                 0.000000000000000,  0.000000000000000, -0.141908711688743,
                                -0.067218281439662,  0.000000000000000, -0.000000000000000,
                                 0.066991096858044,  0.146872490616373,  0.000000000000000,
                                -0.000000000000000, -0.306943050396439, -0.289693000256262,
                                 0.019651358622366,  0.129898331932618, -0.000000000000000,
                                -0.000000000000000, -0.249082700054654, -0.065791247092908,
                                 0.000000000000000, -0.000000000000000,  0.050889455695432,
                                 0.013723689440602, -0.000000000000001, -0.000000000000000,
                                 0.042002924977437,  0.011901793029321,  0.000000000000000,
                                -0.000000000000000, -0.065236220077411, -0.053547665233262,
                                -0.000000000000000, -0.000000000000000,  0.194637628360171,
                                 0.093955865748934,  0.000000000000000, -0.000000000000000,
                                 0.105136059074566,  0.141908711688743,  0.000000000000000,
                                 0.000000000000000, -0.162290817537872, -0.066991096858044,
                                -0.000000000000000, -0.000000000000000,  0.401444740003684,
                                 0.306943050396439,  0.000000000000000, -0.000000000000000,
                                 0.151337543643598,  0.231854174734868,  0.000000000000000,
                                 0.000000000000000,  0.012719865108260,  0.039836952448465,
                                 0.000000000000000,  0.000000000000000,  0.006389146917915,
                                 0.008219558954515,  0.000000000000000,  0.000000000000000,
                                 0.004009990711062,  0.004147666746587,  0.000000000000000,
                                 0.000000000000000,  0.000801373104907,  0.029821986323890,
                                 0.000000000000000,  0.000000000000000,  0.010182546388784,
                                -0.023090908412356,  0.000000000000000,  0.000000000000000,
                                 0.073809865952411,  0.067218281439662, -0.000000000000000,
                                 0.000000000000000, -0.081519105341513, -0.146872490616373,
                                 0.000000000000000, -0.000000000000000,  0.214207451590918,
                                 0.289693000256262,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.304297192567312,
                                -0.190776210819750,  0.000000000000000, -0.000000000000000,
                                 0.064855468171459,  0.002646833682865,  0.000000000000000,
                                -0.000000000000000, -0.112632533019234,  0.017349132296702,
                                 0.000000000000000, -0.000000000000000, -0.040833684222308,
                                 0.064416100092911,  0.000000000000000, -0.000000000000000,
                                -0.022698288500661, -0.024978813565834,  0.000000000000000,
                                -0.000000000000000,  0.287259529284552, -0.063155455573298,
                                 0.000000000000000, -0.000000000000000,  0.162290817537872,
                                 0.081519105341513,  0.000000000000000, -0.000000000000000,
                                -0.231251219608137, -0.083337407617736, -0.000000000000000,
                                -0.000000000000000, -0.084868172683888,  0.109997157713489,
                                 0.000000000000000,  0.000000000000000, -0.266179376295925,
                                -0.255558771602326,  0.000000000000000,  0.000000000000000,
                                 0.015860708550064,  0.001306525668860,  0.000000000000000,
                                 0.000000000000000, -0.032131840043758,  0.040978454131137,
                                 0.000000000000000,  0.000000000000000,  0.021633158331970,
                                 0.116394545366911,  0.000000000000000,  0.000000000000000,
                                -0.016278503843101, -0.040699449007654,  0.000000000000000,
                                 0.000000000000000,  0.034869115633149, -0.123361491557480,
                                 0.000000000000000,  0.000000000000000,  0.066991096858044,
                                 0.146872490616373,  0.000000000000000,  0.000000000000000,
                                -0.198482432868394, -0.063660887027818,  0.000000000000000,
                                -0.000000000000000,  0.021867988563272,  0.208299156113515,
                                 0.304297192567312,  0.266179376295925,  0.000000000000000,
                                -0.000000000000000, -0.064855468171459, -0.015860708550064,
                                -0.000000000000001, -0.000000000000000,  0.112632533019234,
                                 0.032131840043757,  0.000000000000000, -0.000000000000000,
                                 0.040833684222308, -0.021633158331970,  0.000000000000000,
                                -0.000000000000000,  0.022698288500661,  0.016278503843101,
                                 0.000000000000000, -0.000000000000000, -0.287259529284552,
                                -0.034869115633149, -0.000000000000000, -0.000000000000000,
                                -0.162290817537872, -0.066991096858044,  0.000000000000000,
                                -0.000000000000000,  0.231251219608137,  0.198482432868394,
                                 0.000000000000000,  0.000000000000000,  0.084868172683887,
                                -0.021867988563272, -0.000000000000000, -0.000000000000000,
                                 0.190776210819750,  0.255558771602326,  0.000000000000000,
                                 0.000000000000000, -0.002646833682865, -0.001306525668860,
                                 0.000000000000000,  0.000000000000000, -0.017349132296702,
                                -0.040978454131137,  0.000000000000000,  0.000000000000000,
                                -0.064416100092911, -0.116394545366910,  0.000000000000000,
                                 0.000000000000000,  0.024978813565834,  0.040699449007654,
                                 0.000000000000000,  0.000000000000000,  0.063155455573298,
                                 0.123361491557480,  0.000000000000000,  0.000000000000000,
                                -0.081519105341513, -0.146872490616373,  0.000000000000000,
                                 0.000000000000000,  0.083337407617736,  0.063660887027818,
                                -0.000000000000000,  0.000000000000000, -0.109997157713489,
                                -0.208299156113516,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.003630076021569,
                                -0.000388546125550,  0.000000000000000, -0.000000000000000,
                                 0.329367541961200,  0.193046952755571,  0.000000000000000,
                                -0.000000000000000,  0.177682005753488,  0.172900597216915,
                                 0.000000000000000, -0.000000000000000, -0.350890226607171,
                                -0.165204858591598,  0.000000000000000, -0.000000000000000,
                                 0.443314205528081,  0.124617589068450,  0.000000000000000,
                                -0.000000000000000,  0.129400669930938, -0.018959572766302,
                                 0.000000000000000, -0.000000000000000, -0.401444740003684,
                                -0.214207451590918,  0.000000000000000, -0.000000000000000,
                                -0.084868172683887,  0.109997157713489,  0.000000000000000,
                                -0.000000000000000,  0.099202407345287,  0.255043302516853,
                                 0.000000000000000,  0.000000000000000, -0.001246728054130,
                                -0.000368383007328,  0.000000000000000,  0.000000000000000,
                                 0.273916083198242,  0.257665039349259,  0.000000000000000,
                                 0.000000000000000,  0.189963329673229,  0.253908403770195,
                                 0.000000000000000,  0.000000000000000, -0.257832727903338,
                                -0.213731210904300,  0.000000000000000,  0.000000000000000,
                                 0.247196373387439,  0.147277321021618,  0.000000000000000,
                                 0.000000000000000,  0.014663129899406, -0.035259372180495,
                                 0.000000000000000,  0.000000000000000, -0.306943050396439,
                                -0.289693000256262,  0.000000000000000,  0.000000000000000,
                                 0.021867988563272,  0.208299156113516,  0.000000000000000,
                                 0.000000000000000,  0.192768415275717,  0.418713138364703,
                                 0.003630076021569,  0.001246728054130, -0.000000000000001,
                                -0.000000000000000, -0.329367541961199, -0.273916083198242,
                                 0.000000000000000, -0.000000000000000, -0.177682005753488,
                                -0.189963329673229,  0.000000000000000, -0.000000000000000,
                                 0.350890226607171,  0.257832727903338,  0.000000000000000,
                                -0.000000000000000, -0.443314205528081, -0.247196373387439,
                                 0.000000000000000,  0.000000000000000, -0.129400669930938,
                                -0.014663129899406,  0.000000000000000, -0.000000000000000,
                                 0.401444740003684,  0.306943050396439, -0.000000000000000,
                                -0.000000000000000,  0.084868172683888, -0.021867988563272,
                                 0.000000000000000, -0.000000000000000, -0.099202407345287,
                                -0.192768415275717,  0.000000000000000,  0.000000000000000,
                                 0.000388546125550,  0.000368383007327,  0.000000000000000,
                                 0.000000000000000, -0.193046952755571, -0.257665039349259,
                                 0.000000000000000,  0.000000000000000, -0.172900597216915,
                                -0.253908403770195,  0.000000000000000,  0.000000000000000,
                                 0.165204858591598,  0.213731210904300,  0.000000000000000,
                                 0.000000000000000, -0.124617589068450, -0.147277321021618,
                                 0.000000000000000,  0.000000000000000,  0.018959572766302,
                                 0.035259372180495,  0.000000000000000,  0.000000000000000,
                                 0.214207451590918,  0.289693000256262,  0.000000000000000,
                                 0.000000000000000, -0.109997157713489, -0.208299156113515,
                                 0.000000000000000,  0.000000000000000, -0.255043302516853,
                                -0.418713138364703, -0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomxmat, CDenseMatrix(intxvals, 36, 36));
 
    std::vector<double> intyvals{ 0.000000000000000, -0.000000000000000,  0.154026820023360,
                                 0.383072618175658, -0.000000000000000, -0.000000000000000,
                                -0.309537189074358, -0.191013283815059, -0.000000000000000,
                                -0.000000000000000,  0.280655943866065,  0.208378993125476,
                                -0.000000000000000, -0.000000000000000, -0.083019102050599,
                                -0.115778175609192, -0.000000000000000, -0.000000000000000,
                                 0.399056269390324,  0.118915693120619, -0.000000000000000,
                                -0.000000000000000, -0.169032468264508, -0.070807538321545,
                                -0.000000000000000, -0.000000000000000,  0.163975543640721,
                                -0.030332937376469, -0.000000000000000, -0.000000000000000,
                                -0.348851295293275, -0.049927176533726, -0.000000000000000,
                                -0.000000000000000, -0.005329515295384, -0.000571564179691,
                                 0.000000000000000,  0.000000000000000,  0.290837690756786,
                                 0.628545218131297,  0.000000000000000, -0.000000000000000,
                                -0.267293606914694, -0.255746949469109,  0.000000000000000,
                                -0.000000000000000,  0.255240637751978,  0.296923599639450,
                                 0.000000000000000, -0.000000000000000, -0.137725692309836,
                                -0.160283575855345,  0.000000000000000, -0.000000000000000,
                                 0.230879198419481,  0.141514426577693,  0.000000000000000,
                                -0.000000000000000, -0.114272969815404, -0.090871251567422,
                                 0.000000000000000, -0.000000000000000,  0.036644911950113,
                                -0.067614868258287,  0.000000000000000, -0.000000000000000,
                                -0.203162461957130, -0.005542523711894,  0.000000000000000,
                                -0.000000000000000, -0.001832757289853, -0.000542029930100,
                                -0.154026820023360, -0.290837690756786,  0.000000000000000,
                                -0.000000000000000,  0.309537189074358,  0.267293606914695,
                                -0.000000000000000, -0.000000000000000, -0.280655943866065,
                                -0.255240637751978,  0.000000000000000, -0.000000000000000,
                                 0.083019102050598,  0.137725692309836, -0.000000000000000,
                                -0.000000000000000, -0.399056269390324, -0.230879198419481,
                                 0.000000000000000,  0.000000000000000,  0.169032468264508,
                                 0.114272969815404, -0.000000000000000, -0.000000000000000,
                                -0.163975543640721, -0.036644911950113,  0.000000000000000,
                                -0.000000000000000,  0.348851295293275,  0.203162461957130,
                                -0.000000000000000, -0.000000000000000,  0.005329515295384,
                                 0.001832757289854, -0.000000000000001, -0.000000000000000,
                                -0.383072618175658, -0.628545218131297,  0.000000000000000,
                                 0.000000000000000,  0.191013283815059,  0.255746949469109,
                                 0.000000000000000, -0.000000000000000, -0.208378993125476,
                                -0.296923599639450,  0.000000000000000, -0.000000000000000,
                                 0.115778175609192,  0.160283575855345,  0.000000000000000,
                                -0.000000000000000, -0.118915693120619, -0.141514426577693,
                                 0.000000000000000, -0.000000000000000,  0.070807538321545,
                                 0.090871251567422,  0.000000000000000, -0.000000000000000,
                                 0.030332937376470,  0.067614868258287,  0.000000000000000,
                                -0.000000000000000,  0.049927176533725,  0.005542523711895,
                                 0.000000000000000, -0.000000000000000,  0.000571564179691,
                                 0.000542029930100, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.309537189074358,
                                -0.191013283815059,  0.000000000000000, -0.000000000000000,
                                -0.281096763812961, -0.121899029083393, -0.000000000000000,
                                -0.000000000000000,  0.263723342320351, -0.012302936665709,
                                -0.000000000000000, -0.000000000000000, -0.010684163382600,
                                 0.067981650734906, -0.000000000000000, -0.000000000000000,
                                 0.138593653953596, -0.029170314160157, -0.000000000000000,
                                -0.000000000000000, -0.009736926780168, -0.042766695858344,
                                -0.000000000000000, -0.000000000000000,  0.277022760049705,
                                 0.067965659103222, -0.000000000000000, -0.000000000000000,
                                -0.018578931931413, -0.000639529215620, -0.000000000000000,
                                -0.000000000000000,  0.300157502741393,  0.044930952358423,
                                 0.000000000000000,  0.000000000000000, -0.267293606914695,
                                -0.255746949469109,  0.000000000000000,  0.000000000000000,
                                -0.279959627834455, -0.093927567960174,  0.000000000000000,
                                -0.000000000000000,  0.068384832009855, -0.039571639952932,
                                 0.000000000000000, -0.000000000000000,  0.024501490592006,
                                 0.122920058735891,  0.000000000000000, -0.000000000000000,
                                 0.007736489394996, -0.050859212405087,  0.000000000000000,
                                -0.000000000000000, -0.020129455341430, -0.076488611496357,
                                 0.000000000000000, -0.000000000000000,  0.101418053085295,
                                 0.112547338202879,  0.000000000000000, -0.000000000000000,
                                -0.004072375832510, -0.000307241238895,  0.000000000000000,
                                -0.000000000000000,  0.186895531108790,  0.000829952427779,
                                 0.309537189074358,  0.267293606914694,  0.000000000000000,
                                -0.000000000000000,  0.281096763812961,  0.279959627834455,
                                 0.000000000000000, -0.000000000000000, -0.263723342320351,
                                -0.068384832009855, -0.000000000000000, -0.000000000000000,
                                 0.010684163382600, -0.024501490592006,  0.000000000000000,
                                -0.000000000000000, -0.138593653953596, -0.007736489394996,
                                -0.000000000000000, -0.000000000000000,  0.009736926780168,
                                 0.020129455341430, -0.000000000000000, -0.000000000000000,
                                -0.277022760049705, -0.101418053085294, -0.000000000000000,
                                -0.000000000000000,  0.018578931931413,  0.004072375832510,
                                -0.000000000000000, -0.000000000000000, -0.300157502741393,
                                -0.186895531108790, -0.000000000000000, -0.000000000000000,
                                 0.191013283815059,  0.255746949469109,  0.000000000000000,
                                 0.000000000000000,  0.121899029083393,  0.093927567960174,
                                 0.000000000000000,  0.000000000000000,  0.012302936665708,
                                 0.039571639952932,  0.000000000000000, -0.000000000000000,
                                -0.067981650734906, -0.122920058735891,  0.000000000000000,
                                -0.000000000000000,  0.029170314160157,  0.050859212405087,
                                 0.000000000000000, -0.000000000000000,  0.042766695858344,
                                 0.076488611496357,  0.000000000000000, -0.000000000000000,
                                -0.067965659103222, -0.112547338202879,  0.000000000000000,
                                -0.000000000000000,  0.000639529215620,  0.000307241238895,
                                -0.000000000000000, -0.000000000000000, -0.044930952358423,
                                -0.000829952427779,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.280655943866065,
                                 0.208378993125476,  0.000000000000000, -0.000000000000000,
                                 0.263723342320351, -0.012302936665708,  0.000000000000000,
                                -0.000000000000000, -0.253826750868108, -0.131584699693157,
                                -0.000000000000000, -0.000000000000000,  0.053619543272388,
                                -0.017077125040132, -0.000000000000000, -0.000000000000000,
                                 0.189033258040713,  0.041345900586478, -0.000000000000000,
                                -0.000000000000000, -0.106491569532025, -0.011015696374842,
                                -0.000000000000000, -0.000000000000000,  0.064227669766659,
                                 0.013062120370420, -0.000000000000000, -0.000000000000000,
                                -0.163173778761717, -0.063986212422043, -0.000000000000000,
                                -0.000000000000000, -0.209909649953597,  0.025040391405633,
                                 0.000000000000000,  0.000000000000000,  0.255240637751978,
                                 0.296923599639450,  0.000000000000000,  0.000000000000000,
                                 0.068384832009855, -0.039571639952932,  0.000000000000000,
                                 0.000000000000000, -0.238152345407807, -0.134347126761912,
                                 0.000000000000000, -0.000000000000000,  0.012245989862930,
                                -0.035401561010224,  0.000000000000000, -0.000000000000000,
                                 0.097454288843187,  0.036095523700437,  0.000000000000000,
                                -0.000000000000000, -0.070207227560110,  0.014838269227749,
                                 0.000000000000000, -0.000000000000000,  0.016961367396232,
                                 0.020592514140692,  0.000000000000000, -0.000000000000000,
                                -0.071841499465275, -0.111804313814818,  0.000000000000000,
                                -0.000000000000000, -0.052389117564953,  0.062332786013811,
                                -0.280655943866065, -0.255240637751978, -0.000000000000000,
                                -0.000000000000000, -0.263723342320351, -0.068384832009855,
                                 0.000000000000000, -0.000000000000000,  0.253826750868108,
                                 0.238152345407807,  0.000000000000000, -0.000000000000000,
                                -0.053619543272388, -0.012245989862930, -0.000000000000000,
                                -0.000000000000000, -0.189033258040713, -0.097454288843187,
                                 0.000000000000000, -0.000000000000000,  0.106491569532025,
                                 0.070207227560110, -0.000000000000000, -0.000000000000000,
                                -0.064227669766659, -0.016961367396232, -0.000000000000000,
                                -0.000000000000000,  0.163173778761717,  0.071841499465275,
                                -0.000000000000000, -0.000000000000000,  0.209909649953597,
                                 0.052389117564953, -0.000000000000000,  0.000000000000000,
                                -0.208378993125476, -0.296923599639450,  0.000000000000000,
                                 0.000000000000000,  0.012302936665709,  0.039571639952932,
                                 0.000000000000000,  0.000000000000000,  0.131584699693157,
                                 0.134347126761912,  0.000000000000000,  0.000000000000000,
                                 0.017077125040132,  0.035401561010224,  0.000000000000000,
                                -0.000000000000000, -0.041345900586478, -0.036095523700437,
                                 0.000000000000000, -0.000000000000000,  0.011015696374842,
                                -0.014838269227749,  0.000000000000000, -0.000000000000000,
                                -0.013062120370420, -0.020592514140692, -0.000000000000000,
                                -0.000000000000000,  0.063986212422043,  0.111804313814818,
                                 0.000000000000000, -0.000000000000000, -0.025040391405633,
                                -0.062332786013811, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.083019102050598,
                                -0.115778175609192,  0.000000000000000, -0.000000000000000,
                                -0.010684163382600,  0.067981650734906,  0.000000000000000,
                                -0.000000000000000,  0.053619543272388, -0.017077125040132,
                                 0.000000000000000, -0.000000000000000,  0.013063114096567,
                                -0.090811251763899, -0.000000000000000, -0.000000000000000,
                                 0.014411077440416, -0.014528095587845, -0.000000000000000,
                                -0.000000000000000,  0.078108936058709, -0.025575035914479,
                                -0.000000000000000, -0.000000000000000,  0.184957113114378,
                                 0.027755142848112, -0.000000000000000, -0.000000000000000,
                                 0.272048423481339,  0.022544391883176, -0.000000000000000,
                                -0.000000000000000,  0.357511993187504,  0.113156361935442,
                                 0.000000000000000,  0.000000000000000, -0.137725692309836,
                                -0.160283575855345,  0.000000000000000,  0.000000000000000,
                                 0.024501490592006,  0.122920058735891,  0.000000000000000,
                                 0.000000000000000,  0.012245989862930, -0.035401561010224,
                                 0.000000000000000,  0.000000000000000, -0.155748354201583,
                                -0.074164841703546,  0.000000000000000, -0.000000000000000,
                                -0.027420465307459, -0.008939379716839,  0.000000000000000,
                                -0.000000000000000, -0.016052165189794, -0.031235543098639,
                                 0.000000000000000, -0.000000000000000,  0.093669035054260,
                                 0.009866781384986,  0.000000000000000, -0.000000000000000,
                                 0.069771898054566,  0.030655314157951,  0.000000000000000,
                                -0.000000000000000,  0.210250900600096,  0.137733448049973,
                                 0.083019102050599,  0.137725692309836,  0.000000000000000,
                                -0.000000000000000,  0.010684163382600, -0.024501490592006,
                                -0.000000000000000, -0.000000000000000, -0.053619543272388,
                                -0.012245989862930,  0.000000000000000, -0.000000000000000,
                                -0.013063114096567,  0.155748354201583,  0.000000000000000,
                                -0.000000000000000, -0.014411077440416,  0.027420465307459,
                                -0.000000000000000, -0.000000000000000, -0.078108936058709,
                                 0.016052165189794, -0.000000000000000, -0.000000000000000,
                                -0.184957113114378, -0.093669035054260, -0.000000000000000,
                                -0.000000000000000, -0.272048423481339, -0.069771898054566,
                                 0.000000000000000,  0.000000000000000, -0.357511993187504,
                                -0.210250900600096, -0.000000000000000, -0.000000000000000,
                                 0.115778175609192,  0.160283575855345,  0.000000000000000,
                                 0.000000000000000, -0.067981650734906, -0.122920058735891,
                                 0.000000000000000,  0.000000000000000,  0.017077125040132,
                                 0.035401561010224,  0.000000000000000,  0.000000000000000,
                                 0.090811251763899,  0.074164841703546,  0.000000000000000,
                                 0.000000000000000,  0.014528095587845,  0.008939379716839,
                                 0.000000000000000, -0.000000000000000,  0.025575035914479,
                                 0.031235543098639, -0.000000000000000, -0.000000000000000,
                                -0.027755142848112, -0.009866781384986,  0.000000000000000,
                                -0.000000000000000, -0.022544391883176, -0.030655314157951,
                                -0.000000000000000, -0.000000000000000, -0.113156361935442,
                                -0.137733448049973,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.399056269390324,
                                 0.118915693120619,  0.000000000000000, -0.000000000000000,
                                 0.138593653953596, -0.029170314160157,  0.000000000000000,
                                -0.000000000000000,  0.189033258040713,  0.041345900586478,
                                 0.000000000000000, -0.000000000000000,  0.014411077440416,
                                -0.014528095587845,  0.000000000000000, -0.000000000000000,
                                -0.203037251099097, -0.062642377474218, -0.000000000000000,
                                -0.000000000000000,  0.013964458261972, -0.004638839241007,
                                -0.000000000000000, -0.000000000000000, -0.178591528787835,
                                -0.026285292750065, -0.000000000000000, -0.000000000000000,
                                 0.057750770079191, -0.062865591626993, -0.000000000000000,
                                -0.000000000000000, -0.025881028221192,  0.009872957708862,
                                 0.000000000000000,  0.000000000000000,  0.230879198419481,
                                 0.141514426577693,  0.000000000000000,  0.000000000000000,
                                 0.007736489394996, -0.050859212405087,  0.000000000000000,
                                 0.000000000000000,  0.097454288843187,  0.036095523700437,
                                 0.000000000000000,  0.000000000000000, -0.027420465307459,
                                -0.008939379716839,  0.000000000000000,  0.000000000000000,
                                -0.152358804559392, -0.043218518184414,  0.000000000000000,
                                -0.000000000000000,  0.002223192220894, -0.008810119043436,
                                 0.000000000000000, -0.000000000000000, -0.108956252378105,
                                 0.001743299035187,  0.000000000000000, -0.000000000000000,
                                -0.022358817289708, -0.104747823915071,  0.000000000000000,
                                -0.000000000000000,  0.006844682722198,  0.014151169961243,
                                -0.399056269390324, -0.230879198419481, -0.000000000000000,
                                -0.000000000000000, -0.138593653953596, -0.007736489394996,
                                 0.000000000000000, -0.000000000000000, -0.189033258040713,
                                -0.097454288843187, -0.000000000000000, -0.000000000000000,
                                -0.014411077440416,  0.027420465307459,  0.000000000000000,
                                -0.000000000000000,  0.203037251099097,  0.152358804559392,
                                 0.000000000000000, -0.000000000000000, -0.013964458261972,
                                -0.002223192220894, -0.000000000000000, -0.000000000000000,
                                 0.178591528787835,  0.108956252378105, -0.000000000000000,
                                -0.000000000000000, -0.057750770079191,  0.022358817289708,
                                -0.000000000000000, -0.000000000000000,  0.025881028221192,
                                -0.006844682722197, -0.000000000000000, -0.000000000000000,
                                -0.118915693120619, -0.141514426577693, -0.000000000000000,
                                 0.000000000000000,  0.029170314160157,  0.050859212405087,
                                 0.000000000000000,  0.000000000000000, -0.041345900586478,
                                -0.036095523700437,  0.000000000000000,  0.000000000000000,
                                 0.014528095587845,  0.008939379716839,  0.000000000000000,
                                 0.000000000000000,  0.062642377474218,  0.043218518184414,
                                 0.000000000000000,  0.000000000000000,  0.004638839241007,
                                 0.008810119043436,  0.000000000000000, -0.000000000000000,
                                 0.026285292750065, -0.001743299035187,  0.000000000000000,
                                -0.000000000000000,  0.062865591626993,  0.104747823915071,
                                 0.000000000000000, -0.000000000000000, -0.009872957708862,
                                -0.014151169961243,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.169032468264508,
                                -0.070807538321545,  0.000000000000000, -0.000000000000000,
                                -0.009736926780168, -0.042766695858344,  0.000000000000000,
                                -0.000000000000000, -0.106491569532025, -0.011015696374842,
                                 0.000000000000000, -0.000000000000000,  0.078108936058709,
                                -0.025575035914479,  0.000000000000000, -0.000000000000000,
                                 0.013964458261972, -0.004638839241007,  0.000000000000000,
                                -0.000000000000000,  0.023155876819279, -0.031619106690814,
                                -0.000000000000000, -0.000000000000000, -0.042002924977437,
                                -0.004009990711062, -0.000000000000000, -0.000000000000000,
                                -0.040833684222308,  0.064416100092911, -0.000000000000000,
                                -0.000000000000000, -0.350890226607171, -0.165204858591598,
                                 0.000000000000000,  0.000000000000000, -0.114272969815404,
                                -0.090871251567422,  0.000000000000000,  0.000000000000000,
                                -0.020129455341430, -0.076488611496357,  0.000000000000000,
                                 0.000000000000000, -0.070207227560110,  0.014838269227749,
                                 0.000000000000000,  0.000000000000000, -0.016052165189794,
                                -0.031235543098639,  0.000000000000000,  0.000000000000000,
                                 0.002223192220894, -0.008810119043436,  0.000000000000000,
                                 0.000000000000000, -0.047276473020110, -0.028410230692311,
                                 0.000000000000000, -0.000000000000000, -0.011901793029321,
                                -0.004147666746587,  0.000000000000000, -0.000000000000000,
                                 0.021633158331970,  0.116394545366910,  0.000000000000000,
                                -0.000000000000000, -0.257832727903338, -0.213731210904300,
                                 0.169032468264508,  0.114272969815404,  0.000000000000000,
                                -0.000000000000000,  0.009736926780168,  0.020129455341430,
                                 0.000000000000000, -0.000000000000000,  0.106491569532025,
                                 0.070207227560110,  0.000000000000000, -0.000000000000000,
                                -0.078108936058709,  0.016052165189794,  0.000000000000000,
                                 0.000000000000000, -0.013964458261972, -0.002223192220894,
                                 0.000000000000000, -0.000000000000000, -0.023155876819279,
                                 0.047276473020110,  0.000000000000000, -0.000000000000000,
                                 0.042002924977437,  0.011901793029321, -0.000000000000000,
                                -0.000000000000000,  0.040833684222308, -0.021633158331970,
                                -0.000000000000000, -0.000000000000000,  0.350890226607171,
                                 0.257832727903338, -0.000000000000000, -0.000000000000000,
                                 0.070807538321545,  0.090871251567422,  0.000000000000000,
                                 0.000000000000000,  0.042766695858344,  0.076488611496357,
                                 0.000000000000000,  0.000000000000000,  0.011015696374842,
                                -0.014838269227749,  0.000000000000000,  0.000000000000000,
                                 0.025575035914479,  0.031235543098639,  0.000000000000000,
                                 0.000000000000000,  0.004638839241007,  0.008810119043436,
                                 0.000000000000000,  0.000000000000000,  0.031619106690814,
                                 0.028410230692311,  0.000000000000000,  0.000000000000000,
                                 0.004009990711062,  0.004147666746587,  0.000000000000000,
                                -0.000000000000000, -0.064416100092911, -0.116394545366910,
                                 0.000000000000000, -0.000000000000000,  0.165204858591598,
                                 0.213731210904300,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.163975543640721,
                                -0.030332937376470,  0.000000000000000, -0.000000000000000,
                                 0.277022760049705,  0.067965659103222,  0.000000000000000,
                                -0.000000000000000,  0.064227669766659,  0.013062120370420,
                                 0.000000000000000, -0.000000000000000,  0.184957113114378,
                                 0.027755142848112,  0.000000000000000, -0.000000000000000,
                                -0.178591528787835, -0.026285292750065,  0.000000000000000,
                                -0.000000000000000, -0.042002924977437, -0.004009990711062,
                                 0.000000000000000, -0.000000000000000, -0.299447133966276,
                                -0.133550940858659, -0.000000000000000, -0.000000000000000,
                                 0.097991890753537, -0.017766060739254, -0.000000000000000,
                                -0.000000000000000,  0.144125766939988,  0.188212592041246,
                                 0.000000000000000,  0.000000000000000,  0.036644911950113,
                                -0.067614868258287,  0.000000000000000,  0.000000000000000,
                                 0.101418053085294,  0.112547338202879,  0.000000000000000,
                                 0.000000000000000,  0.016961367396232,  0.020592514140692,
                                 0.000000000000000,  0.000000000000000,  0.093669035054260,
                                 0.009866781384986,  0.000000000000000,  0.000000000000000,
                                -0.108956252378105,  0.001743299035187,  0.000000000000000,
                                 0.000000000000000, -0.011901793029321, -0.004147666746587,
                                 0.000000000000000,  0.000000000000000, -0.250725489271401,
                                -0.134025928955255,  0.000000000000000, -0.000000000000000,
                                 0.029538255126811, -0.041243766626670,  0.000000000000000,
                                -0.000000000000000,  0.200644835617403,  0.276091307994687,
                                -0.163975543640721, -0.036644911950113, -0.000000000000000,
                                -0.000000000000000, -0.277022760049705, -0.101418053085295,
                                 0.000000000000000, -0.000000000000000, -0.064227669766659,
                                -0.016961367396232,  0.000000000000000,  0.000000000000000,
                                -0.184957113114378, -0.093669035054260,  0.000000000000000,
                                -0.000000000000000,  0.178591528787835,  0.108956252378105,
                                 0.000000000000000, -0.000000000000000,  0.042002924977437,
                                 0.011901793029321,  0.000000000000000, -0.000000000000000,
                                 0.299447133966276,  0.250725489271401,  0.000000000000000,
                                -0.000000000000000, -0.097991890753537, -0.029538255126811,
                                -0.000000000000000, -0.000000000000000, -0.144125766939988,
                                -0.200644835617403, -0.000000000000000, -0.000000000000000,
                                 0.030332937376469,  0.067614868258287,  0.000000000000000,
                                 0.000000000000000, -0.067965659103222, -0.112547338202879,
                                 0.000000000000000,  0.000000000000000, -0.013062120370420,
                                -0.020592514140692,  0.000000000000000,  0.000000000000000,
                                -0.027755142848112, -0.009866781384986,  0.000000000000000,
                                 0.000000000000000,  0.026285292750065, -0.001743299035187,
                                 0.000000000000000,  0.000000000000000,  0.004009990711062,
                                 0.004147666746587,  0.000000000000000,  0.000000000000000,
                                 0.133550940858659,  0.134025928955255,  0.000000000000000,
                                 0.000000000000000,  0.017766060739254,  0.041243766626670,
                                 0.000000000000000, -0.000000000000000, -0.188212592041246,
                                -0.276091307994687,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.348851295293275,
                                -0.049927176533725,  0.000000000000000, -0.000000000000000,
                                -0.018578931931413, -0.000639529215620,  0.000000000000000,
                                -0.000000000000000, -0.163173778761717, -0.063986212422043,
                                 0.000000000000000, -0.000000000000000,  0.272048423481339,
                                 0.022544391883176,  0.000000000000000, -0.000000000000000,
                                 0.057750770079191, -0.062865591626993,  0.000000000000000,
                                -0.000000000000000, -0.040833684222308,  0.064416100092911,
                                 0.000000000000000, -0.000000000000000,  0.097991890753537,
                                -0.017766060739254,  0.000000000000000, -0.000000000000000,
                                -0.394018769023096, -0.126881736794983, -0.000000000000000,
                                -0.000000000000000, -0.324127545454153, -0.192809879760263,
                                 0.000000000000000,  0.000000000000000, -0.203162461957130,
                                -0.005542523711895,  0.000000000000000,  0.000000000000000,
                                -0.004072375832510, -0.000307241238895,  0.000000000000000,
                                 0.000000000000000, -0.071841499465275, -0.111804313814818,
                                 0.000000000000000,  0.000000000000000,  0.069771898054566,
                                 0.030655314157951,  0.000000000000000,  0.000000000000000,
                                -0.022358817289708, -0.104747823915071,  0.000000000000000,
                                 0.000000000000000,  0.021633158331970,  0.116394545366910,
                                 0.000000000000000,  0.000000000000000,  0.029538255126811,
                                -0.041243766626670,  0.000000000000000,  0.000000000000000,
                                -0.309060714269911, -0.096413738712012,  0.000000000000000,
                                -0.000000000000000, -0.272801852579473, -0.257476861482476,
                                 0.348851295293275,  0.203162461957130,  0.000000000000000,
                                -0.000000000000000,  0.018578931931413,  0.004072375832510,
                                 0.000000000000000,  0.000000000000000,  0.163173778761717,
                                 0.071841499465275,  0.000000000000000, -0.000000000000000,
                                -0.272048423481339, -0.069771898054566, -0.000000000000000,
                                 0.000000000000000, -0.057750770079191,  0.022358817289708,
                                 0.000000000000000, -0.000000000000000,  0.040833684222308,
                                -0.021633158331970,  0.000000000000000, -0.000000000000000,
                                -0.097991890753537, -0.029538255126811,  0.000000000000000,
                                -0.000000000000000,  0.394018769023096,  0.309060714269911,
                                 0.000000000000000, -0.000000000000000,  0.324127545454153,
                                 0.272801852579473, -0.000000000000000, -0.000000000000000,
                                 0.049927176533726,  0.005542523711894,  0.000000000000000,
                                 0.000000000000000,  0.000639529215620,  0.000307241238895,
                                 0.000000000000000,  0.000000000000000,  0.063986212422043,
                                 0.111804313814818,  0.000000000000000,  0.000000000000000,
                                -0.022544391883176, -0.030655314157951, -0.000000000000000,
                                 0.000000000000000,  0.062865591626993,  0.104747823915071,
                                 0.000000000000000,  0.000000000000000, -0.064416100092911,
                                -0.116394545366910,  0.000000000000000,  0.000000000000000,
                                 0.017766060739254,  0.041243766626670,  0.000000000000000,
                                 0.000000000000000,  0.126881736794983,  0.096413738712012,
                                 0.000000000000000,  0.000000000000000,  0.192809879760263,
                                 0.257476861482476,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.005329515295384,
                                -0.000571564179691,  0.000000000000000, -0.000000000000000,
                                 0.300157502741393,  0.044930952358423,  0.000000000000000,
                                -0.000000000000000, -0.209909649953597,  0.025040391405633,
                                 0.000000000000000, -0.000000000000000,  0.357511993187504,
                                 0.113156361935442,  0.000000000000000, -0.000000000000000,
                                -0.025881028221192,  0.009872957708862,  0.000000000000000,
                                -0.000000000000000, -0.350890226607171, -0.165204858591598,
                                 0.000000000000000, -0.000000000000000,  0.144125766939988,
                                 0.188212592041246,  0.000000000000000, -0.000000000000000,
                                -0.324127545454153, -0.192809879760263,  0.000000000000000,
                                -0.000000000000000,  0.162617418247386,  0.383909903761004,
                                 0.000000000000000,  0.000000000000000, -0.001832757289854,
                                -0.000542029930100,  0.000000000000000,  0.000000000000000,
                                 0.186895531108790,  0.000829952427779,  0.000000000000000,
                                 0.000000000000000, -0.052389117564953,  0.062332786013811,
                                 0.000000000000000,  0.000000000000000,  0.210250900600096,
                                 0.137733448049973,  0.000000000000000,  0.000000000000000,
                                 0.006844682722197,  0.014151169961243,  0.000000000000000,
                                 0.000000000000000, -0.257832727903338, -0.213731210904300,
                                 0.000000000000000,  0.000000000000000,  0.200644835617403,
                                 0.276091307994687,  0.000000000000000,  0.000000000000000,
                                -0.272801852579473, -0.257476861482476,  0.000000000000000,
                                 0.000000000000000,  0.293614052372593,  0.629329762903792,
                                 0.005329515295384,  0.001832757289853,  0.000000000000001,
                                 0.000000000000000, -0.300157502741393, -0.186895531108790,
                                 0.000000000000000, -0.000000000000000,  0.209909649953597,
                                 0.052389117564953,  0.000000000000000,  0.000000000000000,
                                -0.357511993187504, -0.210250900600096,  0.000000000000000,
                                -0.000000000000000,  0.025881028221192, -0.006844682722198,
                                 0.000000000000000, -0.000000000000000,  0.350890226607171,
                                 0.257832727903338,  0.000000000000000, -0.000000000000000,
                                -0.144125766939988, -0.200644835617403,  0.000000000000000,
                                -0.000000000000000,  0.324127545454153,  0.272801852579473,
                                 0.000000000000000, -0.000000000000000, -0.162617418247386,
                                -0.293614052372593,  0.000000000000000, -0.000000000000000,
                                 0.000571564179691,  0.000542029930100,  0.000000000000000,
                                 0.000000000000000, -0.044930952358423, -0.000829952427779,
                                 0.000000000000000,  0.000000000000000, -0.025040391405633,
                                -0.062332786013811, -0.000000000000000,  0.000000000000000,
                                -0.113156361935442, -0.137733448049973,  0.000000000000000,
                                 0.000000000000000, -0.009872957708862, -0.014151169961243,
                                 0.000000000000000,  0.000000000000000,  0.165204858591598,
                                 0.213731210904300,  0.000000000000000,  0.000000000000000,
                                -0.188212592041246, -0.276091307994687,  0.000000000000000,
                                 0.000000000000000,  0.192809879760263,  0.257476861482476,
                                 0.000000000000000,  0.000000000000000, -0.383909903761004,
                                -0.629329762903792,  0.000000000000000,  0.000000000000000};
 
    ASSERT_EQ(lmomymat, CDenseMatrix(intyvals, 36, 36));
    
    std::vector<double> intzvals{ 0.000000000000000, -0.000000000000000, -0.136096126301352,
                                 0.023005780351949, -0.000000000000000, -0.000000000000000,
                                -0.083935248724248, -0.029400073556522, -0.000000000000000,
                                -0.000000000000000, -0.066007505284347,  0.004067296448449,
                                -0.000000000000000, -0.000000000000000,  0.092741119050295,
                                -0.007149664136029, -0.000000000000000, -0.000000000000000,
                                -0.057504517442095,  0.001494372349711, -0.000000000000000,
                                -0.000000000000000, -0.049348748095369,  0.001548596467477,
                                -0.000000000000000, -0.000000000000000,  0.122709398369009,
                                -0.010778402448764, -0.000000000000000, -0.000000000000000,
                                -0.116376801074970, -0.043923671225316, -0.000000000000000,
                                -0.000000000000000,  0.001852618531763,  0.000083817961309,
                                 0.000000000000000,  0.000000000000000, -0.058339453954522,
                                 0.073352553914521,  0.000000000000000, -0.000000000000000,
                                -0.070099091222471, -0.022464979954151,  0.000000000000000,
                                -0.000000000000000, -0.016679099126823,  0.011674693488572,
                                 0.000000000000000, -0.000000000000000,  0.017551253938562,
                                -0.016204517676063,  0.000000000000000, -0.000000000000000,
                                -0.008561931715365,  0.003622203828694,  0.000000000000000,
                                -0.000000000000000, -0.008252492653703,  0.004105692408620,
                                 0.000000000000000, -0.000000000000000,  0.033704068733351,
                                -0.028666363140755,  0.000000000000000, -0.000000000000000,
                                -0.103661856144219, -0.033625477641283,  0.000000000000000,
                                -0.000000000000000,  0.000393940013169,  0.000066530922836,
                                 0.136096126301352,  0.058339453954522,  0.000000000000000,
                                -0.000000000000000,  0.083935248724248,  0.070099091222471,
                                 0.000000000000000,  0.000000000000000,  0.066007505284347,
                                 0.016679099126823, -0.000000000000000, -0.000000000000000,
                                -0.092741119050295, -0.017551253938562, -0.000000000000000,
                                 0.000000000000000,  0.057504517442095,  0.008561931715365,
                                -0.000000000000000, -0.000000000000000,  0.049348748095369,
                                 0.008252492653703, -0.000000000000000, -0.000000000000000,
                                -0.122709398369009, -0.033704068733351, -0.000000000000000,
                                -0.000000000000000,  0.116376801074970,  0.103661856144219,
                                 0.000000000000000, -0.000000000000000, -0.001852618531763,
                                -0.000393940013169, -0.000000000000000, -0.000000000000000,
                                -0.023005780351949, -0.073352553914521,  0.000000000000000,
                                 0.000000000000000,  0.029400073556522,  0.022464979954151,
                                 0.000000000000000, -0.000000000000000, -0.004067296448449,
                                -0.011674693488572,  0.000000000000000, -0.000000000000000,
                                 0.007149664136029,  0.016204517676063,  0.000000000000000,
                                -0.000000000000000, -0.001494372349711, -0.003622203828694,
                                 0.000000000000000, -0.000000000000000, -0.001548596467477,
                                -0.004105692408620,  0.000000000000000, -0.000000000000000,
                                 0.010778402448764,  0.028666363140755,  0.000000000000000,
                                -0.000000000000000,  0.043923671225316,  0.033625477641283,
                                 0.000000000000000, -0.000000000000000, -0.000083817961309,
                                -0.000066530922836,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.083935248724248,
                                -0.029400073556522,  0.000000000000000, -0.000000000000000,
                                -0.000422551709814,  0.122490102204896, -0.000000000000000,
                                -0.000000000000000, -0.207968936269462, -0.167310695501857,
                                -0.000000000000000, -0.000000000000000, -0.199283576067266,
                                -0.076282535318958, -0.000000000000000, -0.000000000000000,
                                -0.062588393438753, -0.017318983147248, -0.000000000000000,
                                -0.000000000000000,  0.390865879856073,  0.159083150169926,
                                -0.000000000000000, -0.000000000000000, -0.295678525486407,
                                -0.247333446186212, -0.000000000000000, -0.000000000000000,
                                 0.000218073452978,  0.000698680167878, -0.000000000000000,
                                -0.000000000000000,  0.122312584601403,  0.044033612065375,
                                 0.000000000000000,  0.000000000000000, -0.070099091222471,
                                -0.022464979954151,  0.000000000000000,  0.000000000000000,
                                 0.008509514652159,  0.260524992364179,  0.000000000000000,
                                -0.000000000000000, -0.220547068069124, -0.221118802059071,
                                 0.000000000000000, -0.000000000000000, -0.138351012065544,
                                -0.092358983021088,  0.000000000000000, -0.000000000000000,
                                -0.038736468665832, -0.018593011109103,  0.000000000000000,
                                -0.000000000000000,  0.278754989305717,  0.195188616960638,
                                 0.000000000000000, -0.000000000000000, -0.320732580658678,
                                -0.328153443636237,  0.000000000000000, -0.000000000000000,
                                 0.001504480898443,  0.000738744831000,  0.000000000000000,
                                -0.000000000000000,  0.104588282935190,  0.033670336702622,
                                 0.083935248724248,  0.070099091222471, -0.000000000000000,
                                -0.000000000000000,  0.000422551709814, -0.008509514652159,
                                 0.000000000000000, -0.000000000000000,  0.207968936269462,
                                 0.220547068069124,  0.000000000000000,  0.000000000000000,
                                 0.199283576067266,  0.138351012065544, -0.000000000000000,
                                -0.000000000000000,  0.062588393438753,  0.038736468665832,
                                -0.000000000000000, -0.000000000000000, -0.390865879856073,
                                -0.278754989305717, -0.000000000000000, -0.000000000000000,
                                 0.295678525486408,  0.320732580658678,  0.000000000000000,
                                -0.000000000000000, -0.000218073452978, -0.001504480898443,
                                -0.000000000000000, -0.000000000000000, -0.122312584601403,
                                -0.104588282935190,  0.000000000000000, -0.000000000000000,
                                 0.029400073556522,  0.022464979954151, -0.000000000000000,
                                 0.000000000000000, -0.122490102204896, -0.260524992364179,
                                 0.000000000000000,  0.000000000000000,  0.167310695501856,
                                 0.221118802059071,  0.000000000000000, -0.000000000000000,
                                 0.076282535318958,  0.092358983021088,  0.000000000000000,
                                -0.000000000000000,  0.017318983147248,  0.018593011109103,
                                 0.000000000000000, -0.000000000000000, -0.159083150169926,
                                -0.195188616960638,  0.000000000000000, -0.000000000000000,
                                 0.247333446186212,  0.328153443636237,  0.000000000000000,
                                -0.000000000000000, -0.000698680167878, -0.000738744831000,
                                 0.000000000000000, -0.000000000000000, -0.044033612065375,
                                -0.033670336702622,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.066007505284347,
                                 0.004067296448449,  0.000000000000000, -0.000000000000000,
                                -0.207968936269462, -0.167310695501856,  0.000000000000000,
                                -0.000000000000000, -0.095271989196245,  0.107100476272857,
                                -0.000000000000000, -0.000000000000000, -0.097891984247525,
                                -0.115345772444228, -0.000000000000000, -0.000000000000000,
                                -0.230561360745992,  0.111724026193542, -0.000000000000000,
                                -0.000000000000000, -0.005050654303224, -0.183488541504174,
                                -0.000000000000000, -0.000000000000000,  0.052230851430148,
                                -0.003786191083407, -0.000000000000000, -0.000000000000000,
                                 0.342616219756544,  0.257810066711544, -0.000000000000000,
                                -0.000000000000000, -0.133061895796010,  0.010483589519766,
                                 0.000000000000000,  0.000000000000000, -0.016679099126823,
                                 0.011674693488572,  0.000000000000000,  0.000000000000000,
                                -0.220547068069124, -0.221118802059071,  0.000000000000000,
                                 0.000000000000000, -0.058657629894771,  0.271531776308908,
                                 0.000000000000000, -0.000000000000000, -0.118146800329066,
                                -0.166484558235376,  0.000000000000000, -0.000000000000000,
                                 0.023892877760436,  0.186859600322848,  0.000000000000000,
                                -0.000000000000000, -0.162594520583426, -0.267158814486036,
                                 0.000000000000000, -0.000000000000000,  0.008664053117716,
                                -0.007482575682416,  0.000000000000000, -0.000000000000000,
                                 0.349827019318919,  0.338319054230750,  0.000000000000000,
                                -0.000000000000000, -0.035538010215707,  0.028478758876030,
                                 0.066007505284347,  0.016679099126823,  0.000000000000000,
                                -0.000000000000000,  0.207968936269462,  0.220547068069124,
                                -0.000000000000000, -0.000000000000000,  0.095271989196245,
                                 0.058657629894771,  0.000000000000000, -0.000000000000000,
                                 0.097891984247525,  0.118146800329066,  0.000000000000000,
                                 0.000000000000000,  0.230561360745992, -0.023892877760436,
                                -0.000000000000000, -0.000000000000000,  0.005050654303224,
                                 0.162594520583426,  0.000000000000001, -0.000000000000000,
                                -0.052230851430148, -0.008664053117716, -0.000000000000000,
                                -0.000000000000000, -0.342616219756544, -0.349827019318919,
                                 0.000000000000000, -0.000000000000000,  0.133061895796010,
                                 0.035538010215707, -0.000000000000000, -0.000000000000000,
                                -0.004067296448449, -0.011674693488572,  0.000000000000000,
                                 0.000000000000000,  0.167310695501857,  0.221118802059071,
                                -0.000000000000000,  0.000000000000000, -0.107100476272857,
                                -0.271531776308908,  0.000000000000000,  0.000000000000000,
                                 0.115345772444228,  0.166484558235376,  0.000000000000000,
                                -0.000000000000000, -0.111724026193542, -0.186859600322848,
                                 0.000000000000000, -0.000000000000000,  0.183488541504174,
                                 0.267158814486035,  0.000000000000000, -0.000000000000000,
                                 0.003786191083407,  0.007482575682416,  0.000000000000000,
                                -0.000000000000000, -0.257810066711544, -0.338319054230750,
                                 0.000000000000000, -0.000000000000000, -0.010483589519766,
                                -0.028478758876030,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.092741119050295,
                                -0.007149664136029,  0.000000000000000, -0.000000000000000,
                                -0.199283576067266, -0.076282535318958,  0.000000000000000,
                                -0.000000000000000, -0.097891984247525, -0.115345772444228,
                                 0.000000000000000, -0.000000000000000, -0.572684191352688,
                                -0.128187242102766, -0.000000000000000, -0.000000000000000,
                                 0.167020361684731, -0.069080694416547, -0.000000000000000,
                                -0.000000000000000,  0.068802063110635, -0.059401825330953,
                                -0.000000000000000, -0.000000000000000, -0.037485542317195,
                                 0.186629506355524, -0.000000000000000, -0.000000000000000,
                                -0.264177904920759, -0.124307882640111, -0.000000000000000,
                                -0.000000000000000, -0.010659465317641, -0.001260612518809,
                                 0.000000000000000,  0.000000000000000,  0.017551253938562,
                                -0.016204517676063,  0.000000000000000,  0.000000000000000,
                                -0.138351012065544, -0.092358983021088,  0.000000000000000,
                                 0.000000000000000, -0.118146800329066, -0.166484558235376,
                                 0.000000000000000,  0.000000000000000, -0.434345174583584,
                                -0.017722682475710,  0.000000000000000, -0.000000000000000,
                                -0.001315568338678, -0.116706680865727,  0.000000000000000,
                                -0.000000000000000,  0.007760502839718, -0.111756624047078,
                                 0.000000000000000, -0.000000000000000,  0.158206816610374,
                                 0.272388407625927,  0.000000000000000, -0.000000000000000,
                                -0.201526815897616, -0.156822033931692,  0.000000000000000,
                                -0.000000000000000, -0.001014108595884, -0.002307117376965,
                                -0.092741119050295, -0.017551253938562,  0.000000000000000,
                                -0.000000000000000,  0.199283576067266,  0.138351012065544,
                                 0.000000000000000, -0.000000000000000,  0.097891984247525,
                                 0.118146800329066, -0.000000000000000, -0.000000000000000,
                                 0.572684191352688,  0.434345174583584,  0.000000000000000,
                                -0.000000000000000, -0.167020361684733,  0.001315568338678,
                                 0.000000000000001, -0.000000000000000, -0.068802063110635,
                                -0.007760502839718, -0.000000000000000, -0.000000000000000,
                                 0.037485542317195, -0.158206816610374,  0.000000000000001,
                                -0.000000000000000,  0.264177904920759,  0.201526815897616,
                                -0.000000000000000, -0.000000000000000,  0.010659465317641,
                                 0.001014108595884, -0.000000000000000, -0.000000000000000,
                                 0.007149664136029,  0.016204517676063, -0.000000000000000,
                                 0.000000000000000,  0.076282535318958,  0.092358983021088,
                                 0.000000000000000,  0.000000000000000,  0.115345772444228,
                                 0.166484558235376, -0.000000000000000,  0.000000000000000,
                                 0.128187242102766,  0.017722682475710,  0.000000000000000,
                                 0.000000000000000,  0.069080694416547,  0.116706680865727,
                                 0.000000000000000, -0.000000000000000,  0.059401825330953,
                                 0.111756624047078,  0.000000000000000, -0.000000000000000,
                                -0.186629506355524, -0.272388407625927,  0.000000000000000,
                                -0.000000000000000,  0.124307882640111,  0.156822033931692,
                                 0.000000000000000, -0.000000000000000,  0.001260612518809,
                                 0.002307117376965,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.057504517442095,
                                 0.001494372349711,  0.000000000000000, -0.000000000000000,
                                -0.062588393438753, -0.017318983147248,  0.000000000000000,
                                -0.000000000000000, -0.230561360745992,  0.111724026193542,
                                 0.000000000000000, -0.000000000000000,  0.167020361684733,
                                -0.069080694416547,  0.000000000000000, -0.000000000000000,
                                -0.413569787045341, -0.162720209844354, -0.000000000000000,
                                -0.000000000000000,  0.111346907789822, -0.046053796277698,
                                -0.000000000000000, -0.000000000000000,  0.096067233644163,
                                -0.046551677580642, -0.000000000000000, -0.000000000000000,
                                 0.319896233131405,  0.088519247197046, -0.000000000000000,
                                -0.000000000000000, -0.057025313130078,  0.001481919246796,
                                 0.000000000000000,  0.000000000000000, -0.008561931715365,
                                 0.003622203828694,  0.000000000000000,  0.000000000000000,
                                -0.038736468665832, -0.018593011109103,  0.000000000000000,
                                 0.000000000000000,  0.023892877760436,  0.186859600322848,
                                 0.000000000000000,  0.000000000000000, -0.001315568338678,
                                -0.116706680865727,  0.000000000000000,  0.000000000000000,
                                -0.473837778055131, -0.052191423649961,  0.000000000000000,
                                -0.000000000000000, -0.000877045559119, -0.077804453910485,
                                 0.000000000000000, -0.000000000000000, -0.009955365733515,
                                -0.077858166801187,  0.000000000000000, -0.000000000000000,
                                 0.197986395403143,  0.095030945668746,  0.000000000000000,
                                -0.000000000000000, -0.008490582284404,  0.003592018796788,
                                 0.057504517442095,  0.008561931715365,  0.000000000000000,
                                -0.000000000000000,  0.062588393438753,  0.038736468665832,
                                 0.000000000000000, -0.000000000000000,  0.230561360745992,
                                -0.023892877760436,  0.000000000000000, -0.000000000000000,
                                -0.167020361684731,  0.001315568338678, -0.000000000000001,
                                -0.000000000000000,  0.413569787045341,  0.473837778055131,
                                 0.000000000000000, -0.000000000000000, -0.111346907789821,
                                 0.000877045559119, -0.000000000000000, -0.000000000000000,
                                -0.096067233644164,  0.009955365733515, -0.000000000000000,
                                -0.000000000000000, -0.319896233131405, -0.197986395403143,
                                -0.000000000000000, -0.000000000000000,  0.057025313130078,
                                 0.008490582284404, -0.000000000000000, -0.000000000000000,
                                -0.001494372349711, -0.003622203828694,  0.000000000000000,
                                 0.000000000000000,  0.017318983147248,  0.018593011109103,
                                 0.000000000000000,  0.000000000000000, -0.111724026193542,
                                -0.186859600322848,  0.000000000000000,  0.000000000000000,
                                 0.069080694416547,  0.116706680865727,  0.000000000000000,
                                 0.000000000000000,  0.162720209844354,  0.052191423649961,
                                 0.000000000000000,  0.000000000000000,  0.046053796277698,
                                 0.077804453910485, -0.000000000000000, -0.000000000000000,
                                 0.046551677580642,  0.077858166801187,  0.000000000000000,
                                -0.000000000000000, -0.088519247197046, -0.095030945668746,
                                 0.000000000000000, -0.000000000000000, -0.001481919246796,
                                -0.003592018796788,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.049348748095369,
                                 0.001548596467477,  0.000000000000000, -0.000000000000000,
                                 0.390865879856073,  0.159083150169926,  0.000000000000000,
                                -0.000000000000000, -0.005050654303224, -0.183488541504174,
                                 0.000000000000000, -0.000000000000000,  0.068802063110635,
                                -0.059401825330953,  0.000000000000000, -0.000000000000000,
                                 0.111346907789821, -0.046053796277698,  0.000000000000000,
                                -0.000000000000000, -0.630019243944883, -0.078685720993638,
                                -0.000000000000000, -0.000000000000000,  0.119515242923505,
                                -0.131399592795571, -0.000000000000000, -0.000000000000000,
                                -0.073651334256414, -0.041797061685225, -0.000000000000000,
                                -0.000000000000000,  0.105004104035868, -0.007208515127214,
                                 0.000000000000000,  0.000000000000000, -0.008252492653703,
                                 0.004105692408620,  0.000000000000000,  0.000000000000000,
                                 0.278754989305717,  0.195188616960638,  0.000000000000000,
                                 0.000000000000000, -0.162594520583426, -0.267158814486035,
                                 0.000000000000000,  0.000000000000000,  0.007760502839718,
                                -0.111756624047078,  0.000000000000000,  0.000000000000000,
                                -0.000877045559119, -0.077804453910485,  0.000000000000000,
                                 0.000000000000000, -0.440812260283349,  0.075407837563521,
                                 0.000000000000000, -0.000000000000000, -0.095720757800134,
                                -0.193213589839266,  0.000000000000000, -0.000000000000000,
                                -0.061766406769178, -0.054312121517383,  0.000000000000000,
                                -0.000000000000000,  0.019444931245847, -0.016572065672482,
                                 0.049348748095369,  0.008252492653703,  0.000000000000000,
                                -0.000000000000000, -0.390865879856073, -0.278754989305717,
                                 0.000000000000000, -0.000000000000000,  0.005050654303224,
                                 0.162594520583426, -0.000000000000001, -0.000000000000000,
                                -0.068802063110635, -0.007760502839718,  0.000000000000000,
                                -0.000000000000000, -0.111346907789822,  0.000877045559119,
                                 0.000000000000000,  0.000000000000000,  0.630019243944883,
                                 0.440812260283349,  0.000000000000000, -0.000000000000000,
                                -0.119515242923505,  0.095720757800134, -0.000000000000000,
                                -0.000000000000000,  0.073651334256414,  0.061766406769178,
                                -0.000000000000000, -0.000000000000000, -0.105004104035868,
                                -0.019444931245847, -0.000000000000000, -0.000000000000000,
                                -0.001548596467477, -0.004105692408620,  0.000000000000000,
                                 0.000000000000000, -0.159083150169926, -0.195188616960638,
                                 0.000000000000000,  0.000000000000000,  0.183488541504174,
                                 0.267158814486036,  0.000000000000000,  0.000000000000000,
                                 0.059401825330953,  0.111756624047078,  0.000000000000000,
                                 0.000000000000000,  0.046053796277698,  0.077804453910485,
                                 0.000000000000000,  0.000000000000000,  0.078685720993638,
                                -0.075407837563521,  0.000000000000000,  0.000000000000000,
                                 0.131399592795571,  0.193213589839266, -0.000000000000000,
                                -0.000000000000000,  0.041797061685225,  0.054312121517383,
                                 0.000000000000000, -0.000000000000000,  0.007208515127214,
                                 0.016572065672482,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.122709398369009,
                                -0.010778402448764,  0.000000000000000, -0.000000000000000,
                                -0.295678525486408, -0.247333446186212,  0.000000000000000,
                                -0.000000000000000,  0.052230851430148, -0.003786191083407,
                                 0.000000000000000, -0.000000000000000, -0.037485542317195,
                                 0.186629506355524,  0.000000000000000, -0.000000000000000,
                                 0.096067233644164, -0.046551677580642,  0.000000000000000,
                                -0.000000000000000,  0.119515242923505, -0.131399592795571,
                                 0.000000000000000, -0.000000000000000,  0.008319199473549,
                                 0.099591197290766, -0.000000000000000, -0.000000000000000,
                                -0.217560893892505, -0.169451646429981, -0.000000000000000,
                                -0.000000000000000, -0.040563867284411,  0.004791866871771,
                                 0.000000000000000,  0.000000000000000,  0.033704068733351,
                                -0.028666363140755,  0.000000000000000,  0.000000000000000,
                                -0.320732580658678, -0.328153443636237,  0.000000000000000,
                                 0.000000000000000,  0.008664053117716, -0.007482575682416,
                                 0.000000000000000,  0.000000000000000,  0.158206816610374,
                                 0.272388407625927,  0.000000000000000,  0.000000000000000,
                                -0.009955365733515, -0.077858166801187,  0.000000000000000,
                                 0.000000000000000, -0.095720757800134, -0.193213589839266,
                                 0.000000000000000,  0.000000000000000, -0.041473924544634,
                                 0.256691334538784,  0.000000000000000, -0.000000000000000,
                                -0.226492665249274, -0.223196196518921,  0.000000000000000,
                                -0.000000000000000, -0.012171767101951,  0.012135774018422,
                                -0.122709398369009, -0.033704068733351,  0.000000000000000,
                                -0.000000000000000,  0.295678525486407,  0.320732580658678,
                                -0.000000000000000, -0.000000000000000, -0.052230851430148,
                                -0.008664053117716,  0.000000000000000, -0.000000000000000,
                                 0.037485542317195, -0.158206816610374, -0.000000000000001,
                                -0.000000000000000, -0.096067233644163,  0.009955365733515,
                                 0.000000000000000, -0.000000000000000, -0.119515242923505,
                                 0.095720757800134,  0.000000000000000,  0.000000000000000,
                                -0.008319199473549,  0.041473924544634,  0.000000000000000,
                                -0.000000000000000,  0.217560893892505,  0.226492665249274,
                                -0.000000000000000, -0.000000000000000,  0.040563867284411,
                                 0.012171767101951, -0.000000000000000, -0.000000000000000,
                                 0.010778402448764,  0.028666363140755,  0.000000000000000,
                                 0.000000000000000,  0.247333446186212,  0.328153443636237,
                                 0.000000000000000,  0.000000000000000,  0.003786191083407,
                                 0.007482575682416,  0.000000000000000,  0.000000000000000,
                                -0.186629506355524, -0.272388407625927,  0.000000000000000,
                                 0.000000000000000,  0.046551677580642,  0.077858166801187,
                                 0.000000000000000,  0.000000000000000,  0.131399592795571,
                                 0.193213589839266,  0.000000000000000,  0.000000000000000,
                                -0.099591197290766, -0.256691334538784,  0.000000000000000,
                                 0.000000000000000,  0.169451646429981,  0.223196196518921,
                                -0.000000000000000, -0.000000000000000, -0.004791866871771,
                                -0.012135774018422,  0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000, -0.116376801074970,
                                -0.043923671225316,  0.000000000000000, -0.000000000000000,
                                 0.000218073452978,  0.000698680167878,  0.000000000000000,
                                -0.000000000000000,  0.342616219756544,  0.257810066711544,
                                 0.000000000000000, -0.000000000000000, -0.264177904920759,
                                -0.124307882640111,  0.000000000000000, -0.000000000000000,
                                 0.319896233131405,  0.088519247197046,  0.000000000000000,
                                -0.000000000000000, -0.073651334256414, -0.041797061685225,
                                 0.000000000000000, -0.000000000000000, -0.217560893892505,
                                -0.169451646429981,  0.000000000000000, -0.000000000000000,
                                -0.001494482813223,  0.119055768529456, -0.000000000000000,
                                -0.000000000000000, -0.075191008393334, -0.029238115303939,
                                 0.000000000000000,  0.000000000000000, -0.103661856144219,
                                -0.033625477641283,  0.000000000000000,  0.000000000000000,
                                 0.001504480898443,  0.000738744831000,  0.000000000000000,
                                 0.000000000000000,  0.349827019318919,  0.338319054230750,
                                 0.000000000000000,  0.000000000000000, -0.201526815897616,
                                -0.156822033931692,  0.000000000000000,  0.000000000000000,
                                 0.197986395403143,  0.095030945668746,  0.000000000000000,
                                 0.000000000000000, -0.061766406769178, -0.054312121517383,
                                 0.000000000000000,  0.000000000000000, -0.226492665249274,
                                -0.223196196518921,  0.000000000000000,  0.000000000000000,
                                 0.001114300574064,  0.256893722482330,  0.000000000000000,
                                -0.000000000000000, -0.068734334830468, -0.022398896275119,
                                 0.116376801074970,  0.103661856144219, -0.000000000000000,
                                -0.000000000000000, -0.000218073452978, -0.001504480898443,
                                 0.000000000000000, -0.000000000000000, -0.342616219756544,
                                -0.349827019318919, -0.000000000000000, -0.000000000000000,
                                 0.264177904920759,  0.201526815897616,  0.000000000000000,
                                -0.000000000000000, -0.319896233131405, -0.197986395403143,
                                 0.000000000000000, -0.000000000000000,  0.073651334256414,
                                 0.061766406769178,  0.000000000000000, -0.000000000000000,
                                 0.217560893892505,  0.226492665249274,  0.000000000000000,
                                 0.000000000000000,  0.001494482813223, -0.001114300574064,
                                 0.000000000000000, -0.000000000000000,  0.075191008393334,
                                 0.068734334830468, -0.000000000000000, -0.000000000000000,
                                 0.043923671225316,  0.033625477641283,  0.000000000000000,
                                 0.000000000000000, -0.000698680167878, -0.000738744831000,
                                 0.000000000000000,  0.000000000000000, -0.257810066711544,
                                -0.338319054230750,  0.000000000000000,  0.000000000000000,
                                 0.124307882640111,  0.156822033931692,  0.000000000000000,
                                 0.000000000000000, -0.088519247197046, -0.095030945668746,
                                 0.000000000000000,  0.000000000000000,  0.041797061685225,
                                 0.054312121517383,  0.000000000000000,  0.000000000000000,
                                 0.169451646429981,  0.223196196518921,  0.000000000000000,
                                 0.000000000000000, -0.119055768529456, -0.256893722482330,
                                 0.000000000000000,  0.000000000000000,  0.029238115303939,
                                 0.022398896275119, -0.000000000000000, -0.000000000000000,
                                 0.000000000000000, -0.000000000000000,  0.001852618531763,
                                 0.000083817961309,  0.000000000000000, -0.000000000000000,
                                 0.122312584601403,  0.044033612065375,  0.000000000000000,
                                -0.000000000000000, -0.133061895796010,  0.010483589519766,
                                 0.000000000000000, -0.000000000000000, -0.010659465317641,
                                -0.001260612518809,  0.000000000000000, -0.000000000000000,
                                -0.057025313130078,  0.001481919246796,  0.000000000000000,
                                -0.000000000000000,  0.105004104035868, -0.007208515127214,
                                 0.000000000000000, -0.000000000000000, -0.040563867284411,
                                 0.004791866871771,  0.000000000000000, -0.000000000000000,
                                -0.075191008393334, -0.029238115303939,  0.000000000000000,
                                -0.000000000000000, -0.136127133012073,  0.023004377516322,
                                 0.000000000000000,  0.000000000000000,  0.000393940013169,
                                 0.000066530922836,  0.000000000000000,  0.000000000000000,
                                 0.104588282935190,  0.033670336702622,  0.000000000000000,
                                 0.000000000000000, -0.035538010215707,  0.028478758876030,
                                 0.000000000000000,  0.000000000000000, -0.001014108595884,
                                -0.002307117376965,  0.000000000000000,  0.000000000000000,
                                -0.008490582284404,  0.003592018796788,  0.000000000000000,
                                 0.000000000000000,  0.019444931245847, -0.016572065672482,
                                 0.000000000000000,  0.000000000000000, -0.012171767101951,
                                 0.012135774018422,  0.000000000000000,  0.000000000000000,
                                -0.068734334830468, -0.022398896275119,  0.000000000000000,
                                 0.000000000000000, -0.058346047208244,  0.073351440406779,
                                -0.001852618531763, -0.000393940013169,  0.000000000000000,
                                -0.000000000000000, -0.122312584601403, -0.104588282935190,
                                -0.000000000000000, -0.000000000000000,  0.133061895796010,
                                 0.035538010215707,  0.000000000000000, -0.000000000000000,
                                 0.010659465317641,  0.001014108595884,  0.000000000000000,
                                -0.000000000000000,  0.057025313130078,  0.008490582284404,
                                 0.000000000000000, -0.000000000000000, -0.105004104035868,
                                -0.019444931245847,  0.000000000000000, -0.000000000000000,
                                 0.040563867284411,  0.012171767101951,  0.000000000000000,
                                -0.000000000000000,  0.075191008393334,  0.068734334830468,
                                 0.000000000000000,  0.000000000000000,  0.136127133012073,
                                 0.058346047208244,  0.000000000000000, -0.000000000000000,
                                -0.000083817961309, -0.000066530922836,  0.000000000000000,
                                 0.000000000000000, -0.044033612065375, -0.033670336702622,
                                 0.000000000000000,  0.000000000000000, -0.010483589519766,
                                -0.028478758876030,  0.000000000000000,  0.000000000000000,
                                 0.001260612518809,  0.002307117376965,  0.000000000000000,
                                 0.000000000000000, -0.001481919246796, -0.003592018796788,
                                 0.000000000000000,  0.000000000000000,  0.007208515127214,
                                 0.016572065672482,  0.000000000000000,  0.000000000000000,
                                -0.004791866871771, -0.012135774018422,  0.000000000000000,
                                 0.000000000000000,  0.029238115303939,  0.022398896275119,
                                 0.000000000000000,  0.000000000000000, -0.023004377516322,
                                -0.073351440406779,  0.000000000000000,  0.000000000000000};
    
    ASSERT_EQ(lmomzmat, CDenseMatrix(intzvals, 36, 36));
}
